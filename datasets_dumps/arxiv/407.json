{"entry_id": "http://arxiv.org/abs/2303.06762v1", "published": "20230312215845", "title": "$hp$-Multigrid preconditioner for a divergence-conforming HDG scheme for the incompressible flow problems", "authors": ["Guosheng Fu", "Wenzheng Kuang"], "primary_category": "math.NA", "categories": ["math.NA", "cs.NA", "65N30, 65N12, 65N55, 76D07"], "text": "\nhp-MG for H(div)-HDG]hp-multigrid preconditioner for a divergence-conforming HDG scheme for the incompressible flow problems\n\n\nDepartment of Applied and Computational Mathematics and \nStatistics, University of Notre Dame, USA.\ngfu@nd.edu\nWe gratefully acknowledge the partial support of this work\n\tby the U.S. National Science Foundation through grant DMS-2012031.\n\nDepartment of Applied and Computational Mathematics and \n\tStatistics, University of Notre Dame, USA.\nwkuang1@nd.edu\n\n\n65N30, 65N12, 65N55, 76D07\n\n    In this study, we present an hp-multigrid preconditioner for\n    \n    a divergence-conforming HDG scheme for the generalized Stokes and the Navier-Stokes equations using an augmented Lagrangian formulation. \n    Our method relies on conforming simplicial meshes in two- and three-dimensions. The hp-multigrid algorithm is a multiplicative auxiliary space preconditioner that employs the lowest-order space as the auxiliary space, and we developed a geometric multigrid method as the auxiliary space solver. For the generalized Stokes problem, the crucial ingredient of the geometric multigrid method is the equivalence between the condensed lowest-order divergence-conforming HDG scheme and a Crouzeix-Raviart discretization with a pressure-robust treatment as introduced in <cit.>, which allows for the direct application of geometric multigrid theory on the Crouzeix-Raviart discretization. \n    The numerical experiments demonstrate the robustness of the proposed hp-multigrid preconditioner with respect to mesh size and augmented Lagrangian parameter, with\n    iteration counts insensitivity to polynomial order increase. Inspired by the works by Benzi and Olshanskii <cit.> and Farrell et al. <cit.>, we further test the proposed preconditioner on the divergence-conforming HDG scheme for the Navier-Stokes equations. Numerical experiments show a mild increase in the iteration counts of the preconditioned GMRes solver with the rise in Reynolds number up to 10^3.\n\n[\n    Wenzheng Kuang\n    March 30, 2023\n==================\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n\n\nThe development of pressure-robust numerical schemes for incompressible flow problems has emerged as an active research topic in recent years. In the continuous setting, when the source term of the Stokes and Navier-Stokes equations is changed by a gradient field, only the pressure solution is affected, while the velocity solution remains unchanged. The key objective of pressure-robust numerical schemes is to maintain this invariance, so that the obtained numerical velocity solution is exactly divergence-free and its error estimation is independent of the regularity of the pressure solution of the incompressible flow problems. We refer to <cit.> for a comprehensive review of the pressure-robust finite element methods.\n\nAmong the developed pressure-robust numerical schemes, divergence-conforming hybridizable discontinuous Galerkin (H(div)-HDG) methods \n are an efficient variant of the divergence-conforming discontinuous Galerkin (DG) methods. By leveraging the hybridization technique, coupling between the degrees of freedom (DOFs) of the H(div)-HDG is reduced. Additionally, the H(div)-HDG schemes can be statically condensed into a global system where only DOFs on the mesh skeleton remain, resulting in a much smaller matrix to be solved. At the same time, the HDG schemes retain attractive features of DG schemes, such as hp-adaptivity, stable upwind discretization of the convection term, and the ability to handle unstructured meshes with hanging nodes. The grad-velocity-pressure formulation for the H(div)-HDG was first introduced by Cockburn and Sayas in <cit.> for the Stokes flow, and later generalized to the Brinkman equation in <cit.>. Lehrenfeld and Sch\u00f6berl <cit.> proposed and analyzed a symmetric interior penalty formulation for the H(div)-HDG scheme for the Stokes and Navier-Stokes equations. Different from the aforementioned methods, Rhebergen and Wells <cit.> constructed H(div)-HDG scheme with facet unknowns for the pressure as Lagrange multipliers to ensure the numerical velocity solution is exactly divergence-free, and this scheme is then extended to the Navier-Stokes equations in <cit.>.\n\nHowever, constructing efficient solvers and preconditioners for large-scale simulations for the statically condensed systems of high-order HDG schemes remains a challenge and has attracted interest in recent years. For the H(div)-HDG scheme for the incompressible flow problems, most solvers are focused on block preconditioner for the saddle-point structure of the condensed H(div)-HDG for the Stokes flow <cit.>, seeking a robust approximation of the Schur complement.\nIn this study, we propose a robust hp-geometric multigrid preconditioner for the\nthe H(div)-HDG scheme for both the generalized Stokes and Navier-Stokes equations. \n\nConstructing geometric multigrid algorithms for the condensed HDG schemes poses a challenge in designing a stable intergrid transfer operator between different mesh levels. This difficulty arises because the global DOFs of the condensed systems exist only on the mesh skeleton, and the finite element spaces of these global unknowns on different mesh levels are non-nested. In <cit.>, some intuitive choices of the intergrid transfer operators were tested for Poisson's equation but proved to be unstable and not optimal by numerical expriments.\n\nTo tackle this problem, Cockburn et al. <cit.> first introduced a \u201ctwo-level\" V-cycle multigrid for the HDG scheme for Poisson's equation in the spirit of the auxiliary space preconditioning (ASP) technique, where they employed a continuous piece-wise linear finite element space on the same mesh as the auxiliary space. The residual of the condensed HDG system is projected onto the auxiliary space and there is no coarse-grid facet unknown space.\nHowever, adopting such an approach for the H(div)-HDG scheme problems for incompressible flow problems could be challenging. A stable projection operator on to an inf-sup stable pair of auxiliary spaces is needed, and moreover there is no natural correspondent for the upwind HDG discretization of the convection term in the continuous finite element spaces. \nLu et al. <cit.> have recently proposed an approach that keeps the HDG discretization on the coarse grid and constructs a novel prolongation operator, where hierarchical continuous finite element spaces are used to link facet variable spaces on different mesh levels.\n\n\nLu et al. proved that the standard V-cycle algorithm exhibits h-robust convergence for the local HDG scheme (LDG-H) for Poisson's equation, and extended their findings to the single-face hybridizable (SFH), hybrid Raviart-Thomas (RT-H), and hybrid Brezzi-Douglas-Marini (BDM-H) schemes for the Stokes equation in a more recent study <cit.>. To solve the saddle-point structure of the HDG scheme, they employed an augmented Lagrangian with parameter \u0394 t and iteratively solved it (outer iteration), with the standard V-cycle used as the solver of the condensed SPD system (inner iteration). However, while the fast convergence of the outer iteration requires a large \u0394 t, the V-cycle of the inner iteration is not robust with \u0394 t and may result in a large total iteration count.\n\nIn this study, we propose an hp-multigrid preconditioner for the condensed global systems of the grad-velocity-pressure formulation for the H(div)-HDG scheme for the generalized Stokes and the Navier-Stokes equations on conforming simplicial meshes. The augmented Lagrangian Uzawa iteration method is used to solve the condensed H(div)-HDG schemes, and we aim to accelerate Krylov space solvers by the hp-multigrid preconditioner for the primal operator on global velocity spaces. Our hp-multigrid is essentially a multiplicative ASP, with lowest-order global velocity spaces as the auxiliary space and geometric h-multigrid method as the auxiliary space solver. For the generalized Stokes equation, the key to the geometric multigrid algorithm is the establishment of the equivalence between the condensed lowest order H(div)-HDG scheme and the nonconforming Crouzeix-Raviart (CR) discretization with a pressure-robust treatment, with both methods introduced in <cit.> as approaches to satisfy the exact divergence-free constraint in incompressible flow problems. We note that the equivalence between the CR discretization and the lowest-order Raviart-Thomas (RT) mixed method is well-known for Poisson's equation <cit.>. Motivated by this, we proved in our previous work <cit.> the equivalence between the condensed lowest-order HDG scheme (HDG-P0) and a (scaled) CR discretization for the generalized Stokes equation. In this work, we extend and prove the equivalence between the condensed lowest-order H(div)-HDG scheme and a pressure-robust treated CR discretization.\nFig.<ref> demonstrates the DOFs of the condensed HDG-P0, condensed lowest-order H(div)-HDG and CR discretization.\nSuch equivalence allows us to directly employ the rich geometric multigrid theory for CR discretization.\nThen we use the geometric multigrid as the building block of the hp-multigrid for the condensed higher-order H(div)-HDG schemes. Numerical experiments support the robustness of the preconditioner with respect to mesh size and the augmented Lagrangian parameter, with iteration counts insensitivity to polynomial order increase. Inspired by the works by Benzi and Olshanskii <cit.>, and Farrell et al. <cit.>, we further test the developed hp-preconditioenr on the condensed H(div)-HDG scheme for the linearized Naiver-Stokes equation by Picard and Newton's method. Our numerical experiments demonstrate that the proposed preconditioner still works well, with a mild increase of the iteration counts of the preconditioned GMRes solver for Reynolds number as large as 10^3.\n\n\n\nThe rest of the paper is organized as follows. Basic notations and the finite element spaces to be used in the H(div)-HDG schemes are introduced in Section <ref>. In Section <ref>, we present the grad-velocity-pressure formulation of the H(div)-HDG scheme for the generalized Stokes equation and propose the augmented Lagrangian Uzawa iteration for the condensed system. We first focus on the lowest order case, prove the equivalence to the CR discretization and present the geometric multigrid algorithm, then we use it as the building block for the hp-multigrid preconditioner for higher-order cases. In Section <ref>, we present the H(div)-HDG scheme for the Navier-Stokes equations. We use Picard linearization to search for a close enough initial guess and then use Newton's method to accelerate convergence. Two- and three-dimensional numerical experiments are performed in Section <ref> and we conclude in Section <ref>.\n\n\n\n\n\n\u00a7 PRELIMINARIES AND NOTATIONS\n\n\nWe assume a bounded polygonal/polyhedral domain \u03a9\u2208\u211d^d, d\u2208{2, 3}, with boundary \u2202\u03a9. We denote  as a conforming, shape-regular and quasi-uniform simplicial triangulation of the domain \u03a9, and  as the set of facets of .  is also referred to as mesh skeleton. We split  into the boundary part ^\u2202 := {F\u2208 |  F\u2282\u2202\u03a9} and the interior part ^o:=\\^\u2202. \n\nFor each element K\u2208 with element boundary \u2202 K, we denote |K| as the measure of K, (\u00b7, \u00b7)_K as the L^2-inner product over K, \u27e8\u00b7, \u00b7\u27e9_\u2202 K as the L^2-inner product over \u2202 K. We further define (\u00b7, \u00b7)_:= \u2211_K\u2208(\u00b7, \u00b7)_K as the discrete L^2 inner product over the domain, and \u27e8\u00b7, \u00b7\u27e9_\u2202:= \u2211_K\u2208\u27e8\u00b7, \u00b7\u27e9_\u2202 K as the discrete L^2 inner product over all element boundaries.\n\n\n\nFurthermore, we denote n_K as the unit normal vector on \u2202 K pointing outward, \ud835\uddcd\ud835\uddc7\ud835\uddc0(w) := w-(w\u00b7n_K)n_K as the tangential component and \ud835\uddc7\ud835\uddcb\ud835\uddc6(w) := (w\u00b7n_K)n_K as the normal component on \u2202 K of a vector field w. \n\n\n\n\n\n\n\n\n\nAs usual, we denote \u00b7_p,S and |\u00b7|_p,S as the norm and semi-norm of the Sobolev spaces H^p(S) for the domain S\u2282\u211d^d, with p omitted when p=2, and S omitted when S=\u03a9 is the whole domain. \n\nFor the finite element spaces, we denote ^k(S) and ^k(S) as the polynomial and homogeneous polynomial of order k over a simplex S. The following spaces are used to construct the H(div)-conforming HDG scheme and the multigrid method:\n\n       W_h^k :=       {\n        q_h \u2208L_2(\u03a9):  q_h|_K \u2208^k(K),  \u2200K\u2208\ud835\udcaf_h },\n    \n\n       W_h,0^k :=       {\n        q_h \u2208W_h^k:  \u222b_\u03a9q_hdx = 0},\n    \n\n       V_h^k :=       {\n        v_h \u2208H(div;\u03a9):  v_h|_K \u2208[^k(K)]^d \u2295x ^k(K),  \u2200K\u2208\ud835\udcaf_h},\n    \n\n       V_h,0^k :=       {\n        v_h \u2208V_h^k:  v_h\u00b7n|_F = 0,  \u2200F\u2282\u2202\u03a9},\n    \n\n       V_h,k :=       {\n        v_h \u2208L_2(\u2130_h):  v_h|_F \u2208^k(F)  and  v_h\u00b7n|_F = 0,   \u2200F\u2208\u2130_h},\n    \n\n       V_h,0^k :=       {\n        v_h \u2208V_h^k:  \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h)|_F = 0,  \u2200F\u2282\u2202\u03a9},\n    \n\n       V_h^ :=       {v_h \u2208L^2(\u03a9):  v_h|_K \u2208^1(K),  \u2200K\u2208\ud835\udcaf_h, \n    \n           and v_h is continuous at the barycenter m_F of F, \u2200 F\u2208^o\n        },\n    \n\n       V_h,0^ :=       {v_h \u2208V_h^:  v_h(m_F) = 0, \u2200 F\u2208^\u2202}.\n\nV_h^k is the k-th order RT space <cit.> and V_h^ is the first-order nonconforming CR space <cit.>. In this work, we use underline to denote the vector version of the finite element spaces, and double underline line to denote the matrix version, e.g., V_h^ := [V_h^]^d and W_h^k := [W_h^k]^d\u00d7 d.\n\nNext, to facilitate our analysis of static condensation of the H(div)-conforming HDG scheme, we perform a hierarchical basis splitting for the RT space V_h^k following <cit.>. We first divide V_h^k into global subspace V_h^k,\u2202 and local subspace V_h^k,o, i.e.\n\n    V_h^k=\n        V_h^k,\u2202\u2295V_h^k,o.\n\nFor the global subspace V_h^k,\u2202, we have\n\n    V_h^k,\u2202   :=\n        \u2295_F\u2208span{\u03d5^0_F}  \u2295\u2295_c\n                F\u2208\n    i=1,\u2026,n_F^kspan{\u03d5_F^i},\n\nand\n\n    \u2207\u00b7v_h^\u2202|_K \u2208^0(K),\n           (v_h^\u2202\u00b7n_K)|_F \u2208^k(F), \n          \u2200 F\u2208\u2202 K, K\u2208,   \u2200v_h^\u2202\u2208V_h^k,\u2202,\n\nwhere \u03d5_F^0 is the basis of the lowest-order Raviart-Thomas (RT0) space on the facet F, and \u03d5_F^i is the higher-order basis of the divergence-free facet bubbles with normal component only supported on the facet F.\nFor the local subspace V_h^k,o, we have\n\n    V_h^k,o:=\n        \u2295_c\n                K\u2208\n    i=1,\u2026,n_K^k,1span{\u03d5_K^i}  \u2295\u2295_c\n                K\u2208\n    i=1,\u2026,n_K^k+1,2span{\u03c8_K^i},\n\nand\n\n    \u2207\u00b7v_h^o|_K \u2208^k(K)\\\u211d,\n           (v_h^o\u00b7n_K)|_F = 0, \n          \u2200 F\u2208\u2202 K, K\u2208,   \u2200v_h^o\u2208V_h^k,o,\n\nwhere \u03d5_K^i, i=1,\u2026,n_K^k,1, is the higher order basis of the divergence-free bubbles on the element K with zero normal components on ; and \u03c8_K^i, i=1,\u2026 n_K^k+1,2, is the higher order basis on the element K with zero normal components on  and nonzero divergence. \nHere the integers n_F^k,n_K^k,1,n_K^k,2 are denoted as the number of basis functions of each corresponding group per facet/element. \nWe also split W_h^k into element-wise constant space and its complement, i.e.\n\n    W_h^k =\n        W_h^\u2202\u2295 W_h^k,o,\n\nwhere\n\n    W_h^\u2202   := W_h^0,\n        \n    \n        W_h^k,o   :=\n        {q\u2208 W_h^k:  (q, 1)_K=0, \u2200 K\u2208}.\n\nThus by the definition of the subspaces, we have\n\n    \u2207\u00b7V_h^k,\u2202   = W_h^\u2202,\n    \u2207\u00b7V_h^k,o   = W_h^k,o.\n\nWhen k=0, there is no high-order local components in V_h^0 and W_h^0. We refer readers to<cit.> for more details of the basis functions of RT space.  \n\nFor two positive constants a and b, we denote a\u2272 b if there exists a positive constant C independent of mesh size and model parameters \nsuch that a\u2264 Cb. We denote a \u2243 b when a\u2272 b and b\u2272 a.\n\n\n\n\n\n\u00a7 GENERALIZED STOKES EQUATION\n\n\n\n\n \u00a7.\u00a7 Model problem\n\n\nLet f\u2208 L^2(\u03a9) be the source term and assume homogeneous Dirichlet boundary condition for simplicity. The model problem is to find (u, p) satisfying \n\n    \n    \n        - \u2207\u00b7(\u03bd\u2207u) + \u03b2u + \u2207p \n        =     f,         in \u03a9,\n        \n\n        \u2207\u00b7u =      0,         in \u03a9,\n        \n\n        u=     0,         on \u2202\u03a9,\n    \n\nwhere u is the velocity, p is the pressure, \u03bd > 0 is a constant representing the fluid viscosity, and the lower-order term coefficient 0\u2264\u03b2_0\u2264\u03b2\u2264\u03b2_1.\n\n\nTo present the H(div)-HDG scheme for the generalized Stokes equation, we introduce the tensor L:= - \u03bd\u2207u as a new variable and rewrite (<ref>) into a first-order system:\n\n    \n    \n        \u03bd^-1L + \u2207u =      0,         in \u03a9,\n        \n\n        \u2207\u00b7L + \u03b2u \n        + \u2207p =      f,         in \u03a9,\n        \n\n        \u2207\u00b7u =      0,         in \u03a9,\n        \n\n        u =      0,         on \u2202\u03a9.\n    \n\nBoth the superconvergence property of the H(div)-HDG scheme used in this study and the geometric multigrid analysis for the lowest-order case require the following full elliptic regularity result for the solution (L, u, p) \u2208H^1(\u03a9)\u00d7(H^2(\u03a9)\u2229H^1_0(\u03a9)\u00d7 (H^1(\u03a9)\\\u211d) to the model problem (<ref>):\n\n    L_1 + u_2 + p_1 \n        \u2272f_0,\n\nwhich holds in convex domain \u03a9.\n\n\n\n \u00a7.\u00a7 The H(div)-HDG scheme\n\nThe H(div)-HDG scheme used in this study for the system (<ref>) is to find (L_h, u_h, u_h, p_h) \u2208W_h^k \u00d7V_h,0^k \u00d7V_h,0^k\u00d7 W_h,0^k, k \u2265 0, such that\n\n\n    \n    \n    (\u03bd^-1L_h, G_h)_\ud835\udcaf_h  \n            + (\u2207u_h, G_h)_\ud835\udcaf_h\n            - \u27e8\ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h - u_h), G_hn_K\u27e9_\u2202\ud835\udcaf_h   = 0,\n            \n    \n            -( L_h, \u2207v_h )_\ud835\udcaf_h\n            + \u27e8L_hn_K, \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h - v_h) \u27e9_\u2202\n            + (\u03b2u_h, v_h)_\ud835\udcaf_h \n            - (p, \u2207\u00b7v_h)_    = (f, v_h)_\ud835\udcaf_h,\n            \n    \n            (\u2207\u00b7u_h,  q_h)_\ud835\udcaf_h   = 0,\n\n\nfor all (G_h, v_h, v_h, q_h)\u2208W_h^k \u00d7V_h,0^k \u00d7V_h,0^k\u00d7 W_h,0^k.\n\nThe above H(div)-HDG scheme has been studied in <cit.> for the Brinkman equations. Besides the superconvergence property for post-processed velocity when k\u2265 1, the numerical solution (L_h, u_h, u_h, p_h) to the H(div)-HDG scheme (<ref>) has optimal a priori error analysis results when k\u2265 0 that are parameter-robust with respect to the ratio \u03bd / \u03b2. Since \u2207\u00b7V_h^k=W_h^k, the velocity error estimates are pressure-robust. We refer readers to <cit.> for more details.\nNote that no extra facet-based HDG stabilization is introduced in the scheme (<ref>), hence, it is technically a hybrid-mixed method. Here we follow the convention in  <cit.>, and still call it an HDG method.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBased on the subspace splitting in Section <ref>, we split the numerical solution (L_h, u_h, u_h, p_h) to (<ref>) into local variables (L_h, u_h^o, p_h^o)\u2208W_h^k \u00d7V_h^k,o\u00d7 W_h^k,o and global variables (u_h^\u2202, u_h, p_h^\u2202)\u2208V_h,0^k,\u2202\u00d7V_h,0^k\u00d7 W_h,0^\u2202, where\n\n    u_h = u_h^o + u_h^\u2202,\n           p_h = p_h^o + p_h^\u2202.\n\nWhen implementing the H(div)-HDG scheme (<ref>), we first eliminate the local variables to arrive at the condensed global system composed of the global variables. After solving (u_h^\u2202, u_h, p_h^\u2202) from the condensed global system, which is the most computationally costly part, we recover the local variables in an element-by-element manner.\nTo simplify notation, we denote \ud835\udd67_h:=(v_h, v_h), \ud835\udd67_h^\u2202:=(v_h^\u2202, v_h),\n\ud835\udd4d_h^k:=V_h^k\u00d7V_h^k, \nand \ud835\udd4d_h^k,\u2202:=V_h^k,\u2202\u00d7V_h^k from now on.\nWe introduce an L^2-like inner-product on \ud835\udd4d_h^k,\u2202:\n\n    (\ud835\udd66_h^\u2202, \ud835\udd67_h^\u2202)_0, h\n        := \n            \u2211_K\u2208|K|/d+1(\u27e8\ud835\uddc7\ud835\uddcb\ud835\uddc6(u_h), \ud835\uddc7\ud835\uddcb\ud835\uddc6(v_h) \u27e9_\u2202\n            +\n            \u27e8\ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h), \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h) \u27e9_\u2202)\n\nfor all \ud835\udd66_h^\u2202,\ud835\udd67_h^\u2202\u2208\ud835\udd4d_h^k, \u2202, with the induced norm \u00b7_0, h. The constant global pressure space W_h^\u2202 is equipped with standard L^2 norm denoted as\n\n    [p_h^\u2202,  q_h^\u2202]_0,h :=\n        (p_h^\u2202,  q_h^\u2202)_,\n          \u2200 p_h^\u2202, q_h^\u2202\u2208 W_h^\u2202.\n\nThe characterization of the condensed system of (<ref>) has been studied in <cit.> and the operator form is to find (\ud835\udd66_h^\u2202, p_h^\u2202)\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 satisfying\n\n    \n    \n    A_k,h\ud835\udd66_h^\u2202\n            + B_k,h^\u2217 p_h^\u2202 =    F_k,h\n    B_k,h\ud835\udd66_h^\u2202 =     0,\n\n\n for all \ud835\udd66_h^\u2202, \ud835\udd67_h^\u2202\u2208\ud835\udd4d_h,0^k,\u2202 and q_h^\u2202\u2208 W_h,0^\u2202, where\n\n    (A_k,h\ud835\udd66_h^\u2202, \ud835\udd67_h^\u2202)_0,h:=    \n        (\u03bd\u2112(\ud835\udd66_h^\u2202), \u2112(\ud835\udd67_h^\u2202))_\n        + (\u03b2u_h^\u2202, v_h^\u2202)_,\n        \n    \n        [B_k,h\ud835\udd66_h^\u2202,  q_h^\u2202]_0,h:=    \n        -(\u2207\u00b7u_h^\u2202,  q_h^\u2202)_,\n\nand \u2112:\ud835\udd4d_h,0^k,\u2202\u2192W_h^k is a mapping defined by the local solvers of the H(div)-HDG scheme, and B_k,h^\u2217:W_h,0^\u2202\u2192\ud835\udd4d_h,0^k,\u2202 is the transpose of B_k,h:\ud835\udd4d_h,0^k,\u2202\u2192 W_h,0^\u2202 with respect to L^2 inner product:\n\n    (B_k,h^\u2217 p_h^\u2202, \ud835\udd67_h^\u2202)_0,h\n        = [p_h^\u2202, B_k,h\ud835\udd67_h^\u2202]_0,h,\n          \u2200 p_h^\u2202\u2208 W_h,0^\u2202, \ud835\udd67_h^\u2202\u2208\ud835\udd4d_h,0^k,\u2202\n\n\nIt is clear to see that A_k,h:\ud835\udd4d_h,0^k,\u2202\u2192\ud835\udd4d_h,0^k,\u2202 is a symmetric positive definite (SPD) operator, and we denote \u00b7_A_k,h as the induced norm on \ud835\udd4d_h,0^k,\u2202, i.e. \u00b7_A_k,h := \u221a((A_k,h\u00b7, \u00b7)_0,h) \n\n\n\n \u00a7.\u00a7 Augmented Lagrangian Uzawa iteration for the condensed H(div)-HDG\n\nTo avoid solving saddle-point system, we apply the augmented Lagrangian Uzawa iteration method <cit.>.\n\n. \nThe saddle-point system is first transformed into an equivalent augmented Lagrangian formulation: find (\ud835\udd66_h^\u2202, p_h^\u2202)\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 satisfying\n\n    \n    \n    (A_k,h+ \u03f5^-1B_k,h^\u2217B_k,h)_A_k,h^\u03f5\ud835\udd66_h^\u2202 \n            + B_k,h^\u2217 p_h^\u2202 =   F_k, h,\n            \n    B_k,h\ud835\udd66_h^\u2202 =    0,\n\n\nwhere \u03f5 is a small augmented Lagrangian parameter, which is also referred to as the penalty parameter. The operator form of \u03f5^-1B_k,h^\u2217B_k,h is expressed as\n\n    (\u03f5^-1B_k,h^\u2217B_k,h\ud835\udd66_h^\u2202, \ud835\udd67_h^\u2202)_0,h\n        = \u03f5^-1(\u2207\u00b7u_h^\u2202, \u2207\u00b7v_h^\u2202)_,\n          \u2200\ud835\udd66_h^\u2202, \ud835\udd67_h^\u2202\u2208\ud835\udd4d_h,0^k,\u2202.\n\nThe Uzawa iteration method with \u03f5^-1\u226b 1 is to start with p_h^\u2202 (0)=0, and iteratively find \n(\ud835\udd66_h^\u2202 (n),p_h^\u2202 (n))\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 such that \n\n    \n    \n    A_k,h^\u03f5\ud835\udd66_h^\u2202 (n) =    F_k,h - B_k,h^\u2217 p_h^\u2202 (n-1),\n            \n    \n        p_h^\u2202  (n) =       p_h^\u2202  (n-1)- \u03f5^-1B_k,h\ud835\udd66_h^\u2202  (n),\n\n\nThe convergence property of the Augmented Lagrangian Uzawa iteration method (<ref>) has been studied in <cit.>, and we quote it here for completeness.\n\n    \n    Let (\ud835\udd66_h^\u2202, p_h^\u2202)\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 be the solution of (<ref>) and \n    (\ud835\udd66_h^\u2202  (n), p_h^\u2202  (n))\n    be the n-th Uzawa iteration solution to (<ref>). \nThen the following estimate holds:\n    \n    \ud835\udd66_h^\u2202 (n) - \ud835\udd66_h^\u2202_A_k,h\u2272   \u221a(\u03f5)p_h^\u2202 (n) - p_h^\u2202_0 \u2272 \u221a(\u03f5)(\u03f5/\u03f5+\u03bc_0)^np_h^\u2202_0,\n\n    where \u03bc_0 is the \n    minimal eigenvalue of the Schur complement\n    S_k,h=B_k,hA_k,h^-1B^\u2217_k,h.\n    \n\n\nThe discontinuous piecewise constant nature of the global pressure space W_h,0^\u2202 results in trivial computation in equation (<ref>). As a consequence, the major computational cost of a Uzawa iteration is associated with solving the global velocity equation (<ref>). Here we use the  preconditioned conjugate gradient (PCG) method to iteratively solve it. Specifically, we refer to the augmented Uzawa iteration method as the outer iteration, and the CG method for solving equation (<ref>) as the inner iteration. The subsequent subsections are devoted to designing an hp-multigrid algorithm to precondition the operator A_k,h^\u03f5 for the PCG method.\n\n\n\n\n    We are aware of the extensive body of literature on solving saddle-point problems, including the problem presented in equation (<ref>). For a comprehensive review, we refer the reader to <cit.>. In this work, we adopt the augmented Lagrangian Uzawa iteration method for two primary reasons. Firstly, by locally eliminating p_h^\u2202, the final matrix size is further reduced. Secondly, the resulting global velocity operator A_k,h^\u03f5 is SPD on the space \ud835\udd4d_h,0^k,\u2202, allowing us to use the CG method, for which the eigenvalues of the preconditioned linear operator are sufficient to characterize the convergence rate of the method. A good preconditioner for A_k,h^\u03f5 can also serve in block preconditioners as an approximate inverse of the primal (1,1)-block of the augmented Lagrangian transformed saddle-point structure as in (<ref>).\n\n    However, there are two potential drawbacks to this approach. Firstly, the term \u03f5^-1B_k,h^\u2217B_k,h in A_k,h^\u03f5 poses challenges for preconditioning when \u03f5^-1\u226b 1. Secondly, setting \u03f5 to an extremely small value leads to round-off issues. This is because the non-zero entries in the matrix A_k,h are of order \ud835\udcaa(1), whereas the entries in \u03f5^-1B_k,h^\u2217B_k,h are of order \ud835\udcaa(\u03f5^-1). \n    Hence, log(\u03f5^-1) digits loss is expected in a practical implementation.\n    In our numerical experiments, we \n    use double digit calculation with machine precision of 10^-16,  set \u03f5=10^-6, and perform two Uzawa iterations.\nHere the round-off error is of order \n\ud835\udcaa(10^-16/\u03f5)=\ud835\udcaa(10^-10).\n\n\n\n\n\n \u00a7.\u00a7 Geometric h-multigrid for the lowest-order scheme\n\nWe first focus on the lowest order case when k=0 and prove the equivalence between the condensed H(div)-HDG scheme (<ref>) and a CR discretization after a pressure-robust treatment. Then we propose for the lowest-order scheme a geometric h-multigrid method robust with the mesh size and the penalty parameter \u03f5.\n\n\n\n  \u00a7.\u00a7.\u00a7 Equivalence to a CR discretization\n\nTo explain the pressure-robust treatment of the CR discretization, we introduce an interpolation operator from vector CR space to the RT0 space \u03a0^RT:V_h^\u2192V_h^0 satisfying \n\n    \u222b_F (\u03a0^RTv_h^CR)\u00b7n_K ds = \u222b_F v_h^CRn_K ds,\n          \u2200 F\u2208\u2202 K, K\u2208, \u2200v_h^CR\u2208V_h^.\n \nTo establish the link between the lowest-order H(div)-HDG and the CR discretization, we define an interpolation operator from the lowest order RT0 and tangential facet finite element space to the vector CR space \u03a0^: \ud835\udd4d_h^0 \u2192V_h^:\n\n\n\n    \u03a0^\ud835\udd67_h (m_F) \u00b7n_K \n            = v_h(m_F)\u00b7n_K,\n        \n    \ud835\uddcd\ud835\uddc7\ud835\uddc0(\u03a0^\ud835\udd67_h(m_F))\n            = \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h(m_F)),\n\n\nfor all F \u2208\u2202 K, K\u2208, where m_F is the barycenter of facet F.\nBy counting the DOFs of the spaces, it is clear that \u03a0^ is an isomorphic mapping between \ud835\udd4d_h^0 and V_h^. Then we have the following property for the above interpolation operators:\n \n\nFor all \ud835\udd67_h\u2208\ud835\udd4d_h^0, we have:\n\n    \u03a0^RT\u03a0^CR\ud835\udd67_h    = v_h,\n        \n    \u2207\u00b7\u03a0^CR\ud835\udd67_h    = \n        \u2207\u00b7v_h.\n\n\n\n    With the definition of the interpolation operators in (<ref>)-(<ref>),\n    \n    we have\n    \n    \u222b_F (\u03a0^RT\u03a0^CR\ud835\udd67_h)\u00b7n_K ds \n            = \n            \u222b_F (\u03a0^CR\ud835\udd67_h)\u00b7n_K ds\n            =    \n            \n            \n            \n            \n            \u222b_F v_h\u00b7n_K ds,\n\n    for all \ud835\udd67_h\u2208\ud835\udd4d_h^0, F\u2208\u2202 K and K\u2208.\n\n\n\n\n\n    The result (<ref>) then immediately follows. \n    \n    Similarly, by the divergence theorem, we have for all \ud835\udd67_h\u2208\ud835\udd4d_h^0,\n    \n    \u222b_K\u2207\u00b7\u03a0^CR\ud835\udd67_h dx\n            =\n            \u222b_\u2202 K(\u03a0^CR\ud835\udd67_h)\u00b7n_Kds\n            \n            \n            \n            \n            =\n            \u222b_\u2202 Kv_h\u00b7n_K ds\n            =\n            \u222b_K\u2207\u00b7v_hdx,\n\n    and the divergence invariance (<ref>) follows from the fact that \n    \n    (\u2207\u00b7\u03a0^CR\ud835\udd67_h)|_K,\n           (\u2207\u00b7v_h)|_K \u2208^0(K), \n          \u2200 K\u2208.\n\n\nNow we are ready to present our main result below.\n\n\n\nLet (u_h^CR, p_h^CR) \u2208V_h,0^CR\u00d7 W_h,0^0 be the solution to the following nonconforming scheme:\n\n    \n    \n    \u03bd(\u2207u_h^CR, \u2207v_h^CR)_\n            +\u03b2(\u03a0^RTu_h^CR, \u03a0^RTv_h^CR)_\n            - (p_h^CR, \u2207\u00b7v_h^CR)_   = (f, \u03a0^RTv_h^CR)_,\n            \n    \n            (\u2207\u00b7u_h^CR,  q_h^CR)_   = 0,\n\n\nfor all (v_h^CR, q_h^CR) \u2208V_h,0^CR\u00d7 W_h,0^0. Then the solution (L_h, \ud835\udd66_h, p_h) \u2208W_h^0\u00d7\ud835\udd4d_h,0^0 \u00d7 W_h,0^0 to the lowest-order H(div)-HDG scheme for the generalized Stokes equation (<ref>) satisfies\n\n\n    \n    L_h     = -\u03bd\u2207u_h^CR,\n        \n    \u03a0^CR\ud835\udd66_h\n            = u_h^CR,\n        \n    \n        p_h    = p_h^CR.\n\n\n\n\nBy integration by parts and the definition of \u03a0^CR, we have\n\n    (\u2207u_h, G_h)_\ud835\udcaf_h\n        - \u27e8\ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h - u_h), G_hn_K\u27e9_\u2202\ud835\udcaf_h\n        =    \u27e8 (\ud835\uddc7\ud835\uddcb\ud835\uddc6(u_h) + \ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h), G_hn_K\u27e9_\u2202\ud835\udcaf_h\n        \n        - (u_h, \u2207\u00b7G_h)_\ud835\udcaf_h_\u2261 0\n    \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        =    \u27e8\u03a0^CR\ud835\udd66_h, G_hn_K\u27e9_\u2202\ud835\udcaf_h\n    \n        =    \n        (\u2207\u03a0^CR\ud835\udd66_h, G_h)_\ud835\udcaf_h\n        + ( \u03a0^CR\ud835\udd66_h, \u2207\u00b7G_h)_\ud835\udcaf_h_\u2261 0,\n\nfor all \ud835\udd66_h\u2208\ud835\udd4d_h,0^0 \nand G_h\u2208W_h^0,\nwhere we used the fact that G_h|_K\u2208^0(K). \n\nBy plugging (<ref>) into (<ref>), we immediately get \n\n    L_h \n        = -\u03bd\u2207\u03a0^CR\ud835\udd66_h.\n\n\nNext, with the same arguments as in proving (<ref>), for all \ud835\udd67_h\u2208\ud835\udd4d_h,0^0 and L_h\u2208W_h^0 we have\n\n    -( L_h, \u2207v_h )_\ud835\udcaf_h\n        + \u27e8L_hn_K, \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h - v_h) \u27e9_\u2202\n        =   (\u2207\u00b7L_h, v_h)__\u2261 0 \n        - \u27e8L_hn_K, \ud835\uddc7\ud835\uddcb\ud835\uddc6(u_h) + \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h)\n        \u27e9_\u2202\n    \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        =   \n        -\u27e8L_hn_K, \u03a0^CR\ud835\udd67_h\u27e9_\u2202\n    \n        =   -(\u2207\u00b7L_h, \u03a0^CR\ud835\udd67_h)__\u2261 0 \n        - (L_h, \u2207\u03a0^CR\ud835\udd67_h)_\n    \n        =   \u03bd(\u2207\u03a0^CR\ud835\udd66_h, \u2207\u03a0^CR\ud835\udd67_h)_,\n\nwhere we plug in the equivalence (<ref>) at the final step. Finally, by plugging (<ref>) into the lowest order H(div)-HDG scheme (<ref>) and results in Lemma <ref>, the lowest order H(div)-HDG scheme (<ref>) becomes finding (\ud835\udd66_h,  p_h)\u2208\ud835\udd4d_h,0^0\u00d7 W_h,0^0 satisfying\n\n    \n    \n    \u03bd(\u2207\u03a0^CR\ud835\udd66_h, \u2207\u03a0^CR\ud835\udd67_h)_\n         +\u03b2(\u03a0^RT\u03a0^CR\ud835\udd66_h, \u03a0^RT\u03a0^CR\ud835\udd67_h)_\ud835\udcaf_h   \n    \n         -(p_h, \u2207\u00b7\u03a0^CR\ud835\udd67_h)_    = (f, \u03a0^RT\u03a0^CR\ud835\udd67_h)_\ud835\udcaf_h\n    \n         (\u2207\u00b7\u03a0^CR\ud835\udd66_h,  q_h)_\ud835\udcaf_h   = 0,\n\n\nfor all (\ud835\udd67_h,  q_h)\u2208\ud835\udd4d_h,0^0\u00d7 W_h,0^0, and the equivalence results (<ref>) follows from the well-posedness of the CR discretization (<ref>).\n \n\n\n\nThe modified CR discretization (<ref>) was firstly introduced in <cit.> for the incompressible Stokes equation, i.e. \u03b2=0 in (<ref>). The original mixed CR discretization for the incompressible Stokes equation, though inf-sup stable, has poor mass conservation property and not pressure-robust velocity error estimates. To address this issue, the test function on the right hand side was reconstructed using \u03a0^RT, which maps discretely divergence-free test functions onto exactly divergence-free test functions and reconstructs the L^2-orthogonality between discretely divergence-free and irrotational vector fields in the mixed method, while the left hand side remains unchanged. Despite introducing extra inconsistency error into the scheme, optimal and pressure-robust discrete H^1 norm error estimates of velocity were obtained, and optimal and pressure-robust L^2 norm convergence rates were supported by numerical experiments. Later this pressure-robust treatment of CR discretization was extended to the incompressible generalized Stokes equation <cit.>, i.e. \u03b2\u2260 0 in (<ref>), where both the trial function and the test function in the mass term were further reconstructed onto RT0 space. It is worth mentioning that a skew-symmetric pressure-robust treatment for the convection term was also introduced in <cit.> for the CR discretization of the incompressible Navier-Stokes equations.\n\n\n\nIn practical implementation of the lowest-order H(div)-HDG scheme (<ref>), we first locally eliminate L_h and arrive at the condensed global system (<ref>) composed of (\ud835\udd66_h, p_h) where there is no higher-order local velocity and pressure components. Thus theorem <ref> implies the equivalence between the condensed lowest-order H(div)-HDG scheme (<ref>) and the modified CR discretization (<ref>). In other words, when k=0, the condensed H(div)-HDG scheme is equivalent to find (\ud835\udd66_h,p_h)\u2208\ud835\udd4d_h,0^0\u00d7 W_h,0^0 satisfying\n\n\n    \n    A_0,h\ud835\udd66_h\n            + B_0,h^\u2217 p_h =   F_0,h,\n            \n    B_0,h\ud835\udd66_h =    0,\n\n\nwhere for all \ud835\udd66_h, \ud835\udd67_h \u2208\ud835\udd4d_h,0^0 and q_h\u2208 W_h,0^0,\n\n    (A_0,h\ud835\udd66_h, \ud835\udd67_h)_0,h\u2261     \u03bd(\u2207\u03a0^CR\ud835\udd66_h, \u2207\u03a0^CR\ud835\udd67_h)_\n         +\u03b2(\u03a0^RT\u03a0^CR\ud835\udd66_h, \u03a0^RT\u03a0^CR\ud835\udd67_h)_\ud835\udcaf_h,\n         \n    \n         [B_0,h\ud835\udd66_h, q_h]_0,h\u2261     \n          -(\u2207\u00b7\u03a0^CR\ud835\udd66_h,  q_h)_\ud835\udcaf_h,\n\nand the augmented Lagrangian Uzawa iteration (<ref>) is equivalent to find (\ud835\udd66_h^(n),p_h^(n))\u2208V_h,0^0\u00d7 W_h,0^0 satisfying\n\n\n    \n    A_0,h^\u03f5\ud835\udd66_h^(n) =    F_0,h - B_0,h^\u2217 p_h^(n-1),\n        \n    \n        p_h^(n) =       p_h^(n-1)- \u03f5^-1B_0,h\ud835\udd66_h^(n).\n\n\nwhere for all \ud835\udd66_h, \ud835\udd67_h \u2208\ud835\udd4d_h,0^0,\n\n    (A_0,h^\u03f5\ud835\udd66_h, \ud835\udd67_h)_0,h\u2261     \u03bd(\u2207\u03a0^CR\ud835\udd66_h, \u2207\u03a0^CR\ud835\udd67_h)_\n         +\u03b2(\u03a0^RT\u03a0^CR\ud835\udd66_h, \u03a0^RT\u03a0^CR\ud835\udd67_h)_\ud835\udcaf_h\n       \n        +\n        (\u2207\u00b7\u03a0^CR\ud835\udd66_h, \u2207\u00b7\u03a0^CR\ud835\udd67_h)_\ud835\udcaf_h\n\nThis result is inspired by the equivalence of the lowest order Raviart-Thomas mixed method and the nonconforming CR method for Poisson's equation <cit.>. Such equivalence allows for the direct application of the rich multigrid theory on the CR discretization to solve the condensed lowest-order H(div)-HDG scheme.  In this study, we adopt Sch\u00f6berl's geometric multigrid theory <cit.> to the SPD primal operator A_0,h^\u03f5 to get geometric multigrid methods robust concerning both mesh size and the penalty parameter \u03f5.\n\n\n    There are other two approaches in the literature to construct geometric multigrid algorithms for the CR scheme (<ref>) which is equivalent to the condensed system (<ref>).\n    The first approach <cit.> exploits the cell-wise divergence-free subspace of the CR element and implements multigrid algorithms for the positive definite system on the divergence-free kernel space. However, this method is limited to two dimensions and the extension to three dimensions is exceedingly challenging due to the need for constructing complex intergrid transfer operators between the divergence-free subspaces. \n    The second approach, proposed by Brenner <cit.>, directly deals with the saddle point system (with a penalty term) to avoid the divergence kernel, and proved convergence results for nested W-cycle multigrid method with large enough smoothing steps.\n    Sch\u00f6berl's approach works with the resulting positive definite primal operator from the saddle point system with a penalty term, the same as the A_0,h^\u03f5 in our study. This approach is more feasible in three dimensions as the intergrid transfer operator is considerably easier to implement in practice than the first approach. Originally introduced for the P^2-P^0 discretization on triangles, Sch\u00f6berl's approach has been successfully applied by other researchers to other finite element schemes in two- and three-dimensions, as documented in <cit.>.\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Geometric multigrid algorithm\n\nIn this subsection, we present detailed geometric multigrid algorithm to solve (<ref>) based on the parameter-robust multigrid theory of Sch\u00f6berl <cit.>.\n\nWe consider a hierarchical mesh sequence for the geometric h-multigrid algorithm, beginning with the coarsest simplicial triangulation \ud835\udcaf_1. \nThe finest mesh is denoted as \ud835\udcaf_J=\ud835\udcaf_h and is obtained through a sequence of mesh refinements for l=2,\u2026, J. \nOn each mesh level, the mesh skeleton is denoted as \u2130_l and the maximum mesh size of \ud835\udcaf_l is denoted by h_l. We assume that on each level the triangulation \ud835\udcaf_l is conforming, shape-regular, and quasi-uniform over the domain \u03a9, and that the difference in mesh size between two adjacent mesh levels is bounded by h_l\u2272 h_l+1. The corresponding finite element spaces on \ud835\udcaf_l are denoted as W_l^0, V_l^0, V_h^0, and V_l^CR.\nThe corresponding L^2 inner product on global spaces \ud835\udd4d_l^0 and W_l^0 are denoted as (\u00b7, \u00b7)_0,l and [\u00b7, \u00b7]_0,l,\nand the corresponding linear operators in (<ref>) are denoted as A_0,l^\u03f5, B_0,l^\u2217 and B_0,l.\n\nThe main components in <cit.> are (i) a robust intergrid transfer operator that transfer coarse-grid divergence-free functions to fine-grid (nearly) divergence-free functions,  and (ii) a robust block-smoother capable of capturing the divergence-free basis functions.\n\nFor the intergrid transfer operator, we first define the following averaging operator I_l-1^l:\ud835\udd4d_l-1,0^0\u2192\ud835\udd4d_l,0^0 in light of the one used in multigrid methods for the CR discretization for Poisson's equation\n<cit.>: Let (v_l', v_l') = I_l-1^l\ud835\udd67_l-1, then we have\n\n\n    \n    \ud835\uddc7\ud835\uddcb\ud835\uddc6(v_l'(m_F)):=   {\n            [                  \ud835\uddc7\ud835\uddcb\ud835\uddc6(\n                (\u03a0^_l-1\ud835\udd67_l-1)(m_F)),                          if F\u2208\u2130_l^0 lies inside \ud835\udcaf_l-1,; \ud835\uddc7\ud835\uddcb\ud835\uddc6(1/2((\u03a0^_l-1\ud835\udd67_l-1)^+(m_F) + (\u03a0_l-1^\ud835\udd67_l-1)^-(m_F))),                            if F\u2208\u2130_l^0 lies on \u2130_l-1^o, ].\n        \n    \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_l'(m_F)):=   {\n            [                  \ud835\uddcd\ud835\uddc7\ud835\uddc0(\n                (\u03a0^_l-1\ud835\udd67_l-1)(m_F)),                          if F\u2208\u2130_l^0 lies inside \ud835\udcaf_l-1,; \ud835\uddcd\ud835\uddc7\ud835\uddc0(1/2((\u03a0^_l-1\ud835\udd67_l-1)^+(m_F) + (\u03a0_l-1^\ud835\udd67_l-1)^-(m_F))),                            if F\u2208\u2130_l^0 lies on \u2130_l-1^o, ].\n\n\nwhere (\u03a0^_l-1\ud835\udd67_l-1)^+ and (\u03a0^_l-1\ud835\udd67_l-1)^- are the values of \u03a0^_l-1\ud835\udd67_l-1 on two adjacent elements K^+,  K^-\u2208\ud835\udcaf_l-1 that share the facet F. On the finer l-th mesh level, we denote V_l,0^0,T and V_l,0^0,T as the local subspaces of V_l,0^0 and V_l,0^0 respectively, with DOFs of these subspaces vanishing on the mesh skeleton \u2130_l-1 of the coarser (l-1)-th mesh level. Due to the components of \ud835\udd67_l' in \ud835\udd4d_l,0^0,T, the energy norm \ud835\udd67_l-1_A_0,l-1^\u03f5 can not be bounded by \ud835\udd67_l'_A_0,l^\u03f5 independent of \u03f5^-1 after performing only averaging operator, thus we stabilize this averaging operator with a local correction using discrete harmonic extensions <cit.>.\nThe integer grid transfer operator \u2110_l-1^l : \ud835\udd4d_l-1,0^0\u2192\ud835\udd4d_l,0^0\nis defined as follows:\n\n    \u2110_l-1^l:=(id - P^T_A_0,l^\u03f5)I_l-1^l,\n\nwhere id is the identity operator and  the local projection\nP_A_0,l^\u03f5^T: V_l,0^0\u2192\ud835\udd4d_l,0^0,T satisfies\n\n    (A_0,l^\u03f5P_A_0,l^\u03f5^T\ud835\udd66_l, \ud835\udd67_l^T)_0,l\n        =\n        (A_0,l^\u03f5\ud835\udd66_l, \ud835\udd67_l^T)_0,l, \n          \u2200\ud835\udd66_l\u2208\ud835\udd4d_l,0^0, \ud835\udd67_l^T\u2208\ud835\udd4d_l,0^0,T,\n\nwhich is locally solved on coarse mesh elements of \ud835\udcaf_l-1. We further define the restriction operator \u2110_l^l-1: \ud835\udd4d_l,0^0\u2192\ud835\udd4d_l-1,0^0 as the transpose of I_l-1^l with respect to (\u00b7, \u00b7)_0,l satisfying\n\n    (\u2110_l^l-1\ud835\udd66_l, \ud835\udd67_l-1)_0,l-1\n        =\n        (\ud835\udd66_l, \u2110_l-1^l\ud835\udd67_l)_0,l, \n          \u2200\ud835\udd66_l\u2208\ud835\udd4d_l,0^0, \ud835\udd67_l-1\u2208\ud835\udd4d_l-1,0^0.\n\n\nFor the smoother for (<ref>), we employ the classical block smoother for H(div)-elliptic problems proposed by Arnold, Falk, and Winther <cit.> to address the discretely divergence-free kernel space of the operator A_0,l^\u03f5. Specifically, we utilize the vertex-patched damped block Jacobi or block Gauss-Seidel smoother.\nIt is worth noting that in three dimensions, edge-patch block smoothers can also be utilized to reduce memory usage <cit.>. For completeness, we present the formulation of the vertex-patch damped block Jacobi smoother here.\nWe define S_l as the set of vertices in the triangulation \ud835\udcaf_l,\nand we further denote \ud835\udcaf_l^s as the subset of mesh elements\nand \u2130_l^s as the subset of mesh skeletons\nmeeting at the vertex\ns\u2208S_l respectively, i.e.\n\n    \ud835\udcaf_l^s:=   \u22c3_K\u2208\ud835\udcaf_l,   s\u2208 K K,\n        \n    \u2130_l^s:=   \u22c3_F\u2208\u2130_l,   s\u2208 F F.\n\nThe lowest-order compound finite element space \ud835\udd4d_l,0^0 is then decomposed into overlapping subspaces with support on \ud835\udcaf_l^s and \u2130_l^s as follows: \n\n    \ud835\udd4d_l,0^0 = \u2211_s\u2208S_l\ud835\udd4d_l, 0^0, s :=\n        \u2211_s\u2208S_l{\n            (v_l^s, v_l^s)\u2208\ud835\udd4d_l,0^0: supp v_l^s\u2282interior(\ud835\udcaf_l^s), supp v_l^s\u2282\u2130_l^s\n        }.\n\nFurthermore, we define P_A_0,l^\u03f5^s: \ud835\udd4d_l,0^0\u2192\ud835\udd4d_l,0^0,s as the local projection onto the subspace \ud835\udd4d_l,0^0,s with respect to the operator A_0,l^\u03f5 that satisfies:\n\n    (A_0,l^\u03f5P_A_0,l^\u03f5^s\ud835\udd66_l, \ud835\udd67_l^s)_0,l\n        =  (A_0,l^\u03f5\ud835\udd66_l, \ud835\udd67_l^s)_0,l,   \u2200\ud835\udd66_l \u2208\ud835\udd4d_l,0^0, \ud835\udd67_l^s\u2208\ud835\udd4d_l,0^0,s, \u2200 s\u2208S_l.\n\nThe damped block Jacobi smoother is then expressed as:\n\n    R_l:=\n        \u03c2\u2211_s\u2208S_lP_A_0,l^\u03f5^s (A_0,l^\u03f5)^-1,\n\nwhere the damping parameter \u03c2 > 0 is small enough to ensure \nthat the operator (id - R_lA_0,l^\u03f5)\nis a positive definite contraction, and only depends on the bounded number of overlapping blocks <cit.>. We further define R_l^T as the transpose of R_l with respect to the inner product (\u00b7, \u00b7)_0,l.\n\nNow we are ready to present the W-cycle and variable V-cycle multigrid algorithms for the linear system A_0,l^\u03f5\ud835\udd66_l = \ud835\udd58_l\u2208\ud835\udd4d_l,0^0 \nas in Algorithm <ref>.\n\n\n\nSch\u00f6berl's multigrid theory <cit.>, originally introduced for the P^2-P^0 discretization on triangles, can be applied to the CR discretization in two- and three-dimensions and requires full elliptic regularity results in (<ref>). The proof procedures for the optimality of W-cycle and variable V-cycle multigrid for the CR discretization with pressure-robust treatment (<ref>) are essentially the same as in our previous work <cit.>, where we used Sch\u00f6berl's theory for the CR discretization without pressure-robust treatment, and we refer to <cit.> for more details. We note that the only difference of the left-hand-side operator before and after the pressure-robust treatment lies in the mass term. The L^2 norm of \u03a0^RTv_h^CR is bounded by v_h^CR_0 for any v_h^CR\u2208V_h^CR.\nHere we quote the optimality result from <cit.>, from which we have, for the lowest-order case, W-cycle multigrid is a convergent iteration method when the smoothing steps are large enough, and V-cycle multigrid is a preconditioner, with both methods robust concerning the mesh size and the penalty parameter \u03f5.\n\n\n\nThe geometric h-multigrid procedure defined in Algorithm <ref> has the following properties:\n\n    \n  * The W-cycle multigrid algorithm is a robust convergent method. Specifically, there exist positive constants m_\u2217 and C, independent of the mesh size h_l and the penalty parameter \u03f5, such that with q = 2 and m(1)= \u22ef=m(l) = m in Algorithm <ref>, we have\n    \n    \ud835\udd3c_l,m\ud835\udd67_l_A_0,l^\u03f5\u2264  C m^-1/4\ud835\udd67_l_A_0,l^\u03f5,\n              \u2200\ud835\udd67_l\u2208\ud835\udd4d_l,0^0, \n            l\u2265 1,  m\u2265 m_\u2217,\n\n    where \ud835\udd3c_l,m: \ud835\udd4d_l,0^0\u2192\ud835\udd4d_l,0^0\n    is the operator relating the initial error and the final error of the W-cycle multigrid algorithm, i.e., \n    \n    \ud835\udd3c_l,m(\ud835\udd66_l-\ud835\udd66_l^(0)) := \ud835\udd66_l - MG_h(l, \ud835\udd58_l, \ud835\udd66_l^(0), m, 2).\n\n    \n  * The variable V-cycle algorithm is a robust preconditioner. Specifically, with q=1 and \u03b3_0 m(l) \u2264 m(l-1) \u2264\u03b3_1 m(l) in Algorithm <ref> (1<\u03b3_0<\u03b3_1), there exists a positive constant C independent of the mesh size h_l and the penalty parameter \u03f5 such that\n    \n    \u03ba(\ud835\udd39_l,m(l)A_0,l^\u03f5) \u2264 1 + C m(l)^-1/4 ,\n\n    where \u03ba is the condition number, and  \ud835\udd39_l,m(l): \ud835\udd4d_l,0^0\u2192\ud835\udd4d_l,0^0\n    is the preconditioning operator relating the residual to the correction of the variable V-cycle multigrid algorithm with a zero initial guess, i.e., \n    \n    \ud835\udd39_l,m(l)\ud835\udd67_l:=\n            MG_h(l, \ud835\udd67_l, 0, m(l),1),\n              \u2200\ud835\udd67_l\u2208\ud835\udd4d_l,0^0.\n\n\n\n\n\n\n\n \u00a7.\u00a7 hp-Multigrid algorithm for the higher-order scheme\n\nWe now consider the augmented Lagrangian Uzawa iteration (<ref>) for the condensed higher-order H(div)-HDG scheme with k\u2265 1. We present an hp-multigrid algorithm to precondition the primal operator A_k,h^\u03f5 on the finest mesh =\ud835\udcaf_J.  Specifically, we define a \"two-level\" nested ASP for the system A_k,h^\u03f5\ud835\udd66_h^\u2202=\ud835\udd58_h^\u2202\u2208\ud835\udd4d_h,0^k,\u2202, where we use the lowest-order velocity space \ud835\udd4d_h,0^0 as the auxiliary space and MG_h in Algorithm <ref> as the inexact auxiliary space solver.\n\nTwo components are needed to finish constructing the multiplicative ASP: (i) a prolongation operator to transfer functions from the lowest-order velocity space \ud835\udd4d_h,0^0 to the higher-order global velocity space \ud835\udd4d_h,0^k,\u2202, and (ii) a relaxation method to reduce the errors in the high-order spaces.\nFor the prolongation operator, we use the natural inclusion operator denoted by \u03a0_0^k. The transpose of this operator with respect to (\u00b7, \u00b7)_0,h is the L^2-projection operator \u03a0_k^0.\nFor the relaxation method, we again need to take care of the divergence-free kernels in \ud835\udd4d_h,0^k,\u2202 and we use vertex-patched block Jacobi/Gauss-Seidel method.\nWith slight abuse of notation, for any vertex s\u2208S_h=S_J, we denote \ud835\udd4d_h,0^k,\u2202,s as the subspace of \ud835\udd4d_h,0^k,\u2202 with support on the vertex-patched mesh elements \ud835\udcaf_h^s and vertex-patched mesh skeletons \u2130_h^s, and P^s_A_k,h^\u03f5:\ud835\udd4d_h,0^k,\u2202\u2192\ud835\udd4d_h,0^k,\u2202,s as the A_k,h^\u03f5-orthogonal projection onto vertex-patched subspace \ud835\udd4d_h,0^k,\u2202,s. \nWe define R_h^\u2202 as the corresponding damped block Jacobi smoother\n\n    R_h^\u2202 := \u03c2'\u2211_s\u2208\ud835\udcae_hP_A_k,h^\u03f5^s (A_k,h^\u03f5)^-1,\n\nwhere \u03c2'>0 is the damping parameter, and R_h^\u2202, T as the transpose of R_h^\u2202 with respect to the inner product (\u00b7, \u00b7)_0,h. Now we present the hp-multigrid method for A_k,h^\u03f5\ud835\udd66_h^\u2202=\ud835\udd58_h^\u2202 in Algorithm <ref>.\n\n\n\n\n Our goal is to achieve a mild increase or robustness in iteration counts of the Krylov space solver preconditioned by the hp-multigrid method as the polynomial order increases. Our hp-multigrid algorithm can be seen as a Schwarz-type method <cit.>, utilizing a space decomposition given by\n\n    \ud835\udd4d_h,0^k,\u2202 = \ud835\udd4d_h,0^0 + \u2211_s\u2208\ud835\udcae_h\ud835\udd4d_h,0^k,\u2202,s.\n\nBased on the same subspace decomposition (lowest-order space + vertex-patched subspaces), Pavarino  <cit.> introduced and proved a p-robust additive Schwarz preconditioner for the continuous finite element space for Poisson's equation, and Brubeck and Farrell <cit.> further scale this p-robust preconditioner to very high polynomial degrees. For a nearly-singular system such as in (<ref>) where \u03f5 approaches 0, Lee et al. <cit.> presented a general framework and proved that the method of subsequent subspace correction (MSSC) is convergent provided that the exact/inexact solver on each subspace is a robust contraction and that the kernel of the divergence operator can be decomposed into sum of elements of the subspaces, and the convergence rate is robust with respect to mesh size and parameter \u03f5. Our numerical experiments show that the hp-multigrid in Algorithm <ref> is robust with respect to mesh size and parameter \u03f5, and the preconditioned Krylov space solver has only a very mild increase in iteration counts as the polynomial order increases.\n\nWe acknowledge that our current hp-multigrid method is multiplicative and subsequent between the lowest order spaced \ud835\udd4d_h,0^0 and the vertex-patched subspaces \u2211_s\u2208\ud835\udcae_h\ud835\udd4d_h,0^k,\u2202,s, whereas ASP introduced in <cit.> is additive and parallel. However, we observed drastic increases in iteration counts when \u03f5\u2192 0 and the polynomial order increases when an additive version of the hp-multigrid is used as the preconditioner in our numerical experiments.\n\n\n\n\nTherefore, a parallel and robust hp-multigrid for the operator A_k,h^\u03f5 along with its theoretical proof is worth pursuing and will be the focus of our future research.\n\n\n\n\n\n\n\n\n\u00a7 NAVIER-STOKES EQUATION\n\n\n\n\n \u00a7.\u00a7 Model problem and the H(div)-HDG scheme\n\nThe model problem is to find (u, p) satisfying \n\n    \n    \n        \u03b2u - \u2207\u00b7(\u03bd\u2207u) + u\u00b7\u2207u\n        + \u2207p \n        =     f,         in \u03a9,\n        \n\n        \u2207\u00b7u =      0,         in \u03a9,\n        \n\n        u=     0,         on \u2202\u03a9,\n    \n\nwith notations the same as in (<ref>).\nWe introduce the tensor L:= - \u03bd\u2207u as a new variable and rewrite (<ref>) into a first-order system:\n\n    \n    \n        \u03bd^-1L + \u2207u =      0,         in \u03a9,\n        \n\n        \u03b2u + \u2207\u00b7L + u\u00b7\u2207u\n        + \u2207p =      f,         in \u03a9,\n        \n\n        \u2207\u00b7u =      0,         in \u03a9,\n        \n\n        u =      0,         on \u2202\u03a9.\n    \n\n\nFor the nonlinear convection term u\u00b7\u2207u in the Navier-Stokes equations, we use the natural upwind discretization which needs no additional stabilization and leads to minimal numerical dissipation <cit.>. The trilinear form for the H(div)-HDG discretization for the convection term is defined as\n\n    \ud835\udc9e_h(w_h; \ud835\udd66_h, \ud835\udd67_h):=    \n                - (w_h \u2297u_h, \u2207v_h)_\n                +\u27e8 (w_h\u00b7n_K)u_h^up, \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h - v_h)\u27e9_\u2202,\n\nfor all w_h\u2208V_h,0^k and \ud835\udd66_h,\ud835\udd67_h\u2208\ud835\udd4d_h,0^k, where\n\n    u_h^up:=   \ud835\uddc7\ud835\uddcb\ud835\uddc6(u_h) + {\n            [       \ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h), if u_h\u00b7n_K > 0,;       \ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h), if u_h\u00b7n_K < 0. ].\n\n\n\n\n\n \u00a7.\u00a7 Linearization and iterative solving procedure\n\nWe linearize the convection term by Picard or Newton's method and then iteratively solve the resulting linearized H(div)-HDG scheme. Given \ud835\udd66_h^(n-1)\u2208\ud835\udd4d_h,0^k at the previous step, when Picard iteration is used, the linearized convection term at the n-th step is\n\n    \ud835\udc9e_h^l(u_h^(n-1); \ud835\udd66_h^(n), \ud835\udd67_h):=\n         \ud835\udc9e_h(u_h^(n-1); \ud835\udd66_h^(n), \ud835\udd67_h),\n\nwhere \ud835\udd66_h^(n)\u2208\ud835\udd4d_h,0^k is the velocity solution to be found at the n-th step, and when Newton iteration is used, the linearized convection term at n-th step becomes\n\n    \ud835\udc9e_h^l(u_h^(n-1); \u03b4\ud835\udd66_h^(n), \ud835\udd67_h)\n        :=\n        \ud835\udc9e_h(u_h^(n-1); \u03b4\ud835\udd66_h^(n), \ud835\udd67_h)\n        + \ud835\udc9e_h(\u03b4u_h^(n); \ud835\udd66_h^(n-1), \ud835\udd67_h),\n\nwhere \u03b4\ud835\udd66_h^(n)\u2208\ud835\udd4d_h,0^k is the change to the velocity at the n-th step.\n\nThen given solution (L_h^(n-1), \ud835\udd66_h^(n-1), p_h^(n-1)) at the previous step, the linearized H(div)-HDG scheme is to find (L_h, \ud835\udd66_h, p_h) \u2208W_h^k \u00d7\ud835\udd4d_h,0^k \u00d7 W_h,0^k, k \u2265 0, such that\n\n    \n    \n    (\u03bd^-1L_h, G_h)_\ud835\udcaf_h  \n            + (\u2207u_h, G_h)_\ud835\udcaf_h\n            - \u27e8\ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h - u_h), G_hn_K\u27e9_\u2202\ud835\udcaf_h   = 0,\n            \n    \n            (\u03b2u_h, v_h)_\ud835\udcaf_h\n            -( L_h, \u2207v_h )_\ud835\udcaf_h\n            + \u27e8L_hn_K, \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h - v_h) \u27e9_\u2202   \n    \n            + \ud835\udc9e_h^l(u_h^(n-1); \ud835\udd66_h, \ud835\udd67_h)\n            - (p_h, \u2207\u00b7v_h)_    = (f', v_h)_\ud835\udcaf_h\n    \n            (\u2207\u00b7u_h,  q_h)_\ud835\udcaf_h   = 0.\n\n\nfor all (G_h, \ud835\udd67_h, q_h) \u2208W_h^k \u00d7\ud835\udd4d_h,0^k \u00d7 W_h,0^k, where for the Picard method,\n\n    (f', v_h)_\ud835\udcaf_h := (f, v_h)_\ud835\udcaf_h,\n\nand for the Newton's method,\n\n    (f', v_h)_\ud835\udcaf_h :=    \n        (f, v_h)_\ud835\udcaf_h\n        -(\u03bd^-1L_h^(n-1), G_h)_\ud835\udcaf_h  \n        -(\u2207u_h^(n-1), G_h)_\ud835\udcaf_h\n        + \u27e8\ud835\uddcd\ud835\uddc7\ud835\uddc0(u_h^(n-1) - u_h^(n-1)), G_hn_K\u27e9_\u2202\ud835\udcaf_h\n       \n        -(\u03b2u_h^(n-1), v_h)_\ud835\udcaf_h\n        +( L_h^(n-1), \u2207v_h )_\ud835\udcaf_h\n        - \u27e8L_h^(n-1)n_K, \ud835\uddcd\ud835\uddc7\ud835\uddc0(v_h - v_h) \u27e9_\u2202\n       \n        - \ud835\udc9e_h^l(u_h^(n-1); \ud835\udd66_h^(n-1), \ud835\udd67_h)\n        + (p_h^(n-1), \u2207\u00b7v_h)_.\n\nWe denote the operator form of the condensed global system of the linearized H(div)-HDG scheme (<ref>) as to find (\ud835\udd66_h^\u2202, p_h^\u2202)\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 satisfying:\n\n    \n    \n    A_k,h^c\ud835\udd66_h^\u2202\n            + B_k,h^\u2217 p_h^\u2202 =    F_k,h^c,\n            \n    B_k,h\ud835\udd66_h^\u2202 =     0,\n\n\nwhere the operators B_k,h and B_k,h^\u2217 are identical to those in (<ref>). The operator A_k,h^c is obtained by augmenting A_k,h with a condensed operator from the linearized convection term \ud835\udc9e_h^l. To solve the resulting saddle-point system, we employ an augmented Lagrangian Uzawa iteration, similar to the approach used for the generalized Stokes equation: With p_h^\u2202 (0) = 0, iteratively find solution (\ud835\udd66_h^\u2202(n),p_h^\u2202(n))\u2208\ud835\udd4d_h,0^k,\u2202\u00d7 W_h,0^\u2202 that satisfies\n\n    \n    \n    A_k,h^c, \u03f5\ud835\udd66_h^\u2202 (n) =    F_k,h^c - B_k,h^\u2217 p_h^\u2202 (n-1),\n            \n    \n        p_h^\u2202  (n) =       p_h^\u2202  (n-1)- \u03f5^-1B_k,h\ud835\udd66_h^\u2202  (n),\n\n\nwhere \n\n    A_k,h^c, \u03f5:=\n        A_k,h^c + \u03f5^-1B_k,h^\u2217B_k,h,\n\nwith the penalty parameter \u03f5^-1\u226b 1.\n\nWhen the viscosity \u03bd approaches zero, the convection term in the Navier-Stokes equations dominates over the diffusion term, and this dominance causes the linear system to become more ill-conditioned, making it challenging to find a robust preconditioner for Krylov subspace solvers such as GMRes <cit.>. Moreover, the non-symmetry of the H(div)-HDG scheme further complicates the analysis of the preconditioner's robustness.\nHowever, in a study by Benzi and Olshanskii <cit.>, Sch\u00f6berl's geometric multigrid method <cit.> was applied to precondition the primal operator of the augmented Lagrangian formulation of the two-dimensional Oseen problem discretized by isoP^2-P^0 and isoP^2-P^1 elements with streamline-upwind Petrov-Galerkin (SUPG) stabilization. Numerical experiments demonstrate that this approach is essentially robust with respect to the Reynolds number.\nSubsequently, Farrell et al. <cit.> extended this approach to the three-dimensional Newton linearized Navier-Stokes equations, which is discretized by a P^1-P^0 pair with velocity space enriched by facet bubbles and with SUPG stabilization. Numerical experiments support the preconditioner's robustness with respect to the Reynolds number.\nMotivated by these results, we adapt the hp-multigrid algorithm developed for the generalized Stokes equation in Algorithm <ref> to precondition the operator A_k,h^c, \u03f5 of the linearized Navier-Stokes equations in (<ref>). We employ the same block relaxation method, block smoothing method, and intergrid transfer operators with discrete harmonic extensions.\n\nIt is important to note that the Newton iteration solver has quadratic convergence, but it requires a sufficiently accurate initial guess. To address this and test the performance of the proposed hp-multigrid for both the Picard and the Newton linearization, the Picard iteration method is firstly utilized in this study to solve the Navier-Stokes equations until the L^2 norm of the difference between the velocities of two consecutive steps becomes smaller than a predefined tolerance \u03f5_picard. Subsequently, the Newton iteration method is employed, using the solution of the last Picard iteration as the initial guess for the Newton iteration. The algorithm is described in Algorithm <ref>. In both the Picard and Newton iteration, the result of the previous iteration is used as the initial guess of the current iteration. Fig. <ref> provides a graphical illustration of the overall solving procedure.\n\n\n\n\n\n\n\n\n\n\u00a7 NUMERICAL EXPERIMENTS\n\n\nThis section presents the numerical experiments carried out to validate the optimal convergence rates of the H(div)-HDG scheme and the robustness of the proposed hp-multigrid method. We conduct experiments for both the generalized Stokes equation and the Navier-Stokes equations. For the latter, we solve the steady cases with \u03b2 = 0.\nTo solve the condensed H(div)-HDG scheme, we use two-step augmented Lagrangian Uzawa iteration method with (\u03bd\u03f5)^-1=10^6 for both set of equations. In updating global velocity in each step of Uzawa iteration, the preconditioned conjugate gradient solver (PCG) is adopted for the generalized Stokes equation, while the preconditioned GMRes solver (PGM) is adopted for the linearized Navier-Stokes equations. The proposed hp-multigrid method is employed as the preconditioner for both solvers, and the stopping criterion is a relative tolerance of 10^-8 and an absolute tolerance of 10^-10.\nIn Algorithm <ref>, we set \u03b5_picard to 10^-4, and the Newton iteration stops with a relative tolerance of 10^-8 and an absolute tolerance of 10^-10.\nIn all cases, we use block Gauss-Seidel method for both the relaxation and smoothing to avoid the damping parameter in Jacobi method. We further set the relaxation steps to be the same as the smoothing steps, i.e. m_h = m_p = m in the hp-multigrid in Algorithm <ref>.\nAll results are obtained by using the NGSolve <cit.> and ParaView <cit.>.\nSource code for the numerical experiments is available at <https://github.com/WZKuang/MG4HdivHDG>.\n\n\n\n \u00a7.\u00a7 Convergence rate check\n\nWe first verify the optimal convergence rates of the H(div)-HDG scheme solved with the proposed hp-multigrid method for the generalized Stokes equation and the Navier-Stokes equations with manufactured solutions.\nWe set the exact solution \n\n    .\n    \t\t[                                u_x  = x^2 (x - 1)^2 2y(1 - y)(2y - 1);                                u_y = y^2 (y - 1)^2 2 x(x - 1)(2x - 1);                                  p           = x(1 - x)(1 - y) - 1/12 ]} when d = 2,\n\nand\n\n    .\n    \t\t[                                                      u_x  = x^2(x - 1)^2 (2 y - 6y^2 + 4 y^3)(2 z - 6z^2 + 4 z^3);                                                      u_y    = y^2 (y - 1)^2 (2x - 6x^2 + 4x^3) (2z - 6z^2 + 4z^3);                                                      u_z = -2 z^2 (z - 1)^2 (2x - 6x^2 + 4x^3) (2y - 6y^2 + 4y^3);                                                        p                          = x(1 - x)(1 - y)(1 - z) - 1/24 ]} when d = 3.\n\nThe source term f is obtained by plugging the exact solution into the model problem.\n\n\n  \u00a7.\u00a7.\u00a7 Generalized Stokes equation\n\n\nWe set the domain as a unit square/cube \u03a9=[0, 1]^d with homogeneous Dirichlet boundary conditions on all sides.\nThe coarsest mesh is a triangulation of \u03a9 with the maximum element diameter 1/h=2 in 2D or 1/h=3 in 3D, followed by uniform refinement by connecting the midpoints of the element boundaries. After solving (L_h,u_h, p_h) from the H(div)-HDG scheme (<ref>), a post-processed velocity approximation u_h^\u2217\u2208W_h^k+1 is obtained element-wise by solving\n\n    \n    \n        (\u2207u_h^\u2217,  \u2207v_h)_K =    \n        (L_h,  \u2207v_h)_K,\n                \n        \u2200v_h \u2208^k+1(K),\n        \n\n        (u_h^\u2217,  w_h)_K\n        =     (u_h,  w_h)_K,\n                 \u2200w_h\u2208^0(K),\n    \n\nand the superconvergence property of such post-processed u_h^\u2217 when k\u2265 1 has been proved in <cit.>.\n\nWe set the viscosity \u03bd = 1, and Table <ref> reports the estimated order of convergence (EOC) of the L_2 norms of e_u:=u-u_h, e_L:=L-L_h, and e_u^\u2217:=u-u_h^\u2217 in both two-dimensional and three-dimensional cases, together with the L_2 norm of the divergence error \u2207\u00b7u_h, for different \u03b2 and polynomial orders k of the finite element spaces.\nAs observed, the optimal (k+1)-th convergence rate is obtained for both the velocity u_h and the flux L_h when k\u2265 0, with the globally divergence-free constraint satisfied. When k\u2265 1, the (k+2)-th convergence rate is obtained for u_h^\u2217. We note that the deterioration of the convergence rates when e_u_0 and e_u^\u2217_0 approach \ud835\udcaa(10^-10) is due to the round-off error caused by \u03f5^-1, as mentioned in Remark <ref>.\n\n\n[ht]|c|c|cc|cc|cc|c|cc|\nEstimated convergence rates of the H(div)-HDG scheme for the generalized Stokes equation in Example <ref>.\n \n2*k     2*1/h     2c|DOF     2*e_u_0     2*EOC     2*e_L_0     2*EOC     2*\u2207\u00b7u_h_0     2*e_u^\u2217_0     2*EOC  \n\n                                                    N_total     N_global                                                                                                                                                                                                                                                                                    11|c|d = 2                                                                                                                                                                                                                                                                                                              \n \n                                                              7c|\u03b2=0                                                                                                                                                                                                                                   \n \n4*0       32                         3.5e3       1.5e3          1.2e-3                                     1.2                      1.5e-2                                      1.0                      1.3e-13                                               9.2e-4                                          1.4                   \n\n                         64                         1.4e4       6.0e3          5.8e-4                                     1.1                      7.5e-3                                      1.0                      1.3e-13                                               4.0e-4                                          1.2                   \n\n                         128                        5.7e4       2.4e4          2.9e-4                                     1.0                      3.7e-3                                      1.0                      1.3e-13                                               1.9e-4                                          1.1                   \n\n                         256                        2.3e5       9.8e4          1.4e-4                                     1.0                      1.9e-3                                      1.0                      1.3e-13                                               9.6e-5                                          1.0                   \n \n4*1       32                         1.0e4       3.0e3          8.4e-5                                     2.0                      6.3e-4                                      2.0                      1.4e-13                                               5.3e-6                                          3.0                   \n\n                         64                         4.1e4       1.2e4          2.1e-5                                     2.0                      1.6e-4                                      2.0                      1.4e-13                                               6.7e-7                                          3.0                   \n\n                         128                        1.6e5       4.9e4          5.3e-6                                     2.0                      4.0e-5                                      2.0                      1.3e-13                                               8.5e-8                                          3.0                   \n\n                         256                        6.5e5       2.0e5          1.3e-6                                     2.0                      1.0e-5                                      2.0                      1.2e-13                                               1.1e-8                                          3.0                   \n \n4*2       32                         2.0e4       4.4e3          3.9e-6                                     3.0                      2.4e-5                                      3.0                      1.4e-13                                               1.4e-7                                          3.9                   \n\n                         64                         8.0e4       1.8e4          4.9e-7                                     3.0                      3.1e-6                                      3.0                      1.4e-13                                               8.8e-9                                          4.0                   \n\n                         128                        3.2e5       7.3e4          6.1e-8                                     3.0                      3.8e-7                                      3.0                      1.3e-13                                               8.2e-10                                         3.4                   \n\n                         256                        1.3e6       2.9e5          8.0e-9                                     2.9                      5.1e-8                                      2.9                      1.3e-13                                               2.4e-9                                          -1.6                  \n \n4*3       32                         3.3e4       6.0e3          1.1e-7                                     4.0                      4.8e-7                                      3.9                      1.4e-13                                               5.9e-9                                          5.0                   \n\n                         64                         1.3e5       2.4e4          6.8e-9                                     4.0                      3.1e-8                                      4.0                      1.4e-13                                               2.2e-10                                         4.8                   \n\n                         128                        5.2e5       9.7e4          6.4e-10                                    3.4                      4.3e-9                                      2.8                      1.4e-13                                               4.8e-10                                         -1.1                  \n\n                         256                        2.1e6       3.9e5          1.9e-9                                     -1.6                     1.5e-8                                      -1.8                     1.4e-13                                               1.9e-9                                          -2.0                  \n \n                                                              7c|\u03b2=1e3                                                                                                                                                                                                                                 \n \n4*0       32                         3.5e3       1.5e3          1.1e-3                                     1.0                      1.4e-2                                      0.9                      5.2e-12                                               7.9e-4                                          1.1                   \n\n                         64                         1.4e4       6.0e3          5.7e-4                                     1.0                      7.3e-3                                      0.9                      5.2e-12                                               3.9e-4                                          1.0                   \n\n                         128                        5.7e4       2.4e4          2.8e-4                                     1.0                      3.7e-3                                      1.0                      5.3e-12                                               1.9e-4                                          1.0                   \n\n                         256                        2.3e5       9.8e4          1.4e-4                                     1.0                      1.9e-3                                      1.0                      5.3e-12                                               9.6e-5                                          1.0                   \n \n4*1       32                         1.0e4       3.0e3          8.4e-5                                     2.0                      6.1e-4                                      1.9                      5.3e-12                                               4.9e-6                                          2.9                   \n\n                         64                         4.1e4       1.2e4          2.1e-5                                     2.0                      1.6e-4                                      2.0                      5.3e-12                                               6.5e-7                                          2.9                   \n\n                         128                        1.6e5       4.9e4          5.3e-6                                     2.0                      4.0e-5                                      2.0                      5.3e-12                                               8.4e-8                                          3.0                   \n\n                         256                        6.5e5       2.0e5          1.3e-6                                     2.0                      1.0e-5                                      2.0                      5.3e-12                                               1.1e-8                                          3.0                   \n \n4*2       32                         2.0e4       4.4e3          3.8e-6                                     2.9                      2.7e-5                                      3.1                      5.3e-12                                               1.5e-7                                          4.1                   \n\n                         64                         8.0e4       1.8e4          4.8e-7                                     3.0                      3.2e-6                                      3.1                      5.3e-12                                               9.0e-9                                          4.1                   \n\n                         128                        3.2e5       7.3e4          6.1e-8                                     3.0                      3.9e-7                                      3.0                      5.3e-12                                               5.6e-10                                         4.0                   \n\n                         256                        1.3e6       2.9e5          7.6e-9                                     3.0                      4.8e-8                                      3.0                      5.3e-12                                               1.1e-10                                         2.3                   \n \n4*3       32                         3.3e4       6.0e3          1.0e-7                                     3.9                      6.2e-7                                      4.3                      5.3e-12                                               6.2e-9                                          5.1                   \n\n                         64                         1.3e5       2.4e4          6.7e-9                                     4.0                      3.3e-8                                      4.2                      5.3e-12                                               1.9e-10                                         5.1                   \n\n                         128                        5.2e5       9.7e4          4.2e-10                                    4.0                      2.8e-9                                      3.6                      5.3e-12                                               1.0e-11                                         4.2                   \n\n                         256                        2.1e6       3.9e5          1.5e-10                                    1.5                      2.1e-9                                      0.4                      5.3e-12                                               1.5e-10                                         -3.9                  \n \n11|c|d = 3                                                                                                                                                                                                                                                                                                              \n \n                                                              7c|\u03b2=0                                                                                                                                                                                                                                   \n \n4*0       12                         5.4e3       2.0e3          1.9e-3                                     1.8                      1.8e-2                                      1.0                      1.1e-13                                               1.9e-3                                          2.0                   \n\n                         24                         4.5e4       1.7e4          7.1e-4                                     1.4                      9.2e-3                                      1.0                      1.5e-13                                               6.1e-4                                          1.7                   \n\n                         48                         3.6e5       1.4e5          3.2e-4                                     1.2                      4.7e-3                                      1.0                      1.7e-13                                               2.3e-4                                          1.4                   \n\n                         96                         2.9e6       1.2e6          1.5e-4                                     1.1                      2.4e-3                                      1.0                      1.8e-13                                               1.0e-4                                          1.2                   \n \n4*1       12                         2.1e4       6.0e3          3.9e-4                                     1.6                      3.9e-3                                      1.3                      1.8e-13                                               1.2e-4                                          2.2                   \n\n                         24                         1.7e5       5.2e4          1.1e-4                                     1.9                      1.1e-3                                      1.8                      1.8e-13                                               1.7e-5                                          2.8                   \n\n                         48                         1.4e6       4.3e5          2.7e-5                                     2.0                      3.0e-4                                      1.9                      1.9e-13                                               2.3e-6                                          2.9                   \n\n                         96                         1.1e7       3.5e6          6.7e-6                                     2.0                      7.5e-5                                      2.0                      1.9e-13                                               2.9e-7                                          3.0                   \n \n4*2       6                          6.2e3       1.2e3          4.2e-4                                     1.4                      3.6e-3                                      1.4                      1.8e-13                                               1.8e-4                                          2.3                   \n\n                         12                         5.1e4       1.2e4          7.2e-5                                     2.6                      7.0e-4                                      2.4                      1.8e-13                                               2.1e-5                                          3.2                   \n\n                         24                         4.2e5       1.0e5          1.0e-5                                     2.8                      9.8e-5                                      2.8                      1.9e-13                                               1.5e-6                                          3.8                   \n\n                         48                         3.3e6       8.6e5          1.3e-6                                     3.0                      1.3e-5                                      2.9                      1.9e-13                                               9.6e-8                                          4.0                   \n \n4*3       6                          1.2e4       2.2e3          1.3e-4                                     2.6                      1.4e-3                                      2.2                      1.8e-13                                               9.5e-5                                          2.9                   \n\n                         12                         1.0e5       2.0e4          1.4e-5                                     3.3                      1.2e-4                                      3.5                      1.8e-13                                               4.0e-6                                          4.6                   \n\n                         24                         8.2e5       1.7e5          9.6e-7                                     3.8                      8.5e-6                                      3.8                      1.9e-13                                               1.4e-7                                          4.9                   \n\n                         48                         6.6e6       1.4e6          6.1e-8                                     4.0                      5.5e-7                                      4.0                      1.9e-13                                               4.4e-9                                          5.0                   \n \n                                                              7c|\u03b2=1e3                                                                                                                                                                                                                                 \n \n4*0       12                         5.4e3       2.0e3          1.0e-3                                     0.6                      1.3e-2                                      0.3                      3.6e-12                                               8.6e-4                                          0.9                   \n\n                         24                         4.5e4       1.7e4          5.6e-4                                     0.9                      8.6e-3                                      0.6                      3.8e-12                                               3.9e-4                                          1.1                   \n\n                         48                         3.6e5       1.4e5          2.9e-4                                     1.0                      4.7e-3                                      0.9                      3.9e-12                                               1.8e-4                                          1.1                   \n\n                         96                         2.9e6       1.2e6          1.5e-4                                     1.0                      2.4e-3                                      1.0                      4.0e-12                                               9.2e-5                                          1.0                   \n \n4*1       12                         2.1e4       6.0e3          3.5e-4                                     1.5                      3.7e-3                                      1.3                      3.9e-12                                               1.1e-4                                          2.1                   \n\n                         24                         1.7e5       5.2e4          1.0e-4                                     1.8                      1.1e-3                                      1.7                      4.0e-12                                               1.8e-5                                          2.6                   \n\n                         48                         1.4e6       4.3e5          2.6e-5                                     1.9                      3.0e-4                                      1.9                      4.0e-12                                               2.4e-6                                          2.9                   \n\n                         96                         1.1e7       3.5e6          6.7e-6                                     2.0                      7.6e-5                                      2.0                      4.1e-12                                               2.9e-7                                          3.0                   \n \n4*2       6                          6.2e3       1.2e3          3.5e-4                                     1.6                      3.4e-3                                      1.4                      3.9e-12                                               2.0e-4                                          2.1                   \n\n                         12                         5.1e4       1.2e4          6.4e-5                                     2.5                      7.7e-4                                      2.2                     4.1e-12                                               2.2e-5                                          3.2                   \n\n                         24                         4.2e5       1.0e5          9.4e-6                                     2.8                      1.1e-4                                      2.8                      4.1e-12                                               1.6e-6                                          3.8                   \n\n                         48                         3.3e6       8.6e5          1.3e-6                                     2.9                      1.4e-5                                      3.0                      4.1e-12                                               1.0e-7                                          4.0                   \n \n4*3       6                          1.2e4       2.2e3          1.3e-4                                     2.6                      1.5e-3                                      2.0                      4.0e-12                                               9.1e-5                                          2.8                   \n\n                         12                         1.0e5       2.0e4          1.4e-5                                     3.2                      1.5e-4                                      3.3                      4.0e-12                                               4.5e-6                                          4.3                   \n\n                         24                         8.2e5       1.7e5          9.6e-7                                     3.8                      9.7e-6                                      3.9                      4.1e-12                                               1.5e-7                                          4.9                   \n\n                         48                         6.6e6       1.4e6          6.1e-8                                     4.0                      5.8e-7                                      4.1                      4.1e-12                                               4.6e-9                                          5.1                   \n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Stationary Navier-Stokes equations\n\n\nWe consider the same exact solution and settings as in Example <ref>. Upon solving (L_h, u_h, p_h) using the H(div)-HDG scheme (<ref>), we locally post-process u_h as in (<ref>) to achieve superconvergence. Table <ref> presents the estimated order of convergence (EOC) of the L_2 norms of e_u, e_L, and e_u^\u2217 in two-dimensional and three-dimensional cases, along with the L_2 norm of the divergence error \u2207\u00b7u_h for different values of viscosity \u03bd and polynomial order k of the finite element spaces. The observed optimal convergence rates of e_u_0, e_u^\u2217_0, e_L_0, and the exact divergence-free results are similar to those obtained in the generalized Stokes equation. It is noteworthy that the convergence rates deteriorate as e_u_0 and e_u^\u22170 approach \ud835\udcaa(10^-8), which is due to the fact that \u03f5_newton in <ref> is of order \ud835\udcaa(10^-8) in this example.\n\n\n\n\n|c|c|cc|cc|cc|c|cc|\nEstimated convergence rates of the H(div)-HDG scheme for the Navier-Stokes equations in Example <ref>.\n \n2*k     2*1/h     2c|DOF     2*e_u_0     2*EOC     2*e_L_0     2*EOC     2*\u2207\u00b7u_h_0     2*e_u^\u2217_0     2*EOC  \n\n                                                    N_total     N_global                                                                                                                                                                                                                                                                                    11|c|d = 2                                                                                                                                                                                                                                                                                                                                                                                                                                        \n \n                                                              7c|\u03bd=1                                                                                                                                                                                                                                                                                                                                                                \n \n4*0       16                         8.6e2       3.5e2          2.8e-3                                                          1.4                                          2.9e-2                                                           0.9                                          6.3e-11                                               2.1e-3                                                               1.6                                       \n\n                         32                         3.5e3       1.5e3          1.2e-3                                                          1.2                                          1.5e-2                                                           1.0                                          9.8e-12                                               8.0e-4                                                               1.4                                       \n\n                         64                         1.4e4       6.0e3          5.8e-4                                                          1.1                                          7.4e-3                                                           1.0                                          4.1e-12                                               3.6e-4                                                               1.1                                       \n\n                         128                        5.7e4       2.4e4          2.9e-4                                                          1.0                                          3.7e-3                                                           1.0                                          7.1e-12                                               1.7e-4                                                               1.1                                       \n \n4*1       16                         2.5e3       7.0e2          3.3e-4                                                          1.9                                          2.4e-3                                                           1.9                                          7.9e-12                                               4.2e-5                                                               2.9                                       \n\n                         32                         1.0e4       3.0e3          8.4e-5                                                          2.0                                          6.3e-4                                                           2.0                                          1.0e-11                                               5.3e-6                                                               3.0                                       \n\n                         64                         4.1e4       1.2e4          2.1e-5                                                          2.0                                          1.6e-4                                                           2.0                                          2.4e-11                                               6.7e-7                                                               3.0                                       \n\n                         128                        1.6e5       4.9e4          5.3e-6                                                          2.0                                          4.0e-5                                                           2.0                                          1.6e-11                                               8.5e-8                                                               3.0                                       \n \n4*2       16                         4.9e3       1.1e3          3.0e-5                                                          2.9                                          1.9e-4                                                           2.8                                          6.8e-12                                               2.1e-6                                                               3.8                                       \n\n                         32                         2.0e4       4.4e3          3.9e-6                                                          3.0                                          2.4e-5                                                           2.9                                          2.3e-11                                               1.4e-7                                                               3.9                                       \n\n                         64                         8.0e4       1.8e4          4.9e-7                                                          3.0                                          3.1e-6                                                           3.0                                          8.1e-12                                               8.8e-9                                                               4.0                                       \n\n                         128                        3.2e5       7.3e4          6.1e-8                                                          3.0                                          3.9e-7                                                           3.0                                          2.1e-11                                               3.4e-9                                                               1.4                                       \n \n4*3       16                         8.1e3       1.4e3          1.7e-6                                                          3.9                                          7.4e-6                                                           3.9                                          8.0e-12                                               1.9e-7                                                               4.9                                       \n\n                         32                         3.3e4       6.0e3          1.1e-7                                                          4.0                                          4.8e-7                                                           3.9                                          2.4e-11                                               5.9e-9                                                               5.0                                       \n\n                         64                         1.3e5       2.4e4          6.8e-9                                                          4.0                                          3.4e-8                                                           3.8                                          1.3e-11                                               6.3e-10                                                              3.2                                       \n\n                         128                        5.2e5       9.7e4          3.0e-9                                                          1.2                                          6.0e-8                                                           -0.8                                         2.0e-11                                               3.0e-9                                                               -2.3                                      \n \n                                                              7c|\u03bd=1e-3                                                                                                                                                                                                                                                                                                                                                             \n \n4*0       16                         8.6e2       3.5e2          2.4e-3                                                          1.0                                          2.7e-2                                                           0.7                                          1.7e-10                                               1.8e-3                                                               1.0                                       \n\n                         32                         3.5e3       1.5e3          1.2e-3                                                          1.0                                          1.5e-2                                                           0.9                                          2.0e-10                                               8.6e-4                                                               1.1                                       \n\n                         64                         1.4e4       6.0e3          6.1e-4                                                          1.0                                          7.8e-3                                                           0.9                                          2.0e-10                                               4.3e-4                                                               1.0                                       \n\n                         128                        5.7e4       2.4e4          3.1e-4                                                          1.0                                          4.0e-3                                                           1.0                                          2.0e-10                                               2.2e-4                                                               1.0                                       \n \n4*1       16                         2.5e3       7.0e2          3.3e-4                                                          1.9                                          2.7e-3                                                           1.9                                          1.9e-12                                               6.2e-5                                                               2.8                                       \n\n                         32                         1.0e4       3.0e3          8.4e-5                                                          2.0                                          7.0e-4                                                           2.0                                          2.0e-10                                               8.1e-6                                                               2.9                                       \n\n                         64                         4.1e4       1.2e4          2.1e-5                                                          2.0                                          1.8e-4                                                           2.0                                          2.0e-10                                               1.0e-6                                                               3.0                                       \n\n                         128                        1.6e5       4.9e4          5.3e-6                                                          2.0                                          4.5e-5                                                           2.0                                          2.0e-10                                               1.3e-7                                                               3.0                                       \n \n4*2       16                         4.9e3       1.1e3          3.0e-5                                                          2.9                                          2.3e-4                                                           2.9                                          1.9e-10                                               2.8e-6                                                               3.9                                       \n\n                         32                         2.0e4       4.4e3          3.8e-6                                                          3.0                                          2.9e-5                                                           3.0                                          2.0e-10                                               1.8e-7                                                               4.0                                       \n\n                         64                         8.0e4       1.8e4          4.8e-7                                                          3.0                                          3.7e-6                                                           3.0                                          2.0e-10                                               1.1e-8                                                               4.0                                       \n\n                         128                        3.2e5       7.3e4          6.1e-8                                                          3.0                                          4.6e-7                                                           3.0                                          2.1e-10                                               6.0e-9                                                               0.9                                       \n \n4*3       16                         8.1e3       1.4e3          1.6e-6                                                          3.8                                          1.3e-5                                                           3.9                                          2.0e-10                                               2.1e-7                                                               4.9                                       \n\n                         32                         3.3e4       6.0e3          1.1e-7                                                          3.9                                          8.6e-7                                                           3.9                                          2.0e-10                                               6.7e-9                                                               5.0                                       \n\n                         64                         1.3e5       2.4e4          7.1e-9                                                          3.9                                          5.9e-8                                                           3.9                                          2.0e-10                                               2.2e-9                                                               1.6                                       \n\n                         128                        5.2e5       9.7e4          4.6e-10                                                         0.6                                          5.8e-8                                                           0.0                                          2.0e-10                                               4.6e-9                                                               -1.1                                      \n \n11|c|d = 3                                                                                                                                                                                                                                                                                                                                                                                                                                         \n \n                                                              7c|\u03bd=1                                                                                                                                                                                                                                                                                                                                                                \n \n4*0       12                         5.4e3       2.0e3          1.9e-3                                                          1.8                                          1.8e-2                                                           1.0                                          9.5e-12                                               2.0e-3                                                               2.0                                       \n\n                         24                         4.5e4       1.7e4          7.1e-4                                                          1.4                                          9.2e-3                                                           1.0                                          4.2e-12                                               6.1e-4                                                               1.7                                       \n\n                         48                         3.6e5       1.4e5          3.2e-4                                                          1.2                                          4.7e-3                                                           1.0                                          1.3e-12                                               2.2e-4                                                               1.4                                       \n\n                         96                         2.9e6       1.2e6          1.5e-4                                                          1.1                                          2.4e-3                                                           1.0                                          5.0e-12                                               1.0e-4                                                               1.2                                       \n \n4*1       12                         2.1e4       6.0e3          3.9e-4                                                          1.6                                          3.9e-3                                                           1.3                                          2.0e-12                                               1.2e-4                                                               2.2                                       \n\n                         24                         1.7e5       5.2e4          1.1e-4                                                          1.9                                          1.1e-3                                                           1.8                                          7.4e-12                                               1.7e-5                                                               2.8                                       \n\n                         48                         1.4e6       4.3e5          2.7e-5                                                          2.0                                          3.0e-4                                                           1.9                                          1.3e-12                                               2.3e-6                                                               2.9                                       \n\n                         96                         1.1e7       3.5e6          6.7e-6                                                          2.0                                          7.5e-5                                                           2.0                                          2.7e-12                                               2.9e-7                                                               3.0                                       \n \n4*2       6                          6.2e3       1.2e3          4.2e-4                                                          1.4                                          3.6e-3                                                           1.4                                          4.4e-13                                               1.8e-4                                                               2.3                                       \n\n                         12                         5.1e4       1.2e4          7.2e-5                                                          2.6                                          7.0e-4                                                           2.4                                          5.2e-12                                               2.1e-5                                                               3.2                                       \n\n                         24                         4.2e5       1.0e5          1.0e-5                                                          2.8                                          9.8e-5                                                           2.8                                          3.9e-12                                               1.5e-6                                                               3.8                                       \n\n                         48                         3.3e6       8.6e5          1.3e-6                                                          3.0                                          1.3e-5                                                           2.9                                          1.5e-12                                               9.6e-8                                                               3.9                                       \n \n4*3       6                          1.2e4       2.2e3          1.3e-4                                                          2.6                                          1.4e-3                                                           2.2                                          5.1e-13                                               9.5e-5                                                               2.8                                       \n\n                         12                         1.0e5       2.0e4          1.4e-5                                                          3.3                                          1.2e-4                                                           3.5                                          1.3e-12                                               4.0e-6                                                               4.6                                       \n\n                         24                         8.2e5       1.7e5          9.6e-7                                                          3.8                                          8.5e-6                                                           3.8                                          4.7e-13                                               1.4e-7                                                               4.9                                       \n\n                         48                         6.6e6       1.4e6          6.1e-8                                                          4.0                                          5.5e-7                                                           3.9                                          2.2e-13                                               4.4e-9                                                               5.0                                       \n \n                                                              7c|\u03bd=1e-3                                                                                                                                                                                                                                                                                                                                                             \n \n4*0       12                         5.4e3       2.0e3          5.1e-3                                                          1.9                                          4.3e-2                                                           1.4                                          1.4e-10                                               5.4e-3                                                               2.0                                       \n\n                         24                         4.5e4       1.7e4          1.1e-3                                                          2.2                                          1.3e-2                                                           1.8                                          1.6e-10                                               1.1e-3                                                               2.4                                       \n\n                         48                         3.6e5       1.4e5          3.6e-4                                                          1.6                                          5.0e-3                                                           1.3                                          1.7e-10                                               2.8e-4                                                               1.9                                       \n\n                         96                         2.9e6       1.2e6          1.6e-4                                                          1.2                                          2.4e-3                                                           1.1                                          1.8e-10                                               1.1e-4                                                               1.4                                       \n \n4*1       12                         2.1e4       6.0e3          3.8e-4                                                          1.5                                          3.9e-3                                                           1.3                                          1.8e-10                                               1.2e-4                                                               2.2                                       \n\n                         24                         1.7e5       5.2e4          1.0e-4                                                          1.9                                          1.1e-3                                                           1.8                                          1.8e-10                                               1.8e-5                                                               2.7                                       \n\n                         48                         1.4e6       4.3e5          2.7e-5                                                          2.0                                          3.0e-4                                                           1.9                                          1.9e-10                                               2.4e-6                                                               2.9                                       \n\n                         96                         1.1e7       3.5e6          6.7e-6                                                          2.0                                          7.6e-5                                                           2.0                                          1.9e-10                                               3.0e-7                                                               3.0                                       \n \n4*2       6                          6.2e3       1.2e3          4.0e-4                                                          1.5                                          3.6e-3                                                           1.4                                          1.8e-10                                               1.8e-4                                                               2.3                                       \n\n                         12                         5.1e4       1.2e4          7.0e-5                                                          2.5                                          7.0e-4                                                           2.4                                          1.9e-10                                               2.1e-5                                                               3.1                                       \n\n                         24                         4.2e5       1.0e5          9.9e-6                                                          2.8                                          9.9e-5                                                           2.8                                          1.8e-10                                               1.5e-6                                                               3.8                                       \n\n                         48                         3.3e6       8.6e5          1.3e-6                                                          2.9                                          1.3e-5                                                           2.9                                          1.9e-10                                               9.7e-8                                                               3.9                                       \n \n4*3       6                          1.2e4       2.2e3          1.3e-4                                                          2.6                                          1.4e-3                                                           2.2                                          1.8e-10                                               9.5e-5                                                               2.8                                       \n\n                         12                         1.0e5       2.0e4          1.4e-5                                                          3.3                                          1.2e-4                                                           3.5                                          1.9e-10                                               4.0e-6                                                               4.6                                       \n\n                         24                         8.2e5       1.7e5          9.6e-7                                                          3.8                                          8.6e-6                                                           3.8                                          1.9e-10                                               1.4e-7                                                               4.9                                       \n\n                         48                         6.6e6       1.4e6          6.2e-8                                                          4.0                                          5.6e-7                                                           3.9                                          1.9e-10                                               4.4e-9                                                               5.0                                       \n\n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Lid-driven cavity problem\n\nIn this example, we investigate the robustness of the proposed hp-multigrid preconditioners for the lid-driven cavity problem. The computational domain is a unit square/cube \u03a9=[0,1]^d. We assume an inhomogeneous Dirichlet boundary condition u=[4x(1-x),  0]^ when d=2 or u=[16x(1-x)y(1-y),  0,  0]^ when d=3 on the top side, and no-slip boundary conditions on the remaining domain boundaries. The source term f=0. The coarsest mesh is a triangulation of \u03a9 with the maximum element diameter 1/h=2 in 2D or 1/h=3 in 3D. We refine the mesh uniformly by connecting the midpoints of the element boundaries in two dimensions, whereas in three dimensions, we apply one-step bisection refinement and split each coarse-grid tetrahedron into two due to computational capacity limitations. Vertex-patched block smoothing and relaxation method are used when d=2, while edge-patched block smoothing and relaxation method are used when d=3 to save memory usage.\n\n\n\n  \u00a7.\u00a7.\u00a7 Generalized Stokes equation\n\n\nWe conducted tests on the PCG method preconditioned by both the variable V-cycle multigrid and W-cycle multigrid to solve the primal variable operator of the augmented Lagrangian Uzawa iteration for the condensed H(div) HDG scheme for the generalized Stokes equation. Table <ref> reports the obtained PCG iteration counts with varying mesh levels, lower-order term coefficient \u03b2, finite element space polynomial order k, and smoothing steps m_p = m_h = m. The iteration counts remain almost unchanged as \u03b2 increases from 0 to 10^3. \nWe noticed a slight increase in iteration counts as the polynomial order k increases, particularly in three-dimensional cases. However, increasing the smoothing steps effectively decreases the PCG iteration counts.\nOther results verify the robustness of the hp-multigrid preconditioner with respect to mesh size.\n\n\n\n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Stationary Navier-Stokes equations\n\n\nWe use PGM method preconditioned by the variable V-cycle method to solve the primal variable operator of the augmented Lagrangian Uzawa iteration method for the condensed H(div)-HDG method for the linearized Navier-Stokes equations as in Algorithm <ref>. Table <ref> and Table <ref> report the obtained average PGM iteration counts during the Picard iteration and Newton iteration procedures in Algorithm <ref>, with different mesh levels, viscosity \u03bd, finite element space polynomial order k, and smoothing steps m_p = m_h = m. Fig. <ref> demonstrates the magnitude and the streamlines of the obtained numerical velocity solution with \u03bd=10^-3 (left panel) and \u03bd=10^-4 (right panel).\n\n\n\nIn Table <ref>, for the two-dimensional cases where \u03bd\u2265 10^-3, the proposed hp-multigrid method demonstrates satisfactory performance under both Picard and Newton linearization methods, despite some mild increases in the iteration count of the PGM solver with increasing polynomial order k and Reynolds number \ud835\udc45\ud835\udc52. However, when \ud835\udc45\ud835\udc52=10^4 and k \u2265 1, the performance of the hp-multigrid method deteriorates significantly, although it remains satisfactory when k=0. This highlights the need for an efficient p-robust relaxation method to handle the convection-dominated case in the H(div)-HDG scheme, which requires further investigation.\nIn Table <ref>, the hp-multigrid method exhibits similarly good performance when \u03bd\u2265 10^-2 for the three-dimensional cases. However, when \u03bd\u2264 10^-3, the solution of the Picard linearization oscillates and cannot provide a sufficiently close initial guess for the Newton iteration. To address this issue, we employed the pseudo-time integration method to obtain the steady state, using a simple implicit backward-Euler discretization with the pseudo-time step size \u03b4 t^\u2217. The results in Table <ref> show that 1/\u03b4 t^\u2217=0.1 is good enough when \u03bd=10^-3, and the extra mass term in the primal operator A_k,h^c,\u03f5 in (<ref>) makes it easier to be solved by PGM. In the extreme case where \ud835\udc45\ud835\udc52=10^4, the solution to the Picard iteration oscillates even more severely, and we omit this case to keep our discussion simple. All other results verify the robustness of our hp-multigrid with respect to the mesh size.\n\nIn addition to Algorithm <ref>, we are aware of other techniques to solve the stationary Navier-Stokes equations, such as continuation on Reynolds number and pseudo-time integration with implicit-explicit (IMEX) methods. Our numerical experiments demonstrate that the proposed hp-multigrid method is a promising preconditioner for these techniques.\n\n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Backward-facing step flow problem\n\nFinally, we test the proposed hp-multigrid preconditioners for the \nbackward-facing step flow problem, with the domain \u03a9=([0.5,4]\u00d7[0,0.5])\u222a([0,4]\u00d7[0.5,1]) when d=2, or \u03a9=(([0.5,4]\u00d7[0,0.5])\u222a([0,4]\u00d7[0.5,1]))\u00d7[0,1] when d=3. We assume an inhomogeneous Dirichlet boundary condition u=[16(1-y)(y-0.5),  0]^ when d=2, or u=[64(1-y)(y-0.5)z(1-z),  0,  0]^ when d=3 for the inlet flow on {x=0}, with do-nothing boundary condition on {x=4} and no-slip boundary conditions on the remaining sides.\nWe note that when the edge-patched block relaxation method is used in our hp-multigrid, an evident increase in the iteration count of preconditioned Krylov subspace solvers with the increase of the polynomial degree is observed when the length of the domain is increased. Thus in the numerical experiments for the backward-facing step flow problems, we use vertex-patched relaxation and edge-patched smoothing in the hp-multigrid.\nOther settings are the same as in the lid-driven cavity problem. \n\n\n\n  \u00a7.\u00a7.\u00a7 Generalized Stokes equation\n\n\nTable <ref> reports the obtained PCG iteration counts.\nSimilar optimal results are observed as in the lid-driven cavity problem.\nWe note that when d=2, \u03b2=10^3 and m=1, or when d=3 and m=2, the PCG solver preconditioned by the W-cycle multigrid fails, which is due to the fact that the smoothing steps on each mesh level of the W-cycle multigrid are not large enough to make the preconditioned operator definite and robust with respect to mesh size <cit.>. Meanwhile, the variable V-cycle with m=1 remains a robust and positive definite preconditioner.\n\n\n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Stationary Navier-Stokes equations\n\n\nWe apply the PGM method preconditioned by the variable V-cycle method to solve the augmented Lagrangian Uzawa iteration (<ref>) for the condensed H(div)-HDG method for the linearized Navier-Stokes equations. Here we limit ourselves to cases with two-dimensional domain and with Reynolds number up to 10^3. All other settings are identical to those in Example <ref> for the generalized Stokes equation. The resulting average PGM iteration counts during the Picard and Newton iteration procedures in Algorithm are reported in Table <ref> for different mesh levels, viscosity \u03bd, finite element space polynomial order k, and smoothing steps m_p = m_h = m, and similar results as for the lid-driven cavity problem in Example <ref> are observed.\n\n\n\n\n\n\n\n\n\n\n\u00a7 CONCLUSION\n\n\nIn this study, we developed an hp-multigrid preconditioner for the H(div)-HDG scheme for both the generalized Stokes and the Navier-Stokes equations. The condensed H(div)-HDG system is solved by the augmented Lagrangian Uzawa iteration, and the hp-multigrid is used to precondition the nearly-singular primal operator on the global velocity spaces. The proposed hp-multigrid is essentially a multiplicative ASP, with the lowest global velocity space as the auxiliary space and a robust geometric multigrid algorithm as the auxiliary space solver. For the generalized Stokes equation, we prove that the condensed lowest-order H(div)-HDG discretization is equivalent to the CR discretization with a pressure-robust treatment, which allows for the application of the rich geometric multigrid theory for the CR discretization. Numerical experiments demonstrate that the proposed hp-multigrid is robust to mesh size and the augmented Lagrangian parameter, while a very mild increase in iteration counts of the preconditioned Krylov space solvers with respect to the increase of polynomial order is observed. We further test the proposed hp-multigrid preconditioner on the H(div)-HDG scheme for the linearized Naiver-Stokes equation by Picard or Newton's method, and the iteration counts grow mildly with respect to the increase of the Reynolds number as large as 10^3. An efficient parallel implementation of an additive hp-multigrid algorithm and the proof of its robustness for the generalized Stokes equation will be our forthcoming research.\n\n\n\nsiam\n\n"}