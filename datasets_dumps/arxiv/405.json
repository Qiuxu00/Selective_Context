{"entry_id": "http://arxiv.org/abs/2303.06765v1", "published": "20230312220245", "title": "Closed-form analytical solution for the transfer matrix based on Pendry-MacKinnon discrete Maxwell's equations", "authors": ["Ovidiu-Zeno Lipan", "Aldo De Sabata"], "primary_category": "physics.optics", "categories": ["physics.optics", "physics.class-ph"], "text": "\n\n\n\n\n\nAPS/123-QED\n\n\n\n\n\n olipan@richmond.edu\n\nDepartment of Physics, Gottwald Center for the Sciences 138 UR Drive, University of Richmond, Richmond, VA 23173, USA\n\n\n\n\n Department of Measurements and Optical Electronics, Politehnica University of Timisoara, 300006 Timisoara, Romania\n\n\n             \n\n\n\n           \n             \n             \n\nPendry and MacKinnon  meaningful discretization of  Maxwell's equations was put forward specifically as part of a finite-element numerical algorithm. By contrast with a numerical approach, in the same spirit evoked by the relationships between the difference and the differential equations, we provide an analytical solution for the transfer matrix elements generated by this discretization of  Maxwell's equations. The method, valid for all modes and any non-magnetic pattern with frequency-dependent permittivities, is exemplified for a bilaminar structure. The results from hundreds of  path-operators simplify to a small number of propagation channels, which transfer the electromagnetic field between input and output. A specific bilaminar device is design-optimized and used to generate  a topological map from permittivities to the number of modes and very high Q-factor resonances.\n\n\n\n\n  PACS Numbers\n78.67.Pt, 42.25.Fx\n\n\n\n\n\n\n\n                             \n\n                              \nClosed-form analytical solution for the transfer matrix based on Pendry-MacKinnon discrete Maxwell's equations\n    Aldo De Sabata\n    March 30, 2023\n==============================================================================================================\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n\n\nWhat follows came about as an overlap of a present technological need with a perennial scientific quest. The current need is represented by photonic devices based on thin laminae,  be they in the form of waveguides for augmented reality <cit.>, <cit.> or of frequency-selective surfaces for the 5 and 6G networks <cit.>, of wearable applications <cit.> or of surface wave-mediated sensing applications <cit.>, <cit.>. The perennial quest is to understand the  interplay between discrete and continuous models <cit.>, <cit.>. The focus on this association has varied since the 19th century, <cit.>,  piquing the interest of many in, for example, the theory of solitons <cit.>,  universality in chaos <cit.>, <cit.>, fractals <cit.>.  The manifestation that interests us  is  the relationship between the difference and the differential equations. For example, the discrete version of the equation of Korteweg and de Vries for soliton wave motion,<cit.>, shows a distinct asymmetric  richness  since it contains a series of universal  properties that are not readily visible in the continuum. Particularly, the discrete form of soliton equations proposed by  Hirota <cit.>,<cit.> is connected with quantum integrable systems  <cit.>, <cit.>.\nIt is essential to emphasize that it is not at all trivial to discretize an equation in a way that preserves the prime properties of the original continuous equation. \n \nPendry and MacKinnon obtained a meaningful discretization of  Maxwell's equations <cit.> on a carefully chosen simple cubic lattice <cit.>, by retaining the essential properties of the longitudinal modes present in the continuum. This discretization was put forward specifically  as part of a finite-element numerical algorithm <cit.>.\n  \nBy contrast with a numerical approach, in the same spirit evoked by the relationships between the difference and the differential equations, we asked the question of whether a complete analytical solution can be found to the transfer matrix of the Pendry and MacKinnon discrete Maxwell's equations. \n\nThe transfer matrix, <cit.>, is widely used well beyond the study of the propagation of electromagnetic fields <cit.>, <cit.>. \nIts common appearance is in the form of a 2\u00d7 2 matrix, reduced to one propagation mode <cit.>, <cit.>,<cit.>.\nHowever, we are looking here for an  analytical solution for the transfer matrix that is valid for any non-magnetic pattern and that has to encompass all Bloch-Floquet modes, either propagative or evanescent. As a consequence, our procedures differ from those employed in theories where the number of parameters are few and symmetries are many, <cit.>,<cit.>.\n\n\nIn the ensuing sections we derive this  analytical solution and present the techniques we used, noteworthy among them being the definition of path-operators, Fig.<ref>, and the appearance of propagation channels for the transfer of the electromagnetic field between input and output, Fig.<ref>. This analytical solution is valid for filling the lattice's nodes with frequency-dependent non-magnetic isotropic material of any kind.  We present the general solution for two laminae, although the method can be extended to additional laminae. \n\n To be more specific, in Sections <ref> and <ref> we rewrite the Pendry and MacKinnon discrete version of  Maxwell's equations to take shape in a tensor product of two 2-dimensional linear spaces, (<ref>) to (<ref>) and (<ref>) to (<ref>). As a consequence, the electromagnetic states and the propagation operators are decomposed as a tensor product, (<ref>). This course of action proves to be essential in simplifying a large volume of analytic computations. \n Sections <ref> and <ref> are dedicated to the discrete dispersion relation in vacuum and to the on-shell scattering method, <cit.>, from which a function along the z-coordinate is extracted, (<ref>). The Bloch-Floquet periodic boundary conditions along the x and y axes, but not along z, are introduced in Section <ref>. The building up of the transfer matrix from its elements is covered in Section <ref>.\n \n  A key step towards the solution, the path-operators, is defined and discussed in Section <ref>. The summation over the entire set of path-operators greatly simplifies the transfer matrix to reveal that the propagation run along a small number of channels, Section <ref>. \n  \n  To concretize the proposed method, which hinges on path-operators and channels, we completely solve for the transfer matrix elements of a bilaminar structure. The presentation of the solution starts in Section <ref> from a bird's eye view, and dives into the details in Sections <ref> and <ref>.  The classification of the channels by the  input-output polarization and the direction of propagation is summarized in Table <ref>, Figs.<ref> and <ref> and Appendix B. \n  \n  In Section <ref> we segue into the continuum limit, and then apply it to the specific bilaminar pattern from Fig.<ref>.\n   The limit is in the x and y directions and it reveals that channels can be classified by a set of universal functions. It also calls for computing 2-dimensional Fourier integrals of products of these functions, each function's argument being defined by the permittivities of a lamina, Section <ref> and <ref>. For polygonal tessellated laminae, Section <ref>, these integrals can be computed in a closed form, Section <ref> and <ref>. The formulas contain a gauge freedom and are arranged as a sum of terms over the vertices of the tessellated polygons. These terms hold all the information about the non-magnetic materials and the geometric orientations of the structure, as can be seen in (<ref>).\n  \nLastly, from the formulas for the transfer matrix, an optimization procedure is devised in Section <ref> to create a dielectric bilaminar structure, Fig.<ref>, on which Bloch-Floquet modes propagate along the laminae with large amplitudes, being evanescent in the z-direction <cit.>. These resonances display a series of relevant properties.  One is the robustness with respect to the change of the dielectric constants, Section <ref>. The resonant frequencies are located close to the zeroes of the diagonal elements of the transfer matrix. As the dielectric permittivities pass through different values, the zeroes are created or disappear  allowing us to define a topological map that counts the number of resonant modes, Fig.<ref>.\n  \nOn a separate note, in Section <ref> and <ref> we find that the same bilaminar structure, but with specifically selected  dielectric constants, resonates with a very large  Q-factor, Fig.<ref>. Finally, in Section <ref>, the complete analytical formula offers the possibility to obtain the Fano-Lorentz spectral line shape for a resonant mode, <cit.>,<cit.>, through a zero-pole approximation (<ref>), in the complex frequency plane Fig.<ref>. \n  \n   \n   \n\n\n\n\n\n\u00a7 DISCRETE MAXWELL'S EQUATIONS ON A LATTICE\n\n\n\nSpace is an orthogonal lattice with lattice constants a,b and c on the x,y and z directions, respectively. The z-axis is singled-out as the propagation axis for the transfer matrix. The discrete space is thus viewed as a sequence of x,y-parallel planes labeled by the z-axis coordinate. The discrete position vector is n=(a n_x,b n_y,c n_z)=(n_\u22a5,c n_z), where the notation n_\u22a5=(a n_x,b n_y) emphasizes the decomposition of the space as a collection of planes perpendicular to the z-axis, as in <cit.>. If there is a preference to view the collection of planes as central, then \u22a5 should be changed to \u2225 everywhere in the paper. At each point of the lattice, the electromagnetic field is described by six components, E and H. The material attached to each lattice point is characterized by two discrete scalar fields which connect D to E and B to H, respectively:\n\n    D   =   \u03f5_0\u03f5(n_\u22a5,c n_z)E, \n    B   =   \u03bc_0\u03bc(n_\u22a5,c n_z)H.\n\nIn the discrete electrodynamics that we are taking forward, the \u2207 operator becomes a pair, (T^E ,T^H ), of lattice operators,  where T^E=(T_x^E(a),T_y^E(b),T_z^E(c)) and T^H=(T_x^H(a),T_y^H(b),T_z^H(c)). These discrete operators are defined by their action on a lattice scalar function f(n). For the x-axis\n\n    T_x^E(a)f(n)   =(i a)^-1(f(n+a x\u0302)-f(n)),\n    \n    \tT_x^H(a)f(n)   =-(i a)^-1(f(n-a x\u0302)-f(n)).\n\nwith (y,b) and (z,c) taking place of (x,a), for the other axes.\nThe Maxwell's equations on the lattice are\n\n    T^E \u00d7E   =   \u0393_H^-1H^' , \n    T^H\u00d7H^'   =   \u0393_E^-1E,\n\nwhere\n\n    \u0393_H^-1   =    -i\u03c9^2 \u03f5_0\u03bc_0 \u03bc(n_\u22a5,c n_z) c,\n    \u0393_E^-1   =   -i \u03f5(n_\u22a5,c n_z)c^-1,\n    H^'   =   i(\u03c9\u03f5_0 c)^-1H.\n\nEliminating E_z and H^'_z from  Maxwell's equations, the propagation of the  4-dimensional vector field \n\n    |F(n_\u22a5,n_z)\u27e9=\n              [   E_x(n_\u22a5,c n_z);   E_y(n_\u22a5,c n_z); H^'_x(n_\u22a5,c n_z); H^'_y(n_\u22a5,c n_z) ]\n\nis carried on, as usual, by two operators. The first operator O_E, (<ref>), advances only the E-components Fig.(<ref>)\n\n\n\n    [   E_x(n_\u22a5,c n_z);   E_y(n_\u22a5,c n_z); H^'_x(n_\u22a5,c n_z); H^'_y(n_\u22a5,c n_z) ]              [ E_x(n_\u22a5,c n_z+c); E_y(n_\u22a5,c n_z+c); H^'_x(n_\u22a5,c n_z); H^'_y(n_\u22a5,c n_z) ].\n\n\n\n\n\n\n\n\n\n\n\n\nThe material properties \u0393_H and \u0393_E embedded in the O_E matrix elements depend only on the spatial position n located on the plane n_z.  The operator O_E acts on the internal index \u03b1 of the vector field F_\u03b1, (<ref>), as a 4 by 4 matrix multiplication, whereas the matrix elements of O_E are operators on the external space variable n_\u22a5 of the field, but not on the n_z-position.\nThe E-step carried by O_E is followed by an H-step carried by O_H\n\n    [ E_x(n_\u22a5,c n_z+c); E_y(n_\u22a5,c n_z+c); H^'_x(n_\u22a5,c n_z); H^'_y(n_\u22a5,c n_z) ]                            [   E_x(n_\u22a5,c n_z+c);   E_y(n_\u22a5,c n_z+c); H^'_x(n_\u22a5,c n_z+c); H^'_y(n_\u22a5,c n_z+c) ].\n\n\n\n\n\n\n\n\n\n\n\nIn contrast to O_E, the material properties \u0393_H and \u0393_E for the O_H matrix elements depend on the spatial position on plane n_z+1.\nThe complete propagation from the plane located at n_z to the one located at n_z+1 is accomplished by O_H(n_\u22a5,c n_z+c) O_E(n_\u22a5,c n_z).\n\nIt is apparent from the structure of the operators O_E and O_H that the internal 4-dimensional space can be viewed as a tensor product of two 2-dimensional spaces. This decomposition proves to be efficient in classifying different paths taken by the electromagnetic propagation through materials, which will be one of our main instruments to obtain closed analytic formulas for the transfer matrix elements. So, departing from <cit.>, the path viewpoint is expressed by writing the operators as\n\n    O_E (n_z)   =    O_E^(1)+O_E^(2)+O_E^(3), \n    \n       O_E^(3)   =   1\u22971,\n        \n    \n       O_E^(2)   =    I_E\u2297\u03c3_2 \u0393_H^-1(-c),\n    \n       O_E^(1)   =   I_E\u2297|T_E\u27e9\u0393_E \u27e8T_E|\u03c3_2(-c),\n\nwhere \u03c3_2 is the Pauli matrix and\n\n    1=[ 1 0; 0 1;   ]   ,\n    I_E=[ 0 1; 0 0;   ]   ,\n    I_H=[ 0 0; 1 0;   ].\n\n\nThe ket and the bra operators form (<ref>) act  on the internal space as 2-dimensional vectors and on the external space variable  n_\u22a5 as operators on functions\n\n    |T_E\u27e9=[ T_x^E;      ; T_y^E ]   ,\n    \u27e8T_E|=[ T_x^H T_y^H ].\n\n\nThe ket to bra conjugation is defined as the change of E into H. There is no  additional conjugation over the complex unit i. The labels, as is usually the case, do not change under conjugation.\n\nSimilarly, but different to the E-step, the operator for the H-step is\n\n    O_H(n_z+1)    =    O_H^(1)+O_H^(2)+O_H^(3), \n    \n       O_H^(3)   =   1\u22971,\n        \n    \n       O_H^(2)   =    I_H\u2297\u03c3_2 \u0393_E^-1(-c),\n    \n       O_H^(1)   =   I_H\u2297|T_H\u27e9\u0393_H \u27e8T_H|\u03c3_2(-c),\n\n\n    |T_H\u27e9=[ T_x^H;      ; T_y^H ],\n       \u27e8T_H|=[ T_x^E T_y^E ].\n\n\n\nConcordant to the tensor product decomposition of the operators, the field will be represented also as a tensor product,\n\n    |F(n_\u22a5,n_z)\u27e9=   \n    |e\u27e9\u2297[ E_x(n_\u22a5,c n_z); E_y(n_\u22a5,c n_z) ]+|h\u27e9\u2297   [ H^'_x(n_\u22a5,c n_z); H^'_y(n_\u22a5,c n_z) ],\n\nwhere the 2-dimensional vectors |e\u27e9 and  |h\u27e9, \n\n    |e\u27e9=[ 1;  ; 0 ]   ,\n    |h\u27e9=[ 0;  ; 1 ],\n\nselect the electric part (E_x,E_y) and the magnetic part  (H^'_x,H^'_y)  of the 4-dimensional vector (E_x,E_y,H^'_x,H^'_y), respectively.\n\n\n\n\u00a7 BASIS VECTORS FOR FIELDS ON A LATTICE\n\n\n\nThe solutions to  Maxwell's equations on a lattice filled with a homogeneous medium, i.e. constant \u0393_H(n_\u22a5,c n_z)=\u0393_H and \u0393_E(n_\u22a5,c n_z)=\u0393_E, are plane waves.\n These solutions, |\u03a8_S/P,p_\u22a5^\u00b1\u27e9 e^\u00b1 i p_z n_z c e^- i \u03c9 t, are distinguished by the type of polarization S or P and by the direction of propagation \u00b1 along the positive or negative z-direction. Here\n\n    |\u03a8_S/P,p_\u22a5^\u00b1\u27e9=|p_\u22a5,S/P,\u00b1\u27e9e^i p_\u22a5 n_\u22a5,\n\nwith the propagation in the (x,y)-plane  described by p_\u22a5=(p_x,p_y).\n\nThe internal 4-dimensional vectors of the plane waves are \n\n    |p_\u22a5,S,+\u27e9   =|e\u27e9\u2297 i \u03c3_2 |p_\u22a5^H\u27e9+|h\u27e9\u2297|p_\u22a5^H\u27e9\u0393_H k_z^E,\n    |p_\u22a5,P,+\u27e9   =|e\u27e9\u2297|p_\u22a5^E\u27e9\u0393_E k_z^H+|h\u27e9\u2297 i \u03c3_2 |p_\u22a5^E\u27e9,\n\nwhere, consistent with (<ref>) and (<ref>), the column vectors  |p_\u22a5^E\u27e9 and |p_\u22a5^H\u27e9 are the transpose and E\u21c4 H conjugate of the row vectors \u27e8p_\u22a5^E|=[k_x^H,k_y^H] and \u27e8p_\u22a5^H|=[k_x^E,k_y^E], respectively.\n The space being discrete, the  plane wave depends on the lattice constants (a,b,c) through the vectors k^E=(k_x^E,k_y^E,k_z^E) and k^H=(k_x^H,k_y^H,k_z^H),\n\n    k_x^E = (i a)^-1(e^i a p_x-1),\n    \n    \tk_x^H = -(i a)^-1(e^-i a p_x-1),\n\nwith the pairs (b,p_y) and (c,p_z) instead of (a,p_x), for the other axes. To obtain the other two basis vectors, |p_\u22a5,S/P,-\u27e9, change k_z^E from  |p_\u22a5,S/P,+\u27e9 into - k_z^H.\n\nTo derive the transfer matrix elements, the field (<ref>), at a given n_z, is decomposed in the basis |\u03a8_S/P,p_\u22a5^\u00b1\u27e9. The decomposition is carried out by projecting on an orthogonal set of bra vectors (<ref>)\n\n\n    \u27e8\u03a6_S/P,p_\u22a5^\u00b1|=\u27e8p_\u22a5,S/P,\u00b1|e^-i p_\u22a5 n_\u22a5,\n\t\nwhere\n\n    \u27e8p_\u22a5,S,+|   =-\u27e8e|\u2297\u27e8p_\u22a5^H|i \u03c3_2 k_z^H+\u27e8h|\u2297\u27e8p_\u22a5^H|\u0393_H^-1,\n    \n    \u27e8p_\u22a5,P,+|   =\u27e8e|\u2297\u27e8p_\u22a5^E|\u0393_E^-1-\u27e8h|\u2297\u27e8p_\u22a5^E|i \u03c3_2 k_z^E.\n\nMultiply  \u27e8p_\u22a5,S/P,+| by -1 and change k_z^H into -k_z^E to attain  \u27e8p_\u22a5,S/P,-|. The orthogonal basis is not normalized. The norm,  \u27e8p_\u22a5^H||p_\u22a5^H\u27e9( k_z^H+k_z^E)=\u27e8p_\u22a5^E||p_\u22a5^E\u27e9( k_z^E+k_z^H), is invariant to E\u21c6 H conjugation. \n\n\n\n\n\n\n\u00a7 DISPERSION RELATION FOR A HOMOGENEOUS MEDIUM\n\n\n\nThe requirement that the plane wave basis satisfy  Maxwell's equations on the lattice filled with a homogeneous medium imposes that\n\n    -(\u0393_H \u0393_E)^-1=\u27e8p_\u22a5^H||p_\u22a5^H\u27e9+k_z^E k_z^H.\n\nThis is the dispersion relation for the homogeneous medium\n\n    \u03c9^2/v_0^2=k_x^E k_x^H+k_y^E k_y^H+k_z^E k_z^H,\n\nwhere the velocity of light in that medium is v_0. \nThrough the following c-scaling\n\n    \u03c9/v_0=\u03a9/c=2 \u03c0/\u03bb,\n\nthe dispersion relation is written in terms of a unitless frequency \u03a9\n\n    \u03a9^2/c^2=k_x^Ek_x^H+k_y^Ek_y^H+k_z^Ek_z^H,\n\nwhich will become useful for expressing the transfer matrix elements in terms of unitless parameters.\nNote that the term k_x^Ek_x^H+k_y^Ek_y^H, which is equal to \u27e8p_\u22a5^E||p_\u22a5^E\u27e9=\u27e8p_\u22a5^H||p_\u22a5^H\u27e9, tends in the continuum limit a \u2192 0,b\u2192 0 to p_x^2+p_y^2. In what follows, we use vacuum as the homogeneous medium for the basis. Interchangeably, this medium will be called also as the reference medium for the basis.\n\n\n\n\u00a7 SOLVING FOR \u03a6 _Z=E^I C P_Z FOR GIVEN \u03a9, P_X AND P_Y\n\n\nThe approach in <cit.> is to work on-shell which means solve the dispersion relation for p_z, given the frequency \u03a9 and  p_\u22a5.\nTo this end, we introduce the function \u03c6 _z\n\n    \u03c6 _z=e^i c p_z,\n\nwhich is the solution to the equation\n\n    \u03c6 _z+\u03c6 _z^-1=2\u03b6,\n\nwhere\n\n    \u03b6=1-\u03a9^2/2+c^2/2\u27e8p_\u22a5^H||p_\u22a5^H\u27e9.\n\n\nThere are two distinct and non-overlapping constraints that we impose on p_z from (<ref>). One condition is Im(p_z)\u2a7e 0 so that evanescent waves generated away from sources placed at z=-\u221e or at z=\u221e  are represented by a decaying \u03c6_z or \u03c6_z^-1, respectively. The other condition is p_z\u2a7e0 enforcing the velocity of   propagating waves coming from z=-\u221e or z=\u221e to be oriented along  \u1e91 or \n -\u1e91, respectively. The formal solution to the equation (<ref>), \u03c6_z=\u03b6\u00b1\u221a(\u03b6^2-1)\n\n\n\ndivides the real axis  into three intervals, (-\u221e,-1), (-1,1) and (1,\u221e). The requirement Im(p_z)\u2a7e0  for the interval (-\u221e,-1) selects the  \u03c6_z=\u03b6 - \u221a(\u03b6^2-1)\n\n\n\nbut does not impose specific values for \u03c6_z on (-\u221e,-1). Both walks in the \u03b6-complex plane  above or below (-\u221e,-1) satisfy  Im(p_z)\u2a7e 0. \nThe second constrain, p_z\u2a7e 0,  requires the values of  \u03c6_z on (-1,1) to be those obtained from walking below the segment (-1,1). For the last interval the constrain  Im(p_z)\u2a7e 0 is fulfilled and, like for  (-\u221e,-1), we are free to define \u03c6_z on  (1,\u221e) from walking above or below the interval. \n We opt to construct a function \u03c6_z continuous from below, Im(\u03b6)\u2a7d 0, and so select the values of \u03c6_z on the real axis by walking below it in the \u03b6-complex plane.\n \n This analysis leads to the following solution\n\n    \u03c6_z(\u03b6)=\u03b6-\u221a(\u03b6^2-1)e^i/2(arg(\u03b6-1)+arg(\u03b6+1)).\n\nThe arg(\u03b6) takes values on [-\u03c0,\u03c0) in such a way  that arg(\u03b6)=-\u03c0 if Im(\u03b6)=0 and \u03b6<0.\nIn Fig.<ref> the point \u03c6_z=1 defines the Rayleigh frequency, at which, for a given p_\u22a5, the waves turn from evanescent to propagating.\n\n\n\n\n\n\u00a7 PERIODIC BOUNDARY CONDITIONS\n\n\nConsider that the electromagnetic field is subjected to the Bloch-Floquet boundary conditions\n\n    |F(n_\u22a5+(a,0)L_x,c n_z)\u27e9=\te^2\u03c0 i \u03be_x |F(n_\u22a5,c n_z)\u27e9,\n    |F(n_\u22a5+(0,b)L_y,c n_z)\u27e9=\te^2\u03c0 i \u03be_y |F(n_\u22a5,c n_z)\u27e9,\n\nwhere L_x\u2a7e 2 and L_y\u2a7e 2 are two integer numbers selected to describe the dimensions of a unit cell in the (x,y)-plane. The material properties are taken to be periodic from one unit cell to another\n\n    \u0393_H(n_\u22a5+(a,0)L_x,n_z)    =   \u0393_H(n_\u22a5,n_z) \n    \u0393_H(n_\u22a5+(0,b)L_y,n_z)    =   \u0393_H(n_\u22a5,n_z)\n\nwith a similar periodicity for \u0393_E. The Bloch-Floquet boundary condition reduces the possible values for (p_x,p_y) to\n\n    p_x = 2 \u03c0M_x/a L_x+ 2 \u03c0\u03be_x/a L_x,\n    \n    \tp_y = 2 \u03c0M_y/b L_y+ 2 \u03c0\u03be_y/b L_y,\n\nwhere  M_x=0,1,\u2026,L_x-1 and M_y=0,1,\u2026,L_y-1, with 0\u2a7d\u03be_x<1, 0\u2a7d\u03be_y<1.\n\nThe indices of the basis, written as |\u03c8_POL,BF^DIR\u27e9, are thus of four categories. The first, POL, is the polarization index, which takes two values S and P. The second, DIR, is the direction of propagation of the plane wave along the z-axis, which also take two values, + and -. The third, BF, is the Bloch-Floquet index consisting of pairs of integer numbers (M_x,M_y) and  it takes a finite number of values. The last index, (\u03be_x,\u03be_y)  takes only one value and can be viewed as a label for the entire Bloch-Floquet linear basis.\n\nThe parameters (\u03be_x,\u03be_y) specify the direction of the wave in the (x,y)-plane. For example, if the direction of the incoming mode (M_x=0,M_y=0) is stated in spherical coordinates by the angles (\u03b8,\u03c6), then the parameterization of \u03be_x and \u03be_y is\n\n    sin(\u03c0\u03be_x/L_x)    =   a \u03a9/2 csin(\u03b8) cos(\u03c6), \n    sin(\u03c0\u03be_y/L_y)    =   b \u03a9/2 csin(\u03b8) sin(\u03c6), \n    sin(1/2c p_z)    =   c \u03a9/2 ccos(\u03b8).\n\n\nThe first two equations give \u03be_x,\u03be_y for  chosen \u03b8, \u03c6 and \u03a9, whereas  the third equation solves for p_z. \n\n\n\n\n\u00a7 TRANSFER AND SCATTERING MATRICES\n\t\nTo go ahead and propagate from the IN  plane located at n_z to the OUT at n_z+L_z, decompose the IN and OUT fields in the plane wave basis, (<ref>), labeled  as |\u03c8_pol,bf^dir\u27e9 and |\u03c8_POL,BF^DIR\u27e9, respectively. The z-phases, e^\u00b1 i p_z^IN n_z and  e^\u00b1 i p_z^OUT (n_z+L_z), which are not included in the basis, are generated by the operators and so they do appear in the transfer matrix elements.\nThe transfer matrix elements are defined in (<ref>) as the factors that connect the coefficients of the |F^IN(n_\u22a5,n_z)\u27e9 and |F^OUT(n_\u22a5,n_z+L_z)\u27e9 fields decomposed in the reference medium plane wave basis\n\n    C_POL,BF^DIR=\u2211(T^DIR;dir_POL,BF;pol,bf ) C_pol,bf^dir ,\n\nthe sum being over indices (dir,pol,bf) related to the IN parameters.\nThe transfer matrix elements T in (<ref>) borrow, from the basis, all four index categories.\n\n\n\n\n\n\t\n\t\n\n\nBuilding a matrix out of the T-coefficients of (<ref>)  requires a map from the 2-dimensional Bloch-Floquet index (M_x,M_y)  to a 1-dimensional integer index m=1,2,\u22ef, L_x L_y. We use the Rayleigh frequency of (M_x,M_y) to both map and order the Bloch-Floquet index. If the Rayleigh frequency of (M_x,M_y) is less than the Rayleigh frequency of (M_x^',M_y^') we order the Bloch-Floquet indices as (M_x,M_y)<(M_x^',M_y^'). If two distinct Bloch-Floquet modes have the same Rayleigh frequency, the order used is the lexicographic order. Note that this ordering depends on (\u03be_x,\u03be_y). The mode (M_x,M_y)=(0,0) has f_Rayleigh=0 and it is mapped into m=1. The next  f_Rayleigh > 0 is mapped into m=2 and so on Table<ref> from Appendix I.\n\nThe process of building the transfer matrix out of its elements starts with  all 2\u00d7 2 matrices \n\n    T^-,-_m,n=\t(\n    \t[ T^-,-_Sm,Sn T^-,-_Sm,Pn; T^-,-_Pm,Sn T^-,-_Pm,Pn;             ])\n \nconstructed for each pair (m,n).\nThese matrices contain the information about the transfer, through the device, of the mode n with a negative direction present at IN into the mode m, also with a negative direction but located at OUT. \n\nFrom these 2\u00d7 2-matrices, construct the transfer matrix T^-,- by letting the Bloch-Floquet indices m and n  run from 1 to L_x L_y\n\n    T^-,-=\t(\n    \t[ T^-,-_1,1 T^-,-_1,2 T^-,-_1,3         \u22ef; T^-,-_2,1 T^-,-_2,2 T^-,-_2,3         \u22ef; T^-,-_3,1 T^-,-_3,2 T^-,-_3,3         \u22ef;         \u22ef         \u22ef         \u22ef         \u22ef;           ]).\n\n\nOnce  all four matrices T^-,-, T^-,+,\tT^+,-, T^+,+ are constructed in a similar manner, the complete transfer matrix appears as\n\n    T(\u03be_x,\u03be_y)=\t(\n    \t[ T^+,+ T^+,-; T^-,+ T^-,-;       ]),\n\nwhere (\u03be_x,\u03be_y) are explicitly written here to remind us of their role. \n\nThe elements of the scattering matrix can now be obtained from the complete transfer matrix. The input and output have a different meaning for the scattering matrix than OUT and IN have for the transfer matrix. Instead of \"DIR/dir\", for the scattering matrix we use a position index, which is either min or max depending on the position on the z-axis of the field |F\u27e9, at z=n_z or at z=n_z+L_z, respectively. The polarization and the Bloch-Floquet  indices remain the same.\n\nThe well-known procedure to obtain the scattering matrix, <cit.>,\n \n\n\n\n\n\n\n\n\n\n    t(\u03be_x,\u03be_y)=\t(\n    \t[ t^max,min t^max,max; t^min,min t^min,max;           ]),\n\nrequires the inverse of the transfer matrix T^-,-\n\n    t^min,max   =   (T^-,-)^-1,\n    \n    \tt^min,min   =   -t^min,maxT^-,+,\n    \n    \tt^max,max   =   T^+,-t^min,max,\n    \n    \tt^max,min   =   T^+,++t^max,maxT^-,-t^min,min.\n\n\n\n\n\n\u00a7 PROPAGATION BY PATH-OPERATORS\n\n\nThe transfer matrix elements\n(<ref>) can be written in terms of the propagation operator\n\n    T^DIR; dir_POL,BF; pol,bf=   OUT^-1(L_xL_y)^-1\u2211_-5mu n_\u22a5\n       \u27e8\u03d5_POL,BF^DIR|Operator|\u03c8_pol,bf^dir\u27e9,\n\t\n\n\n\t\n\t\n\t\n\t\n\nwhere the normalization in the internal space and the Operator are\n\n    OUT=\u27e8p^H,OUT_\u22a5||p^H,OUT_\u22a5\u27e9(k_z^H,OUT+k_z^E,OUT),\n    Operator=O_H(n_z+L_z)O_E(n_z+ L_z-1)\n    \u2026 \n    \tO_H(n_z+1)O_E(n_z).\n \n\nThe common approach, also followed by <cit.>, is to place the resolution of identity between every pair of O_HO_E operators in the product (<ref>). Within this procedure, for a stack of laminae we need  to multiply a set of large-dimensional transfer matrices, one for each lamina. This implies that to grasp one desired transfer matrix element of the stack we actually need to compute all elements, which can be computationally taxing, at both levels, theoretical or numerical. Furthermore, the advantage of using a sequence of matrix products is diminished by numerical instabilities and, potentially, by approximating a large-dimensional transfer matrix by a smaller one. \n\nTo avoid using  products of matrices  we develop a different procedure, which, to the best of our knowledge is new in the context of transfer matrices for non-homogeneous  permittivity and permeability materials. \n\n\nTo exemplify, consider |\u03c8_pol,bf^dir\u27e9=|p_\u22a5^IN,S,+\u27e9 e^i p_\u22a5^IN n_\u22a5 at IN and \u27e8\u03d5_POL,BF^DIR|=\u27e8p_\u22a5^OUT,S,+| e^-i p_\u22a5^OUT n_\u22a5 at OUT in (<ref>).\n\n\n\n\n\n\nThere are several decisive moments in this manuscript. One is here, where we decide to expand the product operator as a sum of path-operators. Namely, since each O_E and O_H is a sum of there operators, (<ref>) and (<ref>), (<ref>) becomes a sum of 3^L_z+1 terms O_H^(j)O_E^(k)\u2026 O_H^(m)O_E^(n), parameterized by a path (INn,m,\u2026,k,jOUT), where each index takes three values. Each path can be represented graphically, like in Fig.<ref>, by associating a j \u2219 and a j \u2218 to O_E^(j) and O_H^(j), respectively.\n\n\n\n\n\n\n\n\n\n\n\nFor example, the path-operator O_H^(2)O_E^(3)O_H^(2)O_E^(1)O_H^(2)O_E^(1) for the path IN121232OUT is represented in Fig.<ref>\n\n\n\t\n\t\n\n\n \n \n\n\n\u00a7 CHANNELS\n\n\nThe transfer matrix element is thus a sum over path-operators\n\n    OUT^-1(L_xL_y)^-1\u2211_paths\u2211_n_\u22a5e^-i p_\u22a5^OUT n_\u22a5\n       \u27e8p_\u22a5^OUT,S,+|path-operator|p_\u22a5^IN,S,+\u27e9 e^i p_\u22a5^IN n_\u22a5.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n We continue with the chosen example where S+ is placed at both  IN and OUT. However, the liberty of choosing any pair of polarization and direction at both IN and, independently, OUT, is manifestly visible in (<ref>). \n To proceed further, the tensor product decomposition of both the basis and the operators proves to be very useful. Each element of the  basis, (<ref>), is a sum of two parts, the e-part and the h-part, that contains |e\u27e9 and |h\u27e9, respectively. The same kind of decomposition is valid for the path-operator, where there is an I_E-part and an I_H-part in  (<ref>) and (<ref>). Due to these decompositions, the  tensor product in \u27e8p_\u22a5^OUT,S,+|path-operator|p_\u22a5^IN,S,+\u27e9 splits as a product of  two factors. The first factor is  of the form \u27e8e|I_H I_E I_2I_HI_1\u22ef I_E|h\u27e9, and alike versions. It can take only two values, 0 or 1. For each non-zero path that survives this first-factor selection, we must compute the second factor, which contains the material properties. For this paper we confine ourselves to non-magnetic materials.\n \n The structure of the second factor is of the form \u27e8p_\u22a5^H,OUT||T_E\u27e9\u0393_P\u03c3_2\u22ef|p_\u22a5^E,IN\u27e9, which, drawing on \u27e8T_E|\u03c3_2|T_H\u27e9 e^i p_\u22a5\u00b7 n_\u22a5=0, offers a second zero-selection procedure. Moreover, the second factor, for those paths that are overall non-zero, admits, as well, a pleasing and advantageous factorization into two terms. One term, call it the \ud835\udcb5-term, is a function of (p_z^IN,p_z^OUT,\u03a9) but not on the  materials parameters, whereas the other, call it the XY-term, depends on p_\u22a5^IN and the deposited materials.\nThis factorization is crucial in simplifying the final result for the transfer matrix because, fortunately, the XY-term is common to a group of paths. \n\nWe will call a channel a subset of paths, which have the same XY-term. The main significance is that the number of channels is much smaller than the number of non-zero paths, substantially reducing the final analytical expression for a transfer matrix element. Furthermore, the \ud835\udcb5-term of a channel, which is the sum of the \ud835\udcb5-terms of the paths that belong to that channel, simplifies into products of \u03c6_z-dependent factors. \n\nThe technique to separate a \ud835\udcb5-term from an XY-term is to forward-propagate the input phase e^i p_\u22a5^IN\u00b7 n_\u22a5 and backward-propagate the output phase  e^i p_\u22a5^OUT\u00b7 n_\u22a5, both through the chain of path-operator product. These propagations are carried through the path-operator by using the general relation\n\n\n    \u2211_n_\u22a5e^-i p_\u22a5^OUT\u00b7 n_\u22a5 f_OUT (n_\u22a5)(|T_E/H\u27e9(f_IN (n_\u22a5)e^i p_\u22a5^IN\u00b7 n_\u22a5))=\n    \u2211_n_\u22a5(-|T_H/E\u27e9(e^-i p_\u22a5^OUT\u00b7 n_\u22a5 f_OUT (n_\u22a5)))f_IN (n_\u22a5)e^i p_\u22a5^IN\u00b7 n_\u22a5.\n\t\n\nFor the specific aim of splitting-up the \ud835\udcb5 from the XY-factor, the forward-propagation proceeds as long as  f_IN (n_\u22a5) is a constant independent of n_\u22a5. With or without the use of (<ref>), a trivial observation is that  the phase \ne^i p_\u22a5^IN can be pushed through |T_E\u27e9 leaving behind |p_E^IN\u27e9.\n\n\n\nHowever, (<ref>) brings in clarity for the backward-propagation. In this case, i.e. for constant f_OUT (n_\u22a5), the phase \ne^-i p_\u22a5^OUT is acted upon by  -|T_H\u27e9, creating  |p_E^OUT\u27e9, but at the output.\n\n\n\nThe splitting-up procedure stops when each phase meets its own n_\u22a5-dependent non-magnetic materials. The sub-chain of a path-operator that extends between the final propagation positions of e^-i p_\u22a5^OUT\u00b7 n_\u22a5 and e^i p_\u22a5^IN\u00b7 n_\u22a5 is the XY-operator, which defines a channel. Once the classification of channels is at hand, the complete solution for the transfer matrix elements is obtained by continuing the forward-propagation of the phase e^i p_\u22a5^IN, but now through the non-magnetic material-dependent XY-operators. We explain this below, solving the case of a structure composed of two nonhomogeneous non-magnetic laminae.\n\n\n\n\n\u00a7 ANALYTICAL SOLUTION FOR A BILAMINAR NON-MAGNETIC STRUCTURE\n\n\n\nIt is not difficult to complete the path-operator calculation for a single lamina carrying an (n_x,n_y)-dependent non-magnetic materials. The next in line is a bilaminar structure, which gives rise to a greater range of scattering phenomena. Although its complete solution may seem arduous, the end result elucidates the role played by each propagation channel. Furthermore, the analytical solution combined with optimization procedures provides a method for designing practical devices, Section <ref>. \n\nIn what follows we present the solution to the path-operator propagation for a device composed of two laminae with non-homogeneous and distinct non-magnetic materials  \u03f5_1(n_x,n_y)\u2260\u03f5_2(n_x,n_y), Fig.<ref>.\n\n\nFirst we take an overall view of the results, followed by an in-depth study of  propagation through  path-operators.\n\nFrom the total of 3^6=729 paths only 188 paths, counted for all possible polarization pairs, are non-zero. These paths are grouped into channels. The channels through which the plane waves propagate from IN at n_z-1 to OUT at n_z+2, depend on the polarization index, Tab.<ref>. For example, the specific propagation from S^IN into S^OUT goes through 104 paths, the contributions from the rest of the paths, up to 188, being zero for this polarization pair. These 104 paths are grouped in 5 channels Tab.<ref>. Channel 1 of S^OUTS^IN contains 46 paths, Channel 2 comprises 22 and so on, until Channel 5, which is built on 20 paths. Tab.<ref> contains, for each pair of IN-OUT polarization, the information for the number of channels and the number of paths per channel.\n\n\n\nBy way of example, to justify these results, and more, we will analyze three paths.\n\n\nTwo paths are selected form the 729-188 set of zero-paths to explain the source of their null contribution to propagation. \n\nThe path  IN321321OUT does not contribute at all to any polarization propagation because the operator product for this path,  O_H^(1)O_E^(2)O_H^(3)O_E^(1)O_H^(2)O_E^(3), is of the form\n(I_H I_E1I_E I_H1)\u2297(operator ). The part I_E1I_E=|e\u27e9\u27e8h|1|e\u27e9\u27e8h| is zero, since \u27e8h||e\u27e9=0, which renders the paths inactive to any propagation.\n\nAnother path, IN321121OUT is also zero, but for a different reason. Its path-operator O_H^(1)O_E^(2)O_H^(1)O_E^(1)O_H^(2)O_E^(3) is of the form\n(I_H I_EI_HI_E I_H1)\u2297(operator). The first term of the tensor product, (I_H I_E I_H I_E I_H1)=|h\u27e9\u27e8e|, is not zero. However, the second term of its tensor product contains O_H^(1)O_E^(1)=|T_H\u27e9\u0393_S\u27e8T_H|\u03c3_2 (-c)|T_E\u27e9(-c \u0393_P)\u27e8T_E|\u03c3_2. This brings into contact \u27e8T_H| with |T_E\u27e9 acted by \u03c3_2, which is zero\n\n\n    [ T_x^E;      ; T_y^E ]\u03c3_2\n    \t\t[ T_x^E T_y^E ]=i(T_y^ET_x^E-T_x^ET_y^E)=0,\n\ngiven that T_y^E and T_x^E commute. \nWe are left with the propagation along 188 non-zero paths, which is exemplified next.   \n\n\n\n\u00a7 CHANNEL 3 SS\n\n\n\nCompute the contribution of the path IN321221OUT to the propagation of S^IN,+ into S^OUT,+. This path is part of Channel 3 S^OUTS^IN, which contains 8 paths, Tab.<ref>.\nIts path-operator  is of the form\n|h\u27e9\u27e8e|\u2297(operator). To evaluate its contribution to the transfer matrix element, the operator needs to act on both the input \n|p_\u22a5^IN,S,+\u27e9 e^i p_\u22a5^IN n_\u22a5 \nand on the output \ne^-i p_\u22a5^OUT n_\u22a5\u27e8p_\u22a5^OUT,S,+|,\n(<ref>).\n\n\n\n\n\n\n\n\n\nThe first term |h\u27e9\u27e8e| tells us that only the e-part of the input |p_\u22a5^IN,S,+\u27e9 is delivered, by this path, into the h-part of the output \u27e8p_\u22a5^OUT,S,+|.\n\n\n\n\n\n\n\n\nUse, for a non-magnetic device, \u0393_H^-1=\u03a9^2(i c)^-1 and \u0393_E^-1=i \u03f5(n_\u22a5)c^-1 to arrive at\n\n\n    OUT^-1(L_xL_y)^-1\u2211_n_\u22a5e^-i p_\u22a5^OUTn_\u22a5\n     ic^3\u03a9^2\u27e8p_\u22a5^OUT,H||T_H\u27e9\u27e8T_H|\u03c3_2\u03f5_2|T_E\u27e9\u03f5_1^-1\u27e8T_E|\u03f5_1\u03c3_2|p_\u22a5^IN,H\u27e9\n     e^i p_\u22a5^IN n_\u22a5.\n\nFactorize the summand into a \ud835\udcb5-factor and an XY-factor, by back-propagating e^-i p_\u22a5^OUTn_\u22a5 through |T_H\u27e9 at OUT, (<ref>), whereas at IN use   |T_H\u27e9e^i p_\u22a5^IN n_\u22a5=|p_\u22a5^IN,H\u27e9e^i p_\u22a5^IN n_\u22a5,\n\n\n    OUT^-1(L_xL_y)^-1\u2211_n_\u22a5e^-i p_\u22a5^OUTn_\u22a5 ic^3\u03a9^2\u27e8p_\u22a5^OUT,H||p_\u22a5^OUT,H\u27e9\n    \u27e8T_H|\u03c3_2\u03f5_2|T_E\u27e9\u03f5_1^-1\u27e8T_E|\u03f5_1\u03c3_2|T_H\u27e9 e^i p_\u22a5^IN n_\u22a5.\n\nFor this path, the \ud835\udcb5-factor is ic^3\u03a9^2\u27e8p_\u22a5^OUT,H||p_\u22a5^OUT,H\u27e9. For other paths, both variables \u03c6_z^OUT and \u03c6_z^IN are present in the result.  \n\nThe XY-operator, which is common to all 8 paths from channel_3-SS and thus  defines this channel, is\n\n\n    Operator-XY_3^SS=\u27e8T_H|\u03c3_2\u03f5_2|T_E\u27e9\u03f5_1^-1\u27e8T_E|\u03f5_1\u03c3_2|T_H\u27e9.\n\n\n In the general case, the action of an XY-operator on the input phase e^i p_\u22a5^IN n_\u22a5 delivers a function of n_\u22a5, \u03c7(n_\u22a5), which depends on \u03f5_1(n_\u22a5), \u03f5_2(n_\u22a5) and p_\u22a5^IN. This function,  \u03c7(n_\u22a5), contains the information from the propagation of the IN phase through the entire  non-magnetic media, all the way to the OUT. Here, for Channel 3 SS, \n\n    Operator-XY_3^SS(e^i p_\u22a5^IN n_\u22a5)=e^i p_\u22a5^IN n_\u22a5\u03c7_3^S^OUT,S^IN(n_\u22a5).\n\t\n\nHenceforth, to keep the formulas for \u03c7(n_\u22a5) simple,  we write interchangeably p_x=p^IN_x and p_y=p^IN_y. However, to avoid confusion and to be able to distinguish between the IN and OUT phases, we will keep the index OUT for p_\u22a5^OUT.\n\nFrom (<ref>) we deduce the dependence on p_\u22a5^IN of the \u03c7-function.\nNamely, \u03c7_3^S^OUT,S^IN(n_\u22a5)=g_0+g_1cos(a p_x)+g_2cos(b p_y)+g_3sin(a p_x)+g_4sin(b p_y)+g_5cos(a p_x-b p_y)+g_6sin(a p_x-b p_y), where g_j, with j=0\u22ef6, are functions of n_\u22a5 build exclusively on the non-magnetic materials deposited on the laminae. For example\n\n\n    g_6= i\u03f5 _1(n_x-1,n_y+1) \u03f5 _2(n_x,n_y)/a^2 b^2 \u03f5 _1(n_x,n_y+1)   \n    \n    \t\t-i\u03f5 _1(n_x+1,n_y-1)\n    \t\t\t\u03f5 _2(n_x,n_y)/a^2 b^2 \u03f5 _1(n_x+1,n_y)   \n    \n    \t\t+i\u03f5 _1(n_x+1,n_y-1) \u03f5 _2(n_x+1,n_y)/a^2 b^2 \u03f5 _1(n_x+1,n_y)   \n    -i\u03f5 _1(n_x-1,n_y+1)\n    \t\t\t\u03f5 _2(n_x,n_y+1)/a^2 b^2 \u03f5 _1(n_x,n_y+1)   \n    \n    \t\t+i\u03f5 _2(n_x,n_y+1)/a^2 b^2-i\u03f5 _2(n_x+1,n_y)/a^2 b^2,\n\nwhere, for clarity, we used the shorthand notation n_x-1=a n_x-a, n_y+1=b n_y+b, and alike.\n\n\n\n\n\n\nThe periodic boundary conditions and the sum from (<ref>) bring in the Fourier transform of  \u03c7(n_\u22a5) over the variable q_\u22a5=p_\u22a5^IN-p_\u22a5^OUT\u2261 p_\u22a5-p_\u22a5^OUT,\n\n    \u03c7\u0303_3^S^OUT,S^IN(q_\u22a5):=\n    \n    \t\t(L_xL_y)^-1\u2211_n_\u22a5e^i q_\u22a5\u00b7 n_\u22a5\u03c7_3^S^OUT,S^IN(n_\u22a5).\n\t\n\n\n\n\n\n\n\n\n\n\nSince \u03c7\u0303_3^S^OUT,S^IN(q_\u22a5) is common to all paths from Channel 3, the next focus is on the sum of all \ud835\udcb5_paths. It turns out that, for all channels, this sum factorizes into simple terms, each term being a function of either \u03c6 _z,IN or \u03c6 _z,OUT, but not both. For the example under study\n\n\n    \u2211_paths from\n    Channel 3\ud835\udcb5_path\t=i c \u03a9 ^2 \u03c6 _z,IN\u03c6 _z,OUT.\n \t\n\nFinally, we arrive at the contribution of Channel 3 S^OUT,+,S^IN,+, \n\n\n\n\n\n\nwhich, conveniently, is a product of \u03c7\u0303_3 from (<ref>) and the channel \ud835\udcb5-factor (<ref>) \n\n\n    \ud835\udcb5_3^OUT,S+,IN,S+=\tOUT^-1 i c \u03a9 ^2 \u03c6 _z,IN\u03c6 _z,OUT.\n \t\n\n\nThe main result, for the IN S to OUT S propagation, is that the transfer matrix element is reduced from a sum of 729 paths to a sum of 5 channels\n\n\n    T_Sm,Sn^+,+=\u2211_channel=1^5\t\ud835\udcb5_channel^OUT,S+,IN,S+ \u03c7\u0303_channel^S^OUT,S^IN(q_\u22a5).\n\t\n\nThe dependence on the Bloch-Floquet indices m and n is through both p_\u22a5 and q_\u22a5.\n\n\n\n\n\u00a7 \ud835\udcb5 AND XY-FACTORS FOR ALL CHANNELS\n\n\nThe XY-channel-operators  for all four polarization combinations (OUT/IN,S/P) are represented in Fig.<ref>. These operators are independent of the direction of propagation index \u00b1. The channels from IN S to OUT S were discussed above. There are 9 channels that connect  IN S polarization with  OUT P. All start with |T_E\u27e9 and end in \u27e8T_H|. They are colored green in Fig.<ref>. Change the input into a P-polarization. There are 5 unique channels that transfer an IN P into an OUT S. They are colored purple in Fig.<ref>. The last case  is the transfer of  IN P into  OUT P. There are 14 channels out of which 13 are unique to this polarization pair. They are colored black in Fig.<ref>. The non-unique channel, shared with IN S to OUT S, has no (x,y)-dependence and so its \u03c7-function is 1.\n\n\n\nBy contrast, the \ud835\udcb5-factors depend on the direction of propagation. Tab.<ref> and Appendix B contain the information for all the other \ud835\udcb5-factors.\n\n\n\nThe rule to obtain the \ud835\udcb5-factors for other directions is to change IN- into IN+ and, at the same time, change\n\u03c6_z,IN\u2192\u03c6_z,IN^-1 and\nc \u2192  -c. The same rule applies for OUT- into OUT+.\n\nHowever, this rule does not apply for Channel 1, for both  SS and PP, Appendix B,  Tables <ref>, <ref>. The reason is that, in vacuum, there are pairs of polarization and directions that cannot propagate into each other. For example, in vacuum,  IN S+ cannot propagate into  OUT S-. In contrast, Channel 1 is open in vacuum, so the rule does not apply to it.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAt this point, the transfer matrix elements are  computed in closed analytical formulas for any non-magnetic bilaminar lattice structure. \nThe solution is completely general being valid for elaborate non-magnetic material patterns that can be drawn on both laminae.\n\nThe decomposition of propagation by channels can be implemented also for three or more patterned laminae. The number of channels increases with the increase of the number of laminae, but the procedure remains the same.\n\nReturning to the bilaminar structure, an avenue worth to explore is the continuum limit in the x and y dimensions. In this limit, the number of Bloch-Floquet modes become infinite, placing  weight to our method of directly seizing the transfer matrix elements by circumventing infinite-dimensional transfer matrices.\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 CONTINUUM LIMIT FOR A,B\u2192 0\n\nConsider that the discrete lattice constants a and b are much smaller than c, the discrete lattice constant on the z-axis. In this case n_\u22a5 transforms into a continuum r_\u22a5 coordinate so that the unit cell length is  l_x=lim (a L_x) for a\u2192 0 and L_x\u2192\u221e. Same goes for l_y. However, the z-axis remains discrete. In the continuum x,y-limit the discrete \u03c7_3^S^OUT,S^IN(n_\u22a5), (<ref>), is a function of (x,y)\n\n    \u03c7_3^InS,OutS(x,y,p_x,p_y)=\n    \t\t\n       \n    \t\tp_x (\n    \t\ti (\u2202_yyln\u03f5_1)(\u2202_x\u03f5_2)-i(\u2202_xyln\u03f5_1)(\u2202_y\u03f5_2))+\n    \t\t\n       \n    \t\tp_y (\n    \t\ti (\u2202_xxln\u03f5_1)(\u2202_y\u03f5_2)-i(\u2202_xyln\u03f5_1)(\u2202_x\u03f5_2))+\n    \t\t\n       \n    \t\tp_x^2  (\u2202_yln\u03f5_1)(\u2202_y\u03f5_2)+\n    \t\t\n       \n    \t\tp_x p_y ( -(\u2202_xln\u03f5_1)(\u2202_y\u03f5_2)-(\u2202_yln\u03f5_1)(\u2202_x\u03f5_2))+\n    \t\t\n       \n    \t\tp_y^2 ( (\u2202_xln\u03f5_1)(\u2202_x\u03f5_2)).\n\nThe dependence of (<ref>) on p_x, p_y is quadratic. Recall that p_\u22a5=p_\u22a5^IN. Each coefficient of this quadratic polynomial is a combination of partial derivatives of permittivities, Fig.<ref>. We purposely placed these coefficients as a sum of terms, each being a product of a partial derivative of a function of \u03f5_1 into another one, which depends exclusively on \u03f5_2. This specific arrangement is crucial to get a closed formula for the Fourier integral for a polygonal tessellated  pattern, which will be a later subject to undertake. In addition to being technically useful, this arrangement has another facet. It reveals that the contribution of the permittivity constants to a channel is via pairs of functions (f_1,f_2), where f_1 and f_2 acts only on \u03f5_1 and \u03f5_2, respectively. From (<ref>) we get f_1(\u03f5_1)= ln(\u03f5_1) and f_2(\u03f5_2)= \u03f5_2.  These functions are easily gleaned, for each of the 33 channels, from Fig.<ref> and Appendix B.  They are either f(\u03f5)=\u03f5,\u03f5^-1, ln(\u03f5) or the constant 1. \nAll 33 channels, with the exception of the following 7 channels \u03c7_3,4^P^OUT,S^IN,  \u03c7_4^S^OUT,P^IN, and \u03c7_7,8,9,13^P^OUT,P^IN, use one pair (f_1,f_2). Channel  \u03c7_8^P^OUT,P^IN involves 3 pairs, whereas the other 6 from the exceptions use 2 pairs. Some examples are presented in Tab.<ref>. \nThese channel-dependent permittivity functions are universal for a bilaminar structure, the distinction between devices with the same geometry being captured by the specific values of their arguments, \u03f5_1 and \u03f5_2. It is worth noting that, for a given IN-OUT polarization pair, the set of functions are uniquely specific to a channel. This property can thus be used to name a channel. For example, Channel 3 in Fig.<ref> may bare the name SS(ln(x),x).\n\n\n\n\u00a7 C-SCALING\n\n\nThe transfer matrix elements get simpler once the influence of the discreteness  along the z-axis, c, is embodied into the scaling of the unit cell \n\n    x = c x^',y=c y^'.\n\nThe frequency was already c-scaled in (<ref>).\nAll parameters  become c-scaled l_x/y = c l_x/y^',\np_x/y= c^-1p_x/y^'.  Scaling a \u03c7 channel-function is equivalent to multiplying it by a power of the scaling parameter c. For example, the c-scaling effect on (<ref>) is\n\n    \u03c7_3^InS,OutS(x,y,p_x,p_y)=c^-4\u03c7_3^InS,OutS(x^',y^',p_x^',p_y^').\n\n\nIn the continuum (x,y)-plane the discrete Fourier transform becomes an integral, as (a b)/((a L_x) (bL_y))\u2192 (dx dy)/(l_x l_y).\nIn the scaled variables, the Fourier transform of the \u03c7 channel-function\n\n    (l_x^'l_y^')^-1\u222b_0^l_x^'dx^'\u222b_0^l_y^'dy^'  e^i q_x^'  x^' e^i q_y^' y^'\u03c7(x^',y^',p_x^',p_y^')\n\nis a function of q_\u22a5^'=p_\u22a5^'IN-p_\u22a5^'OUT where\np_x/y^'IN/OUT=2\u03c0( M_x/y^IN/OUT+\u03be_x/y)(l_x/y^')^-1\nwith 2\u03c0\u03be_x/l_x^' and 2\u03c0\u03be_y/l_y^' being equal to \u03a9sin(\u03b8)cos(\u03d5) and \u03a9sin(\u03b8)sin(\u03d5), respectively.\n\nFor \ud835\udcb5-factors, the c-scaling appears in the argument of \u03c6_z\n\n    \u03c6 _z,IN   =   \u03c6_z(1-2^-1\u03a9 ^2+2^-1(p_x^'2+p_y^'2)).\n\nFor \u03c6 _z,OUT the argument contains p_\u22a5^'OUT.\nBelow, we drop the prime notation for the c-scaled parameters, understanding that all variables are c-scaled.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe advantage of scaling is that the  c-monomial from  \u03c7 and its corresponding  \ud835\udcb5-factor cancel, rendering a c-independent formula for a channel.\n\n\n\n\u00a7 POLYGONAL TESSELLATION PATTERNS\n\n\nThe transfer matrix elements, for the xy-continuous limit, are reduced at this point to the computation of 2-dimensional Fourier transforms of functions defined on the unit cell. To push forward the project of finding analytical closed-form formulas, we show that, in the general case, the Fourier transforms for all channels can be completely solved for polygonal subdomains. The approach and the notations for the general formulas are exemplified using a pattern,  Fig.<ref>, which we will call \u03c0-\u03c0-rig. The unit cell is a square with corners positioned at (\u00b1\u03c0,\u00b1\u03c0), in length units chosen for a desired frequency band. Inside the unit cell sits an inner square. Fig.<ref> shows two inner squares, one located on plane 1, whereas the other on plane 2, both defined in Fig.<ref>. The corners of the unit cell are not visible in Fig.<ref> to save the space for the information pertaining to the inner squares. In the foreground, the square on plane 2 has its vertices labeled B_i,j, i=\u00b1 1,j=\u00b1 1 positioned at (\u00b1\u03c0/2,\u00b1\u03c0/2). In the background, the square on plane 1, with vertices A_i,j, is rotated counterclockwise by an angle \u03b1. For \u03b1=0, the squares' vertices coincide. There are two kinds of points in Fig.<ref>. Points like A_i,j and B_i,j from plane 1 and plane 2, respectively, are called  real . In contrast, we call virtual those that appear as intersection points, like D_1, the origin O and \u0394_1. All points, real and virtual, have associated with them a set of unit vectors. Take for example the origin O. There are four segments that originate at O. One is the segment OA_1,1 which carries a unit vector denoted \u03bc\u0302_1 in Fig.<ref>. Then  \u03bc\u0302_2, \u03bc\u0302_3 and  \u03bc\u0302_4 are along  OB_1,1, OA_-1,-1 and  OB_-1,-1, respectively. All tails of these unit vectors sit on point O. From the same point O, originates another set of four unit vectors \u03bb\u0302_i, i=1,\u2026 ,4 in such a way that each pair (\u03bb\u0302_i,\u03bc\u0302_i) is orthogonal and each triplet (\u03bb\u0302_i,\u03bc\u0302_i, \u1e91) is right-oriented.\n The last geometrical parameter is related to the choice of a frequency band, say in GHz or THz, which scales the device's units to  mm or \u03bcm, respectively. Versus this unit of length we define a unitless thickness parameter t\n\n    t=[1 unit](c  [unit])^-1.\n\t\nAlthough the frequency \u03c9 and the dimensions l_x,l_y are fixed in the chosen units, the c-scaled parameters change with t. As the laminae get thinner the scaled unit cell (l_x^', l_y^') and the probing wavelength \u03bb^' get larger, \u03bb^'=t\u03bb [unit]/1 [unit], whereas the probing frequency \u03a9 slides into lower regions,  \n\u03a9=2 \u03c0\u03bb^'-1.  \n\nThe increase of the scaled unit cell repositions the coordinates of the vertices, but do not change the unit vectors (\u03bb\u0302,\u03bc\u0302). \n\nThe coordinates of all points, real and virtual, together with the orientations of all unit vectors and a choice of the thickness parameter comprise the geometrical data for computing the Fourier transformation of any polygonal tessellation. The other data come from the jumps of the  permittivities across polygonal segments. For example, for point O in Fig.<ref> the relative permittivity pair (\u03f5_1R,\u03f5_2L) appears towards to tip of \u03bb\u0302_1, i.e. on the right-side looking along \u03bc\u0302_1. The pair (\u03f5_1L,\u03f5_2L) sits towards the tail of \u03bb\u0302_1, i.e. on the left-side of \u03bc\u0302_1. As we cross \u03bc\u0302_1 walking in the direction of \u03bb\u0302_1, slightly above point O,  the change in the relative permittivities introduces  a jump\n\n    (\u0394 f_1f_2)_O,\u03bc\u0302_1= f_1(\u03f5_1R)f_2(\u03f5_2L)-f_1(\u03f5_1L)f_2(\u03f5_2L),\n\t\nwhere (f_1,f_2) is a channel-specific pair of permittivity functions as in Tab.<ref>.\n\n\n\n\n\n\n\n\n\n\n\n\nThe Fourier transforms for the \u03c7 channel-functions include both the geometrical configuration and the permittivities jumps.\n In (<ref>) we show, as an example, the result of the Fourier transform, \u2131(\u03c7), of  the third channel for OutS,InS and for the specific case q_\u22a5\u00b7\u03bc\u0302\u2260 0 for all \u03bc\u0302,\n\n    \u2211_(V_12,\u03bc\u0302)e^i (q_\u22a5\u00b7 V_12)_2 (p_\u22a5\u00b7\u03bc\u0302_1)(p_\u22a5\u00b7\u03bc\u0302_2) \n    ( q_\u22a5\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2)( q_\u22a5\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1)\n    \u0394 (\u03f5_2ln\u03f5_1)_\u03bc\u0302W\u00b7\u03bb\u0302/W\u00b7 q_\u22a51/q_\u22a5\u00b7\u03bc\u0302 -\n    \u2211_(V_12,\u03bc\u0302)e^i (q_\u22a5\u00b7 V_12)_3 (p_\u22a5\u00b7\u03bc\u0302_1)(\u03bc\u0302_1\u00b7\u03bb\u0302_2) \n    ( q_\u22a5\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2)^2( q_\u22a5\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1)\n    \u0394 (\u03f5_2ln\u03f5_1)_\u03bc\u0302W\u00b7\u03bb\u0302/W\u00b7 q_\u22a51/q_\u22a5\u00b7\u03bc\u0302.\n\t\nFor each virtual vertex V_12 from Fig.<ref>, the sum covers all four \u03bc\u0302's associated with it. The indices 1 and 2 refer to the line from plane 1 and 2, respectively. In this formula we are free to choose one pair (\u03bc\u0302_1,\u03bc\u0302_2) of unit vectors along line 1 and line 2, out of all four possible choices of the pairs  exiting V_12. The result is independent on the choice of the pair because the terms are invariant to the transformation \u03bc\u0302_1\u2192 -\u03bc\u0302_1 or \u03bc\u0302_2\u2192 -\u03bc\u0302_2.\n\nThe Fourier transform in (<ref>) depends on p_\u22a5, i.e.  p_\u22a5^IN, because the channel's \u03c7-function (<ref>) depends on it. In addition, the transform is naturally a function of the  q_\u22a5, (<ref>).  The first sum in (<ref>) displays the quadratic dependence on p_\u22a5 as a dot product, invariant to rotations of the (x,y) coordinate system. An invariant form also appears for the second sum, which contains the linear dependence on  p_\u22a5. In this formula, the variables q_\u22a5,p_\u22a5 and V_12 are c-scaled and depend on the thickness parameter t. As we announced before, we do not carry the primed symbol, (<ref>), anymore.\nIn the next section we lay down the Fourier transform results, with their proofs left to Appendices D to H.\n\n\n\n\u00a7 FOURIER TRANSFORMS FOR THE \u03a7-CHANNEL-FUNCTIONS\n\n\n\n We encounter four types of integrals on the unit cell, based on the number of derivatives m^1=(m_x^1,m_y^1) and m^2=(m_x^2,m_y^2) being zero or not\n\n\n\t\n  (00). \u222c dx dy (f_1)(f_2) e^q_\u22a5\u00b7 r_\u22a5, m^1=0,m^2=0,\n\t\n  (10). \u222c dx dy (\u2202_m^1f_1)(f_2) e^q_\u22a5\u00b7 r_\u22a5,  m^1\u2260 0, m^2= 0,\n\t\n  (01). \u222c dx dy (f_1) (\u2202_m^2f_2) e^q_\u22a5\u00b7 r_\u22a5,  m^1= 0, m^2\u2260 0,\n\t\n  (11). \u222c dx dy (\u2202_m^1f_1)(\u2202_m^2f_2) e^q_\u22a5\u00b7 r_\u22a5,  m^1\u2260 0, m^2\u2260 0.\n\n\nThere are three cases for (00), which depend on the relation between the geometry of the device, expressed by the set of vectors \u03bc\u0302 and the mode-scattering vector q_\u22a5. For case  (1), q_\u22a5\u00b7\u03bc\u0302\u22600.\nCase (2) consists of q_\u22a5\u00b7\u03bc\u0302=0  and  q_\u22a5\u2260 0, which means that q_\u22a5=\u00b1\u03bb\u0302q_\u22a5. Finally for (3) q_\u22a5=0.\n\nThe formulas for (00), from (<ref>) and (<ref>), are written on purpose as a sum of terms contributed by each pair (V,\u03bc\u0302). This is akin to a potential theory where only the ends of the curve contribute. In addition, also reminiscent of a potential theory,  gauge vectors appear in the solution. They are the same for all pairs (V,\u03bc\u0302) and their arbitrariness helps eliminating all singularities that may appear in the denominators. The gauge vectors are denoted as W and \ud835\udc9f, and can be arbitrarily chosen with the provision that \nW\u00b7 q_\u22a5\u2260 0 and \ud835\udc9f\u00b7\u03bc\u0302\u2260 0.\nThe jump in \u03f5, as the vector \u03bc\u0302 is traversed along \u03bb\u0302, is captured in (\u0394 f_1f_2)_\u03bc\u0302,\nas exemplified in (<ref>).\n \n \n\n\n\n\n\n\nOutside the unit cell we place a fictitious material with \u03f5=0 to get, for the (00) integrals, the correct terms generated by the unit cell boundaries. \n\nThe (00) integration formula for a polygonal tessellation of the unit cell, for cases (1) and (2), is\n\n    \u222c_ dxdy (f_1f_2) e^i q_\u22a5\u00b7 r_\u22a5=\n     \u2211_V,\u03bc\u0302e^i q_\u22a5\u00b7 V1/q_\u22a5\u00b7\u03bc\u0302 W\u00b7\u03bb\u0302/W\u00b7 q_\u22a5 (-\u0394(f_1f_2))_\u03bc\u0302 +\n     \u2211_V,\u03bc\u0302e^i q_\u22a5\u00b7 V(i \u03bc\u0302\u00b7 V) W\u00b7\u03bb\u0302/W\u00b7 q_\u22a5 (-\u0394(f_1f_2))_\u03bc\u0302 .\n\t\nThe first and the second sum applies for case(1) and (2), respectively.\nFor (00) in case (3) we need to use two gauge vectors. The W is the same as before, whereas \ud835\udc9f is specific for this case and comes from taking the limit s\u2192 0 for q_\u22a5=s \ud835\udc9f. This formula,as proven in Appendix E, is independent on the choice of \ud835\udc9f \n\n    \u222c_ dxdy (f_1f_2) =\n    \u2211_V,\u03bc\u03021/2 (i \ud835\udc9f\u00b7 V)^2 1/\ud835\udc9f\u00b7\u03bc\u0302 W\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f (-\u0394 (f_1f_2))_\u03bc\u0302 .\n\nWe intentionally drafted the (00) Fourier transforms as a sum of contributions from vertices. This format can be handed on to the next integrals, (01), (1,0) and (1,1), in a consistent manner. The (00) integral appear in other works <cit.>,<cit.>, but as a sum over the edges of the polygon. \n\nFor the formulas that follow, we will list only the contribution of a pair (V,\u03bc\u0302), the summation being understood.\n\n\n\n\u00a7  FOURIER TRANSFORMS FOR PRODUCT OF DERIVATIVES OF TYPE (01), (10) AND (11)\n\n\nThe result for the (00) case is now used to generate the integrals for which a derivative acts on at least one function. The procedure implies two steps. The first step is to compute \n\n    \u222c_ dxdy f_1(r_\u22a5+\u03b4 r_1) f_2(r_\u22a5+\u03b4 r_2) e^i q_\u22a5\u00b7 r_\u22a5=   \n    Int(\u03b4 x_1,\u03b4 y_1,\u03b4 x_2,\u03b4 y_2)\n\nas a function of two independent translations, \u03b4 r_1 and \u03b4 r_2, on plane 1 and plane 2, respectively. These translations change the position of a vertex V \n\n    V_translated=V-\u03c4_x^1\u03b4 x_1-\u03c4_y^1\u03b4 y_1-\u03c4_x^2\u03b4 x_2-\u03c4_y^2\u03b4 y_2.\n\t\nThe four vectors \u03c4 depend on the vertex V being subjected to a free or constraint translation, which will be defined subsequently. If the vertex is associated with a free translation, we have \u03c4_x^1=\u03c4_x^2=x\u0302\tand \u03c4_y^1=\u03c4_y^2=\u0177. \nA vertex at the intersection of two lines from different planes,  subjected to a constraint translation, moves to\n\n    (V_12)_translated=V_12-\u03b4 r_1\u00b7\u03bb\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1\u03bc\u0302_2-\u03b4 r_2\u00b7\u03bb\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2\u03bc\u0302_1,\n\nwhere \u03bc\u0302_1 and \u03bc\u0302_2 represent the directions of the two intersecting lines situated on plane 1 and 2, respectively. For constraint translations, the vectors \u03c4^1 and \u03c4^2 can be extracted from (<ref>).\nIn what follows we associate vertices  V_1  and V_2 that are exclusively situated either in plane 1 or 2, respectively, to a free translation. For a  V_1-type vertex \u03c4^2=0 and, in reverse, \u03c4^1=0 for a  V_2-type.\nVirtual vertices V_12 are associated to a constraint translation.\nThe sets V_1, V_2 and V_12 are exemplified in Fig.<ref>.\n\nFor the second step, once the function Int(\u03b4 x_1,\u03b4 y_1,\u03b4 x_2,\u03b4 y_2) is at hand, we compute the rest of the integrals by taking its derivatives\n\n    \u222c_ dxdy (\u2202_x^m_x^1\u2202_y^m_y^1f_1(r_\u22a5))(\u2202_x^m_x^2\u2202_y^m_y^2f_2(r_\u22a5)) e^i q_\u22a5\u00b7 r_\u22a5\n    \n    =\u2202_\u03b4 x_1^m_x^1\u2202_\u03b4 y_1^m_y^1\u2202_\u03b4 x_2^m_x^2\u2202_\u03b4 y_2^m_y^2Int\n\n at \u03b4 x_j,\u03b4 y_j=0, j=1,2. The results are listed below and the details follow in Appendices D to H.\n\nUnlike for the (00) integrals, here the unit cell boundaries do not generate any terms, because the derivative  of a permittivity function is zero across the unit cell boundaries.\n\nFor m^1+m^2\u22600 and case (1), q_\u22a5\u00b7\u03bc\u0302\u22600, the contribution of (V,\u03bc\u0302)  is \n\n    e^i (q_\u22a5\u00b7 V)  \n    \t\t(-i q_\u22a5\u00b7\u03c4_x^1)^m_x^1\n    \t\t(-i q_\u22a5\u00b7\u03c4_y^1)^m_y^1   \n    \n    \t\t(-i q_\u22a5\u00b7\u03c4_x^2)^m_x^2\n    \t\t(-i q_\u22a5\u00b7\u03c4_y^2)^m_y^2   \n    1/q_\u22a5\u00b7\u03bc\u0302 W\u00b7\u03bb\u0302/W\u00b7 q_\u22a5(-\u0394(f_1f_2)_\u03bc\u0302).\n\nFor case (2), q_\u22a5\u00b7\u03bc\u0302=0, the contribution of (V,\u03bc\u0302) is\n\n    d/ds|_s=0 e^i (q_\u22a5+s \u03bc\u0302)\u00b7 V)  \n    \t(-i (q_\u22a5+s \u03bc\u0302)\u00b7\u03c4_x^1)^m_x^1\n    \n    \t(-i (q_\u22a5+s \u03bc\u0302)\u00b7\u03c4_y^1)^m_y^1\t\t\t\t\n    \t(-i (q_\u22a5+s \u03bc\u0302)\u00b7\u03c4_x^2)^m_x^2\n    \n    \t(-i (q_\u22a5+s \u03bc\u0302)\u00b7\u03c4_y^2)^m_y^2W\u00b7\u03bb\u0302/W\u00b7 q_\u22a5(-\u0394(f_1f_2)_\u03bc\u0302).\n\nFor case (3), q_\u22a5=0, the contribution of (V,\u03bc\u0302) is\n\n    1/2d^2/ds^2|_s=0 e^i (s\ud835\udc9f\u00b7 V) s^m_x^1+m_y^1+m_x^2+m_2^2\n    \n    \t(-i \ud835\udc9f\u00b7\u03c4_x^1)^m_x^1\n    \t(-i \ud835\udc9f\u00b7\u03c4_y^1)^m_y^1\t\t\t\t\n    \t(-i \ud835\udc9f\u00b7\u03c4_x^2)^m_x^2\n    \n    \t(-i \ud835\udc9f\u00b7\u03c4_y^2)^m_y^2W\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f(-\u0394(f_1f_2)_\u03bc\u0302).\n\n\nThe transfer matrix for a polygonal tessellated bilaminar non-magnetic structure, continuous in the x and y directions, is completely solved at this point.  We are moving to test the theoretical results by comparing our closed analytical formulas for the \u03c0-\u03c0-rig structure, to numerical results obtained from a high-performance analysis software package <cit.>. Complex symbolic computations were handled by <cit.>.\n\n\n\n\u00a7 EVANESCENT RESONANT MODES BY OPTIMIZATION DESIGN\n\n\nThe intent is to design-optimize a dielectric structure from Fig.<ref> such that a subset of evanescent Bloch-Floquet modes (M_x,M_y)\u22600 acquire large scattering matrix elements at a specified frequency. Such an excited resonant mode propagates along the plane (x,y) at a frequency smaller than its Rayleigh frequency. Specifically, in the frequency range under study, 37 GHz to  50 GHz, the optimization function is based on four modes. Two modes, (0,0) and (-1,0), propagate, and two other modes, (0,\u00b1 1), are evanescent. The goal is to find a set of dielectric constants for which the modes (0,\u00b1 1) resonate.  To excite the resonant modes, the plane wave (0,0) coming from z-min lands at angles \u03b8=17.5^\u2218 and \u03c6=0^\u2218  on the face A of the \u03c0-\u03c0-rig oriented at \u03b1=45^\u2218. The thickness of each of the two laminae is\nc=0.25 \ud835\ude96\ud835\ude96.\nThe design-objective-function, constructed from the analytical formulas for the transfer matrix elements, selects a point in the 6-dimensional dielectric space \u03f5 _1B= 4.99, \u03f5 _2B= 2.96, \u03f5 _1L= 7.60,\n\u03f5 _2L = 5.66, \u03f5 _1R=5.93 and \u03f5 _2R= 1.63. \n\nTechnologically, this point may not be easily implemented, although we constrained the dielectric constants to be less than 12. Instead, we focus  on studying the predictions  put forward by the analytic solution and compare them against numerical results from a high-performance software package. \n\nThese predictions are grouped in three categories. The first category, inspired by topological photonics, is related to robustness of the resonant modes with respect to the change of the dielectric constants, quantified as a map from the real to integer numbers.\nThe second is based on resonant frequency identification, whereas the third is focused on high Q-factors and the use of complex frequency plane to estimate the Fano-Lorentz spectral line shape for the resonant modes. In what follows we confine ourselves to evanescent S-polarized resonant waves excited by the (0,0) S-polarized incoming wave. Only the main results are presented below, with specific details on the design optimization being summarized in  Appendix I. \n\n\n\n\u00a7 A  MAP FROM THE REAL TO INTEGER NUMBERS\n \n\nThe resonances in the scattering matrix elements appear as zeros of the determinant of the T^-,- matrix, (<ref>). The minimal T^-,- matrix can be reduced to just the matrix element T^-,-_Sm,Sm, the zeros of which give the first approximation for the resonant frequencies. To see that, take a  2\u00d7 2 transfer matrix  built only from the set T^\u00b1,\u00b1_Sm,Sm and look at the resonance for the mode Sm as a singularity for which  (<ref>) has a non-zero solution if all coefficients but (DIR,POL,BF)=(+,S,m) and  (dir,pol,bf)=(-,S,m) are zero. It turns out that this simple approximation has predictive power.\nAs the dielectric constants change their values, the  zeroes of T^-,-_Sm,Sm appear or disappear, creating or destroying a resonance. We study this phenomenon for variable \u03f5_1B=\u03f5_2B, running from 1 to \u221e, with the rest of the dielectric constants kept constant at the optimized values. \n\n\nHence, map \u03f5_1B=\u03f5_1B to the number of modes m=(M_x,M_y) for which the diagonal transfer matrix element T^-,-_S m,S m, Appendix C, has at least one zero on the frequency axis in the interval [0,60] GHz,\n\n\n\n\n    \u03f5\u2208\u211d\u21a6number of modes with zeroes.\n\t\nThe analytic formulas position the zeros as in Fig.(<ref>) and Fig.(<ref>)\n\n\n\nAs \u03f5_1B=\u03f5_2B increases from 1 to \u221e, Fig.<ref>, the number of modes for which T^-,-_S m,S m crosses the real frequency axis  increases in discontinuous steps, then decreases as the dielectric constant gets above 30. It reaches a plateau of 36 modes as \u03f5\u2192\u221e. Fig.<ref> shows the position in the (M_x,M_y) plane of the 53  and 36 modes for \u03f5_1B=\u03f5_2B=35 and \u221e, respectively. Two adjacent steps in  Fig.<ref> have two distinct topological invariants, i.e. distinct  number of resonant modes. The boundaries of these steps  are not uniformly distributed on the horizontal dielectric axis. Knowing the distribution of these boundary values may play a significant role in assembling compound devices, which are built by bringing together two structures with distinct topological invariants.\n\nNumerical simulations confirm that 5 modes resonate for \u03f5_1B=\u03f5_2B=1 and 53 for \u03f5_1B=\u03f5_2B=35. \n\t\n\nOne step deeper into the analysis of the zeros is provided by  propagation along channels. Channel 1 SS does not depend on the dielectric constants and  is positive for any frequency and direction p_\u22a5, Fig.<ref>. Some other channels have to be negative for T^-,-_S m,S m to cross the frequency axis. Interestingly, each channel keeps a constant sign  as a function of frequency, namely (1,+),(2,-),(3,-),(4,+) and (5,-), noticeable in  Fig.<ref> to Fig.<ref>.\n\n\n\n\nFrom Fig.<ref> we see that Channel 3 is two orders of magnitude smaller than the other ones, so it does not lead to creation of destruction of a zero, but contributes to its location on the frequency axis.\n\n As  \u03f5_1B=\u03f5_2B increases the negative contribution starts to dominate the positive one and two phenomena appear: the zeros are pushed into lower frequencies and a variable number of modes start to cross the frequency axis. This explains the increase in the number of resonant modes as \u03f5_1B=\u03f5_2B increases.\n\n\n\n\n\n\n \u00a7.\u00a7 Zeroes of the diagonal matrix elements of T^-,-\n\n\nA distinctive advantage of analytical formulas over the numerical approaches is in the study of infinite limits\n\n    \u03f5_1B =\u03f5_2B\u2192\u221e.\n\t\n\nIn this limit, the zeros of the transfer matrix elements\nT^-,-_S m,S m(\u03a9)=0, appear at small \u03a9\u2245 0. So, approximate\n1+\u03a9 ^2 \u03c6 _z,OUT\u22451 to get, from Appendix C,\n\n    (T^-,-_S m,S m)_Channel 1\u22451/\u03c6 _z,OUT^3 ,\n\n\n    (T^-,-_S m,S m)_Channel 2\u2245-\u03a9 ^2 /8 \u03c6 _z,OUT^2 (1-\u03c6 _z,OUT^2)( 6 \u03f5 _1B),\n\n\n    (T^-,-_S m,S m)_Channel 3\u22450,\n\n\n    (T^-,-_S m,S m)_Channel 4\u2245\u03a9 ^4 /\u03c6 _z,OUT(1-\u03c6 _z,OUT^2)(  \u03f5_1B\u03f5_2B/\u221a(2)),\n\n\n    (T^-,-_S m,S m)_Channel 5\u2245-\u03a9 ^2 /8 \u03c6 _z,OUT^2 (1-\u03c6 _z,OUT^2)( 6 \u03f5 _2B).\n\nThe equation\n(T^-,-_S m,S m)=0, under the above approximations and using the notation \u03f5_1B=\u03f5_2B=\u03f5, turns into\n\n    -3/2\u03a9 ^2\u03c6 _z,OUT\u03f5+1/\u221a(2)\u03a9 ^4\u03c6 _z,OUT^2\u03f5^2+1-\u03c6 _z,OUT^2=0.\n\nAs \u03f5\u2192\u221e, the zero of T^-,-_S m,S m(\u03a9)=0 tends to zero in such a way that\t\u03a9^2\u03f5\u2192finite number. In terms of  this finite number, which we call X, the equation becomes  \n\n    -3/2X \u03c6 _z,OUT+1/\u221a(2)X ^2\u03c6 _z,OUT^2+1-\u03c6 _z,OUT^2=0.\n\nThe requirement for X to be positive imposes a constrain on mode numbers M_x and M_y, for which the diagonal transfer matrix elements posses a zero on the real frequency axis, in the limit  \u03f5_1B =\u03f5_2B\u2192\u221e\n\n    \u03c6_z (1/2(M_x^2/t^2+M_y^2/t^2)+1) \u2a7e1/4\u221a(16-9 \u221a(2)).\n\nThis inequality is valid for 36 modes, which are visible in Fig.<ref>.\n\n\n\n\n\n\n\n\n\n\n\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\n\n\n\u00a7 ANALYTICAL PREDICTION OF THE RESONANT FREQUENCY\n\n\n\n\n \u00a7.\u00a7 Thinner the lamina higher the precision\n\t\n\nFrom counting the number of zeros for many modes, we change the focus, Table<ref>, to predict the position of the zero, \u03a9_theory, of T^-,-_S m,S m for the optimized design  modes, (0,\u00b1 1).\nBoth modes have the same zero at \u03c6=0^\u2218. The resonant frequency depends on the thickness of the structure's lamina, c. All the other parameters are kept constant.\n\n\nNotice that \u03a9 %-error=100\u03a9 \ud835\ude97\ud835\ude9e\ud835\ude96-\u03a9  \ud835\ude9d\ud835\ude91\ud835\ude8e\ud835\ude98\ud835\ude9b\ud835\udea2/\u03a9 \ud835\ude97\ud835\ude9e\ud835\ude96, which measures the distance to the numerical simulation result \u03a9 \ud835\ude97\ud835\ude9e\ud835\ude96, <cit.>, decreases with the decrease of the width c. This is to be expected because as c\u2192 0 the discrete approximation of Maxwell's equations improves. \n\n\n\n\n\n \u00a7.\u00a7 The influence of the rotation angle \u03b1 on the resonant frequency\n\n\nOut of the 5 channels for transfer of the SS-polarization, only Channels 3 and 4 depend on the angle \u03b1. \nAs the angle \u03b1 is varied, the resonant frequency for the degenerate modes (0,-1) and (0,1) changes in the vicinity of the frequencies determined at \u03b1 =45^\u2218, Figs.<ref>,<ref>.  Although the relative changes are small, with an estimated linear slope of -0.96 MHz/deg and -2.46 MHz/deg, respectively, the slopes are close to the ones from the numerically simulated data.\n\n\nThe systematic shift between the theoretical and numerical values, described for \u03b1=45^\u2218 in Tab.<ref>, is the same for all angles \u03b1.\n\nThe study of the wedge effect, that comes out for 0^\u2218<\u03b1<10^\u2218 or for 80^\u2218<\u03b1<90^\u2218, will be covered in a different manuscript.\n\n\nThe transfer matrix elements depend on the logarithm of the permittivities, so we need to test the formulas for a metal, which exhibits  complex permitivitty. \nWe take \u03f5 _2B=  Johnson-Chrysti gold and find a local minimum of an objective function in the 5-dimensional space of the other dielectric constants.\nThe frequency range is now placed in the infrared at f=286.2 THz. \nThe optimization process to find the five unknown dielectric constants is similar to that for the all-dielectric case. This time, though, the objective function is based on one propagative mode (0,0) and one evanescent mode  (-1,0), both P-polarized. The position and shape of the theoretical resonance were confirmed by numerical simulations performed via <cit.>. \n\n\n\n\n\n\t\n\t\n\t\n\t\n\t\n\n\n\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\n\n\u00a7 A HIGH Q-FACTOR BILAMINAR STRUCTURE\n\nTo study the theoretical prediction for the amplitude we choose a series of  resonances with large Q-factors. The first has Q=4.8\u00d7 10^6 at -3 dB, Fig.<ref>. The theoretical values were computed using a 20\u00d7 20 transfer matrix. Two systematic shifts, f_shift and t_shift, are needed to superpose the theoretical formula 20log_10t^max,min_S(0,1),S(0,0)(f-f_shift)+t_shift on numerical simulations. For Fig.<ref>,  f_shift=3.2 10^-5 GHz and t_shift=-3.9 dB. The lamina being thin, c=0.01mm, the shifts are small with respect to the frequency and amplitude at resonance.\n\n\n\t\n\t\n\t\n\n\t\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t\n\t\t\n\t\t\n\t\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t\n\n\t\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t\n\nVariable \u03c6 offers another venue to study the amplitude around a high Q-factor resonance. The modes (0,-1) and (0,1) are degenerate for \u03c6=0^\u2218, having the same Rayleigh and resonant frequency. As the angle \u03c6 slides away from 0^\u2218, the scattering amplitude of the mode S(0,-1)  decreases, whereas the scattering amplitude for the mode S(0,1) remains excited at high dB levels, Fig.<ref>.\n\nThe same trend was confirmed by numerical simulation. Table<ref> contains additional data for the comparison between theory and numerical simulations for the high Q-factors.\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 COMPLEX-FREQUENCY PLANE AND THE WEIGHTED FANO-LORENTZ LINE SHAPE\n\n\nMoving beyond predicting the position of the resonant frequency and its amplitude, the complete analytical solution for transfer matrix provides a simple but meaningful approximation for the resonant line shape\n\n    t^min,max_S(0,1),S(0,0)=Cofactor_S(0,0),S(0,1)(T^-,-)/Det(T^-,-)\n    \u2245\u03c1 e^i\u03a6f-f_zero/f-f_pole,\n\nwhere the zero and the pole are located in the complex frequency plane, both in the vicinity of  the real resonant frequency, <cit.>. The meromorphic approximation (<ref>) has a natural structure of dipoles with the monopoles placed at f_zero and f_pole, Fig.<ref>. \n\nTo estimate the pole and the zero, we use \u03c6_z(\u03b6) already defined for complex values of \u03b6. Here we take advantage of the continuity at the real \u03b6-axis of \u03c6_z(\u03b6) coming from below,  Im(\u03b6)\u2a7d 0. This translates, for our case  of \u03c6=0^\u2218 and M_x=0, into the continuity from above, Im(\u03a9)\u2a7e 0,  of the cofactor and the determinant at the real \u03a9-axis. Both functions of \u03a9 are thus extended into the lower half of complex frequencies plane from the values they take above and on the real frequency axis, Appendix J. \nAfter this analytic continuation, the zero-pole model, extracted from a  20\u00d7 20 matrix t^min,max , is\n\n\n\n\n    t^min,max_S(0,1),S(0,0)=0.053  e^-2.732 i f-f_zero/f-f_pole  ,\n\nwith frequency, in GHz, given by\n\n\n\n\n\n    f_zero=40.843+ 0.027 i \n    \n    \tf_pole=41.286- 0.009 i\n\nFollowing <cit.>, we express the scattering line shape t^min,max_S(0,1),S(0,0)^2 in different forms. The first is \n\n    t^min,max_S(0,1),S(0,0)^2(x)=\u03c1^2(\u03b4+x)^2+\u03b3^2/1+x^2\n    \n    \t=2.81\u00d7 10^-3(-47.47+x)^2+8.55/1+x^2,\n\nwhere x=-f-Re(f_pole)/Im(f_pole), \u03b4=-Re(f_pole-f_zero)/Im(f_pole), and \u03b3=Im(f_zero)/Im(f_pole).\nThe second form is connected with the presence of a continuum background\n\n    t^min,max_S(0,1),S(0,0)^2(x)=A_0+F_0(\u03bd+x)^2/1+x^2.\n\nWe found two solutions for the parameters A_0,F_0 and \u03bd. Namely,\nA_0=1.06\u00d7 10^-5, F_0=2.8\u00d7 10^-3 and \u03bd=-47.65, or\nA_0=6.37, F_0=-6.36 and \u03bd=2.09\u00d7 10^-2. This form is thus ambiguous as is also noted in  <cit.>.\n\nThe third, and the final format, presents the resonant line shape as a weighted sum of a Fano and Lorentz line shapes\n\n    t^min,max_S(0,1),S(0,0)^2(x)=A (\u03b7(\u03b4+x)^2/1+x^2+(1-\u03b7)1/1+x^2).\n\nwhere the weight parameter is \u03b7=1/(1+\u03b3^2)=0.105 and A=\u03c1^2 (1+\u03b3^2)=0.027.\n\nThe Fano line shape, which is the first term in (<ref>), contributes 10.5% to the resonance line shape.\n\n\n\n\u00a7 CONCLUSION \n\nTo sum up, we show how to derive the transfer matrix using  Pendry-MacKinnon discrete Maxwell's equations. Space is an orthogonal lattice with lattice constants a,b and c on the x,y and z directions, respectively. The z-axis is singled-out as the transfer axis. A finite number of parallel discrete laminae of thickness c are  placed perpendicular along the z-axis. Each lamina can carry any non-magnetic, frequency-dependent pattern, independent from each other. The method we introduce computes, in an analytical closed form, the transfer matrix elements  for all Bloch-Floquet modes. The computation starts with a large number of path-operators that transfer the field from the first to the last lamina. Fortunately, many of these path-operators come up with a zero contribution and the results of the paths that contribute can be further grouped together in simple terms, which we call channels. Each channel has the interesting attribute of being a product of two terms that bear distinctive features. One term, called the channel's \u03c7-function, depends on the permittivities, whereas the other term, called the channel's \ud835\udcb5-factor, does not. We computed the \u03c7 and the \ud835\udcb5-factors for a bilaminar device for all pairs of input output polarization. \n\nTo exemplify the building up of a transfer matrix element consider, in continuum case of a,b\u2192 0, the P polarization at the input and the S at the output. The method for the discrete case is similar to the continuum, except that the \u03c7 functions are discrete like in (<ref>). For this (P,S) pair of polarization the transfer matrix element is a sum over 5 channels, having their \u03c7-functions displayed in Fig.<ref>. For Channel 2, as an example, the  \u03c7-function is a polynomial in  (p_x,p_y) given by p_y (-\u2202_x\u03f5_2)+p_x \u2202_y\u03f5_2, for any permittivity pattern. The transfer matrix elements depend on the Fourier transforms of the  \u03c7-functions, which contain all Bloch-Floquet modes through the variable q_\u22a5=p_\u22a5-p_\u22a5^OUT. Next, the choice of a pair of  \u00b1 propagation direction decides the specific form of the \ud835\udcb5-factor. For example, if we are looking for the matrix element T^-,-, then use Table <ref> and divide its entries by OUT  to normalize the \ud835\udcb5-factor. \n\nThe rule to obtain the \ud835\udcb5-factors for other directions  is to change IN- into IN+ and, at the same time, change\n\u03c6_z,IN\u2192\u03c6_z,IN^-1, and c\u2192 -c, before moving to the c-scaled variables. The same rule applies for OUT- into OUT+. However, this rule does not apply for Channel 1, for both  SS and PP, for which all unnormalized  \ud835\udcb5-factors are tabulated in Appendix B Tables <ref> to <ref>. Finally, the matrix element is a sum over the product of the Fourier transform of  \u03c7 and the \ud835\udcb5-factor for  all channels that belong to the selected  polarization pair.\n\nA  valuable way of proceeding further is to extend to range of applications. One possibility is to exploit Fig.<ref> and bring together two devices with distinct number of resonant modes, and examine the propagation along different channels at the interface. Other applications may be connected to metasurfaces <cit.>, energy harvesting <cit.>, <cit.>,<cit.>, leaky-wave theory <cit.> and frequency-selective surfaces <cit.>.\n\n\n\n\n\u00a7 ACKNOWLEDGMENT\n\n One of us, O.L., wishes to thank the Fulbright Commission for a Fulbright Scholarship grant and the host Victor Lopez-Richard from Universidade Federal de S\u00e3o Carlos, SP, Brazil, where part of this work was done. In addition, O.L. thanks his colleague Mariama Rebello de Sousa Dias for many conversations during the course of this research. Both of us wish to thank Dr. Andrei Silaghi, with Continental Automotive Romania SRL, for facilitating the access to numerical simulation using CST microwave studio <cit.>.\n \n\n\n\n\n\n\nAppendix A: A summary of symbols with explanatory notes\n\n1.The discrete position vectors are n=(a n_x,b n_y,c n_z) and n_\u22a5=(a n_x,b n_y). In the continuous, a,b\u2192 0, the position  n_\u22a5 becomes r_\u22a5=(x,y).\n\n2. The vector p_\u22a5=(p_x,p_y) appear in the formulation of the plane wave basis, |\u03a8_S/P,p_\u22a5^\u00b1\u27e9 e^\u00b1 i p_z n_z c e^- i \u03c9 t where |\u03a8_S/P,p_\u22a5^\u00b1\u27e9=|p_\u22a5,S/P,\u00b1\u27e9e^i p_\u22a5 n_\u22a5, (<ref>). To distinguish between two Bloch-Floquet modes, one at the input IN and the other one at the output OUT, we write p_\u22a5^IN and p_\u22a5^OUT, respectively. To keep the final formulas for the transfer matrix elements simple, we use p_\u22a5 instead of p_\u22a5^IN, as is the case in Fig.<ref>.\n\n3. Connection between p_x and k_x^E = (i a)^-1(e^i a p_x-1), (<ref>).\n\n4. The unitless frequency \u03a9 is defined by \u03a9 v_0=\u03c9 c, (<ref>)\n\n5. The p_z component appears in \u03c6 _z=e^i c p_z. \u03c6_z(\u03b6)=\u03b6-\u221a(\u03b6^2-1)e^i/2(arg(\u03b6-1)+arg(\u03b6+1)), (<ref>). The arg(\u03b6) takes values on [-\u03c0,\u03c0) in such a way  that arg(\u03b6)=-\u03c0 if Im(\u03b6)=0 and \u03b6<0. The argument \u03b6 is defined in (<ref>).\n\n6. Periodic boundary conditions introduce the modes (M_x,M_y) and the direction (\u03be_x,\u03be_y) of the mode (0,0) through  (<ref>) and (<ref>).\n\n7. Transfer matrix element T^-,-_m,n are organized in (<ref>). \n\n8. All XY-operators are listed in Fig.<ref>.\n\n9. An example of a discrete \u03c7-function, (<ref>). \n\n10. Discrete Fourier transform of a \u03c7-function, (<ref>).  \n\n11. The Fourier transform goes from space n_\u22a5 to the mode variable q_\u22a5=p_\u22a5^IN-p_\u22a5^OUT\u2261 p_\u22a5-p_\u22a5^OUT.\n\n12. An example of a \ud835\udcb5-factor, (<ref>). \n\n13. Transfer matrix element as a sum over channels, (<ref>).\n\n14. The \ud835\udcb5-factors are tabulated in Table <ref> and <ref> to <ref>. \n\n15. Rules to obtain all \ud835\udcb5-factors for all directions are presented in  Appendix B. \n\n16. Some examples of  permittivity functions for the continuum (x,y)-plane are in Table <ref>. \n\n17. For the continuum (x,y) case, the \u03c7-functions, the permittivity functions and the polynomial dependence on p_\u22a5\u2261 p_\u22a5^IN are found in (<ref>), Fig.<ref> and Fig.<ref> to <ref>\n\n18. Through  c-scaling,  x = c x^',y=c y^' from (<ref>), the lattice constant c simplifies in the transfer matrix element.\n\n19. Choose a unit of length in accordance with the frequency band under study. Use the thickness parameter t=[1 unit](c  [unit])^-1, (<ref>), to write the transfer matrix element in terms of only unitless parameters.\n\n20. Each vertex for any polygonal tessellation pattern carry a pair of orthogonal unit vectors (\u03bb\u0302,\u03bc\u0302). An example is the \u03c0-\u03c0-rig from Fig.<ref>. \n\n21. The jumps in the relative permittivities are measured across \u03bc\u0302 in the direction of \u03bb\u0302, (<ref>). \n\n22. The Fourier transforms of a tessellated pattern, in continuum, from the position space vector r_\u22a5 to the mode vector q_\u22a5, are built on (\u03bb\u0302,\u03bc\u0302), the permittivities jumps and two constant gauge vector W and \ud835\udc9f.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\n\t\n\t\n\t\n\n\n\n\n\n\n\n\n\nAppendix C: The diagonal T^-,- matrix elements (q_\u22a5=0) for the \u03c0-\u03c0-rig  and a,b\u2192 0.\n\n\n\n\n\n\n\t\n\n\n\n    (T^-,-_S m,S m)_Channel 1=\n    \t-\u03b4 _IN,OUT((\u03a9 ^2 \u03c6 _z,OUT+1)^2-(\u03c6 _z,OUT)^2) /(\u03c6 _z,OUT^2-1) \u03c6 _z,OUT^3 ,\n\n\n\n\n\n\n\n\n\t\n\t\t\n\t\n\n\n\n    (T^-,-_S m,S m)_Channel 2=( 6 \u03f5 _1B+\u03f5 _1L+\u03f5 _1R)\n    \t\u03a9 ^2 (\u03a9 ^2 \u03c6 _z,OUT+1)/8 \u03c6 _z,IN(\u03c6 _z,OUT^2-1) \u03c6 _z,OUT,\n\n\n\n\n\n\n\n\n\n\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\t\n\t\n\t\t\n\t\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\t\n\t\n\t\t\n\t\n\t\n\t\n\t\n\n\n\n\n\n    (T^-,-_S m,S m)_Channel 3=\n    \u03a9^2/4 \u03c0 ^2 t^2 (p_x^2+p_y^2) \u03c6 _z,IN(\u03c6 _z,OUT^2-1)\n    (.\n    \tp_x^2(\n    \t (\u03b1 )  (\u03b1 ) \u03f5 _2B(2 ln(\u03f5 _1B)-ln(\u03f5 _1L)-ln(\u03f5\n    \t_1R))\n    \n    \t+\u03f5 _2L(- (\u03b1 )  (\u03b1 ) log(\u03f5 _1B)+3  (\u03b1 ) log(\u03f5 _1L)/2\n    \t\t(sin (\u03b1 )+cos (\u03b1 ))-( (\u03b1 )-2)  (\u03b1 )  (\u03b1 ) log(\u03f5 _1R)/2 ( (\u03b1 )+1))\n    \n    \t+\u03f5 _2R(- (\u03b1 )  (\u03b1 ) log(\u03f5 _1B)-( (\u03b1 )-2)  (\u03b1 )  (\u03b1 ) log(\u03f5 _1L)/2 ( (\u03b1 )+1)+3  (\u03b1 ) log(\u03f5 _1R)/2 (sin (\u03b1 )+cos (\u03b1\n    \t\t)))\n    \t.\t)\n    \n    \t+p_x p_y (\u03b1 ) /sin (\u03b1 )+cos (\u03b1 )(\u03f5 _2L-\u03f5 _2R) (log(\u03f5 _1L)-log(\u03f5\n    \t_1R))\n    \n    \t+p_y^2 ( .\n    \t (\u03b1 )  (\u03b1 ) \u03f5 _2B(2 log(\u03f5 _1B)-log(\u03f5 _1L)-log(\u03f5\n    \t_1R))\n    \n    \t+\u03f5 _2L(- (\u03b1 )  (\u03b1 ) log(\u03f5 _1B)+(3  (\u03b1 )+2)  (\u03b1 )  (\u03b1 ) log(\u03f5 _1L)/2 ( (\u03b1 )+1)- (\u03b1 ) log(\u03f5 _1R)/2 (sin (\u03b1 )+cos (\u03b1 )))\n    \n    \t+\u03f5 _2R(- (\u03b1 )  (\u03b1 ) log(\u03f5 _1B)- (\u03b1 ) log(\u03f5 _1L)/2\n    \t\t(sin (\u03b1 )+cos (\u03b1 ))+(3  (\u03b1 )+2)  (\u03b1 )  (\u03b1 ) log(\u03f5 _1R)/2 ( (\u03b1 )+1))\n    \t. )\n    \t.\t )\n    \t. ,\n\n\n\n\n\n\n\n\n\n\n\n\t\n\t\n\t\n\t\n\t\n\t\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\n\n\n    (T^-,-_S m,S m)_Channel 4=-\u03a9^4/128 \u03c6 _z,IN(\u03c6 _z,OUT^2-1) \n    (.\n    \t64 \u03f5 _1B\u03f5 _2B+16 \u03f5 _1B\u03f5 _2L+16 \u03f5 _1B\u03f5 _2R+16 \u03f5 _2B\u03f5 _1L+16 \u03f5 _2B\u03f5 _1R+4 (cos (\u03b1 )-sin (\u03b1 )) (\u03f5 _1L-\u03f5 _1R) (\u03f5 _2L-\u03f5 _2R)/sin (\u03b1\n    \t\t)+cos (\u03b1 )\n     ^2(1/4 (2 \u03b1 +\u03c0 ))  (\u03b1 ) (2 sin (\u03b1 )+cos (2 \u03b1 )+3) (\u03f5 _1B-\u03f5 _1R)\n    \t(\u03f5 _2B-\u03f5 _2L)\n    \t\n    \n    \t-4  (\u03b1 )  ^2(1/4 (2 \u03b1 +\u03c0 )) (\u03f5 _1B-\u03f5\n    \t_1L) (\u03f5 _2B-\u03f5 _2L)\n    \t\n    \n    \t+ ^2(1/4 (2 \u03b1 +\u03c0 ))  (\u03b1 ) (2 sin (\u03b1 )+cos (2 \u03b1 )+3) (\u03f5 _1B-\u03f5 _1L)\n    \t(\u03f5 _2B-\u03f5 _2R)\n    \t\n    \n    \t-4  (\u03b1 )  ^2(1/4 (2 \u03b1 +\u03c0 )) (\u03f5 _1B-\u03f5 _1R) (\u03f5 _2B-\u03f5\n    \t_2R)\n    \t\n    \n    \t4 (2 tan(\u03b1/2)+ (\u03b1 )) ((\u03f5 _1B-\u03f5 _1L) (\u03f5 _2B-\u03f5\n    \t_2L)+(\u03f5 _1B-\u03f5 _1R) (\u03f5 _2B-\u03f5 _2R))\n    \t\n    \n    \t-4 tan ^2(\u03b1/2) tan (\u03b1 ) ((\u03f5 _1B-\u03f5 _1L) (\u03f5 _2B-\u03f5\n    \t_2L)+(\u03f5 _1B-\u03f5 _1R) (\u03f5 _2B-\u03f5 _2R))\n    \t). ,\n\n\n\n\n\n\n\n\n\n\n\t\n\t\n\t\t\n\t\n\n\n\n    (T^-,-_S m,S m)_Channel 5=\n    \t (6 \u03f5 _2B+\u03f5 _2L+\u03f5 _2R)\t\u03a9 ^2 (\u03a9 ^2 \u03c6 _z,IN+1)/8 \u03c6 _z,IN^2 (\u03c6 _z,OUT-1) (\u03c6\n    \t\t_z,OUT+1) .\n\n\n\n\nAppendix D: Fourier transform of a constant function on a polygon. Case q_\u22a5\u2260 0\n\nStart with the Stokes theorem applied for a polygon in the (x,y)-plane, <cit.>,\n\n    \u222c_polygon (\u2207\u00d7F)\u00b7dA=\u222e_right-oriented boundaryF\u00b7ds,\n\t\t\nwhere dA=\u1e91 dx dy. Take the filed F to be of a special case F(x,y)=(\u1e91\u00d7 W) e^q_\u22a5\u00b7 r_\u22a5, with W=(W_x,W_y) a constant 2-dimensional field.\nUse the right-oriented pair (\u03bc\u0302_j,\u03bb\u0302_j) to compute, along each segment of the polygon, the right-hand  integral from (<ref>). The integral over each segment gives different results for q_\u22a5\u00b7\u03bc\u0302_j \u2260 0 or q_\u22a5\u00b7\u03bc\u0302_j = 0. At this stage in the computations we notice two features\n(i) the sum over segments is written in terms of sums over vertices,\n(ii) we can drop the requirement of using a specific orientation of the polygon by using both \u03bc\u0302_j and -\u03bc\u0302_j for the j^th-segment. To accomplish this, if  \u03bc\u0302_j is associated with the vertex V_j, then associate -\u03bc\u0302_j with the vertex V_j+1.\nThe result is a vertex-wise formula, with the sum running over the index k that labels the vertices of the polygon \n\n    \u222c_polygon dx dy e^i q_\u22a5\u00b7 r_\u22a5=   \u2211_k\u2208vertices\u00b1W\u00b7\u03bb\u0302_k/ W\u00b7 q_\u22a5 1/ q_\u22a5\u00b7\u03bc\u0302_k e^i q_\u22a5\u00b7 V_k.\n\t\n\nThe \u00b1 is the last remnant of the need of an orientation in the Stokes's theorem. To incorporate this \u00b1 into an unoriented polygon, place a permittivity \u03f5 inside the polygon, \u03f5=0 outside and define the change in \u03f5 like in (<ref>).\n\nThe need for an orientation in the Stokes' theorem is exchange with the need to use a right-oriented pair (\u03bc\u0302,\u03bb\u0302). This, in turn, imposes the jump to change sign when \u03bc\u0302 changes sign,\nwhich makes the \u00b1 in (<ref>) to become part of (\u0394\u03f5)_\u03bc\u0302.\nWe thus arrived at the formula  (<ref>).\n\nNote that the four corners of the unit cell contribute to the (00)-type Fourier integrals. For Channel 1, which is permittivity-independent, the corners contribute with jumps  (\u0394(f_1f_2))_\u03bc\u0302 that are equal to \u00b1 1, given that outside the unit cell we work with \u03f5=0.\n\n\nAppendix E: Fourier transform of a constant function on a polygon. Case q_\u22a5= 0\n\nThis integral is the area of the polygon, for which a simple answer is given by the sum of the areas of triangles, each triangle producing a term 1/2\u1e91\u00b7 (V_j+1\u00d7 V_j). The disadvantage for us is that the vertices V_j+1 and V_J are not separated, as they are in the formula for q_\u22a5\u2260 0.\nStart from (<ref>) and take the limit of q_\u22a5\u2192 0 along a selected direction \ud835\udc9f\n\n    q_\u22a5 = s \ud835\udc9f\u2192 0, as  s\u2192 0.\n\nWe will show that the final result is independent of the choice of the direction \ud835\udc9f.\nWith this choice of q_\u22a5 and \ud835\udc9f\u00b7\u03bc\u0302\u2260 0 for all \u03bc\u0302, formula  (<ref>) becomes\n\n    \u2211_verticese^i \ud835\udc9f\u00b7 V s\u2211_\u03bc\u0302_vertexW\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f1/s(-\u0394\u03f5)_\u03bc\u03021/\ud835\udc9f\u00b7\u03bc\u03021/s .\n\n\n\nIn (<ref>) there is a second-order singularity, s^-2, which we need to eliminate. To do just that, expand the exponential in Taylor series and examine the terms that belong to  \u03bc\u0302 and -\u03bc\u0302 oriented along the same edge and notice that the second-order singularity is eliminated. However, a first-order singularity s^-1 came into being. This singularity goes away too once we sum up its contribution along a closed loop.\nOnce the singularity s^-1 is eliminated, we are left, in the limit s\u2192 0, with one term per segment\n\n    W\u00b7\u03bb\u0302_j/W\u00b7\ud835\udc9f1/\ud835\udc9f\u00b7\u03bc\u0302_j(-\u0394\u03f5)_\u03bc\u0302_j1/2((i \ud835\udc9f\u00b7 V_j)^2-(i \ud835\udc9f\u00b7 V_j+1)^2).\n\n\nThis term can be placed back into a format that contains two \u03bc\u0302 vectors per each edge. This is the result (<ref>).\n\nWe  prove that the result thus obtained is independent on the choice of W and \ud835\udc9f by showing that\n(<ref>) is equal to sum of areas of triangles.\nCall the vertices of the j-edge by V_j and V_j+1. Placed at V_j and V_j+1 are (\u03bb\u0302_j,\u03bc\u0302_j) and (\u03bb\u0302_j+1,\u03bc\u0302_j+1)=(-\u03bb\u0302_j,-\u03bc\u0302_j), respectively. \nAlong the computation we use  V_j+1-V_j=\u03bc\u0302_j l_j, where l_j is the length of the edge. Change the dot product into a cross product,  W\u00b7\u03bb\u0302=(\u1e91\u00d7 W)\u00b7\u03bc\u0302, to prove the equality\n\n\n    W\u00b7\u03bb\u0302_j/W\u00b7\ud835\udc9f1/\ud835\udc9f\u00b7\u03bc\u0302_j(-\u0394\u03f5)_\u03bc\u0302_j1/2(i \ud835\udc9f\u00b7 V_j)^2+   \n    W\u00b7\u03bb\u0302_j+1/W\u00b7\ud835\udc9f1/\ud835\udc9f\u00b7\u03bc\u0302_j+1(-\u0394\u03f5)_\u03bc\u0302_j+11/2(i \ud835\udc9f\u00b7 V_j+1)^2=   \n    \n    \t\t(-\u0394\u03f5)_\u03bc\u0302_j1/W\u00b7\ud835\udc9f1/2(\u1e91\u00d7 W)\u00b7   \n    (V_j+1-V_j/l_j( \ud835\udc9f\u00b7 V_j)+V_j+1-V_j/l_j( \ud835\udc9f\u00b7 V_j+1))l_j  .\n\n\nThere are four terms in the last line of (<ref>). Two out of these four sum up to zero when we go around a closed loop\n\n\n\n\n\n\nkeeping in mind that (-\u0394\u03f5)_\u03bc\u0302_j is the same for all \u03bc\u0302_j because we are working for a polygon with one kind of permittivity inside and \u03f5=0 outside.\n\nWe are left with the sum of the other two terms, which, by the Binet-Cauchy vector relation, is transformed into a sum of  oriented areas of triangles O V_j V_j+1, where O is some arbitrary origin.\n\n\n\n\n\n\nAppendix F: The integral (00) on a polygonal tessellation of the plane  \n\n\n\n\n\n\n\nIn the tessellated plane, for a selected vertex V and a pair (\u03bb\u0302,\u03bc\u0302) associated with this vertex, there are exactly two contributions from the two polygons  that have a common edge along \u03bc\u0302.\n\n\n\n\n\n\n\n Two permittivity jumps along \u03bc\u0302 originate from these two distinct polygons, each polygon being surrounded by a medium with \u03f5=0. The sum of these polygonal jumps is actually equal to (-\u0394(f_1f_2))_\u03bc\u0302 but on the tessellated structure.\n\n\n\n\n\n\n\nWe arrived at the formula for the polygonal tessellation (<ref>).\n\n\n\n\n\n\n\n\n\nAppendix G: Translation of a virtual point\n\nA virtual point appears at the intersection of a line from plane 1 and another line from plane 2, which are described by r_1=V_12+\u03bc_1\u03bc\u0302_1 and r_2=V_12+\u03bc_2 \u03bc\u0302_2, respectively. Parameters \u03bc_1 and \u03bc_2 run on the real axis.\nApply a translation in plane 1, \n\u03b4 r_1=(\u03b4 x_1,\u03b4 y_1), and plane 2,\n\u03b4 r_2=(\u03b4 x_2,\u03b4 y_2), respectively.\nWritten in terms of a new set of  parameters, \u03bc_1^' and \u03bc_2^', the translated lines are \n\n    (r_1)_translated=   V_12-(\u03b4 r_1\u00b7\u03bb\u0302_1)\u03bb\u0302_1+\u03bc_1^'\u03bc\u0302_1,\n    \n    \t\t(r_2)_translated=   V_12-(\u03b4 r_2\u00b7\u03bb\u0302_2)\u03bb\u0302_2+\u03bc_2^'\u03bc\u0302_2.\n\nTo compute the position of the translated intersection, (V_12)_translated, solve for \u03bc_1^' and \u03bc_2^' such that (r_1)_translated=(r_2)_translated.\n\n\n\n\n\n\nUse \u03bc\u0302_2\u00b7\u03bb\u0302_1=-\u03bc\u0302_1\u00b7\u03bb\u0302_2 and get at the final result (<ref>).\n\n\n\n\n\nAppendix H: Fourier transforms for product of derivatives of type (01), (10) and (11)\n\n\n\n\n\n\n\n\n\n\nWe expand on (<ref>) and (<ref>).\nIn order to simplify the computation of \u2202_\u03b4 x_1 and others of this kind, for case (2), (i.e. q_\u22a5\u00b7\u03bc\u0302= 0 and q_\u22a5\u2260 0), compound the product of the two vertex-dependent terms in one exponential\n\n    e^i q_\u22a5\u00b7 V(i \u03bc\u0302\u00b7 V)=d/d s( e^i q_\u22a5\u00b7 V+s i \u03bc\u0302\u00b7 V)|_s=0 .\n\t\nFor case (3), q_\u22a5=0, in a similar way as above, we get\n\n    1/2 (i \ud835\udc9f\u00b7 V)^2=1/2(d^2/ds^2)_s= 0e^i (\ud835\udc9f\u00b7 V)s .\n\t\n\n\n\n\t\t\n\t\t\n\n\n\n\n\t\n\t\t\n\t\t\n\t\t\n\n\n\nTo group together the results for case (1) and (3), we found it useful to define a  function  e^i (q_\u22a5\u00b7 V)_m, which for  q_\u22a5\u22600 it is equal to  e^i q_\u22a5\u00b7 V. For  q_\u22a5=0 and for any natural number m it is 1/2(d^2/ds^2)_s= 0(e^i (\ud835\udc9f\u00b7 V)s s^m). So\n\n\n\n\n\n\n\n\n\n\n    e^i (q_\u22a5\u00b7 V)_m =\n    \t\te^i (q_\u22a5\u00b7 V)    for all  m,if  q_\u22a5\u2260 0,\n    1/2(i \ud835\udc9f\u00b7 V)^2    if  m=0,and  q_\u22a5= 0,\n    \n    \t\ti \ud835\udc9f\u00b7 V    if  m=1,and  q_\u22a5= 0,\n    \n    \t\t1   if  m=2,and  q_\u22a5= 0,\n    \n    \t\t0   if  m\u2a7e3,and  q_\u22a5= 0.\n\nThe function, for q_\u22a5=0, is equal to the term number  2-m,  from the Taylor expansion.\n\nWith the help of this function, the contribution to the type (10)-integral, Section <ref>,\n\n\n\n\n\n\n from a pair from plane 1, i.e. (V_1,\u03bc\u0302), is \n\n    e^i (\ud835\udc9f\u00b7 V_1)_m_x^1+m_y^1 (-i\ud835\udc9f_x )^m_x^1 (-i\ud835\udc9f_y )^m_y^1\n    W\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f(-\u0394(f_1f_2)_\u03bc\u0302)1/\ud835\udc9f\u00b7\u03bc\u0302,\n\nwhere \ud835\udc9f is arbitrary, subject to the condition that \ud835\udc9f\u00b7\u03bc\u0302\u22600 for all \u03bc\u0302 in plane 1.\nThe contribution to the type (01)-integral from all real points from plane 2, i.e. V_2, is a mirror image. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe contribution to the type (11)-integral from a virtual point, V_12, under constrained translation has a different aspect, being\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    \u2211_all four \u03bc\u0302^'se^i (\ud835\udc9f\u00b7 V_12)_m_x^1+m_y^1+m_x^2+m_y^2   \n    \n    \t\t(\u03bb_1x)^m_x^1\t(\u03bb_1y)^m_y^1\n    \t\t(\u03bb_2x)^m_x^2\t(\u03bb_2y)^m_y^2   \n    (i\ud835\udc9f\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2)^m_x^1+m_y^1(i\ud835\udc9f\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1)^m_x^2+m_y^2   \n    W\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f(-\u0394(f_1f_2)_\u03bc\u0302)1/\ud835\udc9f\u00b7\u03bc\u0302  .\n\nTo avoid carrying over a minus sign and to arrive at the above formula, we use \u03bc\u0302_2\u00b7\u03bb\u0302_1=-\u03bc\u0302_1\u00b7\u03bb\u0302_2.\nThe sum, for a fixed virtual point V_12, is over all four \u03bc\u0302^'s, which have the tail located at V_12.\n\nThe above sum, if needed, can be place in a form which is independent of the gauge vector W. For that, first notice that \n\n    (\u03bb_1x)^m_x^1\t(\u03bb_1y)^m_y^1\n    \t\t(\u03bb_2x)^m_x^2\t(\u03bb_2y)^m_y^2\n    (i\ud835\udc9f\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2)^m_x^1+m_y^1(i\ud835\udc9f\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1)^m_x^2+m_y^2\n\nis the same for all four \u03bc\u0302^'s, which have the tail located at V_12. \n\nSecond, use the relation\n\n    \u2211_all four \u03bc\u0302^'sW\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f(-\u0394(f_1f_2)_\u03bc\u0302)1/\ud835\udc9f\u00b7\u03bc\u0302=\n    \u03bb\u0302_1\u00b7\u03bc\u0302_2/(\ud835\udc9f\u00b7\u03bc\u0302_1)(\ud835\udc9f\u00b7\u03bc\u0302_2)\n    \t\t(\u0394 f)_\u03bc\u0302_1(\u0394 g)_\u03bc\u0302_2\n\t\nvalid for any two choices of \u03bc\u0302_1 and \u03bc\u0302_2,  which have the tail located at V_12 and the tip on line 1 and line 2, respectively. \n\nThe contribution of a virtual point can be thus brought into a W-independent form\n\n    \u2211_V_12,two \u03bc\u0302^'se^i (\ud835\udc9f\u00b7 V_12)_m_x^1+m_y^1+m_x^2+m_y^2   \n    (i\ud835\udc9f\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2\u03bb_1x)^m_x^1(i\ud835\udc9f\u00b7\u03bc\u0302_2/\u03bc\u0302_1\u00b7\u03bb\u0302_2\u03bb_1y)^m_y^1   \n    (i\ud835\udc9f\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1\u03bb_2x)^m_x^2(i\ud835\udc9f\u00b7\u03bc\u0302_1/\u03bc\u0302_2\u00b7\u03bb\u0302_1\u03bb_2y)^m_y^2   \n    \u03bb\u0302_1\u00b7\u03bc\u0302_2/(\ud835\udc9f\u00b7\u03bc\u0302_1)(\ud835\udc9f\u00b7\u03bc\u0302_2)\n    \t\t(\u0394 f)_\u03bc\u0302_1(\u0394 g)_\u03bc\u0302_2  .\n\n\n\nTo show (<ref>), choose  two out of four vectors that have the tail on the virtual point and direction on the line in plane 1 and plane 2, and call them \u03bc\u0302_1 and \u03bc\u0302_2, respectively. The other two vectors are -\u03bc\u0302_1 and -\u03bc\u0302_2.\n\n\n\n\n\n\n\n\n\n\n\nUse \n\n    -\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1=\n    \n    \t\t-(-\u0394(f_1f_2)_\u03bc\u0302_2-\u0394(f_1f_2)_-\u03bc\u0302_2)\n\nand get \n\n    \u2211_all four \u03bc\u0302^'sW\u00b7\u03bb\u0302/W\u00b7\ud835\udc9f(-\u0394(f_1f_2)_\u03bc\u0302)1/\ud835\udc9f\u00b7\u03bc\u0302=   \n    (W\u00b7\u03bb\u0302_1/W\u00b7\ud835\udc9f1/\ud835\udc9f\u00b7\u03bc\u0302_1-W\u00b7\u03bb\u0302_2/W\u00b7\ud835\udc9f1/\ud835\udc9f\u00b7\u03bc\u0302_2)   \n    \n    \t\t(-\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1).\n\t\nA vector identity, valid for any W, \ud835\udc9f and two pairs\n(\u03bb\u0302_1,\u03bc\u0302_1) and (\u03bb\u0302_2,\u03bc\u0302_2), \n\n    (W\u00b7\u03bb\u0302_1)(\ud835\udc9f\u00b7\u03bc\u0302_2)-(W\u00b7\u03bb\u0302_2)(\ud835\udc9f\u00b7\u03bc\u0302_1)=(W\u00b7\ud835\udc9f)(\u03bb\u0302_1\u00b7\u03bc\u0302_2)\n\nbrings the right-hand side of (<ref>) into the form\n\n    (\u03bb\u0302_1\u00b7\u03bc\u0302_2/(\ud835\udc9f\u00b7\u03bc\u0302_1)(\ud835\udc9f\u00b7\u03bc\u0302_2))(-\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1).\n\t\nThe final step is to prove that\n\n    (-\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1)(\u03bb\u0302_1\u00b7\u03bc\u0302_2)=\n    \n    \t\t(\u0394 f_1)_\u03bc\u0302_1(\u0394 f_2)_\u03bc\u0302_2\u03bb\u0302_1\u00b7\u03bc\u0302_2  .\n\n\nThis last equality can be established by going through every of the four cases of pairs (\u03bb\u0302,\u03bc\u0302). Another way is to notice that -\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1 is equal to (\u0394 f)_\u03bc\u0302_1(\u0394 g)_\u03bc\u0302_2 up to a sign, i.e. -\u0394(f_1f_2)_\u03bc\u0302_1-\u0394(f_1f_2)_-\u03bc\u0302_1=\u00b1 (\u0394 f_1)_\u03bc\u0302_1(\u0394 f_2)_\u03bc\u0302_2. This is so, because the left-hand side is invariant under the change in sign \u03bc\u0302_1\u2192 -\u03bc\u0302_1, whereas the right-hand side changes its sign. The absolute value eliminates this change in sign and so the equality is valid.\n\n\n\nAppendix I: The optimization procedure for selecting the dielectric constants\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConstruct, out of (<ref>),  a 8 \u00d7 5 sub-matrix  composed of transfer matrix elements that couples only the S-polarization of the four modes selected, (0,0),(-1,0),(0,-1),(0,1).  The equations to solve are obtained from formula (<ref>). The OUT  set (DIR,POL,BF) is composed of (\u00b1,S,m), with m=1,\u2026,4 from Table <ref>. Given the absence of any source at z=+\u221e, the coefficients C_POL,BF^DIR are all zero for (-,S,m), m=1,\u2026,4. At IN, the set (dir,pol,bf) contains the incoming (+,S,1) and the reflected (-,S,m), with m=1,\u2026,4. There are 8 unknown coefficients, 4 at OUT and another 4 at IN. \n\n\nThe 8\u00d7 5 matrix transfers the input column vector (\ud835\udc9e^+_S1,\ud835\udc9e^-_S1,\ud835\udc9e^-_S2,\ud835\udc9e^-_S3,\ud835\udc9e^-_S4) into the output (C^+_S1,C^+_S2,C^+_S3,C^+_S4,0,0,0,0). For ease of reading, the IN and OUT coefficients are marked using distinct fonts. Within this approximation, we can solve 8 equations for 8 unknowns coefficients, by fixing the input \ud835\udc9e^+_S1=1. The coefficients thus found are the transmission and reflection coefficients for the 4 modes under consideration. \nTo construct an objective function for the optimization process we use a series of properties. The first property is that in the vicinity of the resonant frequency the absolute value of the determinant of the 4\u00d7 4 matrix (T^-,-_Sm,Sn) attains a minimum. The second one is that the absolute value of the transmission and reflection coefficients of the evanescent modes need to attain high values. The third property is based on the absorptance factor defined as 1-C^+_S1^2-C^+_S2^2-\ud835\udc9e^-_S1^2-\ud835\udc9e^-_S2^2, similarly to the definition from <cit.>. The absorptance factor goes through a maximum around the resonant frequency.  \nThe objective function we use is\n\n\n    Det(T^-,-_Sm,Sn)+\n    C^+_S1^2+C^+_S2^2+\ud835\udc9e^-_S1^2+\ud835\udc9e^-_S2^2-0.5\n    +\n    C^+_S3-10+C^+_S4-10  .\n\n\nOnly the transmission coefficients for the evanescent waves are present in (<ref>) because we expect that the reflection coefficients be very close, in absolute value, to the transmission values. We choose 10 as a target number for this values. For the absorptance factor the target values is chosen at 0.5. \n\nFor a fixed frequency in the range 37 GHz to 50 GHz, we  found a local minimum for  this objective function in the 6-dimensional space of the dielectric constants, each constant constrained to be between 1 and 12. \nAfter scanning 100 frequencies, the local minimum we selected has f=41.29 GHz, Det(T^-,-_Sm,Sn) =2.5\u00d7 10^-5-3.7\u00d7 10^-5 i, C^+_S1= 0.59 - 0.0022 i, \ud835\udc9e^-_S1=  -0.21 - 0.59 i, C^+_S2= 0.041 + 0.31 i, \ud835\udc9e^-_S2=0.04 + 0.34 i, C^+_S3=-10.03 - 0.15 i, \ud835\udc9e^-_S3=-10.61 - 0.18 i,\nC^+_S4=-3.92 + 9.20 i and \ud835\udc9e^-_S4= -4.13 + 9.74 i. \nWe see that the obtained determinant is a small number and that the reflection and the transmissions coefficients are close, in absolute value, to the value 10 we imposed. The absorptance factor came out as 0.04, far from the value of 0.5. This is because in the vicinity of the resonant frequency the  transmission and reflection coefficients of the propagative modes attain a minimum at frequencies slightly different than the resonance. \n\nThe dielectric permittivity set for the local minimum is \n\n    \u03f5 _1B= 4.98655,\u03f5 _2B= 2.95855,\u03f5 _1L= 7.59549,\n    \u03f5 _2L = 5.663,\u03f5 _1R=\n    5.92965,\u03f5 _2R= 1.63434\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAppendix J: Complex frequency plane\n\nThe real resonant frequency is located at the minimum of the determinant on the real \u03a9-axis.\nThe zero of the cofactor is located in the upper complex plane, Im(f_zero)>0 \n. A search for the minimum of the absolute value of the Cofactor_S(0,0),S(0,1)(T^-,-) gives a complex frequency \u03a9_zero= 0.213999052599+0.00014322547392 i, for which the Cofactor attains the value of -4.17186\u00d710^-7 + 5.51181\u00d710^-7 i. Translated in frequency, using c=0.25 mm, we get f_zero=40.8425 + 0.0273351 i in GHz. Once this zero is localized, the parameters a and b are estimated through a linear regression, <cit.>.\n\nThe linear approximation of the cofactor in the vicinity of \u03a9_zero,\n\n    Cofactor_S(0,0),S(0,1)(T^-,-)\u2245(a+i b) (\u03a9-\u03a9_zero),\n\ncontains two unknown parameters, a and b. The numerical data consists of pairs  (\u03a9,Cofactor_S(0,0),S(0,1)(T^-,-)) obtained from sampling the upper complex-frequency plane  using the analytical formulas for the transfer matrix.\n\nThe linear approximation for the determinant starts with localizing  Re(\u03a9_resonance)=0.21632449245970709 on the real axis at the point where the absolute value of the determinant becomes minimum, attaining the value 1.15869. In terms of the frequency, the resonance is at Re(f_resonance)=41.28635279688047 GHz. The linear approximation of the determinant in the vicinity of \u03a9_pole=0.21632449245970709+ i y_pole,\n\n    Det(T^-,-)\u2245(a^'+i b^') (\u03a9-\u03a9_pole),\n\ncontains three unknown parameters, a^', b^' and y_pole. The numerical data consists of pairs  (\u03a9,Det(T^-,-)) obtained from sampling the upper complex-frequency plane around Re(\u03a9_resonance) using the analytical formulas for the transfer matrix. The fit this time is nonlinear because of the product (a^'+i b^') y_pole.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\t\n\n\n\n\n"}