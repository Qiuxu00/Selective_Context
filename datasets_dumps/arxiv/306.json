{"entry_id": "http://arxiv.org/abs/2303.06912v1", "published": "20230313081505", "title": "Synergizing Beyond Diagonal Reconfigurable Intelligent Surface and Rate-Splitting Multiple Access", "authors": ["Hongyu Li", "Shanpu Shen", "Bruno Clerckx"], "primary_category": "cs.IT", "categories": ["cs.IT", "eess.SP", "math.IT"], "text": "\n\n\nEffects of Nb Doping on the Charge-Density Wave and Electronic Correlations in the Kagome Metal Cs(V_1-xNb_x)_3Sb_5\n    Hai-Hu\u00a0Wen\n    March 30, 2023\n===================================================================================================================\n\nempty\n\nThis work focuses on the synergy of rate-splitting multiple access (RSMA) and beyond diagonal reconfigurable intelligent surface (BD-RIS) to enlarge the coverage, improve the performance, and save on antennas. \nSpecifically, we employ a multi-sector BD-RIS modeled as a prism, which can achieve highly directional full-space coverage, in a multiuser multiple input single output communication system.   \nWith the multi-sector BD-RIS aided RSMA model, we jointly design the transmit precoder and BD-RIS matrix under the imperfect channel state information (CSI) conditions. \nThe robust design is performed by solving a stochastic average sum-rate maximization problem. \nWith sample average approximation and weighted minimum mean square error-rate relationship, the stochastic problem is transformed into a deterministic one with multiple blocks, each of which is iteratively designed. \nSimulation results show that multi-sector BD-RIS aided RSMA outperforms space division multiple access schemes. More importantly, synergizing multi-sector BD-RIS with RSMA is an efficient strategy to reduce the number of active antennas at the transmitter and the number of passive antennas in BD-RIS. \n\n\n\n    Beyond diagonal reconfigurable intelligent surface, rate-splitting multiple access, robust design.\n\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n\n\n\nThe next generation of wireless communications is expected to improve ongoing techniques in 5G and explore novel techniques to support high data rate transmission and massive connectivity <cit.>.\nSpecifically in the physical (PHY) layer, rate-splitting multiple access (RSMA) <cit.> and reconfigurable intelligent surface (RIS) <cit.> are two promising techniques, which can improve the wireless communication performance, such as spectral efficiency, energy efficiency, and coverage. \n\n\nRSMA is a PHY-layer non-orthogonal transmission strategy, which enables more flexible inter-user interference management compared to other existing multiple access techniques, such as spatial division multiple access (SDMA) and orthogonal multiple access (OMA) <cit.>. The key principle of (1-layer) RSMA is summarized as follows. \n1) At the transmitter, user messages are split into common and private parts, where the common parts from different users are combined and encoded into one common stream, while the private parts are individually encoded into private streams. \n2) At the receiver, each user first decodes the common stream and performs successive interference cancellation (SIC) to remove the common stream, and then decodes its own private stream. \nSuch a technique has been proved to achieve higher degree of freedom (DoF) <cit.>, spectral and energy efficiency <cit.> than SDMA, and be robust to channel state information (CSI) uncertainty <cit.> and mobility <cit.>. \nThe higher efficiency, universality, flexibility, robustness, and reliability of RSMA over existing multiple access strategies have been demonstrated in more than forty different applications and scenarios relevant to 6G <cit.>.\n\nMeanwhile, RIS is an emerging PHY-layer technique, which enables flexible manipulations of wireless communication environments in an energy-efficient manner <cit.>. The key advantages of RIS come from the following two perspectives. \n1) RIS is a planar surface consisting of a large number of nearly-passive elements with low power consumption. \n2) RIS has tuneable elements which can reconfigure incident signals. \nSuch a technique has been widely employed into various schemes, such as wireless power transfer (WPT) <cit.>, simultaneous wireless information and power transfer (SWIPT) <cit.>, integrated sensing and communication (ISAC) <cit.>, to show the benefits of RIS in improving sum output current <cit.> and radar output signal-to-interference-plus-noise (SINR) <cit.>.\n\n\n\n\n\n\n\n\n\n\nConventional RIS utilized in aforementioned research <cit.> is modeled as a diagonal phase shift matrix, assuming an architecture where each RIS element is connected to ground by its own load without interacting with other elements. \nHowever, new RIS architectures have recently appeared, namely beyond diagonal RIS (BD-RIS), whose mathematical model is not limited to diagonal matrices. \nUntil now, there are three categories of BD-RIS.\nThe first category is BD-RIS with group/fully-connected architectures modeled as block diagonal matrices <cit.>. In this category, group/fully-connected BD-RIS with reflective mode is first proposed and modeled in <cit.>, followed by the study of discrete-value group/fully-connected architectures <cit.> and optimal group/fully-connected design <cit.> of BD-RIS. \nTo enlarge the coverage of RIS, simultaneous transmitting and reflecting (STAR) RIS or intelligent omni-surface (IOS) <cit.> is recently introduced and implemented. Then STAR-RIS/IOS is proved to be a special case of group-connected architecture with group size 2 and further generalized in <cit.>. \nMulti-sector BD-RIS is proposed in <cit.> to further enhance the achievable performance of RIS while guaranteeing the full-space coverage.\nThe second category is BD-RIS with dynamically group-connected architectures modeled as permuted block diagonal matrix <cit.>. \nDifferent from <cit.>, where the architectures are fixed regardless of CSI, a dynamically group-connected architecture adapting to CSI is proposed in <cit.> based on a dynamic grouping strategy to further enhance the performance. \nThe third category is BD-RIS with non-diagonal phase shift matrix <cit.>. \nIn this category, a novel architecture, where signals impinging on one element can be reflected from another element, is modeled, analyzed, and proved to achieve better performance than conventional RIS with diagonal phase shift matrices. \n\n\nDue to the potential advantages of RSMA and RIS, the synergy among them has recently gained much attention <cit.>. \nThe synergy among the conventional RIS and 1-layer RSMA in multiuser systems is most commonly considered, whose benefits are shown by focusing on various metrics, such as sum-rate maximization <cit.>, energy efficiency maximization <cit.>, outage probability analysis <cit.>, transmit power minimization <cit.>, and max-min fairness <cit.>.\nIn addition, the interplay between conventional RIS and RSMA beyond 1-layer architectures, such as 2-layer hierarchical RSMA <cit.>, is also studied. \nWhile the abovementioned RIS aided RSMA work <cit.> is restricted to perfect CSI conditions, a more practical imperfect CSI scenario is analyzed in <cit.>. \nHowever, the above results <cit.> are restricted to the integration of RSMA and conventional RIS, which limits both the coverage and the achievable performance. \nTo realize full-space coverage in wireless networks, there are a few results on STAR-RIS aided RSMA <cit.> considering spatially correlated channels <cit.>, hardware impairments <cit.>, PHY layer security <cit.>, and the coupling of transmission and reflection phases <cit.>. \nMeanwhile, to enhance the spectrum efficiency of wireless communications, there is only one work <cit.> considering the employment of BD-RIS with fully-connected architecture and reflective mode in RSMA transmission network, where the sum-rate enhancement compared to SDMA schemes is highlighted. \nNevertheless, none of the existing work investigates the integration of BD-RIS and RSMA to simultaneously 1) enlarge the coverage, 2) boost the rate performance <cit.>, and 3) reduce the required number of active/passive antennas to improve energy efficiency, which motivates this work.  \n\nThe contributions of this work are summarized as follows. \n\nFirst, we consider the integration of RSMA and multi-sector BD-RIS in a multiuser multiple input single output (MU-MISO) system to simultaneously achieve the abovementioned three goals.\nThe first two goals are achieved by adopting the multi-sector BD-RIS, which is modeled as a prism consisting of multiple sectors with each covering part of the horizontal space. More importantly, the multi-sector BD-RIS enables highly directional beams and thus can provide high performance gains, thanks to the use of high-gain antennas with narrow beamwidth.  \nTo achieve the third goal, we adopt 1-layer RSMA at the transmitter, which provides additional DoF over conventional multiuser linear precoding, enables better inter-user interference management, and has the potential to save on the number of both active and passive antennas when synergizing with BD-RIS. \n\nSecond, we propose a robust beamforming design algorithm to maximize the average sum-rate for multi-sector BD-RIS aided RSMA under imperfect CSI conditions. To solve the stochastic problem, we first approximate it as a deterministic optimization by sample average approximation (SAA) methods <cit.>, and then transform the deterministic problem into a more tractable three-block optimization based on the weighted minimum mean square error (WMMSE)-rate relationship <cit.>. Specifically for the design of the BD-RIS matrix block, we first transform the non-smooth objective into a smooth one, and then solve the smooth problem by manifold methods. Initialization, complexity analysis, and convergence analysis of the proposed design are also provided. \n\n\nThird, we present simulation results to evaluate the ergodic sum-rate performance of the multi-sector BD-RIS aided RSMA compared to the SDMA scheme from the perspective of 1) the radiation pattern of BD-RIS antennas, 2) CSI conditions, and 3) the quality of service (QoS) threshold. Simulation results show that multi-sector BD-RIS aided RSMA always outperforms multi-sector BD-RIS aided SDMA in either of the abovementioned perspectives.\n\n\nFourth, with the same ergodic sum-rate requirement and QoS thresholds, we show the required numbers of active and passive antennas can be reduced compared to the SDMA scheme by synergizing BD-RIS with RSMA. Such reduction of antenna numbers leads to a potential energy efficiency gain. \n\n\nOrganization: Section II illustrates the multi-sector BD-RIS aided RSMA model. \nSection III provides the robust beamforming design for the multi-sector BD-RIS aided RSMA.\nSection IV evaluates the performance of the proposed design and Section V concludes this work.\n\nNotations:\nBoldface lower- and upper-case letters indicate column vectors and matrices, respectively.\n\u2102, \u211d, and \u211d^+ denote the set of complex numbers, real numbers, and non-negative real numbers, respectively.\n\ud835\udd3c{\u00b7} represents statistical expectation.\n(\u00b7)^\u2217, (\u00b7)^T, (\u00b7)^H, and (\u00b7)^-1 denote the conjugate, transpose, conjugate-transpose operations, and inversion, respectively.\n{\u00b7} denotes the real part of a complex number.\n\ud835\udc08_L denotes an L \u00d7 L identity matrix.\n0 denotes an all-zero matrix.\n\ud835\udc9e\ud835\udca9(0,\u03a3) denotes the circularly symmetric complex Gaussian (CSCG) distribution with mean 0 and covariance matrix \u03a3.\n\ud835\udc00_F denotes the Frobenius norm of matrix \ud835\udc00.\n\ud835\udc1a_2 denotes the \u2113_2-norm of vector \ud835\udc1a.\n|a| denotes the norm of variable a.\n\ud835\uddcf\ud835\uddbe\ud835\uddbc(\u00b7) denotes the vectorization of a matrix.\n\ud835\uddbd\ud835\uddc2\ud835\uddba\ud835\uddc0(\u00b7) denotes a diagonal matrix.\n\ud835\uddb3\ud835\uddcb{\u00b7} denotes the summation of diagonal elements of a matrix. \n\u25bf(\u00b7) denotes the first-order Euclidean gradient operation. \n\u2202(\u00b7)/\u2202(\u00b7) denotes the first-order partial gradient operation.\n[\ud835\udc00]_i,:, [\ud835\udc00]_:,j, [\ud835\udc00]_i,j, and [\ud835\udc1a]_i denote the i-th row, the j-th column, the (i,j)-th element of matrix \ud835\udc00, and the i-th element of vector \ud835\udc1a, respectively. \n\n\n\n\n\u00a7 MULTI-SECTOR BD-RIS AIDED RSMA\n\n\nIn this section, we briefly review the concept of multi-sector BD-RIS, describe the multi-sector BD-RIS aided MU-MISO system, explain the architecture of 1-layer RSMA, and illustrate the modeling of CSI uncertainty.\n\n\n\n\n\n\n\n \u00a7.\u00a7 Multi-Sector BD-RIS\n\n\nThe multi-sector BD-RIS is modeled as a polygon consisting of L sectors, each of which has M antennas, as shown in Fig. <ref>. \nThe modeling of multi-sector BD-RIS is essentially based on group-connected reconfigurable impedance network and antenna array arrangements <cit.>. \nIn this subsection, we briefly explain the key of multi-sector BD-RIS from the following two perspectives.\n\n1) The multi-sector BD-RIS consists of M cells with an index set \u2133 = {1,\u2026,M}. Particularly, cell m, \u2200 m\u2208\u2133 contains antennas m, M+m, \u2026, (L-1)M+m, which are connected to each other by reconfigurable impedance components to support the multi-sector mode.\n\n2) Each multi-sector BD-RIS antenna has a uni-directional radiation pattern with beamwidth 2\u03c0/L, which only covers 1/L azimuth space. \nIn each cell, L antennas are located at the edge of the polygon such that L antennas cover the whole azimuth space. \nThe larger the number of sectors L, the narrower the beamwidth of each BD-RIS antenna, and thus the higher the antenna gain of each BD-RIS antenna.\n\nTo summarize, benefiting from group-connected impedance network and antenna array arrangements, the multi-sector BD-RIS can realize highly directional full-space coverage.   \n\nMathematically, the multi-sector BD-RIS is characterized by L matrices, \u03a6_l\u2208\u2102^M\u00d7 M, \u2200 l\u2208\u2112={1,\u2026,L}, corresponding to L sectors, which satisfy a combined unitary constraint given by\n\n    \u2211_l\u03a6_l^H\u03a6_l = \ud835\udc08_M.\n\nMore details about the modeling, design, and performance evaluation of the multi-sector BD-RIS can be found in <cit.>.\n\n\n\n\n \u00a7.\u00a7 Multi-Sector BD-RIS Aided MU-MISO\n\nConsider a MU-MISO system operating in the downlink as illustrated in Fig. <ref>, where the transmitter equipped with N antennas communicates to a set of single-antenna users \ud835\udca6 = {1,\u2026,K} with the aid of an M-cell multi-sector BD-RIS[In this work, we ignore the direct links between the transmitter and users for simplicity, while the proposed design in the following section is still feasible when direct links exist.].\nIn this work, we assume the transmitter is within the coverage of sector 1 of the multi-sector BD-RIS and K_l users in \ud835\udca6_l = {\u2211_i=1^l-1K_i+1,\u2211_i=1^l-1K_i+2,\u2026,\u2211_i=1^lK_i} are located within the coverage of sector l, \u2200 l\u2208\u2112 of the multi-sector BD-RIS, \u222a_l\ud835\udca6_l = \ud835\udca6, as illustrated in Fig. <ref>.  \nFor the multi-sector BD-RIS aided downlink MU-MISO, the signal received by user k, \u2200 k\u2208\ud835\udca6_l covered by sector l, \u2200 l\u2208\u2112 is \n\n    y_k = \ud835\udc21_k^H\u03a6_l\ud835\udc06\ud835\udc31 + n_k,\n\nwhere \ud835\udc21_k\u2208\u2102^M and \ud835\udc06\u2208\u2102^M\u00d7 N, respectively, are the channel between the multi-sector BD-RIS and user k, \u2200 k\u2208\ud835\udca6, and the channel between the transmitter and the BD-RIS, \ud835\udc31\u2208\u2102^N is the transmit signal vector, and n_k\u223c\ud835\udc9e\ud835\udca9(0,\u03c3_k^2), \u2200 k\u2208\ud835\udca6 is the additive white Gaussian noise (AWGN). \nThe transmit signal vector \ud835\udc31 is subject to the power constraint \ud835\udd3c{\ud835\udc31^H\ud835\udc31}\u2264 P, where P is the maximum transmit power. \n\n\n\n\n\n\n\nAs discussed in <cit.>, reconfigurable impedance networks with different circuit topologies have scattering matrices with different mathematical characteristics. \nIn this work, we focus on a cell-wise single-connected (CW-SC) architecture of the multi-sector BD-RIS, where the inner-cell antennas are connected to each other by reconfigurable impedance components while the inter-cell antennas are not connected to each other. \nTo facilitate understanding, we provide an example of the BD-RIS with 4 sectors, 2 cells, and the CW-SC architecture in Fig. <ref>.\nFor multi-sector BD-RIS with CW-SC architecture, \u03a6_l, \u2200 l\u2208\u2112 are all diagonal matrices and the general unitary constraint (<ref>) becomes\n\n    \u03a6_l = \ud835\uddbd\ud835\uddc2\ud835\uddba\ud835\uddc0(\u03d5_l,1,\u2026,\u03d5_l,M), \u2200 l,\n    \u2211_l |\u03d5_l,m|^2 = 1, \u2200 m,\n\nwhere \u03d5_l,m\u2208\u2102, \u2200 l\u2208\u2112, \u2200 m\u2208\u2133. With equation (<ref>), we can rewrite equation (<ref>) as \n\n    y_k = \u03d5_l^T\ud835\udc10_k^H\ud835\udc31 + n_k,\n\nwhere \ud835\udc10_k = \ud835\udc06^H\ud835\uddbd\ud835\uddc2\ud835\uddba\ud835\uddc0(\ud835\udc21_k)\u2208\u2102^N\u00d7 M, \u2200 k\u2208\ud835\udca6 denotes the cascaded channel between the transmitter and user k, \u03d5_l = [\u03d5_l,1,\u2026,\u03d5_l,M]^T\u2208\u2102^M, \u2200 l\u2208\u2112.\n\n\n\n\n\n \u00a7.\u00a7 Rate-Splitting\n\n\nIn this work, we adopt an 1-layer RSMA architecture at the transmitter. \nFig. <ref> illustrates the transceiver architectures with 1-layer RSMA, where the splitting, combining, encoding, and precoding of transmit signals at the transmitter and the decoding, splitting, and combining of received signal at the user side will be described in detail. \n\n\n\n\n\nTransmitter: The message W_k intended to user k, \u2200 k\u2208\ud835\udca6 is split into a common part W_c,k and a private part W_p,k. \nAs shown in Fig. <ref>(a), the common parts W_c,k from all K users are merged into a common message W_c and further encoded into the common stream s_c, which will be decoded by all users, by a common codebook. \nK private parts are encoded into private streams s_p,1,\u2026,s_p,K and individually decoded by different users. \nThe common stream and K private streams, \ud835\udc2c = [s_c,s_p,1,\u2026,s_p,K]^T\u2208\u2102^K+1, are linearly precoded by \ud835\udc0f = [\ud835\udc29_c,\ud835\udc29_p,1,\u2026,\ud835\udc29_p,K]\u2208\u2102^N\u00d7(K+1), where \ud835\udc29_c\u2208\u2102^N is the common precoder and \ud835\udc29_p,k\u2208\u2102^N is the private precoder for user k.\nThe resulting transmit signal is \n\n    \ud835\udc31 = \ud835\udc0f\ud835\udc2c = \ud835\udc29_cs_c + \u2211_k\ud835\udc29_p,ks_p,k.\n\nAssuming \ud835\udd3c{\ud835\udc2c\ud835\udc2c^H} = \ud835\udc08_K+1, the transmit power constraint  becomes \ud835\udd3c{\ud835\udc31^H\ud835\udc31} = \ud835\uddb3\ud835\uddcb(\ud835\udc0f\ud835\udc0f^H) = \ud835\udc0f_F^2 \u2264 P.\n\n\nReceiver: Substituting (<ref>) into (<ref>), we obtain the received signal at user k covered by sector l, \u2200 k\u2208\ud835\udca6_l,\u2200 l\u2208\u2112 as\n\n    y_k =\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_cs_c + \u03d5_l^T\ud835\udc10_k^H\u2211_k'\ud835\udc29_p,k's_p,k'+ n_k.\n\nTherefore, the average received power of user k covered by sector l for given CSI is given by\n\n    \u03c4_c,k =   \ud835\udd3c{|y_k|^2} = |\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_c|^2\n       +|\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_p,k|^2 + \u2211_k' k|\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_p,k'|^2 + \u03c3_k^2^= \u03b9_p,k_= \u03c4_p,k = \u03b9_c,k.\n\nAt the user side, the signal process, taking user k covered by sector l, \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112 as an example, is summarized as following three steps and also illustrated in Fig. <ref>(b).\n\n\nStep 1: User k covered by sector l decodes the equalized common stream s_c,k = g_c,ky_k with equalizer g_c,k\u2208\u2102 into W\u0305_c,k by regarding the interference induced by all K private streams as noise, i.e., \u03c4_p,k or \u03b9_c,k in (<ref>). After performing SIC, W\u0305_c,k is subtracted from the received signal. \n\nStep 2: User k decodes the equalized private stream s_p,k = g_p,ky_k with equalizer g_p,k\u2208\u2102 into W_p,k by regarding the interference induced by remaining K-1 private streams as noise, i.e., \u03b9_p,k in (<ref>).  \n\nStep 3: User k splits its contribution to the common message, W_c,k, from the decoded W\u0305_c,k, and combines W_c,k with W_p,k to reconstruct W_k.\n\n\nBased on the above signal process, the instantaneous SINRs of the common stream and private streams at user k covered by sector l, \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112 are given by\n\n    \u03b3_c,k = |\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_c|^2\u03b9_c,k^-1,\u00a0\u03b3_p,k = |\u03d5_l^T\ud835\udc10_k^H\ud835\udc29_p,k|^2\u03b9_p,k^-1.\n \nAssuming Gaussian inputs, the instantaneous common rates and private rates for user k are \n\n    R_c,k = log_2(1 + \u03b3_c,k),\u00a0 R_p,k = log_2(1 + \u03b3_p,k).\n \nTo guarantee the common message W_c is successfully decoded by all K users, the common rate should not exceed min_\u2200 k R_c,k.\nGiven the architecture of RSMA as illustrated above, the common rate min_\u2200 k R_c,k is split into K parts, yielding min_\u2200 k R_c,k = \u2211_kC_k. Each part C_k\u2208\u211d^+ corresponds to the common part of the achievable rate for user k. \nFinally, the total rate for user k is a summation of common part and private part, i.e., R_k = C_k + R_p,k, \u2200 k\u2208\ud835\udca6. \n\n\n\n\n \u00a7.\u00a7 Channel State Information\n\n\nPerfect CSI acquisition in RIS aided systems is challenging due to the passive property of RIS. Therefore, in this work, we assume the transmitter has an imperfect instantaneous CSI\n\ud835\udc10 = [\ud835\udc10_1,\u2026,\ud835\udc10_K]\u2208\u2102^N\u00d7 MK. To model the CSI uncertainty, the perfect cascaded channel matrix \ud835\udc10 = [\ud835\udc10_1,\u2026,\ud835\udc10_K]\u2208\u2102^N\u00d7 MK is expressed as a summation of the channel estimate and channel estimation errors, that is \ud835\udc10 = \ud835\udc10 + \ud835\udc10, where the estimation error matrix is defined as \ud835\udc10 = [\ud835\udc10_1,\u2026,\ud835\udc10_K]\u2208\u2102^N\u00d7 MK.\nThe channel estimation error could come from the noise and limited uplink training in time division duplex (TDD) settings based on the typical MMSE criterion <cit.>[The existing popular and effective channel estimation strategy, where the cascaded channel is estimated by pre-defining the RIS pattern during the uplink training process to minimize MSE, can be easily extended to the multi-sector BD-RIS case with CW-SC architecture. The key and main difference compared with conventional RIS case is the design of the RIS pattern due to the new constraint of multi-sector BD-RIS. A simple choice to minimize the MSE is to set identical amplitude for non-zero elements of the BD-RIS matrix, i.e., |\u03d5_l,m| = 1/\u221a(L). Then orthogonal matrices, such as discrete Fourier transform (DFT) matrix and Hadamard matrix, can be adopted to construct the RIS pattern.].\nIn this case, the channel estimation error generally follows the CSCG distribution, that is \ud835\uddcf\ud835\uddbe\ud835\uddbc(\ud835\udc10_k)\u223c\ud835\udc9e\ud835\udca9(0,\u03b4_k^2\ud835\udc08_MN), \u2200 k\u2208\ud835\udca6, where \u03b4_k^2 measures the estimation inaccuracy of the cascaded channel between the transmitter and user k. \n\n\n\n\u00a7 ROBUST BEAMFORMING DESIGN WITH SAMPLE AVERAGE APPROXIMATION\n\n\n\nIn this section, we formulate the sum-rate maximization problem for BD-RIS aided RSMA based on imperfect CSI conditions and propose efficient algorithms to jointly design the transmit precoder and BD-RIS. \n\n\n\n \u00a7.\u00a7 Problem Formulation\n\n\n\nBeamforming design for RIS aided systems highly relies on the CSI among the transmitter, RIS, and users. \nWhen perfect CSI is available at the transmitter, beamforming design can be developed according to perfect channels such that the instantaneous sum-rate, \u2211_kR_k, is maximized, and thus the ergodic sum-rate given by \ud835\udd3c_\ud835\udc10{\u2211_kR_k}. \nHowever, when the transmitter has only partial instantaneous CSI as illustrated in Section <ref>, beamforming design that maximizes instantaneous sum-rate as in perfect CSI case is not possible, which makes it difficult to measure the long-term ergodic sum-rate. \nOne robust approach to tackle this issue is to perform the beamforming design based on the fact that the transmitter has access to the average rate, which captures the statistical property of the channel estimation error with a given estimate. The average rate is defined as follows. \n\n    The average rate is a measure of the expected performance over a distribution of the channel estimation error, e.g., the distribution of \ud835\udc10, with determined estimate \ud835\udc10 <cit.>. \n    Mathematically, the average common and private rates for user k, \u2200 k\u2208\ud835\udca6 are, respectively, defined as R\u0305_c,k = \ud835\udd3c_\ud835\udc10|\ud835\udc10{R_c,k|\ud835\udc10} and R\u0305_p,k = \ud835\udd3c_\ud835\udc10|\ud835\udc10{R_p,k|\ud835\udc10}.\n \nWith Definition 1, we can connect the ergodic rates \ud835\udd3c_\ud835\udc10{R_c,k}, \ud835\udd3c_\ud835\udc10{R_p,k} with average rates R\u0305_c,k, R\u0305_p,k as \n\n    \n    \ud835\udd3c_\ud835\udc10{R_c,k} = \ud835\udd3c_\ud835\udc10{\ud835\udd3c_\ud835\udc10|\ud835\udc10{R_c,k|\ud835\udc10}} = \ud835\udd3c_\ud835\udc10{R\u0305_c,k}, \n    \ud835\udd3c_\ud835\udc10{R_p,k} = \ud835\udd3c_\ud835\udc10{\ud835\udd3c_\ud835\udc10|\ud835\udc10{R_p,k|\ud835\udc10}} = \ud835\udd3c_\ud835\udc10{R\u0305_p,k},\n\n\nwhich indicate that ergodic rates can be characterized by the expectation of average rates over varied channel estimate \ud835\udc10. Accordingly, maximizing the ergodic sum-rate \ud835\udd3c_\ud835\udc10{\u2211_k R_k} with partial CSI is transformed into maximizing the average sum-rate for each \ud835\udc10, given by \u2211_kC\u0305_k + \u2211_kR\u0305_p,k, where C\u0305_k\u2208\u211d^+, \u2200 k\u2208\ud835\udca6_l referring to the common part of the average rate should satisfy \u2211_kC\u0305_k = min_\u2200 kR\u0305_c,k.\nTherefore, the average sum-rate maximization problem can be formulated as\n\n    \n    \n    max_{\ud835\udc0f,\ud835\udc1c\u0305},{\u03d5_l,\u2200 l}\u00a0\u00a0   \u2211_kC\u0305_k + \u2211_k R\u0305_p,k\n    s.t.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0   \u2211_l|\u03d5_l,m|^2 = 1, \u2200 m,\n       \ud835\udc0f_F^2 \u2264 P,\n       \u2211_k'C\u0305_k'\u2264R\u0305_c,k, \u2200 k,\n       \ud835\udc1c\u0305\u227d0,\n       R\u0305_k \u2265 R_th,k, \u2200 k,\n\n\nwhere \u03d5_l=[\u03d5_l,1,\u2026,\u03d5_l,M]^T\u2208\u2102^M, \u2200 l\u2208\u2112, \ud835\udc1c\u0305 = [C\u0305_1,\u2026,C\u0305_K]^T\u2208\u211d^K, and R_th,k\u2208\u211d^+ is the threshold rate for user k, \u2200 k\u2208\ud835\udca6, to guarantee the QoS.\nProblem (<ref>) is a challenging stochastic optimization. One reliable solution is to 1) transform problem (<ref>) into a deterministic one based on SAA <cit.>, and to 2) deal with the deterministic problem by well-known WMMSE-rate relationship <cit.>. Details of the two-step transformation will be illustrated in Section <ref>. \n\n\n\n\n \u00a7.\u00a7 Two-Step Transformation\n\n\n\n\n  \u00a7.\u00a7.\u00a7 SAA\n To facilitate SAA, we give the following definition.\n\n    Given an estimate \ud835\udc10_k of user k, a sample of i.i.d. channel realizations is constructed based on the set \n    \u211a_k = {\ud835\udc10^a_k = \ud835\udc10_k + \ud835\udc10_k^a | \ud835\udc10_k, \u2200 a\u2208\ud835\udc9c = {1,\u2026,A}},\n    where \ud835\udc10_k^a follows the CSCG distribution, i.e., \ud835\uddcf\ud835\uddbe\ud835\uddbc(\ud835\udc10_k^a)\u223c\ud835\udc9e\ud835\udca9(0,\u03b4_k^2\ud835\udc08_MN), \u2200 a\u2208\ud835\udc9c. Then the SAA of average common and private rates are, respectively, defined as R_c,k = 1/A\u2211_aR_c,k^a and R_p,k = 1/A\u2211_aR_p,k^a, \u2200 k\u2208\ud835\udca6[In the following illustrations, notations with superscript \u201c(\u00b7)^a\u201d have the same expressions as that without \u201c(\u00b7)^a\u201d, except that the term \ud835\udc10_k is replaced by \ud835\udc10_k^a, \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112, \u2200 a\u2208\ud835\udc9c.].\n\nThe SAA of average rate in Definition 2 is a tight approximation of the average rate with sufficient large number of samples, i.e., lim_A\u2192\u221eR_c,k = R\u0305_c,k, lim_A\u2192\u221eR_p,k = R\u0305_p,k, \u2200 k\u2208\ud835\udca6, which motivates us to approximate the stochastic problem (<ref>) into a deterministic problem\n\n    max_{\ud835\udc0f,\ud835\udc1c\u0305},{\u03d5_l,\u2200 l}\u00a0\u00a0   \u2211_kC\u0305_k + \u2211_kR_p,k\n    s.t.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0   (<ref>), (<ref>), (<ref>), \n       \u2211_k'C\u0305_k'\u2264R_c,k, \u2200 k,\n       C\u0305_k + R_p,k\u2265 R_th,k, \u2200 k.\n\nProblem (<ref>) can be further transformed into a more tractable form based on the following step. \n\n\n\n  \u00a7.\u00a7.\u00a7 WMMSE-Rate Relationship\n\nLet s_c,k^a = g_c,k^ay_k^a be the estimate of s_c with equalizer g_c,k^a from user k covered by sector l, \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112, \u2200 a\u2208\ud835\udc9c. \nThe estimate of s_p,k with equalizer g_p,k^a after removing the common stream is given by s_p,k^a = g_p,k^a(y_k^a - \u03d5_l^T(\ud835\udc10_k^a)^H\ud835\udc29_cs_c), \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112, \u2200 a\u2208\ud835\udc9c.\nDefine MSE functions regarding the common and private streams for user k covered by sector l at channel sample a as \u03f5_c,k^a = \ud835\udd3c{|s_c,k^a - s_c|^2} = |g_c,k^a|^2\u03c4_c,k^a -2{g_c,k^a\u03d5_l^T(\ud835\udc10_k^a)^H\ud835\udc29_c} + 1 and \u03f5_p,k^a = \ud835\udd3c{|s_p,k^a - s_p,k|^2} = |g_p,k^a|^2\u03c4_p,k^a -2{g_p,k^a\u03d5_l^T(\ud835\udc10_k^a)^H\ud835\udc29_p,k} + 1.\nThen optimal unconstrained equalizers for the common stream and private streams which achieve minimum MSEs are given by \n\n    (g_c,k^a)^\u22c6 = \ud835\udc29_c^H\ud835\udc10_k^a\u03d5_l^*/\u03c4_c,k^a, \u00a0\n            (g_p,k^a)^\u22c6 = \ud835\udc29_p,k^H\ud835\udc10_k^a\u03d5_l^*/\u03c4_p,k^a,\n \nand the corresponding minimum MSEs are (\u03f5_o,k^a)^\u22c6 = min_g_o,k^a\u03f5_o,k^a = (\u03c4_o,k^a)^-1\u03b9_o,k^a = (1 + \u03b3_o,k^a)^-1, \u2200 o\u2208{c,p}, \u2200 k\u2208\ud835\udca6, \u2200 a\u2208\ud835\udc9c.\nIntroducing weights \u03bb_c,k^a\u2208\u211d^+ and \u03bb_p,k^a\u2208\u211d^+ associating common and private MSEs for user k, we can establish the WMMSE-rate relationship R_o,k^a = max_\u03bb_o,k^alog_2\u03bb_o,k^a - \u03bb_o,k^a(\u03f5_o,k^a)^\u22c6 + 1, \u2200 o\u2208{c,p}, \u2200 k\u2208\ud835\udca6, \u2200 a\u2208\ud835\udc9c,\nwhere the maximum of the right-hand problem is achieved when weights \u03bb_c,k and \u03bb_p,k satisfy\n\n    (\u03bb_c,k^a)^\u22c6 = 1 + \u03b3_c,k^a, \u00a0(\u03bb_p,k^a)^\u22c6 = 1 + \u03b3_p,k^a.\n\n\nBased on the above derivations, we reformulate problem (<ref>) as a three-block optimization \n\n    \n    \n    max_{\u03bb_o^a, \ud835\udc20_o^a,\u2200 a,\u2200 o}\n    {\ud835\udc0f,\ud835\udc1c\u0305}, {\u03d5_l,\u2200 l}   \u2211_k(C\u0305_k\n            + 1/A\u2211_a(log_2\u03bb_p,k^a-\u03bb_p,k^a\u03f5_p,k^a))\n    s.t.\u00a0\u00a0\u00a0\u00a0\u00a0   (<ref>), (<ref>), (<ref>),\n       1/A\u2211_a(log_2\u03bb_c,k^a-\u03bb_c,k^a\u03f5_c,k^a+1)\n       \u00a0\u00a0\u00a0\u00a0\u00a0\u2265\u2211_k'C\u0305_k', \u2200 k,\n       C\u0305_k + 1/A\u2211_a(log_2\u03bb_p,k^a-\u03bb_p,k^a\u03f5_p,k^a+1)\n       \u00a0\u00a0\u00a0\u00a0\u00a0\u2265 R_th,k, \u2200 k,\n\n\nwhere \u03bb_o^a = [\u03bb_o,1^a,\u2026,\u03bb_o,K^a]^T and \ud835\udc20_o^a = [g_o,1^a,\u2026,g_o,K^a]^T, \u2200 o\u2208{c,p}, \u2200 a\u2208\ud835\udc9c. \nAlthough problem (<ref>) is not convex in a joint design manner, the sub-problem regarding one block with fixing other blocks is either convex, such as the design of blocks {\u03bb_o^a, \ud835\udc20_o^a,\u2200 o, \u2200 a} and {\ud835\udc0f,\ud835\udc1c\u0305}, or more tractable, such as the design of block {\u03d5_l,\u2200 l\u2208\u2112}, than directly dealing with the original objective. Specifically, the unconstrained solution to block {\u03bb_o^a, \ud835\udc20_o^a, \u2200 o, \u2200 a} with fixed two other blocks have been given in equations (<ref>) and (<ref>), respectively. Solutions to blocks {\ud835\udc0f,\ud835\udc1c\u0305} and {\u03d5_l,\u2200 l} will be respectively given in Sections <ref> and <ref>.\n\n\n\n \u00a7.\u00a7 Solution to Block {\ud835\udc0f,\ud835\udc1c\u0305}\n\n\nWith fixed equalizers, weights, and BD-RIS matrix, the sub-problem regarding block {\ud835\udc0f,\ud835\udc1c\u0305} is given by \n\n    min_{\ud835\udc0f,\ud835\udc1c\u0305}\u00a0\u00a0   1/A\u2211_k\u2211_a\u03bb_p,k^a\u03f5_p,k^a - \u2211_kC\u0305_k\n    s.t.\u00a0\u00a0\u00a0   (<ref>), (<ref>), (<ref>), (<ref>).\n\nWith the following definitions \n\n    \n    \u03c8_c,k^a    = \u03bb_c,k^a(g_c,k^a)^*\ud835\udc10_k^a\u03d5_l^*, \u00a0\u03c8_p,k^a = \u03bb_p,k^a(g_p,k^a)^*\ud835\udc10_k^a\u03d5_l^*,\n    \n            \u03a8_c,k^a    = \u03c8_c,k^a(\u03c8_c,k^a)^H/\u03bb_c,k^a, \u00a0\u03a8_p,k^a = \u03c8_p,k^a(\u03c8_p,k^a)^H/\u03bb_p,k^a,\n    \n            \u03be_c,k^a    = log_2\u03bb_c,k^a - \u03bb_c,k^a|g_c,k^a|^2\u03c3_k^2 - \u03bb_c,k^a + 1,\n    \u03be_p,k^a    = log_2\u03bb_p,k^a - \u03bb_p,k^a|g_p,k^a|^2\u03c3_k^2 - \u03bb_p,k^a + 1,\n\n\nand their averages over A samples, i.e., \u03c8_c,k = 1/A\u2211_a\u03c8_c,k^a, \u03c8_p,k = 1/A\u2211_a\u03c8_p,k^a, \u03a8_c,k = 1/A\u2211_a\u03a8_c,k^a, \u03a8_p,k = 1/A\u2211_a\u03a8_p,k^a, \u03be_c,k = 1/A\u2211_a\u03be_c,k^a, \u03be_p,k = 1/A\u2211_a\u03be_p,k, \u2200 k\u2208\ud835\udca6,\nproblem (<ref>) can be rewritten as \n\n    \n    \n    min_\ud835\udc1c\u0300,\ud835\udc29_c,{\ud835\udc29_p,k,\u2200 k}   \u2211_k(C\u0300_k+\u2211_k'\ud835\udc29_p,k'^H\u03a8_p,k\ud835\udc29_p,k'\n       \u00a0\u00a0\u00a0\u00a0- 2{\u03c8_p,k^H\ud835\udc29_p,k})\n    s.t.\u00a0\u00a0\u00a0\u00a0   \ud835\udc29_c_2^2 + \u2211_k\ud835\udc29_p,k_2^2 \u2264 P,\n       \ud835\udc29_c^H\u03a8_c,k\ud835\udc29_c + \u2211_k'\ud835\udc29_p,k'^H\u03a8_c,k\ud835\udc29_p,k'\n       \u00a0-2{\u03c8_c,k^H\ud835\udc29_c}\u2264\u2211_k'C\u0300_k + \u03be_c,k,\u2200 k,\n       \ud835\udc1c\u0300\u227c0,\n       \u2211_k'\ud835\udc29_p,k'^H\u03a8_p,k\ud835\udc29_p,k'- 2{\u03c8_p,k^H\ud835\udc29_p,k}\n       \u00a0 + C\u0300_k\u2264\u03be_p,k - R_th,k, \u2200 k,\n\n\nwhere \ud835\udc1c\u0300 = [C\u0300_1,\u2026,C\u0300_K]^T = -\ud835\udc1c\u0305. Problem (<ref>) is a convex second-order cone program (SOCP) and can be solved by interior-point methods with computational complexity bounded by \ud835\udcaa((NK+N+K)^3.5) <cit.>.\n\n\n\n \u00a7.\u00a7 Solution to Block {\u03d5_l,\u2200 l}\n\n\nRecall that (<ref>) in problem (<ref>) is the QoS constraint, which can be guaranteed in the design of block {\ud835\udc0f,\ud835\udc1c\u0305}. To simplify the design of block {\u03d5_l,\u2200 l}, we temporarily ignore constraint (<ref>). Then, without the QoS constraint (<ref>), we can remove the term \ud835\udc1c\u0305 by putting constraint (<ref>) into the objective. In this case, the original problem (<ref>) can be simplified as the following form\n\n    \n    \n    max_{\u03bb_o^a, \ud835\udc20_o^a, \u2200 o, \u2200 a}\n    \ud835\udc0f, {\u03d5_l,\u2200 l}   {min_\u2200 k1/A\u2211_a(log_2\u03bb_c,k^a-\u03bb_c,k^a\u03f5_c,k^a+1)}\n       +1/A\u2211_k\u2211_a(log_2\u03bb_p,k^a-\u03bb_p,k^a\u03f5_p,k^a)\n    s.t.\u00a0\u00a0\u00a0\u00a0\u00a0   (<ref>), (<ref>), (<ref>).\n\n\nWith given equalizers, weights, and the transmit precoder, the sub-problem regarding the multi-sector BD-RIS is \n\n    min_{\u03d5_l,\u2200 l}\u00a0   {max_\u2200 k1/A\u2211_a(\u03bb_c,k^a\u03f5_c,k^a-log_2\u03bb_c,k^a-1)}\n       + 1/A\u2211_a\u2211_k\u03bb_p,k^a\u03f5_p,k^a\n    s.t.\u00a0\u00a0\u00a0   \u2211_l|\u03d5_l,m|^2 = 1, \u2200 m.\n\nWith the following definitions\n\n    \n    \ud835\udc2f_c,k^a =    (\ud835\udc10_k^a)^T\ud835\udc29_c^*, \u00a0\u00a0\ud835\udc2f_p,k,k'^a = (\ud835\udc10_k^a)^T\ud835\udc29_p,k'^*, \n    \ud835\udc17_c,k^a =   \u03bb_c,k^a|g_c,k^a|^2\ud835\udc2f_c,k^a(\ud835\udc2f_c,k^a)^H \n       + \u03bb_c,k^a|g_c,k^a|^2\u2211_k'\ud835\udc2f_p,k,k'^a(\ud835\udc2f_p,k,k'^a)^H,\n    \ud835\udc17_p,k^a =   \u03bb_p,k^a|g_p,k^a|^2\u2211_k'\ud835\udc2f_p,k,k'^a(\ud835\udc2f_p,k,k'^a)^H,\n    \n            \ud835\udc31_c,k^a =   \u03bb_c,k^a(g_c,k^a)^*\ud835\udc2f_c,k^a,\u00a0\ud835\udc31_p,k^a = \u03bb_p,k^a(g_p,k^a)^*\ud835\udc2f_p,k,k^a,\n\n\nand their averages over A samples, i.e., \ud835\udc17_c,k = 1/A\u2211_a\ud835\udc17_c,k^a, \ud835\udc17_p,k = 1/A\u2211_a\ud835\udc17_p,k^a, \ud835\udc31_c,k = 1/A\u2211_a\ud835\udc31_c,k^a, \ud835\udc31_p,k = 1/A\u2211_a\ud835\udc31_p,k^a, \u2200 k\u2208\ud835\udca6, \nproblem (<ref>) can be rearranged as \n\n    min_{\u03d5_l,\u2200 l}\u00a0\u00a0   {max_\u2200 k(\u03d5_l^H\ud835\udc17_c,k\u03d5_l - 2{\u03d5_l^H\ud835\udc31_c,k} - \u03be_c,k)}\n       + \u2211_l(\u03d5_l^H\ud835\udc17\u0305_p,l\u03d5_l - 2{\u03d5_l^H\ud835\udc31\u0305_p,l})\n    s.t.\u00a0\u00a0\u00a0\u00a0\u00a0   \u2211_l|\u03d5_l,m|^2 = 1, \u2200 m,\n\nwhere \ud835\udc17\u0305_p,l = \u2211_k'\u2208\ud835\udca6_l\ud835\udc17_p,k' and \ud835\udc31\u0305_p,l = \u2211_k'\u2208\ud835\udca6_l\ud835\udc31_p,k', \u2200 l\u2208\u2112.\nWe observe from problem (<ref>) that the objective regarding each cell of the multi-sector BD-RIS is coupled with each other, while the constraints for different cells are independent of each other. This fact motivates us to successively design each cell while fixing the rest cells. Specifically, the design of one cell with fixed others will be given as follows.\n\nWe first formulate the sub-problem regarding cell m, \u2200 m\u2208\u2133, with fixed other cells as \n\n    min_\u03d5\u0305_m\u00a0\u00a0   {max_\u2200 k\u03bd_c,k,m|\u03d5_l,m|^2 - 2{\u03d5_l,m^*\u03c7_c,k,m} - \u03be_k,m_=f_c,k(\u03d5_l,m)}\n        + \u2211_l\u03bd_p,l,m|\u03d5_l,m|^2 - 2{\u03d5_l,m^*\u03c7_p,l,m}_=f_p,l(\u03d5_l,m)\n    s.t.\u00a0\u00a0\u00a0   \u03d5\u0305_m_2^2 = 1,\n\nwhere the fresh notations are respectively defined as \n\n    \n    \n    \u03bd_c,k,m   = [\ud835\udc17_c,k]_m,m, \u00a0\u03bd_p,l,m = [\ud835\udc17\u0305_p,l]_m,m,\n    \u03c7_c,k,m   = \u2211_n m[\ud835\udc17_c,k]_m,n\u03d5_l,n - [\ud835\udc31_c,k]_m,\n    \u03c7_p,l,m   = \u2211_n m[\ud835\udc17\u0305_p,l]_m,n\u03d5_l,n - [\ud835\udc31\u0305_p,l]_m,\n    \u03be_k,m   = \u03be_c,k - \u2211_n m\u2211_n' m[\ud835\udc17_c,k]_n,n'\u03d5_l,n^*\u03d5_l,n'\n       \u00a0\u00a0\u00a0 + 2{\u2211_n m\u03d5_l,n^*[\ud835\udc31_c,k]_n},\n\n\nand \u03d5\u0305_m = [\u03d5_1,m,\u2026,\u03d5_L,m], \u2200 m\u2208\u2133, \u2200 k\u2208\ud835\udca6_l, \u2200 l\u2208\u2112.\nProblem (<ref>) is a non-smooth optimization with a non-convex constraint. \nTo solve this problem, we 1) introduce the well-known LogSumExp (LSE) function to transform the non-smooth part of the objective function into a smooth form, and 2) adopt the manifold theory <cit.> to transform the constrained problem on the Euclidean space into an unconstrained optimization on the manifold space. Each of the two steps is described as follows. \n\n\n\nStep 1: LSE Approximation. To facilitate the LSE approximation, we give the following definition. \n\n   Given a set \ud835\udd3d = {f_c,k\u2208\u211d | \u2200 k\u2208\ud835\udca6}, an LSE function is defined as the logarithm of the sum of the exponentials of f_c,k, \u2200 k\u2208\ud835\udca6, i.e., log\u2211_kexp(f_c,k), which is a smooth approximation of the maximum max_\u2200 kf_c,k with a lower bound max_\u2200 kf_c,k and an upper bound max_\u2200 kf_c,k + log|\ud835\udca6|, i.e., max_\u2200 kf_c,k\u2264log\u2211_kexp(f_c,k)\u2264max_\u2200 kf_c,k + log|\ud835\udca6|.  \n\nWith Definition 3, we can obtain an approximation to the maximum max_\u2200 k f_c,k(\u03d5_l,m) in problem (<ref>), which has the following bounds \n\n    max_\u2200 k f_c,k(\u03d5_l,m)    (a)\u2264\u03b5log\u2211_kexp(f_c,k(\u03d5_l,m)/\u03b5)_=f\u0305(\u03d5\u0305_m)\n       (b)\u2264max_\u2200 k f_c,k(\u03d5_l,m) + \u03b5log|\ud835\udca6|,\n\nwhere (a) achieves its equality when |\ud835\udca6| = 1 and (b) achieves its equality when f_c,1(\u03d5_l,m) =\u2026= f_c,K(\u03d5_l,m), \u2200 k\u2208\ud835\udca6. f\u0305(\u03d5\u0305) is the LSE function of max_\u2200 kf_c,k(\u03d5_l,m) with \u03b5>0 a scalar to make the bounds tighter[Based on Definition 1, by replacing each f_c,k with f_c,k/\u03b5, \u2200 k\u2208\ud835\udca6, we have max_\u2200 kf_c,k/\u03b5\u2264log\u2211_kexp(f_c,k/\u03b5)\u2264max_\u2200 kf_c,k/\u03b5 + log|\ud835\udca6|. Multiplying by \u03b5 gives the inequality (<ref>).]. Based on (<ref>), problem (<ref>) can be approximated as \n\n    \u03d5\u0305_m^\u22c6 = min_\u03d5\u0305_m_2^2 = 1\u00a0\u2211_l f_p,l(\u03d5_l,m) + f\u0305(\u03d5\u0305_m)_=f(\u03d5\u0305_m).\n\nNow problem (<ref>) has a smooth objective function f(\u03d5\u0305_m) and only one constraint, which can be solved by the manifold method <cit.> as illustrated below. \n\n\nStep 2: Manifold Construction. \nWe give the following definition to construct the feasible region of problem (<ref>), i.e., \u03d5\u0305_m_2^2 = 1, as a manifold <cit.>, <cit.>. \n\n    An L-dimensional complex sphere manifold is defined as \ud835\udd44 = {\u03d5\u0305_m\u2208\u2102^1\u00d7 L: \u03d5\u0305_m_2 = 1}, where \u03d5\u0305_m is a point on the complex sphere manifold \ud835\udd44. \n    Given a point \u03d5\u0305_m on \ud835\udd44, a tangent vector refers to one possible moving direction of this point. The set of these tangent vectors regarding point \u03d5\u0305_m forms the tangent space, which is mathematically defined as \ud835\udd4b_\u03d5\u0305_m\ud835\udd44 = {\ud835\udc2e_m\u2208\u2102^1\u00d7 L: {\ud835\uddb3\ud835\uddcb(\u03d5\u0305_m^H\ud835\udc2e_m)} = 0}. \n    Among all these tangent vectors on \ud835\udd4b_\u03d5\u0305_m\ud835\udd44, Riemannian gradient is defined as the tangent vector with the steepest-descent direction of the objective function.\n\n\nWith Definition 4, we say \u03d5\u0305_m is a point on the complex sphere manifold \ud835\udd44, yielding problem (<ref>) an unconstrained optimization on \ud835\udd44, which can be solved by many classic algorithms with necessary projections. \nThe algorithm we use here to solve problem (<ref>) is the Riemannian conjugate gradient (RCG) algorithm <cit.>, which is a modified version of the well-known CG algorithm by changing the search space from the Euclidean space to a manifold.  \nMore details of the RCG algorithm is summarized in the Appendix.\n\nSummary: With solutions to each cell of the multi-sector BD-RIS, the procedure of the  successive design is straightforward and summarized in Algorithm <ref>. \nThe complexity of Algorithm <ref> is given by \ud835\udcaa(I_1L^1.5), where I_1 is the number of iterations of Algorithm <ref>.\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Algorithm and Analysis\n \n\n\n  \u00a7.\u00a7.\u00a7 Framework of the Algorithm\n \nThe above three blocks are updated in an iterative manner until convergence as summarized in Algorithm <ref>.\n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Initialization\n \nIn Algorithm <ref>, \u03d5_l, \u2200 l\u2208\u2112 are initialized as \u03d5_l^0 = 1/\u221a(L)[e^\u03c6_l,1,\u2026,e^\u03c6_l,M]^T, where \u03c6_l,m is randomly selected within the range [0,2\u03c0],  \u2200 l\u2208\u2112, \u2200 m\u2208\u2133. The transmit power allocated to the common streams is initialized as P_c = 0.7P, and thus that allocated to the private streams is P_p = 0.3P. Accordingly, the common precoder is initialized as \ud835\udc29_c = \u2211_a\u2211_k\ud835\udc10_k^a\u03d5_l^*, followed by a normalization \ud835\udc29_c^0 = \u221a(P_c)\ud835\udc29_c/\ud835\udc29_c_2. The private precoder is initialized as \ud835\udc29_p,k = \u2211_a\ud835\udc10_k^a\u03d5_l^*, followed by \ud835\udc29_p,k^0 = \u221a(P_p/K)\ud835\udc29_p,k/\ud835\udc29_p,k_2, \u2200 k\u2208\ud835\udca6.\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Complexity Analysis\n\nThe complexity of Algorithm <ref> mainly comes from the update of three blocks (steps 4-7). Specifically, updating block {\u03bb_o^a,\ud835\udc20_o^a, \u2200 o, \u2200 a} requires complexity \ud835\udcaa(MNKLA). Updating block {\ud835\udc0f,\ud835\udc1c\u0305} by solving SOCP has complexity \ud835\udcaa((NK+N+K)^3.5), while updating block {\u03d5_l,\u2200 l} by Algorithm <ref> requires \ud835\udcaa(I_1L^1.5). The overall complexity of Algorithm <ref> is thus \ud835\udcaa(I(NK+N+K)^3.5), where I is the number of iterations of Algorithm <ref> to achieve the convergence threshold. \n\n\n\n\n\u00a7 PERFORMANCE EVALUATION\n\n\n\nIn this section, we evaluate the performance of the proposed robust beamforming design for multi-sector BD-RIS aided RSMA under different CSI conditions. Particularly, we first illustrate the simulation settings. Then, we show convergence of the proposed algorithm. Finally, we evaluate the achievable ergodic sum-rate performance of multi-sector BD-RIS aided RSMA by analyzing the impact of the radiation pattern of BD-RIS antennas, CSI uncertainty, QoS threshold, and numbers of active/passive antennas. \n\n\n\n \u00a7.\u00a7 Simulation Setup\n\n\nThe perfect channels \ud835\udc10_k = \u221a(\u03b6_k^-1)\ud835\udc06\u0306^H\ud835\uddbd\ud835\uddc2\ud835\uddba\ud835\uddc0(\ud835\udc21\u0306_k), \u2200 k\u2208\ud835\udca6 are generated as a combination of small-scale fading and large-scale fading.\nSpecifically, the small-scale fading of transmitter-RIS and RIS-user channels is modeled as Rician fading, i.e.,\n\n    \n    \ud835\udc06\u0306   = \u221a(\u03ba/\u03ba + 1)\ud835\udc06\u0306^LoS + \u221a(1/\u03ba + 1)\ud835\udc06\u0306^NLoS, \n    \ud835\udc21\u0306_k    = \u221a(\u03ba_k/\u03ba_k + 1)\ud835\udc21\u0306_k^LoS + \u221a(1/\u03ba_k + 1)\ud835\udc21\u0306_k^NLoS, \u2200 k,\n\n\nwhere {\u03ba,\u03ba_k,\u2200 k} denotes the Rician factor, and channels with superscript \u201cLoS\u201d and \u201cNLoS\u201d, respectively, denote line-of-sight (LoS) and non-LoS (NLoS) channels.\n\u03b6_k is the path loss exponent measuring the large-scale fading. The large-scale fading components have different expressions when BD-RIS antennas have different radiation patterns. Here we consider two cases, that is each BD-RIS antenna has either idealized radiaton pattern or practical radiation pattern <cit.>, which are illustrated in Fig. <ref> from the top view, yielding the following path loss model:\n\n    \u03b6_k = \u03f1 (1-cos\u03c0/L)^2,    Idealized Pattern,\n    \u03f1/(\u03b1_L+1)^2(cos\u03b8_ITcos\u03b8_IU,k)^\u03b1_L,    Practical Pattern,\n\nwhere \u03f1 = 4^3\u03c0^4d_IT^\u03f5_ITd_IU,k^\u03f5_IU/\u03bb^4G_TG_U is calculated by transmiter-RIS distance d_IT, RIS-user distance d_IU,k, \u2200 k\u2208\ud835\udca6, path loss exponents[The value of the path loss exponent is usually chosen within the range [2,4] and depends on the small-scale fading conditions.] \u03f5_IT and \u03f5_IU, wavelength of transmit signal \u03bb, transmit antenna gain G_T and receive antenna gain G_R. In addition,  \u03b1_L is a parameter related to the beamwidth of the BD-RIS antennas, \u03b8_IT is the elevation angle between the transmit antenna and BD-RIS antenna, and \u03b8_IU,k is the elevation angle from the BD-RIS antenna to user k, \u2200 k\u2208\ud835\udca6.\nSectors of the multi-sector BD-RIS are modeled as M_x\u00d7 M_y = M uniform planar arrays and the transmitter is modeled as a uniform linear array with half-wavelength inter-antenna spacing. \nLocations among the transmitter, multi-sector BD-RIS, and users are shown in Fig. <ref>.\n\n\n\n\n\n\nThe channel estimation error for each channel realization \ud835\udc10_k is generalized such that \ud835\uddcf\ud835\uddbe\ud835\uddbc(\ud835\udc10\u0303_k)\u223c\ud835\udc9e\ud835\udca9(0,\u03b4_k^2\ud835\udc08_MN), where the channel estimation uncertainty \u03b4^2_k is set as \u03b4^2_k = \u03b6_k^-1\u03b4^2, \u2200 k\u2208\ud835\udca6 with a scalar \u03b4\u2208[0,1). Specifically, the value \u03b4 = 0 refers to the perfect CSI case.  \nFor each channel estimate \ud835\udc10_k = \ud835\udc10_k - \ud835\udc10_k, the a-th sample in the set (available at the transmitter) \u211a_k is given by \ud835\udc10^a_k = \ud835\udc10_k + \ud835\udc10_k^a, where \ud835\udc10_k^a follows the same error distribution, that is \ud835\uddcf\ud835\uddbe\ud835\uddbc(\ud835\udc10_k^a)\u223c\ud835\udc9e\ud835\udca9(0,\u03b4_k^2\ud835\udc08_MN),  \u2200 k\u2208\ud835\udca6, \u2200 a\u2208\ud835\udc9c.\nFor each channel realization, the precoder and BD-RIS are designed based on sets \u211a_k, \u2200 k\u2208\ud835\udca6 and the maximization of the average sum-rate as summarized in Algorithm <ref>, while the sum-rate is calculated based on the perfect instantaneous channel \ud835\udc10. \nThe ergodic sum-rate is plotted as an average of sum-rates for 50 perfect channel realizations. \nThe simulation settings, unless otherwise stated, are summarized in Table <ref>. \n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Convergence of the Algorithm\n\nThe convergence of Algorithm <ref> cannot be theoretically proved since the design of BD-RIS matrix block does not lead to a global optimal solution. Instead, we provide numerical results to show the proposed algorithm can converge within limited iterations.\nFig. <ref> plots the average sum-rate versus the number of iterations of Algorithm <ref>.\nWe can observe from Fig. <ref> that the proposed algorithm always converges within finite iterations regardless of simulation settings, such as channel conditions (perfect and imperfect CSI), the number of transmit antennas, and QoS requirements. \n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Impact of the Radiation Pattern of BD-RIS Antennas\n\nWe first evaluate the ergodic sum-rate of multi-sector BD-RIS aided RSMA when BD-RIS antennas have either idealized or practical radiation patterns in Fig. <ref>. For comparison, we add the performance of multi-sector BD-RIS assisted SDMA, which is achieved by switching off the common precoder at the transmitter[In this case, the multi-sector BD-RIS design with given precoder is performed by using the closed-form solution proposed in <cit.>.]. We have the following observations from Fig. <ref>. 1) With the same multiple access technique, the idealized radiation pattern scheme always outperforms the practical radiation pattern scheme, which is in accordance with the results in <cit.>. 2) Using the same radiation pattern for each BD-RIS antenna, the RSMA scheme always outperforms the SDMA scheme. 3) Under imperfect CSI conditions, the BD-RIS aided RSMA with practical radiation pattern of BD-RIS antennas outperforms the BD-RIS aided SDMA with idealized radiation pattern for BD-RIS antennas. \nThis phenomenon demonstrates the benefits of integrating RSMA and multi-sector BD-RIS in easing the requirements to antenna realizations and to channel estimation accuracy. \n\n\n\n\n\n \u00a7.\u00a7 Impact of CSI Uncertainty\n\n\nIn Fig. <ref>, we evaluate the impact of CSI uncertainty by plotting the ergodic sum-rate versus \u03b4 when each BD-RIS has an idealized radiation pattern. We observe from Fig. <ref> that the ergodic sum-rate for both RSMA and SDMA schemes decreases with increasing channel estimation errors. However, the multi-sector BD-RIS aided RSMA always outperforms multi-sector BD-RIS aided SDMA regardless of CSI conditions, which demonstrates the robustness of the integration of RSMA and multi-sector BD-RIS in wireless communications. \n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Impact of QoS Threshold\n\n\nThen, in Fig. <ref>, we show the impact of the QoS requirement for each user to the achievable ergodic sum-rate under different CSI conditions when each multi-sector BD-RIS antenna has an idealized radiation pattern. From Fig. <ref> we have the following observations. 1) The multi-sector BD-RIS aided RSMA always outperforms the SDMA scheme with various QoS thresholds and different CSI conditions. 2) The achievable ergodic sum-rate for both schemes decreases with the growth of the QoS requirement, which can be explained as follows. Since we focus on the sum-rate maximization problem, when the number of transmit antennas is smaller than the number of users (4 = N < K = 6), the weakest N-K users tend to be turned off. In this case, increasing the QoS requirement for all users violates the aim of maximizing sum-rate. \n3) The performance gap between the RSMA scheme and the SDMA scheme becomes larger with increasing QoS threshold for each user, and thus the RSMA scheme is able to achieve both higher sum-rate and better QoS than the SDMA case, e.g., the comparison between RSMA scheme with R_th = 0.5 and SDMA scheme with R_th = 0.1.  \nThis is because in RSMA scheme, the power allocated to the common precoders increases with the QoS requirement. \nThis phenomenon demonstrates that the common precoders play an increasingly important role to guarantee the fairness while achieving better sum-rate performance. \n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Impact of Numbers of Active and Passive Antennas\n\n\nIn Fig. <ref>, we plot the ergodic sum-rate versus the total number of antennas of the multi-sector BD-RIS under different CSI conditions when each BD-RIS antenna has an idealized radiation pattern. We observe from Fig. <ref> that the ergodic sum-rate of both RSMA and SDMA schemes grows with increasing number of BD-RIS antennas, and that the RSMA scheme always achieves better performance than the SDMA scheme. More importantly, to achieve the same sum-rate, the required number of passive antennas can be reduced compared to the SDMA scheme by adopting RSMA at the transmitter. \nFor example, in perfect CSI case, to achieve an ergodic sum-rate of 15 b/s/Hz, the required number of passive antennas can be reduced by 16%; in imperfect CSI case, to achieve an ergodic sum-rate of 13 b/s/Hz, the required number can be reduced by 14%. This observation highlights the benefit of synergizing BD-RIS and RSMA in saving on passive antennas, which is friendly to the hardware implementation of multi-sector BD-RIS. \n\n\n\nFinally, in Fig. <ref>, we plot the ergodic sum-rate versus the number of transmit antennas under different CSI conditions. \nSimilar conclusions that the RSMA scheme always outperforms the SDMA scheme can be obtained from Fig. <ref>. \nMore importantly, to achieve the same sum-rate, the required number of active antennas at the transmitter can also be reduced compared to the SDMA scheme when RSMA is adopted at the transmitter. For example, an 1-antenna RSMA-enabled transmittersupports the same sum-rate performance as an 2-antenna SDMA-enabled transmitter. \nSuch reduction of the number of transmit antennas demonstrates the benefit of synergizing BD-RIS and RSMA in reducing power consumption and cost, which leads to an energy efficiency gain.    \n\n\n\n\n\n\u00a7 CONCLUSION\n\n\n\nIn this work, we consider the integration of multi-sector BD-RIS and RSMA in a MU-MISO communication system. \nSpecifically, we assume a multi-sector BD-RIS and an RSMA-enabled transmitter. \nGiven that the channel estimation for RIS and BD-RIS aided scenarios is challenging, we model the channel estimation error when only partial/imperfect CSI is available at the transmitter. \n\nWith the multi-sector BD-RIS aided RSMA model and CSI uncertainty model, we propose a robust design to jointly optimize the transmit precoder and multi-sector BD-RIS for a MU-MISO system. Specifically, SAA and WMMSE-rate relationship are adopted to transform the stochastic problem into a more tractable deterministic multi-block problem. Regarding the design of the BD-RIS matrix block, we adopt the RCG algorithm after transforming the corresponding problem into a smooth optimization.\n\nFinally, we present simulation results, which demonstrate the performance enhancement of multi-sector BD-RIS aided RSMA compared to multi-sector BD-RIS aided SDMA with different radiation pattern of BD-RIS antennas and various parameter settings, such as CSI conditions and QoS threshold for users. \nMore importantly, with given sum-rate requirement, the numbers of active and passive antennas can be effectively reduced by synergizing RSMA with multi-sector BD-RIS. Such reduction of the number of antennas is beneficial for practical implementations. \n\n\n\n[The RCG Algorithm to Solve Problem (<ref>)]\nRecall that RCG is the modified version of the well-known CG, the key of which is to determine the descent direction of the objective function. \nIn RCG, the Riemannian gradient, which can be obtained from the Euclidean gradient, is required to calculate the descent direction. Therefore, we first calculate the Euclidean gradient of the objective function \n\n    f(\u03d5\u0305_m)    = \u2211_l f_p,l(\u03d5_l,m) + f\u0305(\u03d5\u0305_m)\n       = \u2211_l f_p,l(\u03d5_l,m) + \u03b5log\u2211_kexp(f_c,k(\u03d5_l,m)/\u03b5),\n \nwhich is given by\n\n    \n    \u25bf f(\u03d5\u0305_m)    = [\u2202 f(\u03d5\u0305_m)/\u2202\u03d5_1,m, \u2026, \u2202 f(\u03d5\u0305_m)/\u2202\u03d5_L,m]\n       = [\u25bf f_p,1(\u03d5_1,m) + \u2202f\u0305(\u03d5\u0305_m)/\u2202\u03d5_1,m,\n       \u00a0\u00a0\u00a0\u00a0\u00a0\u2026, \u25bf f_p,L(\u03d5_L,m) + \u2202f\u0305(\u03d5\u0305_m)/\u2202\u03d5_L,m],\n    \u25bf f_p,l(\u03d5_l,m)    = 2\u03bd_p,l,m\u03d5_l,m - 2\u03c7_p,l,m,\n    \u2202f\u0305(\u03d5\u0305_m)/\u2202\u03d5_l,m   = \u2211_k\u2208\ud835\udca6_lexp(f_c,k(\u03d5_l,m)/\u03b5)\u25bf f_c,k(\u03d5_l,m)/\u2211_k\u2208\ud835\udca6exp(f_c,k(\u03d5_l,m)/\u03b5), \n    \u25bf f_c,k(\u03d5_l,m)    = 2\u03bd_c,k,m\u03d5_l,m - 2\u03c7_c,k,m.\n\n\nThen, we obtain the Riemannian gradient, which projects the Euclidean gradient onto the tangent space, i.e., \u25bf_\ud835\udd44 f(\u03d5\u0305_m) = \ud835\uddaf\ud835\uddcb_\u03d5\u0305_m(\u25bf f(\u03d5\u0305_m)) = \u25bf f(\u03d5\u0305_m) - {\ud835\uddb3\ud835\uddcb(\u03d5\u0305_m^H\u25bf f(\u03d5\u0305_m))\u03d5\u0305_m}. \nThe descent direction at the v-th iteration of RCG is thus\n\n    \u03b2^v = -\u25bf_\ud835\udd44 f(\u03d5\u0305_m^v) + \u03bc^v\ud835\uddaf\ud835\uddcb_\u03d5\u0305_m(\u03b2^v-1),\n \nwhere \u03bc^v is the Riemannian version of the Polak-Ribi\u00e8re formula <cit.>, which is given by\n\n    \u03bc^v = \u27e8\u25bf_\ud835\udd44 f(\u03d5\u0305_m^v), \u25bf_\ud835\udd44 f(\u03d5\u0305_m^v)-\ud835\uddaf\ud835\uddcb_\u03d5\u0305_m^v(\u25bf_\ud835\udd44 f(\u03d5\u0305_m^v-1))\u27e9/\u27e8\u25bf_\ud835\udd44 f(\u03d5\u0305_m^v-1), \u25bf_\ud835\udd44 f(\u03d5\u0305_m^v-1)\u27e9,\n\nwhere \u27e8\ud835\udc00,\ud835\udc01\u27e9 = {\ud835\uddb3\ud835\uddcb(\ud835\udc00^H\ud835\udc01)}. \nThe v+1-th update is given by a retraction function mapping point \u03d5\u0305_m^v on the tangent space \ud835\udd4b_\u03d5\u0305_m^v\ud835\udd44 to the manifold \ud835\udd44, that is <cit.>\n\n    \u03d5\u0305_m^v+1 = \u03d5\u0305_m^v + \u03c2^v\u03b2^v/\u03d5\u0305_m^v + \u03c2^v\u03b2^v_2,\n\nwhere \u03c2^v is the stepsize obtained by Armijo backtracking <cit.>.\n\nTo summarize, problem (<ref>) can be solved by iteratively updating the stepsize, the retraction, the Polak-Ribi\u00e8re formula, and the search direction as illustrated above, until convergence.  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIEEEtran\n\n\n"}