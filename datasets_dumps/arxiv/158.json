{"entry_id": "http://arxiv.org/abs/2303.07136v1", "published": "20230313140507", "title": "Comparison of confidence regions for quantum state tomography", "authors": ["Jessica O. de Almeida", "Matthias Kleinmann", "Gael Sent\u00eds"], "primary_category": "quant-ph", "categories": ["quant-ph"], "text": "\n\n\n\nICFO - Institut de Ci\u00e8ncies Fot\u00f2niques, The Barcelona Institute of Science and Technology, 08860 Castelldefels (Barcelona), Spain.\n\nNaturwissenschaftlich-Technische Fakult\u00e4t, Universit\u00e4t Siegen, Walter-Flex-Stra\u00dfe 3, 57068 Siegen, Germany\n\nF\u00edsica Te\u00f3rica: Informaci\u00f3 i Fen\u00f2mens Qu\u00e1ntics, Departament de Fisica, Universitat Aut\u00f2noma de Barcelona, E-08193, Bellaterra (Barcelona), Spain\n\n\nThe quantum state associated to an unknown experimental preparation procedure can be determined by performing quantum state tomography. If the statistical uncertainty in the data dominates over other experimental errors, then a tomographic reconstruction procedure must produce a statistical confidence region in state space rather than a single state. Naturally, the size of this region decreases when increasing the number of samples, but it also depends critically on the construction method of the region. We compare recent methods for constructing confidence regions as well as a reference method based on a Gaussian approximation. For the comparison, we propose an operational measure with the finding, that there is a significant difference between methods, but which method is preferable can depend on the details of the state preparation scenario.\n\n\nComparison of confidence regions for quantum state tomography\n    Gael Sent\u00eds\n    March 30, 2023\n=============================================================\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n\n\nQuantum state tomography is a complete and agnostic procedure to characterize an unknown quantum state from experimental data <cit.>. As such, it plays a central role as a quality control subroutine in quantum experiments or quantum technological applications, allowing us to assess the outcome of a state-preparation procedure and verify that a targeted quantum state is indeed being produced.\n\nThe outcome of a tomographic procedure is usually a point estimate \u03c1\u0302 of the true density matrix \u03c1, along with some sort of error bar. A common approach is to use maximum likelihood estimation <cit.> to construct \u03c1\u0302, and report the variance of the point estimate obtained by bootstrapping <cit.>. However, this approach accounts only for the statistical fluctuations of the maximum likelihood point estimate, which can turn out to be smaller than its actual bias <cit.>. More importantly, such error bars tell us nothing about how far off is \u03c1\u0302 from the true state \u03c1. To answer this question rigorously in statistical terms, confidence regions (CRs) are constructed: these are regions in the space of Hermitian operators that intersect the state space and contain the true state with high probability. Generally speaking, we can regard a confidence region C as a function from the experimental data to the space of Hermitian operators fulfilling\n\n\n    [ \u03c1\u2208 C(data)|data\u223c\u03c1 ] \u2265 1-\u03b4\n\n\nfor every state \u03c1, where 1-\u03b4 is the confidence level.\n\nThere exist diverse methods to construct CRs from tomographic data in the literature <cit.>. Methods may differ on the theoretical grounds they are built on, in turn leading to differences in their tightness, speed of convergence, and computational cost. However, these features are not always conveyed in a way that allows for a direct comparison between different methods, particularly in the practically relevant regime of finite data. As a result, the natural question of which CR should one choose to report the results of a tomographic experiment has, to this day, no straightforward answer. The main objective of this work is to close this gap by developing an operational benchmark under which methods to build CRs can be fairly contrasted.\n\nGenerically, for the same dataset and confidence level, the smaller a CR is, the better. To illustrate why this simple criterion is problematic to evaluate in practice, let us have a first look at two recent results in Refs.\u00a0<cit.>, which we will further analyze in this work. A usual way of expressing Eq.\u00a0(<ref>) (see, for example, Refs.\u00a0<cit.>) is\n\n\n    [ \u22c6\u03c1\u0302-\u03c1\u2264\u03f5 ] \u2265 f(\u03f5,d,N),\n\n\nwhere d is the dimension of the quantum system, N is the number of tomographic experiments, and the form of f varies with the norm \u22c6 (usual examples are trace, Hilbert-Schmidt, or operator norm) and with the estimator used for \u03c1\u0302. In terms of speed of convergence with the number of samples taken, Gu\u0163\u0103 et al. <cit.> report an almost optimal scaling of f with respect to N, d, but fixed \u03f5 (showing an improvement over Ref.\u00a0<cit.> for the same norms). In contrast, Wang et al. <cit.> provide an explicit construction of the function C as a polytope, and the convergence of the region with N is implicit, preventing a direct comparison to Eq.\u00a0(<ref>) based only on the region size. For finite N, neither of these works consider the tightness of the CRs quantitatively. Then the question arises, how can we judge whether one of these CRs is smaller than the other in a given experiment? First, the regions have incomparable shapes (a sphere in a norm and a polytope), hence a parametric comparison is not possible. One could look at volumes to disregard shape, but the relevant volume to consider would be that of the intersection of the CRs with the state space, hence we would require numerical estimates (for example, by Monte Carlo sampling) that are not scalable beyond relatively small systems and will be in any case dependent on the chosen integration measure. Finally, we would encounter the same problems when comparing CRs of the form in Eq.\u00a0(<ref>) if these are expressed in different norms. In this case, we could use inequalities between norms to transform one into another, but we would always be underestimating or overestimating one of the regions.\n\nIn this work we propose to assess the power of a CR by how well can it distinguish a pair of states. More precisely, we simulate a tomography experiment on two given target states, and find, for a given confidence level, the minimum number of repetitions necessary for their corresponding CRs (built with the same method) to stop intersecting, which ensures that the two states can be distinguished with the chosen confidence. While, clearly, this is not the most efficient test to discriminate the two states, as a test it has several desirable features: It has an operational meaning, it is agnostic to the specifics of a CR, and it is computationally efficient. We use this test to carry out a comparative analysis of recent CRs in paradigmatic scenarios involving pairs of states of up to 4 qubits, and we focus on performing local Pauli-basis measurements as our tomographically complete set of measurements for its practical relevance and widespread use. Our results show that there is no single CR that outperforms the others in all cases. The performance of the CRs varies not only with the dimension of the system, but also with the pair of states selected for the distinguishability test. An example of this is the finding that while a CR may allow to distinguish a pure state from the completely mixed state with the fewest number of samples, it underperforms when distinguishing two pure states that are very close to each other. This notwithstanding, our analysis allows us to make some general recommendations.\n\nWe apply our comparative analysis to the recent results in Ref.\u00a0<cit.> and Ref.\u00a0<cit.>. In addition, we provide a method to build CRs  based on a Gaussian approximation, which will serve us as a reference. While there are other works on CRs in the literature, the rationale behind focusing on these ones is the following.\nFirst, we concentrate on unconditional tomography, leaving aside Bayesian methods that require assuming a prior distribution over the possible states (and result in credibility regions instead of CRs) <cit.>, methods that assume rank-deficient states like compressed sensing <cit.>, permutationally invariant states <cit.>, or matrix product states <cit.>, and heuristic methods like self-guided tomography <cit.> or CRs based on likelihood ratios <cit.>. Second, we select those works which have not yet been clearly superseded (for example, Ref.\u00a0<cit.> improves on Ref.\u00a0<cit.>, and Ref.\u00a0<cit.> on Ref.\u00a0<cit.>). Finally, it is worth mentioning with Ref.\u00a0<cit.> another recent comparative study on quantum state tomography, which evaluates a different aspect in tomography schemes, namely the typical error (distance between the estimate and the true state) of various point estimators.\n\nThe paper is structured as follows. In Section\u00a0<ref> we summarize the CRs considered in our study. Section\u00a0<ref> details the methodology used for comparing between CRs in a series of simulated tomography experiments, and includes the results of our testing. We end the paper with a short discussion in Section\u00a0<ref>. In the Appendix, we include details on the derivation of the Gaussian CRs as well as technical considerations about the simulations.\n\n\n\n\u00a7 METHODS FOR BUILDING CONFIDENCE REGIONS\n\n\nHere we summarize the results that we use for our comparative analysis. A common feature of all selected methods is that the CRs are built for the free least-squares estimator for \u03c1\u0302, see Appendix\u00a0<ref>. Importantly, this estimator is unbiased, although due to finite statistics in experiments it generally produces a non-physical density matrix. This is not necessarily problematic, in the sense that the associated CR will almost certainly have some overlap with the state space. CRs for physical (hence biased) estimators exist, for example, for projected least-squares <cit.> or other variants <cit.>, but they are derived from a CR for the free least squares estimator and thus do not improve over them. Hence, to treat all methods on equal footing, in this paper we restrict ourselves to free least squares. For easy referencing, we label the CRs used in our analysis as A, B, C_1, and C_2.\n\n\n\nThe first result we review is a non-asymptotic concentration bound for the operator-norm error of the free least-squares estimator. In Ref.\u00a0<cit.>, Gu\u0163\u01ce et al. show that the free least-squares estimator obeys\n\n\nConfidence region A\n\n    [ \u221e\u03c1\u0302-\u03c1\u2265\u03f5 ]\n    \u2264 R_d(\u03f5\u221a(N))\n\n\n\nwhere \u221eX is the operator norm of X, N is the total number of state preparations, and d is the dimension of the underlying Hilbert space. Hence, the CR is of the form in Eq.\u00a0(<ref>). One has\n\n\n    log R_d(\u03be)=-38\u03be^2 g(d)+log d,\n\n\nwhere the factor g(d) takes different forms depending on the chosen measurement scheme. For multiqubit states and local Pauli-basis measurements, we have g(d)= 3^-log_2 d.\n\n\n\nAnother method by Wang et al. <cit.> constructs a polytope-shaped region \u0393(f\u20d7) as a function of the empirical frequencies f\u20d7=(f_1,\u2026,f_M) of a single positive operator-valued measure (POVM), that is, positive semidefinite operators {E_i}_i=1^M obeying \u2211_i E_i =, applied on the state \u03c1, where f_i=n_i/N, n_i is the number of occurrences of outcome i, and N the total number of state preparations. The region \u0393(f\u20d7) obeys\n\n\nConfidence region B\n\n    [ \u03c1\u2209\u0393(f\u20d7) ]\u2264\u03b4.\n\n\n\nEach facet of the polytope is determined by the half-space\n\n\n    \u0393_i(f_i)=\u03c1 | (E_i \u03c1)\u2264 f_i+\u03f5_i ,\n\n\nwhere \u03f5_i is the positive root of\nD(f_i\u2016 f_i+\u03f5_i)=-log(\u03b4_i)/N,\nwith \u2211_i=1^M \u03b4_i = \u03b4, and D(x\u2016 y) = x log (x/y) + (1-x)log[(1-x)/(1-y)] is the relative binary entropy. Then, the CR is given by the intersection of all half-spaces, that is, \u0393(f\u20d7)=\u22c2_i \u0393(f_i). Because each half-space corresponds to an independent confidence interval for the frequency f_i, we are free to choose each individual confidence level by fixing \u03b4_i as long as they add up to the total confidence parameter \u03b4. This method thus allows us to shrink the CR along a preferred measurement direction at the expense of enlarging it in other ones, which adds versatility. For our comparative analysis, we make the uniform choice \u03b4_i=\u03b4/M.\n\n\n\nWe also provide bounds based on a Gaussian approximation. Here we make the approximation that the empirical frequencies f\u20d7 of the measurement outcomes are Gaussian distributed with mean p\u20d7(\u03c1) and a nonsingular covariance matrix \u03a3(\u03c1). Then we obtain the Gaussian CR defined by\n\n\nConfidence region C_1\n\n    [ 2\u03a3(\u03c1)^-1/2(f\u20d7-p\u20d7(\u03c1)) > \u03f5 ]=P_k(\u03f5^2),\n\n\n\nwhere P_k(x) is the survival function of the central \u03c7^2-distribution with k=(\u03a3) degrees of freedom, see Appendix\u00a0<ref> for details. Note that \u03a3(\u03c1) here scales with the number of samples. This CR is exact, but comes with the disadvantage that the region depends nonlinearly on \u03c1 through \u03a3. We can improve on this at the cost of getting a more relaxed bound, see Appendix\u00a0<ref>,\n\n\nConfidence region C_2\n\n    [ 2p\u20d7(\u03c1\u0302)-p\u20d7(\u03c1)\n             >\u03f5 ]\u2264 P_d^2-1(\u03c3^-2_max\u03f5^2),\n\n\n\nwith \u03c3^2_max the largest eigenvalue of \u03a3(\u03c1) across all states.  Note that the resulting CR forms an ellipsoid in the state space. For multinomial distributions, we have \u03c3^2_max=1/(2n), where n is the number of samples per measurement setting. For example, for local Pauli-basis measurements on a q-qubit state, we have 3^q distinct measurement settings, N=3^q n (see Appendix\u00a0<ref>).\n\n\n\n\u00a7 METHODOLOGY FOR COMPARING CRS AND RESULTS\n\n\nWe propose two universal tests to benchmark CRs irrespective of their specifications. The first test consists in computing the (1-\u03b4)-quantile of the distribution of the ratio\n\n\n    r=\u22c6\u2026/\u03f5(\u03b4)\n\n\nover several repetitions of the same tomography experiment with confidence level (1-\u03b4). The terms in r depend on the chosen CR, as they appear in [ \u22c6\u2026 > \u03f5(\u03b4) ] \u2264\u03b4 and note that the norm can be defined either in probability space or in the state space. This test quantifies the tightness of a CR in a scale-independent way. On the one hand, a value 100% for the (1-\u03b4)-quantile of r indicates that the region is exact, inasmuch as the probability of obtaining \u03c1\u0302 at a distance no more than \u03f5 from \u03c1 coincides with the confidence level, that is, the inequality in Eq.\u00a0(<ref>) is saturated. On the other hand, a small value of r tells us that the CR is unnecessarily large, since in (1-\u03b4)\u00d7 100% of the experiments \u03c1\u0302 is actually much closer to \u03c1 than the size of the region \u03f5.\n\n\n\nWe run simulations of tomography experiments on Haar-random pure states of up to 4 qubits. We simulate using N=60 000 samples and local Pauli-basis measurements, see Appendix\u00a0<ref>, and evaluate r for a confidence level of 1-\u03b4=99%. For Confidence Region\u00a0A, Confidence Region\u00a0C_1 and Confidence Region\u00a0C_2, and for each state considered, we determine the empirical (1-\u03b4)-quantile from 10 000 samples of the ratio r; the results are summarized in Table\u00a0<ref>. Note that, since \nConfidence Region\u00a0B is not norm-based, we do not run this test on it.\nWe observe that Confidence Region\u00a0C_1 is an exact region, which supports the validity of the Gaussian sampling assumption in our numerical experiments. For Confidence Region\u00a0A and C_2 we see that C_2 is tighter for the 1-qubit, 2-qubit and 3-qubit cases and then becomes looser for states of 4 qubits, whereas the tightness of Confidence Region\u00a0A is more stable with an increasing number of qubits. As we see next, these results correlate well with those of our second test, even though they quantify different features of the CRs.\n\n\n\nThe second test we devise is aimed at quantifying the distinguishability power of CRs. Choosing two distinct target states over which we perform tomography, we ask the question of how many samples N are required so that their respective CRs do not contain a common state. At this point we can distinguish the two states with confidence 1-\u03b4 based on the CRs, see Figure\u00a0<ref>. In this way we can attach a number to a CR and a given pair of states which is indirectly related to the size of the region. This test thus allows us to rank CRs according to an operationally well defined task and independently of their specifications.\n\nWe run this test with Confidence Region\u00a0A, B, and C_2 for two types of pairs of states of up to 4 qubits: pairs comprised by a pure state and the completely mixed state, and pairs of two pure states relatively close to each other, with fidelity \u27e8\u03d5_1|\u03d5_2|\u27e9^2= 0.63. The specific states are detailed in Appendix\u00a0<ref>, and we fix the confidence level to 1-\u03b4=90%.\nImportantly, the value of N at which the CRs stop intersecting is a stochastic variable, \nsince it directly depends on the estimate \u03c1\u0302 where the regions are centered and thus on the data obtained in each tomography experiment. For increasing values of N, we look at the frequency of finding an intersection over many repetitions (3000 for q=1,2; 1000 for q=3 and 500 for q=4). We also note that testing whether two regions share a common state can be computed efficiently via a convex optimization program, see Appendix\u00a0<ref>. This is the case with the exception of Confidence Region\u00a0C_1 since this region depends nonlinearly on the true state through \u03a3(\u03c1)^-1/2, and for this reason we do not include it in this test.\n\nIn Figure\u00a0<ref> we show the frequency that the CRs of the two target states contain a common state, for each of the three CRs considered. Each plot corresponds to a different pair of target states of one and two qubits. For the case of one-qubit states, Confidence Region\u00a0C_2 performs best in this test, closely followed by Confidence Region\u00a0B, regardless of whether we try to distinguish a pure state versus the completely mixed state or two pure states close to each other, whereas Confidence Region\u00a0A requires roughly a factor of two more state preparations. For two-qubit states we observe an interesting phenomenon: Confidence Region\u00a0A distinguishes a Bell state from the identity with the least number of state preparations and Confidence Region\u00a0C_2 has almost the same performance, but it becomes notably more inefficient when distinguishing between a Bell state and the same state with a slight local rotation applied (with fidelity 0.63), for which case Confidence Region\u00a0C_2 is again the best one. An important remark is that the states selected for the test are not aligned with any measurement direction, in order to represent a generic case of state tomography. Particularly for one-qubit states, if the state would point in the x,y or z direction, we find that Confidence Region\u00a0B slightly outperforms Confidence Region\u00a0C_2. This is due to the facets of the polytope \u0393(f\u20d7) being perpendicular to the measurement directions by design.\n\nWe show the results of the intersection test for pairs of 3-qubit and 4-qubit states in Figure\u00a0<ref>. Here we observe a clear advantage of Confidence Region\u00a0A in all cases. This is consistent with the results of Ref.\u00a0<cit.>. Indeed, the derivation of Confidence Region\u00a0A is based on the observation that \u03c1\u0302 can be seen as a sum of N random matrices and the subsequent application of a matrix concentration inequality, which becomes sharper as N increases (which is necessary for a larger number of qubits). Also, the ranking between the analyzed CRs is maintained throughout the studied 3-qubit and 4-qubit cases, with Confidence Region\u00a0C_2 in a second position and Confidence Region\u00a0B requiring the largest number of state preparations.\n\n\n\n\n\n\n\n\u00a7 DISCUSSION\n\n\nWe have proposed and tested two methods to benchmark confidence regions for quantum state tomography. One of them, based on the distinguishability power of a given confidence region construction, is operationally defined and applicable to any such construction regardless of its shape, specifications, and whether the region is defined in probability space or in state space. In addition, we proposed a second method which determines how tight a given region is. These new metrics allow us to compare existing (and future) methods to build confidence regions that were until now not directly comparable. Thus, we provide a robust tool to help in deciding which confidence region to report in any state tomography experiment.\n\nOur numerical experiments show that this choice should depend on the dimension of the system at hand and the goal for which tomography is used. We see this variability as a reflection of the diverse techniques used to derive confidence regions. For general purposes, the method by Gu\u0163\u01ce et al. <cit.> appears to be a safe choice, particularly for large systems, while in special cases involving 1-qubit and 2-qubit states, one may consider using the method of Wang et al. <cit.> or a Gaussian approximation as in Confidence Region\u00a0C_2. In addition, Confidence Region\u00a0C_2 has also been found to be useful in deriving optimal tests for detecting properties of the measured state directly from the tomographic data, without going through the intermediate step of computing a point estimate of the density matrix. An example of this is a proposal for the experimental detection of bound entanglement <cit.>.\n\nWith this work, we argue that unconditional full quantum state tomography is almost settled as a research topic. A point estimate of the unknown state obtained by linear inversion equipped with a confidence region is computationally inexpensive and should suffice for any purpose where tomography is needed. As for which confidence region is best to use, as we have seen, it depends. There may still be room for improvement in light of our (1-\u03b4)-quantile tests, since, for example, for the method of Gu\u0163\u01ce et al. we observe it is only around 40%. This means there could be an even tighter construction, although this seemingly suboptimal slackness does not have a great effect on our intersection tests.\n\n\nWe thank Richard Kueng, Maciej Lewenstein, and Michael Skotiniotis for the helpful discussions.\nThis work was supported by\nERC (Advanced Grant NOQIA and Consolidator Grant 683107/TempoQ);\nMinisterio de Ciencia y Innovation Agencia Estatal de Investigaciones (PGC2018-097027-B-I00/10.13039/501100011033, CEX2019-000910-S/10.13039/ 501100011033, Plan National FIDEUA PID2019-106901GB-I00, FPI, QUANTERA MAQS PCI2019-111828-2, QUANTERA DYNAMITE PCI2022-132919, Proyectos de I+D+I \u201cRetos Colaboraci\u00f3n\u201d QUSPIN RTC2019-007196-7,\nPID2019-107609GB-I00); \nMICIIN with funding from European Union NextGenerationEU(PRTR-C17.I1) and by Generalitat de Catalunya;\nFundaci\u00f3 Cellex;\nFundaci\u00f3 Mir-Puig;\nGeneralitat de Catalunya (European Social Fund FEDER and CERCA program, AGAUR Grant No. 2021 SGR 01452, QuantumCAT U16-011424, \nQuantumCAT 001-P-001644 \nco-funded by ERDF Operational Program of Catalonia 2014-2020);\nBarcelona Supercomputing Center MareNostrum (FI-2022-1-0042);\nEU Horizon 2020 FET-OPEN OPTOlogic (Grant No 899794);\nEU Horizon Europe Program (Grant Agreement 101080086 \u2013 NeQST), National Science Centre, Poland (Symfonia Grant No. 2016/20/W/ST4/00314); ICFO Internal \u201cQuantumGaudi\u201d project;\nEuropean Union's Horizon 2020 research and innovation program under the Marie-Sk\u0142odowska-Curie grant agreement No 101029393 (STREDCH) and No 847648 (\u201cLa Caixa\u201d Junior Leaders fellowships ID100010434: LCF/BQ/PI19/11690013, LCF/BQ/PI20/11760031, LCF/BQ/PR20/11770012, LCF/BQ/PR21/11840013);\nDeutsche Forschungsgemeinschaft (DFG, German Research Foundation, project numbers 447948357 and 440958198);\nSino-German Center for Research Promotion (Project M-0294);\nGerman Ministry of Education and Research (Project QuKuK, BMBF Grant No. 16KIS1618K).\nViews and opinions expressed in this work are, however, those of the author(s) only and do not necessarily reflect those of the European Union, European Climate, Infrastructure and Environment Executive Agency (CINEA), nor any other granting authority. Neither the European Union nor any granting authority can be held responsible for them.\n\n\n\n\n\n\n\n\n\u00a7 CONFIDENCE REGION FOR NORMAL-DISTRIBUTED TOMOGRAPHIC DATA\n\n\nHere we provide the proofs for Confidence Region\u00a0C_1 and Confidence Region\u00a0C_2. For that, we write f\u20d7 for the collection of the empirical frequencies and assume that f\u20d7 is normal distributed with mean p\u20d7(\u03c1) and covariance matrix \u03a3(\u03c1), where \u03c1 is the state on which the tomography is performed. Statistically dependent entries are eliminated from p\u20d7 and f\u20d7\u2014for example for a multinomial distribution, \u2211_i p_i=1 and hence we remove one entry from p\u20d7. Then \u03a3(\u03c1) is nondegenerate, except for a subset of states which has measure zero, and hence is irrelevant.\n\nWe observe that\n\n\n    \u0394\u20d7_\u03c1 = \u03a3(\u03c1)^-1/2 [ p\u20d7(\u03c1)-f\u20d7 ]\n\n\nis normal distributed with mean 0\u20d7 and covariance matrix . Consequently 2\u0394\u20d7_\u03c1^2 is distributed according to the central \u03c7^2(k)-distribution with k=(\u03a3) degrees of freedom and survival function [ 2\u0394\u20d7_\u03c1^2 > y ]=P_k(y). This already yields Confidence Region\u00a0C_1 via\n\n\n    [ 2\u0394\u20d7_\u03c1 > \u03f5 ] =  P_k(\u03f5^2).\n\n\nWe mention that for a multinomial distribution and n samples one has\n\n    (\u0394\u20d7_\u03c1)^2= n \u2211_i [ p_i(\u03c1)-f_i ]^2/p_i(\u03c1),\n\nwhere the sum includes the element that had been omitted from p\u20d7 and f\u20d7 in order to make \u03a3(\u03c1) nondegenerate.\n\nFor Confidence Region\u00a0C_2 we consider M(\u03c1-\u03c1')=p\u20d7(\u03c1)-p\u20d7(\u03c1') as linear map M on the space of zero-trace Hermitian matrices, which we consider as a real vector space of dimension d^2-1. We write M^+ for the pseudo-inverse of M and P is a map onto \u211d^d^2-1 with P=PMM^+ and M=P^TPM. Note that P can can be constructed by orthogonalizing the row vectors of M. We use now the free least-squares estimate\n\n\n    \u03c1\u0302=_X2p\u20d7(X)-f\u20d7^2 | X=X^\u2020 and (X)=1\n\n\nwhere the result is not required to be positive semidefinite. We have \u03c1\u0302=M^+f\u20d7 and \u03c1=M^+p\u20d7(\u03c1). It follows that PM(\u03c1\u0302-\u03c1)=PMM^+[f\u20d7-p\u20d7(\u03c1)]=P[f\u20d7-p\u20d7(\u03c1)] has mean 0\u20d7 and covariance \u03a3'(\u03c1)=P\u03a3(\u03c1)P^T. Note that \u03a3'(\u03c1) is nonsingular (even if \u03a3(\u03c1) is degenerate) because M is injective and has dimensions (d^2-1)\u00d7(d^2-1). Therefore we have\n\n\n    [ 2\u03a3'(\u03c1)^-1/2P(p\u20d7(\u03c1\u0302)-p\u20d7(\u03c1)) >\u03f5 ] = P_d^2-1(\u03f5^2)\n\n\nThe main advantage of both confidence regions derived so far is that they do not contain any approximations up to the assumption of a normal distribution. Hence they are optimal in this respect. However, they do not have a simple shape because they depend in a nonlinear way on \u03c1 via \u03a3(\u03c1). For this reason we replace \u03a3(\u03c1) by \u03c3_max^2 with \u03c3^2_max the largest eigenvalue of the covariance matrix over all states \u03c1. Using P^TP[p\u20d7(\u03c1\u0302)-p\u20d7(\u03c1)]= p\u20d7(\u03c1\u0302)-p\u20d7(\u03c1), this gives us Confidence Region\u00a0C_2 via\n\n\n    [ 2p\u20d7(\u03c1\u0302)-p\u20d7(\u03c1)\n             >\u03f5 ]\u2264 P_d^2-1(\u03c3^-2_max\u03f5^2).\n\n\nWe mention that the spectral decomposition of \u03f5  (M^TM)^-1/2 yields the semiaxes of the confidence ellipsoid in the state space.\n\nWe can relax Confidence Region\u00a0C_2 even further. For that we let \u03bc be the smallest (nonzero) singular value of M. Since M is injective, it follows that 2M(\u03c1-\u03c1\u0302)\u2265\u03bc2\u03c1\u0302-\u03c1. This gives us an additional CR defined by\n\n\n    [ 2\u03c1-\u03c1\u0302> \u03f5 ]\n      \u2264 P_d^2-1(\u03bc^2 \u03c3_max^-2\u03f5^2).\n\n\nAlthough this bound has a very similar structure to Confidence Region\u00a0A, it cannot be expected to yield a good CR. This can be understood geometrically, because we approximated the previous CR, which gave us an ellipsoid, by simply fitting a sphere around it with the radius of the largest half-axis.\n\n\n\n\u00a7 LOCAL PAULI-BASIS MEASUREMENTS FOR QUANTUM STATE TOMOGRAPHY\n\n\nIn this appendix we provide specifications for computing the CRs analyzed in the main text when choosing local Pauli-basis measurements as a tomographically complete set of measurements.\n\nGenerically, a measurement on a d-dimensional quantum state \u03c1 can be described by a POVM, that is, as \nM positive semi-definite matrices E_1,\u2026,E_M, each with dimension d\u00d7 d, such that \u2211_i E_i=. Each measurement of \u03c1 results in a corresponding outcome and the probability of observing outcome i=1,\u2026,M is given by p_i=( E_i \u03c1 ). This probability can be estimated based on the outcome frequency when measuring many copies of \u03c1. The frequency corresponding to outcome i after n repetitions of the measurement E_1,\u2026,E_M is\n\n    f_i= n_i/n    for  i=1,\u2026,M  ,\n\nand we have f_i\u2192 p_i in the limit n\u2192\u221e.\n\n\n\n \u00a7.\u00a7 Local Pauli-basis measurements\n\n\nWe now particularize this generic POVM for state tomography with local Pauli-basis measurements. For one qubit, measuring in the three Pauli bases can be viewed as a single six-outcome POVM, whose elements correspond to the eigenstates of each Pauli matrix \u03c3_j, j=x,y,z. Each POVM element has two labels, the direction j and the two possible outcomes along that direction, +1 and -1. Therefore, we  write E_j,\u00b1=(\u00b1\u03c3_j)/2=w_j,\u00b1. When each measurement \u03c3_j is performed n times, the frequency vector corresponding to the six-outcome POVM has components f_j,\u00b1=n_j,\u00b1/(3n).\n\nGeneralizing the tomography scheme for q qubits, the dimension of the system is d=2^q, and there are 3^q Pauli measurement settings m\u20d7=(m_1,\u2026,m_q)\u2208x,y,z^q, each with d possible outcomes o\u20d7 = (o_1,\u2026,o_q), where o_j\u2208\u00b1 1. This tomography scheme can also be written as a single POVM, whose elements are now specified by the measurement setting m\u20d7 and the outcome o\u20d7, as\n\n\n    E_m\u20d7,o\u20d7 = 3^-q\u2297_j=1^q w_m_j,o_j.\n\n\nIf each measurement setting m\u20d7 is performed n times, we obtain for the single POVM the frequencies f_m\u20d7,o\u20d7 = n_m\u20d7,o\u20d7/(3^q   n) where the total number of samples is N=3^q n.\n\nAt this point we note that, formally, there is no difference between measuring each combination of Pauli matrices m\u20d7 separately as 2^q-outcome projective measurement and considering the single POVM E_m\u20d7,o\u20d7 with 6^q outcomes. However, in the finite data regime there is a potential difference when it comes to the covariance matrix of the data. Indeed, when considering a single POVM there is only one frequency that is dependent of the others, by the normalization \u2211_m\u20d7,o\u20d7 f_m\u20d7,o\u20d7=1. If, instead, we consider applying the Pauli measurements specified by each m\u20d7 independently and aggregating the data at a later stage, we have now 3^q dependent frequencies, since now \u2211_o\u20d7 f_m\u20d7,o\u20d7 = 1. This is relevant when computing the covariance matrix \u03a3(\u03c1) that appears in Confidence Region\u00a0C_1: if we do not eliminate frequencies corresponding to the trivial outcomes from f\u20d7, \u03a3(\u03c1) will not have a well defined inverse. Moreover, as we saw in Appendix\u00a0<ref>, discarding these outcomes results in a tighter CR. When detailing how to compute Confidence Region\u00a0A and Confidence Region\u00a0B for local Pauli-basis measurements, we use the single-POVM formulation to follow the original references <cit.> and <cit.> closer. We switch to the individual measurement settings m\u20d7 when discussing our bound Confidence Region\u00a0C_2 (<ref>).\n\n\n\n \u00a7.\u00a7 Adaptations for the Confidence Regions\n\n\n\n\n\n  \nGeneralized Bloch representation.\nIt is convenient for our computations to write the density matrix in the generalized Bloch representation. For the tuple of 4^q matrices \u03bc\u20d7=2^-q/2(,\u03c3_x,\u03c3_y,\u03c3_z)^\u2297 q, any Hermitian matrix can be written as X = x\u20d7\u00b7\u03bc\u20d7 with x\u20d7\u2208\u211d^4^q . Due to the choice of the normalization, we have (XY)=x\u20d7\u00b7y\u20d7 for X=x\u20d7\u00b7\u03bc\u20d7 and Y=y\u20d7\u00b7\u03bc\u20d7.\n\n\n\n  \nFree last-squares estimator.\nThe free least-squares estimator in state tomography is the solution to the least-squares problem that seeks to minimize the distance between the frequencies and the probabilities, see also Eq.\u00a0(<ref>),\n\n\n    \u03c1\u0302=_X\u2211_i ( f_i- ( E_i X ))^2 | X=X^\u2020 and (X)=1 .\n\n\nNote that the optimization is performed over all Hermitian matrices with unit trace and hence the resulting estimate \u03c1\u0302, in general, will fail to be positive semidefinite. For local Pauli-basis measurements, where f\u20d7 has 6^q entries, this problem has an analytical solution <cit.>. In our definitions, the frequencies have the form f_m\u20d7,o\u20d7= n_m\u20d7, o\u20d7/(3^q n), and the free least-squares estimate is given by\n\n\n    \u03c1\u0302=\u2211_m\u20d7,o\u20d7f_m\u20d7,o\u20d7\u2297_j=1^q (3w_m_j,o_j -).\n\n\nWe use this explicit solution when evaluating Confidence Region\u00a0A.\n\n\n\n  \nConfidence Region C_1 and C_2.\nAs indicated in Appendix\u00a0<ref>, when considering Confidence Region\u00a0C_1 and Confidence Region\u00a0C_2, we assume that each measurement setting m\u20d7 is measured independently n times, yielding frequencies f_m\u20d7,o\u20d7=n_m\u20d7,o\u20d7/n with \u2211_o\u20d7 f_m\u20d7,o\u20d7 = 1. Therefore, there is one statistically dependent frequency per measurement setting m\u20d7, which we can compute from the remaining frequencies of the same setting. We thus omit the 3^q dependent frequencies to avoid having a singular covariance matrix, which reduces the dimension of the data f\u20d7 to 3^q(2^q-1) components.\n\n\n\n\u00a7 INTERSECTION OF CONFIDENCE REGIONS VIA CONVEX OPTIMIZATION\n\n\nGiven two regions of the types A, B, or C_2, we can determine whether they have a non-empty intersection via convex optimization, see, for example, Ref.\u00a0<cit.>. In our numerical experiments we use the Splitting Conic Solver SCS <cit.> for convex-cone optimization with the Python programming language.\n\n\n\n  \nIntersection for Confidence Region\u00a0A.\nWe have two CRs, R_1 and R_2, for two tomography experiments on the states \u03c1_1 and \u03c1_2, and corresponding free least-squares estimates \u03c1\u0302_1 and \u03c1\u0302_2. Confidence Region\u00a0A for confidence level 1-\u03b4 is given by all states \u03c1 obeying\n\n\n    \u221e\u03c1-\u03c1\u0302_i\u2264\u03f5(\u03b4),\n\n\nwith \u03f5(\u03b4)=N^-1/2R_2^q^-1(\u03b4)=\u221a(3^q log(2^q/\u03b4) 8/(3N)) and N the total number of samples. We can run the following semidefinite program to test for the existence of a state \u03c1\u2208 R_1 \u2229 R_2:\n\n\n    find       \u03c1\n    such that       \u03c1\u2265 0,  (\u03c1)=1,\n       -\u03f5(\u03b4) \u2264\u03c1-\u03c1\u0302_i \u2264\u03f5(\u03b4)     for  i=1,2.\n\n\nIf the above program does not find a feasible solution, we conclude that the intersection R_1\u2229 R_2 is either empty or does not contain physical states.\n\n\n\n  \nIntersection for Confidence Region\u00a0C_2.\nFor Confidence Region\u00a0C_2 we proceed analogously, where here the region with confidence level 1-\u03b4 is given by all states \u03c1 satisfying\n\n\n    2p\u20d7(\u03c1)-p\u20d7(\u03c1\u0302)^2 \u2264\u03f5^2(\u03b4),\n\n\nwith \u03f5(\u03b4)^2 = P_d^2-1^-1(1-\u03b4)/(2n) and n the number of samples per measurement setting, hence N=3^qn. A state \u03c1 in the intersection can be found by the quadratic convex program\n\n\n    find       \u03c1\n    such that       \u03c1\u2265 0,  (\u03c1)=1,\n       \u2211_j=1^3^q(2^q-1)((E_j\u03c1)-(E_j\u03c1\u0302_i))^2\u2264\u03f5_i^2(\u03b4)\n         for  i=1,2.\n\n\n\n  \nIntersection of Confidence Region\u00a0B.\nFor regions of type B, we need to find a state in the intersection \u0393^(1)\u2229\u0393^(2) of the two confidence polytopes.\nThe facets of either polytope \u0393^(i), i=1,2, are given by the linear inequalities\n\n\n    (E_j\u03c1)\u2264 f_j^(i)+\u03f5^(i)_j(\u03b4),\n         for  j=1,\u2026 6^q,\n\n\nwhere \u03f5_j^(i) is determined by the root of the equation\n\n\n    D(f_j^(i)\u2016 f_j^(i)+\u03f5_j^(i) )=-1/Nlog (\u03b4_j^(i)),\n\n\nN is the total number of samples, and we make the uniform choice \u03b4_j^(i)=6^-q\u03b4.\nFinding a state \u03c1\u2208\u0393^(1)\u2229\u0393^(2) hence corresponds to the semidefinite program\n\n    find       \u03c1\n    such that       \u03c1\u2265 0,  (\u03c1)=1,\n       (E_j\u03c1) \u2264 f_j^(i)+\u03f5_j^(i)(\u03b4)\n         for  i=1,2  and  j=1,\u2026,6^q.\n\n\n\n\n\n\u00a7 TARGET QUANTUM STATES\n\n\nThe target quantum states used for evaluating the empirical (1-\u03b4)-quantiles of different CRs in Table\u00a0<ref> are uniformly random pure states sampled according to the Haar measure.\n\nFor the tests of intersecting CRs in Figs.\u00a0<ref> and <ref>, we choose pairs of target states \u03c1^(1), \u03c1^(2). The first state is always chosen as \u03c1^(1) = \u03a8_ target, where |\u03a8_ target\u27e9 is obtained by applying uniformly random rigid local unitaries on exemplary pure states of up to 4 qubits, i.e.,\n\n\n    |\u03a8_ target\u27e9 = U^\u2297 q|\u03c8_q\u27e9 ,\n\n\nwhere q=1,2,3,4 is the number of qubits of |\u03c8_q\u27e9, U\u223c\u03bc_ Haar(SU(2)), and\n\n\n    |\u03c8_1\u27e9   = 1/\u221a(2)(|0\u27e9+|1\u27e9)  ,\n    |\u03c8_2\u27e9   = |\u03a6^+\u27e9 = 1/\u221a(2)(|00\u27e9+|11\u27e9)  ,\n    |\u03c8_3\u27e9   = | GHZ\u27e9 = 1/\u221a(2)(|000\u27e9+|111\u27e9)  ,\n    |\u03c8_4\u27e9   = 1/2( |0000\u27e9+|0011\u27e9+|1100\u27e9-|1111\u27e9)  .\n\n\nThen, we distinguish two cases: the second state is either the maximally mixed state \u03c1^(2) = 2^-q, or another pure state defined as \u03c1^(2) = U_z(\u03b8)^\u2297 q\u03c1^(1) (U_z(\u03b8)^\u2297 q)^\u2020, where U_z(\u03b8) = exp(i \u03b8\u03c3_z), and \u03b8 is chosen such that (\u03c1^(1)\u03c1^(2)) = 0.63.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}