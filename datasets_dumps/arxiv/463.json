{"entry_id": "http://arxiv.org/abs/2303.06671v1", "published": "20230312142549", "title": "An extension of the approximate component mode synthesis method to the heterogeneous Helmholtz equation", "authors": ["Elena Giammatteo", "Alexander Heinlein", "Matthias Schlottbom"], "primary_category": "math.NA", "categories": ["math.NA", "cs.NA"], "text": "\n\n Superconductivity studied by solving ab initio low-energy effective Hamiltonians for carrier doped CaCuO_2, Bi_2Sr_2CuO_6, Bi_2Sr_2CaCu_2O_8, and  HgBa_2CuO_4\n    \nMichael Thobias Schmid^1 0000-0003-2724-0621, \nJean-Baptiste Mor\u00e9e^1 0000-0002-0710-9880, \nYouhei Yamaji^2 0000-0002-4055-8792, \nand Masatoshi Imada^1,3,4 0000-0002-5511-2056\n\n    March 30, 2023\n====================================================================================================================================================================================\n\n\n\n\nAn extension of the approximate component mode synthesis (ACMS) method to the heterogeneous Helmholtz equation is proposed. The ACMS method has originally been introduced by Hetmaniuk and Lehoucq as a multiscale method to solve elliptic partial differential equations. The ACMS method uses a domain decomposition to separate the numerical approximation by splitting the variational problem into two independent parts: local Helmholtz problems and a global interface problem. While the former are naturally local and decoupled such that they can be easily solved in parallel, the latter requires the construction of suitable local basis functions relying on local eigenmodes and suitable extensions. We carry out a full error analysis of this approach focusing on the case where the domain decomposition is kept fixed, but the number of eigenfunctions is increased. This complements related results for elliptic problems where the focus is on the refinement of the domain decomposition instead. The theoretical results in this work are supported by numerical experiments verifying algebraic convergence for the interface problems. In certain, practically relevant cases, even exponential convergence for the local Helmholtz problems can be achieved without oversampling.\n\n\n\n\tMultiscale method, approximate component mode synthesis (ACMS), Helmholtz equation, heterogeneous media, high-frequency\n\n\n\n65N12, \n65N30, \n65N35, \n65N55  \n\n\n\n\n\u00a7 INTRODUCTION\n \n\nIn this paper, we propose and analyze a multiscale method for the heterogeneous Helmholtz equation\n\n-div(a \u2207u) - \u03ba^2 u    = f         in  \u03a9, \n\n a \u2202_n u - i \u03c9\u03b2u    =g          on  \u0393_R, \n\n u   =0         on  \u0393_D,\n \n\nin a plane region \u03a9\u2282^2. The boundary of \u03a9 is decomposed into sets \u0393_D and \u0393_R modeling Dirichlet boundary conditions or impedance boundary conditions described by the function g, respectively. The real-valued function \u03b2 is related to transmission and reflection of the wave described by u.\n\nMaterial properties of the background medium occupying \u03a9 are described by the coefficient functions a and c. \nDenoting the positive angular frequency as \u03c9, the wavenumber is given by \u03ba=\u03c9c, and any interior sources are modeled by the function f.\nHeterogeneous Helmholtz equations have many applications, such as modeling the propagation of light in photonic crystals, where u is related to either the transverse-electric or  the transverse-magnetic field\u00a0<cit.>, or seismic imaging\u00a0<cit.>.\n\n\n\n \u00a7.\u00a7 Literature overview\n\n\nNumerical simulations of the Helmholtz equation are challenging due to the highly oscillatory behavior of the solution, in particular, in the case of a high wavenumber \u03ba. The differential operator in the equation is indefinite, which may lead to stability issues for standard discretization approaches such as the classical finite element method (FEM). \nGenerally, convergence can only be achieved under the scale resolution condition, that is, if the mesh size h is scaled with the wavenumber O(1\u03ba). This pre-asympotic behavior is also known as pollution effect\u00a0<cit.>. \nIn order to reduce this effect, higher-order methods can be employed: in particular, for the hp-FEM, quasi-optimality has been proved in <cit.> under the conditions that the polynomial degree p is at least O(log\u03ba) and that \u03ba hp is sufficiently small.\nIn <cit.>, similar results have been achieved for the heterogeneous Helmholtz equation with piecewise smooth coefficients; however, to the authors' knowledge, no theory for rough coefficients \n\nis available yet. \n\nMultiscale discretization approaches can be very efficient for problems with heterogeneous or non-smooth coefficients, especially if the variations are on a much smaller scale than the size of the computational domain. Indeed, while classical higher-order finite element methods need to resolve the fine-scale variations, requiring a large number of degrees of freedom, multiscale methods are typically defined on a coarser grid, resulting in significantly smaller systems. \n\n\n\n\n\n\nIn recent years, many multiscale discretization methods have been developed and applied to the heterogeneous Helmholtz equation.\n\nThe localized orthogonal decomposition (LOD) method, introduced in\u00a0<cit.>, has successfully been applied to heterogeneous Helmholtz problems with high wavenumbers\u00a0<cit.>, achieving exponential convergence.\n\n\n\nMore recently, even super-exponential convergence could be shown for a variant of the LOD method in\u00a0<cit.>. \nExponential convergence for highly oscillatory heterogeneous Helmholtz equations has also been obtained  in\u00a0<cit.>, for a multiscale discretization inspired by the multiscale FEM (MsFEM) <cit.>;\nsee also, e.g.,\u00a0<cit.> for an overview on MsFEM. Moreover, nearly exponential error decay \n\nhas been achieved in\u00a0<cit.>, using similar ideas as in the multiscale generalized finite element method (Ms-GFEM), first described in \u00a0<cit.>. \n\nAll the aforementioned approaches rely on local oversampling. \nFurthermore, in the multiscale framework, numerical homogenization techniques have been extended to Helmholtz problems: for instance, in\u00a0<cit.>, quasi-optimality is obtained for the heterogeneous multiscale method (HMM)\u00a0<cit.>, which relies on the local periodicity of the media, and in <cit.>, exponential convergence is achieved through homogenization techniques developed in a variational setting.\n\nIn domain decomposition methods, related discretizations are also often used as coarse spaces to construct preconditioners which are robust with respect to heterogeneous coefficients;\nsee, e.g., <cit.> for applications to scalar elliptic problems or\u00a0<cit.> for linear elasticity problems.\n\nFor the application to heterogeneous Helmholtz problems, see, for instance,\u00a0<cit.>.\nLet us also refer to <cit.> for an optimized parallel implementation of a multifrontal solver that employs nested dissection based domain decomposition with matrix compression techniques; see <cit.> for a recent work in the context of elliptic equations. Finally, multigrid methods for the heterogeneous Helmholtz problem have been analyzed; see, e.g., <cit.>.\n\n\nIn this work, we consider an extension of the approximate component mode synthesis (ACMS) method to Helmholtz problems. The ACMS method has been introduced by Hetmaniuk and Lehoucq in\u00a0<cit.> as a multiscale discretization for scalar elliptic problems with heterogeneous coefficient functions. \nIt is based on the early component mode synthesis (CMS) method\u00a0<cit.>, which uses a decomposition of the global approximation space into independent local subspaces and an interface space. The basis functions are defined as eigenmodes of corresponding generalized eigenvalue problems. The global support of the interface basis functions comes at a high computational cost in the construction as well as a dense matrix structure of the interface problem. Hence, the practicability and potential for parallelization of CMS method are rather limited.\n\nTherefore, the ACMS method was introduced in order to improve the CMS approach: instead of global interface modes, functions with local support are employed.\n\n\n\n\n\nThe basis functions incorporate heterogeneities of the model problem; notably, besides edge modes, this framework uses vertex basis functions of MsFEM\u00a0<cit.> type. \n\nSince the ACMS discretization uses problem-specific shape functions with local support, it can therefore be considered a special finite element method (SFEM); cf.\u00a0<cit.>.\nIn contrast to other multiscale approaches, such as those previously mentioned\u00a0<cit.>, the ACMS method is based on a non-overlapping domain decomposition and does not use local oversampling. This makes the method very efficient but generally does not yield exponential convergence.\n\nThe ACMS method has been further investigated in\u00a0<cit.>, where a priori error bounds and an a posteriori error indicator for the method have been derived, and in\u00a0<cit.>, where a parallel implementation in PETSc based on the finite element tearing and interconnecting dual primal (FETI-DP) domain decomposition method as the parallel solver is presented. \nMore recently, a robust spectral coarse space for Schwarz domain decomposition methods based on the ACMS discretization has been introduced in\u00a0<cit.>; further related works on CMS and ACMS methods include\u00a0<cit.>. \nMoreover, to the authors' best knowledge, preliminary but unpublished work on the extension of the ACMS method to wave problems has been carried out by Hetmaniuk and Johnson in the early 2010s. \n\nAs a multiscale discretization, the ACMS method seems to be well suited for approximating heterogeneous Helmholtz problems. As we will discuss in this work, similar basis functions than in the elliptic case are suitable for the Helmholtz case as well, because the eigenmodes of the Helmholtz and the Laplacian operator are the same. \n\n\n\n\n \u00a7.\u00a7 Our contribution and outline\n\n\nIn this paper, we extend\n\nthe ACMS method to heterogeneous Helmholtz problems. In doing so, we slightly modify the construction of the edge modes and the extension operator. At the same time, we adapt the method to Robin boundary conditions, which are necessary for the definition of many real world-oriented Helmholtz problems. \nMoreover, in contrast to <cit.> where the number of subdomains in the domain decomposition is increased to obtain convergence, we perform a complementary error analysis focusing on fixing the domain decomposition and increasing the number of (edge) eigenmodes for tackling the local heterogeneities. \nWhile the error analysis for the local sub-problems, for which we obtain similar a posteriori error bounds as in <cit.> is rather simple, the error analysis for the interface problem is more sophisticated.\nThe analysis is based on the abstract framework of <cit.>, and relies in particular on the smallness of the so-called adjoint approximability constant; see <ref> and, in particular, <ref> below. \nWe show that, upon using sufficiently many (edge) eigenmodes, the adjoint approximability constant can be made arbitrarily small. Tracing the results of <cit.> allows to further obtain wavenumber explicit bounds.\nFinally, we present a detailed numerical study of the method using a flexible implementation that, unlike in the numerical results for the ACMS method shown in previous works, also allows for unstructured meshes and domain decompositions. \n\nThe paper is structured as follows: we introduce the necessary preliminaries for defining and analyzing the ACMS method for Helmholtz problems in\u00a0<ref>. In particular, we show the variational formulation of the Helmholtz equation, recall the well-posedness results of <cit.>, and illustrate the underlying domain decomposition and function spaces of the ACMS discretization. \nThen, in <ref>, we present our new variant of the ACMS method for Helmholtz problems along with some theoretical properties. The error analysis of the ACMS method is carried out in <ref>.\n\nFinally, we describe our numerical results in\u00a0<ref> and conclude with some final remarks.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 PRELIMINARIES\n \nIn the following, we introduce the functional analytic setting and recall well-posedness results for the heterogeneous Helmholtz equation. Furthermore, we introduce the domain decomposition used in the ACMS method.\n\n\n\n \u00a7.\u00a7 Variational formulation of the Helmholtz equation\n\nWe denote by L^2(\u03a9) the Lebesgue space of square-integrable functions v:\u03a9\u2192 with inner product\n\n    (u,v)_\u03a9 = \u222b_\u03a9 u v dx  ,\n\nand by H^1(\u03a9) the usual Sobolev space of functions with square-integrable weak derivatives.\nCorresponding notation is used for other measurable sets besides \u03a9. Furthermore, we indicate by \u2282 H^1(\u03a9) functions with vanishing trace on \u0393_D\u2282\u2202\u03a9. \nLet us introduce the sesquilinear forms ,: \u00d7\u2192 defined by\n\n    (u,v)   =\u222b_\u03a9 a \u2207 u \u00b7\u2207v dx  ,\n    (u,v)   =(u,v) - (\u03ba^2 u,v)_\u03a9-i (\u03c9\u03b2 u,v)_\u0393_R .\n\nThen the weak form of the Helmholtz problem\u00a0<ref> and its adjoint are\n\n    Find  u \u2208:   (u,v) = F(v),   for all  v \u2208, \n        \n       Find  z \u2208:   (v,z) = G(v),   for all  v \u2208.\n\nHere, F:\u2192 and G:\u2192, defined by\n\n    F(v)    = (f,v)_\u03a9 + (g,v)_\u0393_R,\n        \n        \n    \n        G(v)    = (v,f)_\u03a9+(v,g)_\u0393_R,\n\nare antilinear and linear functionals on , respectively.\n\n\n\n \u00a7.\u00a7 Well-posedness of the Helmholtz equation\n\nWe recall the well-posed-ness theory for the Helmholtz equation presented in <cit.>. Thus, we deem the following assumptions valid throughout the paper without explicitly mentioning it.\n\n\t(i) \u03a9\u2282^2 is a connected polygonal domain with piecewise C^2 boundary with convex angles, see <cit.>). Its boundary can be decomposed as \u2202\u03a9=\u0393_R\u222a\u0393_D into relatively open disjoint subsets \u0393_R,\n\t\t\u0393_D\u2282\u2202\u03a9.\n\n\t(ii) The source terms satisfy f \u2208 L^2(\u03a9) and g\u2208 H^12(\u0393_R).\n\t\t\n\n\t(iii) The coefficient functions a,c \u2208 L^\u221e(\u03a9) are uniformly positive, i.e., a_min\u2264 a(x) \u2264  a_max and c_min\u2264 c(x) \u2264 c_max for a.e. x\u2208\u03a9, where a_min, c_min, a_max, c_max are positive constants.\n\t\t\n\n\t(iv) \u03b2\u2208 L^\u221e (\u0393_R) with meas( supp(\u03b2))>0 and either 0< \u03b2 or \u03b2 <0.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe analysis employs the norm u_^2=(u,u) induced by the sesquilinear form \n\n    (u,v)= (u,v) + (\u03ba^2 u ,v)_\u03a9,\n\ndefined for u,v\u2208.\n\nIn\u00a0<cit.>, the following result is proved.\n\n(i) For all u,v\u2208, it holds that\n\n    |(u,v)| \u2264 C_u_v_,\n\n    where the constant C_ =C_(a_min, \u03b2_\u221e, \u03ba_\u221e) grows quadratically in \u03ba_\u221e.\n\n    \n  \n  \n  \n  \n  \n  \n  \n    \n(ii) There exist unique solutions of\u00a0<ref>.\n\n\n(iii)\n    If g=0 in <ref>, then there exists a constant C_ stab = C_ stab(a,c,\u03c9, \u03a9) such that the corresponding solutions u and z satisfy:\n    \n    u_\u2264 C_ stabf_L^2(\u03a9),   z_\u2264 C_ stabf_L^2(\u03a9).\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Decomposition of the  computational domain\n\n\nLet {}_j=1^J denote a conforming decomposition of \u03a9 into J non-overlapping domains  with piecewise smooth boundaries. \n\nFurthermore, let \n\n    \u0393 = \u22c3_j=1^J \u2202\u03a9_i \u2216\u0393_D\n \ndenote the domain decomposition interface and  the set of all edges of the domain decomposition, where each edge e is an open set with e = \u2202\u03a9_i\u2229\u2202 for some i \u2260 j.\n\n\n Furthermore, let ={p\u2208\u0393}=\u0393\u2216\u222a_e\u2208e be the set of points connecting adjacent edges, which we also refer to as the vertices of the domain decomposition. \n\n\n\n\n\n\n\n \u00a7.\u00a7 Function spaces\n\n\nDenoting  the interpolation space between  and L^2(e); see <cit.>, \nwe have the interpolation inequality\n\n    \u03b7_\u2264 C \u03b7_L^2(e)^12\u03b7_^12\n\nfor all \u03b7\u2208; see, e.g., <cit.>.\nWe will also use the Lions\u2013Magenes space , which is defined as an interpolation space between L^2(e) and  <cit.>. Therefore, it holds that \u2282 densely <cit.>.\n\n\n\n\n\n\n\nIn view of <cit.>, if e\u2282\u2202 for some 1\u2264 j\u2264 J, \nfunctions in  can be extended by zero to functions in . Here,  denotes the space of traces of functions in ; cf.\u00a0<cit.>. \nLastly, by  we denote the space of traces on \u0393, i.e., v\u2208 if, for all 1\u2264 j\u2264 J, there exist u_j \u2208 such that u_|\u2202\u2229\u0393=v_|\u2202.\n\n\n\n\u00a7 ACMS METHOD\n \nThe ACMS method introduced in\u00a0<cit.> relies on an orthogonal splitting of  into interface functions  and local functions , j=1,\u2026,J, and on the availability of basis functions with local support; whereas functions in  generally have local support, interface basis functions with local support are \n\nconstructed based \n\non the edges and vertices that form \u0393. In <cit.>, orthogonality is characterized by the bilinear form associated to the elliptic problem. The basic idea of our extension of the ACMS method to Helmholtz problems is similar,  but `orthogonality' is measured with respect to the sequilinear form . Below we will construct spaces \n\n    := \u2295\n\nthat are either associated to the subdomains  or to the interface \u0393.\n\nIn particular, the corresponding basis functions have local support and can be built locally.\nWe now discuss the construction of the bubble space  and the interface space  in detail.\n\n\n\n \u00a7.\u00a7 Bubble space\n\nLet us define the local sesquilinear form _j:\u00d7\u2192 as in <ref> but with domain of integration  instead of \u03a9.\nSince _j is Hermitian, we can consider the eigenproblems: for j=1,...,J and i \u2208, find (b_i^j,\u03bb_i^j)\u2208\u00d7 such that\n\n    _j(b_i^j,v)= \u03bb_i^j ( \u03ba^2 b_i^j,v)_  for all  v \u2208.\n\nStandard theory ensures that the eigenfunctions {b^i_j}_i form an orthogonal basis for  with respect to _j and an orthonormal basis for L^2() with weighted inner product (\u03ba^2 u,v)_, and that \u03bb_i^j>0. Furthermore, we may assume that the eigenvalues \u03bb_i^j are ordered non-decreasingly, i.e., \u03bb_i^j\u2264\u03bb_l^j for i\u2264 l.\nIn slight abuse of notation, we may denote by b_i^j \u2208 H^1_0(\u03a9) also the extension of b_i^j \u2208 by zero outside of  and we call these bubble functions.\n\nAssociated to the partition {}_j of \u03a9, let us introduce the infinite-dimensional bubble space\n\n    = \u2295_j=1^JV^j,    with  V^j= span{  b_i^j :  i\u2208}.\n\nLet S_B=(I_1,\u2026, I_J)\u2208^J be a multi-index. Then, the finite-dimensional bubble space employed in the ACMS method is defined by:\n\n    = \u2295_j=1^JV^j_I_j,    with  V^j_I_j:= span{  b_i^j   :  1 \u2264 i \u2264 I_j }.\n\n\n\n\n\n \u00a7.\u00a7 Solvability of local Helmholtz problems\n\nThe interface space  introduced below relies on the proper extension of functions defined on the interface \u0393. The extension relies on the solvability of local Helmholtz problems with homogeneous Dirichlet conditions. Therefore, in the rest of the manuscript, we additionally assume the following:\n\n    For all j=1,\u2026,J and for all i\u2208, let \u03bb_i^j\u2260 1.\n\n\n<ref> might be justified by suitably adapting the partition {}_j and by a scaling argument.\n\nNext, we establish well-posedness of the local Helmholtz problems.\n\n\tFor \u03b2^j=inf_i\u2208{|\u03bb_i^j-1|(\u03bb_i^j+1)}>0, the following estimates hold:\n\t\n    inf_u\u2208sup_v\u2208_j (u, v)-(\u03ba^2 u, v)_/u_v_   \u2265\u03b2^j ,\n    inf_v\u2208sup_u\u2208_j (u, v)-(\u03ba^2 u, v)_/u_v_   \u2265\u03b2^j .\n\n\n\n\tLet u\u2208 be given. Since {b_i^j}_i is a basis of , we have that\n\t\tu= \u2211_i=1^\u221e u_i b_i^j\n\twith u_i=(\u03ba^2 u, b_i^j)_. Now, let v=\u2211_i=1^\u221e sgn(\u03bb_i^j-1)u_i b_i^j. \n\tWe note that \n\t\n    u_^2=\u2211_i=1^\u221e (\u03bb_i^j+1)|u_i|^2,\n\n\tand v_=u_.\n\tThen we have that \n\t\n    _j (u, v)-(\u03ba^2 u, v)_  = \u2211_i=1^\u221e |\u03bb_i^j-1| u_i^2 \u2265inf_i\u2208|\u03bb_i^j-1|/\u03bb_i^j+1u_^2.\n\n\tHence, the first inequality follows. The second inequality follows similarly.\n\n\n\n\n \u00a7.\u00a7 A harmonic extension operator\n\n\nIn order to define the interface space, we need an extension from \u0393 to \u03a9, which is obtained by combining the extensions of functions from \u2202 to .\n\n\nFor a given \u03c4\u2208, let \u03c4\u0303\u2208 be any function satisfying \u03c4\u0303_|\u2202=\u03c4.\nThen, we indicate by \u03c4\u0303_0\u2208 the solution to\n\n    _j (\u03c4\u0303_0, v)-(\u03ba^2 \u03c4\u0303_0, v)_ = -(_j(\u03c4\u0303,v)-(\u03ba^2 \u03c4\u0303, v)_)   for all  v\u2208,\n\nwhich is uniquely defined following from\u00a0<ref>.\n\n\nWe characterize the -harmonic extension j:\u2192 by setting \n\n    j\u03c4 := \u03c4\u0303+\u03c4\u0303_0.\n\n\n \n    The extension operator j:\u2192 \n    \n    is bounded, that is,\n    \n    j\u03c4_\u2264 (1+1\u03b2^j)\u03c4\u0303_,\n\n    where \u03c4\u0303\u2208 is any extension of \u03c4\u2208.\n  \n\n\tWe estimate the right-hand side in <ref> by \u03c4_v_.\n\t\n\t\n\t\n    Then, <ref> yields that \u03c4\u0303_0_\u2264\u03c4\u0303_\u03b2^j, and the assertion follows.\n    \n\nWe note the following orthogonality relation, which is a crucial property for the construction of the ACMS  spaces: for all bubble functions b_i^j \u2208, we have\n\n    _j(j\u03c4,b_i^j)-(\u03ba^2j\u03c4,b_i^j)_=0.\n\nNext, we construct extensions from local edges and the interface.\nAssume that e=\u2202\u2229\u2202\u03a9_i\u2208 is a common edge of \u03a9_i and . Let \u03c4\u2208, which, by restriction, implies \u03c4\u2208 and \u03c4\u2208 H^12(\u2202\u03a9_i).\nSince (j\u03c4)_| e=\u03c4_| e= (i\u03c4)_| e, we can introduce the  extension operator :\u2192 by (\u03c4)_| = j\u03c4_|\u2202, for all j = 1,\u2026,J. Moreover, we define :\u2192 via \u03c4 =  E_0^e\u03c4, where E_0^e: \u2192 denotes the extension by zero to the interface \u0393.\n\n\n\n \u00a7.\u00a7 Vertex based approximation space\n\nFor any p\u2208, let \u03c6_p: \u0393\u2192 denote a piecewise harmonic function, that is, \u0394_e\u03c6_p| e=0 for all e\u2208, with \u0394_e indicating the Laplace operator along the edge e\u2208, and \u03c6_p(q)=\u03b4_p,q for all p,q\u2208.\nThe vertex based space is then defined by linear combinations of corresponding  extensions:\n\n    V_ =  span{ \u03c6_p  :  p\u2208}.\n\nFor our error analysis, we will employ the nodal interpolant\n\n    I_ v = \u2211_p\u2208 v(p) \u03c6_p,\n\nwhich is well-defined for functions v:\u03a9\u2192 that are continuous in all p\u2208. Moreover, note that the support of the vertex basis functions consists of all subdomains which share the vertex and is therefore local.\n\n\n\n\n \u00a7.\u00a7 Interface space\n\nLet us consider e\u2208 and denote by \u2202_e the tangential derivative, i.e., differentiation along e.\nWe define the edge modes as solutions to the following weak formulation of the edge-Laplace eigenvalue problems: for each e\u2208, for i \u2208, find (\u03c4^e_i,\u03bb^e_i)\u2208\u00d7 such that\n\n    (\u2202_e \u03c4^e_i,\u2202_e \u03b7)_e =\u03bb^e_i ( \u03c4^e_i, \u03b7)_e   for all \u03b7\u2208.\n\nStandard theory ensures that the eigenfunctions {\u03c4^e_i}_i form an orthogonal basis for  and an orthonormal basis for L^2(e). We may again assume that the eigenvalues \u03bb_j^e>0 are ordered increasingly. Moreover, we note that the asymptotic behavior of the eigenvalues, according to <cit.>, is\n\n    \u03bb_i^e \u223c( i \u03c0/|e|)^2.\n\nThe corresponding infinite-dimensional interface space is\n\n    = V_ + \u2211_e\u2208 V^e,   V^e =  span{\u03c4_i^e :  i \u2208}.\n\nAgain, each function in V^e has local support inside the two subdomains adjacent to e. Choosing I_e\u2208, e\u2208, we introduce the L^2(e)-projection P^e_I_e:L^2(e)\u2192 V^e as\n\n    P^e_I_ev=\u2211_j=1^I_e (v,\u03c4_j^e)_e \u03c4_j^e\n\nand denote the range of P^e_I_e by V^e_I_e.\n\n\n\n\n\n\nCollecting the indices I_e in a multi-index S_\u0393,\n\nwe define the finite-dimensional interface space by\n \n    = V_ + \u2211_e\u2208 V^e_I_e,\n\nwhich, together with <ref>, completes the construction of the ACMS approximation space in <ref>.\nWe now give\n\nsome interpolation error estimates.\n\n\nFor any e\u2208 and all w\u2208, it holds that\n\n    w-P^e_I_ew_L^2(e)\u22641/\u221a(\u03bb_I_e+1)w-P^e_I_ew_.\n\nIf, additionally, w \u2208\u2229 H^2(e), then there exists a constant C>0 such that\n\n    w- P^e_I_ew_   \u2264C/\u221a(\u03bb_I_e+1^e)\u0394_e w-P^e_I_e\u0394_e w_L^2(e).\n\n\n\n\nSince {\u03c4_j^e}_j form an orthonormal basis of L^2(e), we have that\n\n\n\n\n\n\n    w-P^e_I_ew_L^2(e)^2 \n    = \u2211_j\u2265 I_e+1|(w,\u03c4_j^e)_e|^2\u22641/\u03bb_I_e+1w-P^e_I_ew_^2,\n\nwhich proves <ref>.\n\nBy <ref> \nand the Poincar\u00e9 inequality, we similarly have that\n\n    w-P^e_I_ew_^2 \n    \u2264 C_P \u2211_j\u2265 I_e+1\u03bb_j^e |(w,\u03c4_j^e)_e|^2.\n\n Using the definition of \u03c4_j^e in <ref> again and performing integration by parts, we obtain\n\n    (w,\u03c4_j^e)_e = 1/\u03bb_j^e (\u2202_e w,\u2202_e \u03c4_j^e)_e = -1/\u03bb_j^e (\u0394_e w,\u03c4_j^e)_e,\n\nwhere we used that w, \u03c4_j^e \u2208. This concludes the proof of <ref>.\n\n\n\nLet e\u2208. Then, there exists a constant C>0 such that\n\n    inf_v^e\u2208 V_I_e^e w -I_ w -v^e_   \u2264C/\u221a(\u03bb^e_I_e)w_H^32(e)\n\nfor all w\u2208 H^32(e), with nodal interpolant I_ w defined in <ref>.\n\n\nBy continuity of the embedding \u21aa C^0(e), we have that the nodal interpolation operator I_ is bounded, i.e., I_ w_\u2264 C w_ for all w\u2208. By choosing v^e=0, we thus have the stability estimate\n\n    inf_v^e\u2208 V_I_e^e w -I_ w -v^e_\u2264 C w_  for all  w\u2208.\n\nEmploying <ref> and using that w-_ w\u2208, we also have that\n\n    inf_v^e\u2208 V_I_e^e w -I_ w -v^e_\u2264C/\u221a(\u03bb_I_e+1^e)w_H^2(e)  for all  w\u2208 H^2(e).\n\nTherefore, we get by interpolation <cit.> that\n\n    inf_v^e\u2208 V_I_e^e w -I_ w -v^e_\u2264C/(\u03bb_I_e+1^e)^14w_H^32(e)  for all  w\u2208 H^32(e).\n\n\n\n\n\n\nEmploying <ref> and <ref> and recalling that the best-approximation is realized via the projection P^e_I_e(w-I_ w), we also have that\n\n    inf_v^e\u2208 V_I_e^e w -I_ w -v^e_L^2(e)   \u22641/(\u03bb^e_I_e)^34w_H^32(e)  for all  w\u2208 H^32(e).\n\nTherefore, by the interpolation inequality <ref>, the relations <ref> yield <ref>, which concludes the proof.\n\n\n\n\n\u00a7 GALERKIN APPROXIMATION\n \n\nWe start by observing that \n\n    (, v_\u0393) = (,v_\u0393) -(\u03ba^2 ,v_\u0393)+ i\u03b2\u211b(,v_\u0393) = 0,\n\nfor all \u2208 and v_\u0393\u2208,\nwhere we used that =0 on \u0393_R and that  and v_\u0393 are _j-orthogonal by <ref>.\nTherefore, the weak Helmholtz problem <ref>\nis equivalent to: find \u2208 and u_\u0393\u2208 such that\n\n    (,)    = F()   for all \u2208  and\n    (u_\u0393,v_\u0393)    = F(v_\u0393)  for all  v_\u0393\u2208.\n\n<ref> implies that  is uniquely defined. Since u is uniquely defined by <ref>, we conclude that also u_\u0393 is uniquely defined.\n\nAnalogously, the Galerkin approximation corresponding to\u00a0<ref> is: find \u2208 V_S such that\n\n    (,v_S) = F(v_S)  for all  v_S \u2208 V_S.\n\nEquivalently, this can be split into two independent problems, namely a bubble approximation: find \u2208 V_B,S_B such that\n\n    (,v_B,S_B) = F(v_B,S_B)   for all  v_B,S\u2208 V_B,S_B;\n\nand an interface approximation: find \u2208 such that\n\n    (u_S,\u0393,v_S,\u0393) = F(v_S,\u0393)  for all  v_S,\u0393\u2208.\n\nThe Galerkin problem <ref> is well-posed under <ref>, while adjoint approximability is required to analyze the Galerkin problem <ref>; cf. <cit.>. In <ref> below, we prove estimates for the adjoint approximability constant, ensuring that also <ref> is well-posed as long as the number of edge modes is sufficiently large.\n\nIn the following subsections, we present an error analysis for the two independent approximation problems <ref>.\n\n\n\n \u00a7.\u00a7 Error estimates for the bubble approximation\n\nFor the statement of the approximation result, let us introduce the L^2-projection \n P^j_I_j:L^2(\u03a9)\u2192 V_I_j^j, given by\n\n    P^j_I_jf=\u2211_i=1^I_j(\u03ba^2 f,b_i^j)_ b_i^j.\n\n\n\n\n\nThe error analysis is then straight-forward. \n  \nAssume f \u2208 L^2(\u03a9) and set f_\u03ba:=f/\u03ba^2.\nFor \u2208 and \u2208, defined in <ref>, respectively, we have the estimates:\n\n    \u03ba(-)_L^2(\u03a9)^2 \n       \u2264\u2211_j=1^J 1/|\u03bb_*^j-1|^2\u03ba (f_\u03ba-P^j_I_jf_\u03ba)_L^2()^2, \n    \u221a(a)\u2207(-)_L^2(\u03a9)^2  \n       \u2264\u2211_j=1^J \u03bb_#^j/|\u03bb_#^j-1|^2\u03ba (f_\u03ba-P^j_I_jf_\u03ba)_L^2()^2,\n\nwhere \u03bb_*^j =  argmin{|\u03bb_i^j-1|, i\u2265 I_j+1}, \nand \u03bb_#^j =  argmax{\u03bb_i^j/|\u03bb_i^j-1|^2, i\u2265 I_j+1}.\n\n\nSince {b_i^j}_i form an orthonormal basis for L^2() with the weighted inner product (\u03ba^2 u,v)_, we may assume the expansion\n\n    = \u2211_j=1^J \u2211_i=1^\u221e u_B,i^j b_i^j,    with  u_B,i^j = (\u03ba^2 ,b_i^j)_.\n\nBy testing <ref> with v_B= b_i^j, for i\u2208, and observing that (,b_i^j)=_j (,b_i^j) - (\u03ba^2 , b_i^j)_, we infer from\u00a0<ref> that\nu_B,i^j = F(b_i^j)/(\u03bb_i^j-1).\nConsequently, we obtain that\n\n    = \u2211_j=1^J \u2211_i=1^I_j u_B,S,i^j b_i^j,  with   u_B,S,i^j = F(b_i^j)(\u03bb_i^j-1).\n\nTherefore, u_B,S,i^j=u_B,i^j for 1\u2264 i\u2264 I_j and 1\u2264 j\u2264 J. \nSince b_i^j=0 on \u2202\u03a9, we further have that F(b_i^j) = (f, b_i^j)_\u03a9.\nHence, we conclude that\n\n    \u03ba(-)_L^2(\u03a9)^2 \n    =\u2211_j=1^J \u2211_i=I_j+1^\u221e1/|\u03bb_i^j-1|^2|(f,b_i^j)_|^2,\n\nwhich, by <ref> and the definition of \u03bb_*^j, implies\u00a0<ref>.\n\nEstimate <ref> follows similarly from _j (b_i^j,b_i^j)=\u03bb_i^j and\n\n    \u221a(a)\u2207(-)_L^2(\u03a9)^2 \n    = \u2211_j=1^J \u2211_i=I_j+1^\u221e\u03bb_i^j/|\u03bb_i^j-1|^2|(f,b_i^j)_|^2.\n\n\n\n\nThe bubble error estimates depend on the wavenumber essentially only via \u03bb_i^j, which can be made fully explicit by a scaling argument.\n\nMoreover,\n\n<ref>\nbecomes a diagonal system, which is easily solvable, also in parallel. \nMoreover, if f_|=0, then u_ B|=0, and the approximation error vanishes on .\n\n\n\n\n\n \u00a7.\u00a7 Well-posedness of the interface Galerkin problem\n\nWell-posedness of the Galerkin problem and quasi-best approximation results under an adjoint approximability condition follow as in <cit.>. To state the result let us introduce T^*\u03c7=z, mapping \u03c7\u2208 L^2(\u03a9) to the solution z\u2208\u2282 of the dual problem\n\n    (v,z) = (v,\u03c7)  for all  v\u2208,\n\nwhich is well-defined due to <ref>.\nThe approximation properties of the interface space  are measured by the adjoint approximability constant\n\n    \u03c3^* = sup_\u03c6\u2208 L^2(\u03a9)\u2216{0}inf_\u2208T^*( \u03ba^2\u03c6)-_/\u03ba\u03c6.\n\nWith these preparations, we can state the abstract result <cit.> in our setting.\n\n\nSuppose that C_\u03c3^*\u226412, where C_ is defined in <ref> and \u03c3^* is the adjoint approximability constant. Then, the Galerkin problem\u00a0<ref> has a unique solution, and the following estimates hold:\n\n    u_\u0393-_   \u2264 2 C_inf_\u2208u_\u0393 - _, \n    \u03ba (u_\u0393-)   \u2264 2 C_^2 \u03c3^* inf_\u2208u_\u0393 - _.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Estimates of the best-approximation error in VGS\n\n\nQuantitative estimates for the interface approximation error follow from localizing the error to single edges and applying the estimates proven in <ref>.\n\n\nAssume that the solution u to <ref> is continuous in all vertices p\u2208 and u \u2208 H^2(e) for all e\u2208,\nand denote as  the solution to <ref>. Then, \n\n\n    u_\u0393-_\u2264\u2211_e\u2208C/(\u03bb_I_e+1^e)^34\u0394_e u-P^e_I_e\u0394_e u_L^2(e)\n\nfor a constant C>0 independent of u and . \n\n\nAccording to <ref>, it suffices to estimate the best-approximation error inf_u_\u0393-_.\n\nBy assumption, the nodal interpolant I_ u of u is well-defined and, by construction, we obtain that (u-I_ u)_| e\u2208.\n\nThese observations motivate the \n\nchoice\n\n    =  I_ u + \u2211_e\u2208 P^e_I_e(u-I_ u),\n\nwith P^e_I_e introduced in <ref>.\nWe then have that u_\u0393(p)-(p)=0 for all p\u2208. \nMoreover, in view of <ref>,\n(-)_| e\u2208\u2282.\nTherefore, the error can be localized to single edges as follows\n\n    _|  - _| = j( u_|\u2202 - _|\u2202 ) = \u2211_e\u2208, e\u2282\u2202 ( (u_| e - _| e))_|.\n\nFrom the latter identity and from the definition <ref>, we obtain the following estimate\n\n    - _^2 \n    \n       \u2264\u2211_j \u2211_e\u2208,e\u2282\u2202 (u_| e- _| e)_|_^2 \n       \u2264 (1+\u03ba_\u221e^2)C max_j(1+1\u03b2^j)^2\u2211_e\u2208u-_^2,\n\nwhere we used <ref> and equivalence of the -norm to the -norm.\nThe interpolation estimate <ref> then yield the assertion.\n\n\n\n\n\n\n\n\n\n\n\n\n\nIf the solution has more regularity convergence improves, as long as the derivatives of the edge modes do not grow too quickly, which is true, e.g., if e is a line segment.\n\n In addition to the assumptions of <ref>, suppose that u\u2208 H^3(e) for all e\u2208. Moreover, assume that there is a constant C>0 such that |\u2202_e\u03c4_i^e(p)|\u2264 C \u221a(\u03bb_i^e) for all i\u2208 and p\u2208\u2202 e.\n Then there is a constant C>0 such that\n\n    u_\u0393-_\u2264 C \u2211_e\u22081/\u03bb_I_e+1^e u_H^3(e).\n\n\n\nIn view of <ref> it suffices to bound (\u0394_e u,\u03c4_i^e)_e for i \u2265 I_e+1. Since -\u0394_e \u03c4_i^e=\u03bb_i^e\u03c4_i^e on e by elliptic regularity, integration by parts yields that\n\n    (\u0394_e u,\u03c4_i^e)_e =- 1/\u03bb_i^e (\u0394_e u,\u0394_e\u03c4_i^e)_e\n    = 1/\u03bb_i^e((\u2202_e^3 u,\u2202_e\u03c4_i^e)_e+ [\u0394_e u\u2202_e\u03c4_i^e ]_q^p),\n\nwhere p,q denote the endpoints of e.\nThe assertion then follows from the Cauchy-Schwarz inequality, the continuity of the embedding \u21aa C^0(e), <ref> and the assumed bounds on \u2202_e\u03c4_i^e.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Estimates for adjoint approximability constant\n\nThe well-posedness and the error estimates for the interface problem in <ref> relied on the smallness of the adjoint approximability constant \u03c3^* defined in <ref>.\nIn order to estimate \u03c3^* in our setting, we follow the ideas of\u00a0<cit.>, \nwhere they work with piecewise linear finite elements, requiring H^2(\u03a9)-regularity of the adjoint problem <ref>. \nSince we need to consider the interface problem only, we can require a weaker H^2-regularity in the vicinity of the interface \u0393. Let, for fixed \u03b4>0, \n\n    \u03a9_\u0393\u2282{x\u2208\u0393:  dist(x,\u0393\u222a\u2202\u03a9)<\u03b4}\n\ndenote an open neighborhood of \u0393\u222a\u2202\u03a9 such that \u2202\u03a9_\u0393\u2216\u2202\u03a9 is smooth.\nWe start with a result similar to <ref> but with slightly weaker regularity assumptions.\n\n\nLet \u03bb^\u0393=min_e\u03bb_I_e^e. Then, there exists a constant C>0 such that, for all z\u2208 H^2(\u03a9_\u0393)\u2229, it holds that\n\n    inf_\u2208z-_\u2264C/\u221a(\u03bb^\u0393)z_H^2(\u03a9_\u0393).\n\n\n\nIn view of <ref> it suffices to estimate\n\n    inf_v^e\u2208 V_I_e^e z -I_ z - v^e _\n\nin terms of z_H^2(\u03a9_\u0393).\n\nBy embedding, z\u2208 H^2(\u03a9_\u0393) implies that z\u2208 H^32(e) for all e\u2208, and applying <ref> yields that\n\n    inf_\u2208z-_\u2264C/\u221a(\u03bb_I_e+1^e)z_H^32(e).\n\nHence, the definition of \u03bb^\u0393 yields the assertion.\n\nAssuming regularity of the coefficients of the Helmholtz problem locally around the interface \u0393, we can next estimate the adjoint approximability constant.\n\nIf a,c\u2208 C^0,1(\u03a9_\u0393),\nthen there exists a constant C>0 such that\n\n    \u03c3^* \u2264C\u221a(\u03bb^\u0393).\n\n\n\nIn view of <ref>, the key for estimating \u03c3^*\nis to obtain an estimate for\n\n    inf_\u2208T^*(\u03ba^2\u03c6)-_\n\nin terms of \u03ba\u03c6 for arbitrary \u03c6\u2208 L^2(\u03a9), where T^*(\u03ba^2\u03c6)\u2208 is the solution to the adjoint problem <ref>.\nSimilarly to the proof of <cit.>, it can been shown that there exists a constant C_*>0 such that\n\n    T^*(\u03ba^2 \u03c6)_H^2(\u03a9_\u0393)\u2264 C_* \u03ba\u03c6_L^2(\u03a9),\n\nwhich employs smoothness of the coefficients on \u03a9_\u0393 and elliptic regularity results for T^*(\u03ba^2\u03c6) as well as <ref> for the dual problem. \nA simple combination of <ref> yields the assertion.\n\nNote that the constant C_* in <ref> depends on  \u03ba_\u221e, see <cit.> for details.\nA consequence of the previous result is that, by using sufficiently many edge modes, the assumptions of <ref> can be verified. Moreover, we obtain the following statement.\n\n\nIn addition to the assumptions of <ref> suppose that u\u2208 H^2+\u03b1(e) for all e\u2208, for \u03b1=0,1.\nThen, for some C>0, it holds\n\n    \u03ba^2 (-)\u2264C/(\u03bb^\u0393)^54 + \u03b14\u2211_e\u2208u_H^2+\u03b1(e).\n\n\n\nInserting the estimate <ref> for \u03c3^* and the error bounds stated in <ref> (if \u03b1=0) or <ref> (if \u03b1=1) into <ref> yields the assertion. \n\n\n\n\n\n\u00a7 NUMERICAL RESULTS\n \nWe provide numerical experiments to support our theoretical results and show the effectiveness of our approach.\n\nSince, in general, we cannot compute the ACMS basis functions in\u00a0<ref> analytically, we compute them approximately using an underlying finite element discretization that adopts piecewise linear and continuous functions. To do so, we employ a quasi-uniform triangulation \n\nof the computational domain \u03a9 into triangles, such that each subdomain  is the union of elements of that triangulation; see, for instance,\u00a0<ref>.\n\n\n\n\n\n\n\n\nWe denote the corresponding finite element solution of the Helmholtz problem by u_ FEM. Moreover, the resulting errors are quantified according to\u00a0<ref>.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Classical Helmholtz example\n\nLet \u03a9=B_1(0) be the unit disc and \u0393_R=\u2202\u03a9.\nWe first consider the boundary value problem given by\u00a0<ref> with a(x) = 1, \u03b2(x)=1.\n\nThe source terms f and g are defined such that \nthe problem has the plane wave solution \n\n\tu(x) = exp(-\u03b9  k\u00b7 x),\n\nwith wave vector k=\u03ba(0.6,0.8) and variable wavenumber \u03ba. \nIn particular, f(x)=0, therefore the solution satisfies u_B=0, and u can be approximated by solving the interface problem <ref> only; see  <ref> and also\u00a0<ref>.\n\nWe employ a decomposition of \u03a9 as depicted in <ref> (left) with an initial coarse triangulation as shown in <ref> (right), which corresponds to a domain decompositions into J = 8 subdomains. In this domain decomposition, the \n\n\nnumber of edges in  is 12, \n\nand\nthe number of vertices in  equals 5.\nThe ACMS solution  and the finite element solution u_ FEM are computed using uniform refinements of the coarse triangulation; see\u00a0<ref> (right).\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Low wavenumber\n\nLet us first consider the case of a low wavenumber \u03ba=1. In this setting, we obtain u_\u2248 2.5 and u_L^2(\u03a9)\u2248 1.8 for the plane wave solution u.\n\nWe compare the plane wave solution u with the approximation  given by the ACMS method \n\n\n\n\nfor different underlying finite element discretizations and multi-indices S_\u0393, which define the order of the interface approximation space V_\u0393,S_\u0393 introduced in <ref>.\nMoreover, we use the same value of  I_e \u2208{2,4,8,\u2026, 64} for each of the 12 edges in .\n \n\n\n<ref> shows the approximation error of the ACMS method and the corresponding errors for the nodal interpolant I_h(u) for each mesh resolution.\n\nWe observe that the H^1-error decreases with a rate between 3.5 and 4.0, until it approaches the accuracy of the nodal interpolant I_hu of\n\n\n\nthe underlying finite element mesh. Similarly, the L^2-error decays cubically for sufficiently fine finite element meshes.\nThis is in good agreement with\u00a0<ref> and the relation \u03bb_i^e \u223c i^2 stated in\u00a0<ref>.\nWe may conclude that, already with a low number of edge modes I_e\u2264 32, or which corresponds to |S_\u0393|\u2264 384, the ACMS solution achieves the accuracy of the nodal interpolant in the H^1-norm, which employs around 8\u00b710^6 vertices for h\u2248 3.4\u00b710^-4.\nIn fact, as shown in <ref>, the ACMS solution converges to the (standard) finite element solution u_ FEM quadratically in the H^1-norm and cubically in the L^2-norm, respectively.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Higher wavenumbers\n\n\nWe now repeat the previous numerical experiments focusing on the effect of an increasing wavenumber; namely, we test our method for \u03ba=2,4,8,16,32,64,128.\n\n\nLet us mention that\u00a0<ref> is satisfied for all chosen wavenumbers and that the plane wave solution u changes with \u03ba.\n\nIn <ref>, we show the convergence of the ACMS method to the finite element approximation u_ FEM and, for comparison, we display the error between the nodal interpolant and the finite element solution.\n\nAs expected, we can clearly observe a dependency of the error on the wavenumber.\n\nFor example, for |S_\u0393|=1 536, the errors e_0,h and e_1,h grow roughly quadratically in \u03ba. This is less than we would expect in view of\u00a0<ref>, and we may explain this behavior by the choice of different but equivalent norms. \nIf one is satisfied with the approximation errors achieved by u_ FEM, we may again conclude that the ACMS method can yield good approximations already with a moderate number of degrees of freedom. We note that, by using higher order elements or further mesh refinements, the accuracy of u_ FEM may be increased; see <cit.>. Then, we would\n\nexpect that \n\nthe corresponding solution of the ACMS method would also show better accuracy in approximating the exact solution.\nIf, however, approximation in the L^2-norm is the main objective, one could as well resort to other approaches that do not suffer from the pollution effect in the high wavenumber case; see, e.g.,\u00a0<cit.>.\n\n\n\n\n\n\n\n \u00a7.\u00a7 Localized interior source\n\nIn certain applications, such as in geophysics <cit.>,\nthe source terms of the wave propagation are localized. Therefore, let us study the behavior of the ACMS method for this type of setup. Different from the previous section, let us consider the non-zero source function\n\n\n\n\n\n\n\n\nf(x) = exp(-200 | x- x_c|^2),\nwith x_c=(13,13), \u03ba=1, and g \u2261 0.\n\nFor this example, no analytical expression of the solution u is available. Thus, we only investigate the convergence of the ACMS method towards the solution of the underlying finite element method, which is justified by the discussion \n\nin the previous sections.\n\n\n\n\n<ref> shows the results for varying numbers of bubble functions and edge modes. In view of\u00a0<ref>, we note that \u2248 0 outside the subdomain  with x_c\u2208. Hence, for an accurate approximation, we only need bubble functions in that subdomains .\n\nMoreover, the linear system for the bubble component is diagonal and decoupled from the interface part. Hence, the solution coefficient corresponding to a specific bubble basis function can be computed independently from any other ACMS basis function; cf.\u00a0<ref>.\n\n\nFor this highly localized source, we observe spectral convergence to the finite element solution when I_j\u2265 32, given a sufficiently high number of edge modes.\nThis can be explained by inspecting the proof of <ref>: using repeatedly\u00a0<ref>, integration-by-parts and that f and all its derivative are negligible on \u2202, we can estimate (f, b_i^j)_ by arbitrary powers of \u03bb_i^j; see also\u00a0<ref> for similar steps. For a high number of bubble functions, a saturation effect occurs. This can be due to the limited quantity of edge modes or to the fact that the values of higher-order derivatives of f are not negligible anymore.\nWhen increasing the selected edge modes while keeping the number of bubble functions fixed, the convergence approaches the predicted quadratic and cubic rates for the H^1- and the L^2-error, respectively.\nSince the Galerkin problems for the bubble part and the interface are decoupled (see\u00a0<ref>), the size of the systems to be solved remains comparably small. \nTherefore, we conclude that, for a moderate number of degrees of freedom, we obtain very good approximations of the finite element solution.\n\n\n\n \u00a7.\u00a7 Localized boundary source\n \nNext, let us modify the classical Helmholtz example from <ref> such that \u03ba=16, f=0, and \ng(x)=exp(-200|x-x_c|^2), with x_c=(-1\u221a(2),1\u221a(2)). \nIn\u00a0<ref>, we display the real and imaginary part of the finite element solution computed on a quasi-uniform mesh with 521 217 vertices, i.e., h\u2248 1.3\u00b7 10^-3. Although the source is very localized around x_c, the whole domain is excited, indicating the wave-type behavior of the solution.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSince f=0 here, we do not need any bubble functions to obtain convergence according to <ref>. As we do not have an analytic solution, we investigate the error between u_ FEM and  for varying number of edge modes.\n\nThe results are shown in\u00a0<ref>, where we consider the relative errors since the solution values are rather small.\n\nAs predicted by\u00a0<ref>, we observe second order convergence for the H^1-error, while convergence is initially slightly faster. The L^2-error shows a similar behavior with a convergence rate approaching third order; cf.\u00a0<ref>.\nWe again may conclude that we can approximate the highly resolved standard finite element solution using a moderate number of edge modes in the ACMS method.\n\n\n\n \u00a7.\u00a7 Periodic structure\n \nLet us conclude our numerical experiments with a heterogeneous Helmholtz problem on a domain decomposition as in\u00a0<ref> (left) with a heterogeneous diffusion coefficient a depicted in\u00a0<ref> (right). This configuration is similar to the modeling of two-dimensional photonic crystals\u00a0<cit.>. We choose wavenumber  \u03ba=100, interior source f=0, and the localized boundary source\ng(x)=exp(-\u03b9 k\u00b7 x)exp(-100|x-x_c|^2),\nwith x_c=(0,12) and wave vector k=\u03ba (1,0).\n\nThe corresponding finite element solution, which has been computed on a quasi-uniform triangulation with 5 330 337 vertices, is shown in\u00a0<ref>.\n\n\n\n\n\n\nSince, again, f=0, we only need to study the behavior for varying numbers of edge modes, while the bubble part of the solution  is zero.\n\nNote that we can choose \u03a9_\u0393 defined in <ref> inside the region with a=1; cf.\u00a0<ref>.\nThe relative H^1- and L^2-errors between the finite element solution and the ACMS solution are listed in\u00a0<ref>. For |S_\u0393|=2 880, which corresponds to the case of 16 modes per edge, the ACMS discretization already yields a good approximation to the highly resolved finite element solution. Moreover, the convergence of the error is initially even better than predicted by our theoretical results for |S_\u0393| \u2265 720.\n\n\n\n\u00a7 CONCLUSIONS\n\nWe extended the ACMS method, which has originally been developed for elliptic problems, to the heterogeneous Helmholtz equation.\nThis framework \n\nis based on a decomposition into local Helmholtz problems and an interface problem, that can be solved separately. The numerical approximation of those problems is achieved by using basis functions with local support and which can be constructed locally as well.\n\nThe error analysis developed for the investigated method is based on the abstract framework introduced in\u00a0<cit.>, and it is possible to trace the wavenumber dependency of the involved constants.\nWe proved error estimates in the H^1- and the L^2-norm, and we obtained algebraic decay in the number of basis functions (modes) being used. \nIn order to be able to apply the framework of\u00a0<cit.>, we presented estimates for the adjoint approximability constants, which can be understood as a `sufficient resolution' condition for the problem at hand. \nIn order to satisfy this resolution condition, the number of edge modes should be sufficiently large in relation to the wavenumber.\nMoreover, we showed applicability of the method also if the diffusion coefficient is not smooth, as long as smoothness in a neighborhood of the interface is guaranteed.\n\nFinally, we exemplified the theoretical error bounds by numerical experiments, which show the accuracy of the investigated ACMS method for moderate wavenumbers. We constructed the ACMS basis functions using a finite element method, and we observed that the resulting discrete ACMS method approximates well the corresponding finite element solution. Thus, we may conclude that the accuracy of the discrete ACMS method depends on the accuracy of the underlying finite element method, and smaller errors might be achieved by using high-order finite elements. \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 ACKNOWLEDGMENTS\n\nEG and MS acknowledge support by the Dutch Research council (NWO) via grant OCENW.GROOT.2019.071.\nAH and MS acknowledge support by the 4TU.AMI SRI Bridging Numerical Analysis and Machine Learning.\n\nsiamplain\n\n\n"}