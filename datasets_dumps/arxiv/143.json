{"entry_id": "http://arxiv.org/abs/2303.07160v1", "published": "20230313143555", "title": "Tighter Lower Bounds for Shuffling SGD: Random Permutations and Beyond", "authors": ["Jaeyoung Cha", "Jaewook Lee", "Chulhee Yun"], "primary_category": "cs.LG", "categories": ["cs.LG", "math.OC", "stat.ML"], "text": "\n\n\n\nQuantum estimation of a charge distance from a hole-spin qubit in Si quantum dots\n    Filippo Troiani^2\n    March 30, 2023\n=================================================================================\n\n\n\n\nWe study convergence lower bounds of without-replacement stochastic gradient descent (SGD) for solving smooth (strongly-)convex finite-sum minimization problems. Unlike most existing results focusing on final iterate lower bounds in terms of the number of components n and the number of epochs K, we seek bounds for arbitrary weighted average iterates that are tight in all factors including the condition number \u03ba. For SGD with Random Reshuffling, we present lower bounds that have tighter \u03ba dependencies than existing bounds. Our results are the first to perfectly close the gap between lower and upper bounds for weighted average iterates in both strongly-convex and convex cases. We also prove weighted average iterate lower bounds for arbitrary permutation-based SGD, which apply to all variants that carefully choose the best permutation. Our bounds improve the existing bounds in factors of n and \u03ba and thereby match the upper bounds shown for a recently proposed algorithm called .\n\n\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n \n\nOne of the most common frameworks used in machine learning is the following finite-sum minimization problem,\n\n    min_ F() = 1/n\u2211_i=1^n f_i().\n\nStochastic gradient descent (SGD), an algorithm first proposed by <cit.>, is highly capable of numerically solving finite-sum optimization problems. In the t-th iteration, SGD randomly samples a component index i(t) and computes a gradient-based update equation of the form _t = _t-1 - \u03b7_t \u2207 f_i(t)(_t-1), where \u03b7_t is a step size parameter, often set to a fixed constant.\n\nMany prior studies on SGD have shown convergence results assuming with-replacement sampling of the component index i(t) (<cit.> and many others), where we independently choose i(t) from a uniform random distribution over the index set every time. This uniform sampling makes each step of SGD an unbiased noisy estimate of vanilla gradient descent (GD).\n\nIn real-world applications, however, it is much more common to use without-replacement SGD, where each epoch runs over the entire shuffled set of n components. Without-replacement SGD has gained popularity for both its simplicity and empirical observations of faster convergence rates <cit.>. However, theoretical analysis on without-replacement SGD remains quite elusive, especially because of the lack of independence between iterates. Nevertheless, recent works have managed to successfully deal with without-replacement SGD in theoretical aspects <cit.>.\n\nA simple and popular method of without-replacement sampling is to randomly shuffle the n components independently on each epoch, often referred to as Random Reshuffling or . Some studies show upper bounds of convergence rates for a certain class of functions <cit.>, while some others present lower bounds by analyzing a function contained in a certain class with a slow convergence rate <cit.>. These preliminary results highlight that without-replacement SGD is in fact capable of converging provably faster than its with-replacement counterpart.\n\nA recent line of work <cit.> opens a new field of studies on permutation-based SGD, which covers all cases where the permutation of the n component functions is chosen according to a certain policy, instead of simple random reshuffling. \nThe aim of this line of research is to design a policy that yields faster convergence compared to random permutations.\nIndeed, a recent result by <cit.> proposes , a permutation-based SGD algorithm that uses the gradient information from previous epochs to manipulate the permutation of the current epoch, and shows that  provably converges faster than Random Reshuffling. This raises the following question:\n\n    Is GraB optimal, or can we find an even faster permutation-based SGD algorithm?\n\n\n\n\n\n\n \u00a7.\u00a7 Related Work\n\n\nBefore summarizing our contributions, we list up related prior results so as to better contextualize our results relative to them. In all convergence rates, we write (\u00b7) for upper bounds and \u03a9 (\u00b7) for lower bounds. The tilde notation (\u00b7) hides polylogarithmic factors. For simplicity, here we write convergence rates only with respect to the number of component functions n and the number of epochs K (i.e., number of passes through the entire components).\n\nSGD with replacement is known to have a tight convergence rate of ( 1/T) after T iterations, which translates to ( 1/nK) in our notation.\nOne of the first studies on  by <cit.> shows an upper bound of ( 1/K^2) for strongly convex objectives with smooth components, along with the assumption that n is a constant. Under the same settings, <cit.> show a convergence rate of ( 1/n^2 K^2 + 1/K^3), which explicitly depends on both n and K. <cit.> further show that the upper bound for strongly convex quadratics is ( 1/n^2 K^2 + 1/nK^3). Follow-up studies prove upper bounds in broader settings, such as ( 1/n K^2) for strongly convex (but not necessarily quadratic) functions <cit.>, or ( 1/n^1/3 K^2/3) under convex assumptions <cit.>. Some further generalize to other variants of , including Minibatch and Local SGD in federated learning\u00a0<cit.>, Nesterov's acceleration\u00a0<cit.>, or Stochastic Gradient Descent-Ascent used in minimax problems\u00a0<cit.>. Meanwhile, investigations on lower bounds have started from simple quadratic assumptions, where <cit.> prove a lower bound of rate \u03a9( 1/n^2 K^2 + 1/n K^3). Lower bounds were then extended to smooth and strongly convex settings, as in <cit.> and <cit.> which both derive a lower bound of \u03a9( 1/n K^2).\n\nRecent works provide evidence of designing algorithms that converge faster than .\nConcretely, <cit.> introduce a permutation-based SGD algorithm called  and prove that it can outperform  for quadratic objectives. \nThe authors also propose a lower bound applicable to arbitrary permutation-based SGD, by proving that no algorithm can converge faster than \u03a91/n^3K^2 for some strongly convex objectives.\n\n\n<cit.> and <cit.> propose methods to find \u201cgood\u201d permutations via a greedy strategy. Extending their previous work, <cit.> propose  and gain a convergence rate 1/n^2K^2 for P\u0141 functions which is faster than 1/nK^2 for  <cit.>.\n\nMost prior results <cit.> mainly concern achieving tight convergence rates with respect to n and K, while recent studies delve deeper to unveil how other parameters can also affect the convergence properties.\nThe condition number \u03ba (defined in <ref>) is an example of such parameters, which is closely related to the problem's geometry. \nIf we take \u03ba into account[For this section, we treat \u03ba = \u0398( 1 / \u03bc) for simplicity, following the convention of other existing results in the literature <cit.>.] in the strongly convex case, the best known upper and lower bounds for  are \u03ba^3/n K^2 <cit.> and \u03a9\u03ba/n K^2 <cit.>, which differ by a factor of \u03ba^2, and those for permutation-based SGD are  \u03ba^3/n^2 K^2 <cit.> and \u03a91/n^3 K^2 <cit.>, which differ by both n and some factors of \u03ba\u2014that is, the bounds are not completely tight for all factors yet.\n\nWhile it is tempting to neglect the looseness in \u03ba by treating factors in \u03ba as \u201cleading constants,\u201d characterizing the right dependence on \u03ba becomes imperative for understanding the regimes in which without-replacement SGD is faster than the with-replacement version. \n\nFor example, the aforementioned rate \u03ba^3/n K^2 of  improves upon the known tight rate \u03ba/nK of with-replacement SGD only if K\u2273\u03ba^2. It turns out that this requirement of large enough K is in fact unavoidable in the strongly convex case\u00a0<cit.>;\nby developing a lower bound, <cit.> show that  cannot converge faster than with-replacement SGD when K \u2272\u03ba. \nCharacterizing the exact threshold (\u03ba vs. \u03ba^2) for faster convergence of  requires a tighter analysis of the \u03ba dependence of its convergence rate.\n\n\n\n\n\n\n \u00a7.\u00a7 Summary of Our Contributions\n\nTowards a complete understanding of  and permutation-based SGD in general, we seek to close the existing gaps outlined above by developing tighter lower bounds with matching upper bounds.\nWe present results under two different kinds of algorithm settings: <ref> contains lower bounds obtained from , and <ref> presents lower bounds that are applicable to arbitrary permutation-based SGD algorithms.\n\n\nOur lower bounds are obtained for without-replacement SGD with constant step size, which is also the case in other existing results in the literature\u00a0<cit.>. While all lower bounds proved in the aforementioned papers are only applicable to the final iterate of the algorithm, many of our results in this paper apply to arbitrary weighted average of end-of-epoch iterates, which can be used to show tightness of matching upper bounds that employ iterate averaging.\n\nOur main contributions are as follows. Here we include \u03ba = \u0398( 1 / \u03bc) in the convergence rates to better describe the results.\nFor a complete summary of our results, please refer to <ref>.\n\n\n\n    \n  * <ref> derives a lower bound of rate \u03a9( \u03ba^2/n K^2) on the strongly convex case for the final iterate, which matches the best-known corresponding upper bound \u03ba^3/n K^2 up to a factor of \u03ba.\n    \n    \n  * <ref> extends the lower bound \u03a9( \u03ba^2/n K^2) under strongly convex settings to arbitrary weighted average (end-of-epoch) iterates. <ref> shows a matching upper bound ( \u03ba^2/n K^2) for the tail average iterate, achieving tightness up to logarithmic factors.\n    \n    \n  * <ref> shows a lower bound \u03a9( 1/n^1/3 K^2/3) for the average iterate in the convex case, which matches the corresponding upper bound in <cit.>. \n    \n    \n  * <ref> provides a lower bound \u03a9\u03ba^2/n^2 K^2 on arbitrary permutation-based SGD, which, to the best of our knowledge, is the first result that matches the best-known upper bound of  <cit.> in terms of n and K.\n\n    \n  * <ref> relaxes the assumption of individual convexity and obtains a stronger lower bound \u03a9\u03ba^3/n^2 K^2 in the scenario of arbitrary permutation-based SGD. This lower bound exactly matches the upper bound in all factors, including \u03ba. Our results therefore answer the question in (<ref>): Yes,  is an optimal permutation-based SGD algorithm.\n\n\n\n\n\n\n\n\n\n\n\u00a7 PRELIMINARIES\n \nFirst we summarize some basic notations used throughout the paper. For a positive integer N, we use the notation [N] := { 1, 2, \u2026, N }. For a vector \u2208^d, we denote its L_2 norm as . We denote the number of component functions as n and the number of epochs as K, where n and K are both positive integers.\n\nSome of our results require large K and we will use K \u2273 x to express such an assumption. We use K \u2273 x to denote the condition K \u2265 Cx logpoly(n, K, \u03bc, L, ...) when C is a numerical constant.\n\n\n\n \u00a7.\u00a7 Function Classes\n\n\nWe state the following definitions to formally define the problem class which our objective function and its components belong to.\n\n    \n    A differentiable function f is L-smooth if\n    \n    \u2207 f () - \u2207 f () \u2264 L  - ,  \u2200, \u2208^d.\n\n\n\n    \n    A differentiable function f is \u03bc-strongly convex if\n    \n    f() \u2265 f() + \u2207 f(),  -  + \u03bc/2 - ^2\n\n    for all , \u2208^d. If the inequality holds for \u03bc = 0, then we say that f is convex.\n\n\n    \n    \n    A differentiable function f satisfies the \u03bc-Polyak-\u0141ojasiewicz (P\u0141) condition if\n    \n    1/2\u2207 f () ^2    \u2265\u03bc (f() - f^*),  \u2200\u2208^d,\n\n    where f^* := inf_ f() > -\u221e is the global minimum value of f.\n\nAdditionally, we define the condition number as \u03ba := L / \u03bc, where L is the smoothness constant and \u03bc is either the strong convexity constant or the P\u0141 constant.\n\nWe also make a common assumption regarding the finite-sum setup in (<ref>), which is that the gradients of the objective function and its components are not too far from each other.\n[Bounded gradient errors]\n    \n    There exists \u03c4\u2265 0 and \u03bd\u2265 0 such that for all i = 1, \u2026, n,\n    \n    \u2207 f_i () - \u2207 F()    \u2264\u03c4\u2207 F()  + \u03bd,  \u2200\u2208^d.\n\n\nNow we define the function class  as follows.\n\n    \n    We define the function class (L, \u03bc, \u03c4, \u03bd) of objective functions F as:\n    \n    (L, \u03bc, \u03c4, \u03bd)    := { F: f_i  are L-smooth and convex, \n        := { F:  F  is \u03bc-strongly convex, \n        := { F:  F  and f_i  satisfy Assumption <ref>}.\n\n\n Note that <ref> takes into account not only the properties of F but that of the components f_i as well. Also, as seen in <ref>, (L, 0, \u03c4, \u03bd) corresponds to the case where F is convex.\n\n\n\n \u00a7.\u00a7 Algorithms\n\n\n\n\nWe denote the i-th iterate of the k-th epoch of permutation-based SGD by _i^k, where i = 0, \u2026, n and k = 1, \u2026, K. We denote the distance between the initial point _0^1 and the optimal point ^* as D := _0^1 - ^*. We also follow the conventional notation _0^k+1 = _n^k, which indicates that the final result of an epoch becomes the initial point of its subsequent epoch. At the beginning of the k-th epoch, we choose a permutation \u03c3_k : [n] \u2192 [n]. The algorithm then accesses the component functions in the order of f_\u03c3_k(1), \u2026, f_\u03c3_k(n). That is, we use the following update equation:\n\n    _i^k   = _i-1^k - \u03b7\u2207 f_\u03c3_k(i) (_i-1^k)\n\nfor i = 1, \u2026, n, where \u03b7 > 0 is a constant step size.\n\nWe particularly focus on two different types of permutation-based SGD. <ref> states theoretical results based on , which assumes that the components are randomly shuffled independently in each epoch.\n\nIn <ref>, we study the case when permutations can be carefully chosen to gain faster convergence.\nWe provide lower bounds that are applicable to any kind of permutation-based SGD.\nTo show our lower bound is tight, it suffices to show that a specific permutation-based SGD algorithm provides a matching upper bound. \nTo this end, we use offline herding SGD\u00a0<cit.>, where the components are manually ordered to \u201cbalance\u201d the gradients.\n\nSpecifically, <cit.> prove that as the gap between the partial sums of consecutive stochastic gradients and the full gradient diminishes faster, the optimizer converges faster as well.\nIn their subsequent work\u00a0<cit.>, they first propose offline herding SGD, a permutation-based SGD algorithm that manages this gap via the herding algorithm but requires intensive memory consumption, and devise online herding SGD (or ) that successfully overcomes the memory challenges. \nThey prove that both algorithms guarantee the same convergence rate 1/n^2 K^2. \nIn our setting, since we are not interested in the usability of algorithms, we will focus on offline herding SGD (or ) just for simplicity. \n<ref> provides a pseudocode of .\nFor the description of Herding subroutine in <ref>, see Assumption <ref> and <ref>.\n\n\n\n\u00a7 RANDOM RESHUFFLING\n \n\n\n\nHere we show lower bounds of  on the last iterate and arbitrary weighted averaged iterates for strongly convex objectives, and then extend results to convex functions. We stress that the lower bounds on weighted average iterates tightly match the upper bounds both for the strongly convex and convex case. \n\nThroughout <ref>, we assume that n is a positive integer with n \u2265 2. \n\n\n\n\n \u00a7.\u00a7 Lower Bound for the Final Iterate\n \n\n<ref> provides a lower bound for the final iterate of  for arbitrary step sizes \u03b7 > 0 in the \u03bc-strongly convex case.\n\ntheoremxhat\n    \n    For any n \u2265 2 and \u03ba\u2265 c_1, there exists a 3-dimensional function F \u2208 (L, \u03bc, 0, \u03bd) such that for any constant step size \u03b7 the last iterate _n^K of  satisfies\n    \n    [ F (_n^K) - F^* ]    = \u03a9( L \u03bd^2/\u03bc^2 n K^2),    if K \u2265 c_2 \u03ba, \n    \u03a9( \u03bd^2/\u03bc n K),    if K < c_2 \u03ba,\n\n    for some universal constants c_1, c_2.\n\nWe take an approach similar to <cit.>, which is to construct F by aggregating three functions, each showing a lower bound for a different step size regime. The proof of <ref> is deferred to <ref>.\n\nWe can compare <ref> with results of <cit.> for M = B = 1, which establishes a lower bound \u03a9( \u03bd/\u03bc n K^2) for the large epoch regime K \u2273\u03ba. We can observe that the lower bound for the large epoch regime is tightened by a factor of \u03ba. In fact, the lower bound in <ref> can be compactly written as:\n\n    [ F (_n^K) - F^* ]    = \u03a9( \u03bd^2/\u03bc n K\u00b7min{ 1, \u03ba/K}),\n\nwhich can be interpreted as a continuous change from \u03a9( \u03bd^2/\u03bc n K) to \u03a9( \u03ba\u03bd^2/\u03bc n K^2) as K gradually increases past the threshold K \u2265 c_2 \u03ba.\n\nWe can also compare our results with <cit.>, which provide a lower bound of rate \u03a9( \u03bd^2/\u03bc n K\u00b7min{ 1, \u03ba/K( 1/n + \u03ba/K) }) under a stronger assumption that the objective and components are all quadratic. The lower bound for the small K \u2272\u03ba regime is identical to ours, since for this case our lower bound also relies on quadratic functions. However, if K grows past \u03a9 (\u03ba), then we can observe that the lower bound in <ref> derived from non-quadratic functions is tighter by a factor of ( 1/n + \u03ba/K).\n\nAn upper bound for  in the \u03bc-strongly convex case under the step-size condition \u03b7 = O(1/Ln) is introduced in Theorem\u00a02 of <cit.>.\n[Corollary of <cit.>, Theorem\u00a02]\n    \n    Suppose that F and f_1, \u2026, f_n are all L-smooth, f_1, \u2026, f_n are convex, and F is \u03bc-strongly convex. Then, for  with constant step size\n    \n    \u03b7 = min{1/\u221a(2) L n, 1/\u03bc n Klog( \u03bc^3 n D^2 K^2/L \u03bd^2) },\n\n    the final iterate _n^K satisfies\n    \n    [ F (_n^K) - F^* ] = ( L D^2 e^- K/\u03ba +  L^2 \u03bd^2/\u03bc^3 n K^2).\n\n    \n\n\nNote that the statements in <cit.> use \u03c3_*^2 := 1/n\u2211_i=1^n\u2207 f_i (^*) ^2 instead of \u03bd^2 in the upper bound. We can easily observe that Assumption <ref> with \u03c4 = 0 and = ^* implies that \u2207 f_i (^*) ^2 \u2264\u03bd^2 for all i, and hence \u03c3_*^2 \u2264\u03bd^2.\n\nThe same applies to Proposition <ref>.\n    \nAssuming K \u2273\u03ba so that the learning rate becomes\n\n    \u03b7 = 1/\u03bc n Klog( \u03bc^3 n D^2 K^2/L \u03bd^2) \u22641/\u221a(2) L n,\n\nthen we have [ F (_n^K) - F^* ] = ( L^2 \u03bd^2/\u03bc^3 n K^2), and for this case we can observe that lower bound shown in <ref> matches the upper bound in Proposition <ref> up to a factor of \u03ba = L/\u03bc and some polylogarithmic factors.\n\n\n\n\n\n \u00a7.\u00a7 Lower Bound for Weighted Average Iterates\n \n\nFor small step sizes \u03b7 = ( 1/Ln), we can extend <ref> to arbitrary weighted average (end-of-epoch) iterates. That is, <ref> provides a lower bound which is applicable to all linear combinations of the following form,\n\n    = \u2211_k=1^K+1\u03b1_k _0^k/\u2211_k=1^K+1\u03b1_k,\n\nfor nonnegative weights \u03b1_k \u2265 0 for all k = 1, \u2026, K+1. \n\ntheoremxavg\n    \n    For any n \u2265 2 and \u03ba\u2265 c_1, there exists a 2-dimensional function F \u2208 (L, \u03bc, 0, \u03bd) such that for any constant step size \u03b7\u22641/c_2 Ln, any weighted average iterate  of  of the form as in (<ref>) satisfies\n    \n    [ F () - F^* ]    = \u03a9( L \u03bd^2/\u03bc^2 n K^2),    if K \u2265 c_2 \u03ba, \n    \u03a9( \u03bd^2/\u03bc),    if K < c_2 \u03ba,\n\n    for the same universal constants c_1, c_2 as in <ref>.\n\nThe full proof of <ref> can be found in <ref>. \nNote that, for weighted average iterates, we restrict ourselves to small step sizes \u03b7 =  (1/Ln); while this could look restrictive, such a choice of step size is commonly used in existing upper bounds, and we will see shortly that our lower bound exactly matches an upper bound when K \u2273\u03ba (<ref>). The tightness also extends to general convex cases, as seen in <ref>.\n\nOne might wonder why the lower bound becomes a constant for small K \u2272\u03ba. This is because in the \u03b7 =  (1/Ln) regime, K < c_2 \u03ba implies \u03b7 < 1/c_2 L n\u22641/\u03bc n K, i.e., the step size is too small for SGD to reach the optimum in K steps. For instance, K epochs of SGD on F(x) = f_i(x) = \u03bc/2 x^2 initialized at x = x_0 reaches the point (1 - \u03b7\u03bc)^nK x_0 > (1 - 1/nK)^nK x_0 \u2265x_0/4. Hence the iterate cannot get past x_0/4, rendering it impossible to reach the optimal point x^* = 0. \n\nThe difficulty of extending the \u03b7 = \u03a9 (1/Ln) regime in <ref> to arbitrary weighted average iterates originates from our proof strategy: for small enough \u03b7, we can show for our worst-case examples that all _0^k's (in expectation) stay on the positive side bounded away from zero, thereby proving that any weighted average also stays suffciently far from zero. However, for larger \u03b7, the iterates may oscillate between positive and negative regions, making it possible for an average iterate to converge faster than individual _0^k's.\n\nNote that our definition in (<ref>) includes the final iterate, as the choice \u03b1_k = 0 for 1 \u2264 k \u2264 K and \u03b1_K+1 = 1 yields = _0^K+1 = _n^K. Different forms of algorithm outputs other than the final iterate also frequently appear in prior works, especially regarding upper bounds for . For instance, we may choose \u03b1_k = 1 for all 2 \u2264 k \u2264 K+1 and \u03b1_1 = 0 to represent the average iterate _avg := 1/K\u2211_k=1^K_n^k <cit.>. We may also set \u03b1_k = 1 for \u2308K/2\u2309 + 1 \u2264 k \u2264 K+1 and \u03b1_k = 0 otherwise to recover the tail average iterate <cit.>, defined as _tail := 1/K - \u2308K/2\u2309 + 1\u2211_k=\u2308K/2\u2309^K_n^k.\n\nWe further show that the lower bound  in <ref> tightly matches the upper bound suggested in <ref>.\nnewpropositiontailub\n    \n    Suppose that F \u2208 (L, \u03bc, 0, \u03bd), and that we choose \u03b7 as\n    \n    \u03b7   = min{1/\u221a(2)Ln, 9/\u03bc n Kmax{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) }}.\n\n    Then, for  with constant step size \u03b7 and K \u2265 5, the tail average iterate _tail satisfies:\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    = ( L D^2/K e^- 1/9 \u221a(2)K/\u03ba + L \u03bd^2/\u03bc^2 n K^2).\n\n\nSee <ref> for a full proof of <ref>.\n\nAssuming K \u2273\u03ba so that the learning rate becomes\n\n    \u03b7   = 9/\u03bc n Kmax{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) }\u22641/\u221a(2)Ln,\n\nthen we have [ F (_tail) - F^* ] = ( L \u03bd^2/\u03bc^2 n K^2) (see Cases (c), (d) in the proof). Then we can observe that the lower bound shown in <ref> exactly matches the upper bound, ignoring polylogarithmic terms.\n\nNote that the upper bound of rate \u03a9( L \u03bd^2/\u03bc^2 n K^2) for the tail average iterate _tail is tighter than Proposition <ref> by a factor of \u03ba. Whether the same rate can also be achieved for the final iterate _n^K or not is still an open problem.\n\n\n\n\n\n\n \u00a7.\u00a7 Extension to Convex Objectives\n \n\nOne important implication of <Ref> is that we can carefully choose a small value of \u03bc to derive a lower bound that exactly matches the upper bound for convex objectives. <ref> extends <ref> to the convex case. \nnewcorollarycorcvxcase\n    \n    For any n \u2265 2, there exists a 2-dimensional function F \u2208 (L, 0, 0, \u03bd) such that if\n    \n    K    \u2265 c_3 max{L^2 D^2 n/\u03bd^2, \u03bd/L D n^1/2},\n\n    then for any constant step size \u03b7\u22641/c_2 L n, any weighted average iterate  of  of the form as in (<ref>) satisfies\n    \n    [ F() - F^* ] = \u03a9( L^1/3\u03bd^2/3 D^4/3/n^1/3 K^2/3),\n\n    for some universal constants c_2 and c_3.\n\nWe defer the proof of <ref> to <ref>.\n\nA matching upper bound for  for the convex case under the step-size condition \u03b7 =  (1/Ln) is introduced in Theorem\u00a03 of <cit.>.\n[<cit.>, Theorem\u00a03]\n    \n    Suppose that F and f_1, \u2026, f_n are all L-smooth and f_1, \u2026, f_n are convex. Then, for  with constant step size\n    \n    \u03b7 = min{1/\u221a(2) L n, ( D^2/L \u03bd^2 n^2 K)^1/3},\n\n    the average iterate _avg := 1/K\u2211_k=1^K_n^k satisfies\n    \n    \ud835\udd3c[ F(_avg) - F^* ]    = ( L D^2/\u221a(2) K + L^1/3\u03bd^2/3 D^4/3/n^1/3 K^2/3).\n\n\nIn Proposition <ref>, if we have a large number of epochs with K \u22652 \u221a(2) L^2 D^2 n/\u03bd^2, then \u03b7 = ( D^2/L \u03bd^2 n^2 K)^1/3\u22641/\u221a(2) L n yields\n\n    \ud835\udd3c[ F(_avg) - F^* ]    = ( L^1/3\u03bd^2/3 D^4/3/n^1/3 K^2/3).\n\n For a large K regime of K = \u03a9( L^2 D^2 n/\u03bd^2 + \u03bd/L D n^1/2), we may choose \u03b1_k = 1 for all k = 2, \u2026, K+1 and \u03b1_1 = 0 so that = _avg, and then observe that the lower bound in <ref> exactly matches the upper bound in Proposition <ref>. Note that the lower bound of K in (<ref>) reduces to \u03a9( L^2 D^2 n/\u03bd^2) when n = \u03a9( \u03bd^2/L^2 D^2), again matching the epoch requirement that arise in the upper bound.\n\n\n\n\u00a7 ARBITRARY PERMUTATION-BASED SGD\n \nSo far, we have considered the case where permutations are randomly shuffled for each epoch.\nIn this section, we study the scenario when permutations can be chosen manually rather than randomly.\nWe provide lower bounds that are applicable to any arbitrary permutation-based SGD.\nOur lower bounds match the previously established upper bound in terms of n and K, and can further match with respect to \u03ba when the objective is ill-conditioned.\n\n\n\n \u00a7.\u00a7 Lower Bound with Component Convexity\n \n<ref> establishes a lower bound on arbitrary weighted average (end-of-epoch) iterates applicable to any permutation-based SGD.\ntheoremgrabLBa\n    \n    For any n \u2265 2 and \u03ba\u2265 4, there exists a 4-dimensional function F \u2208(L,\u03bc,0,\u03bd) and an initialization point _0 such that for any permutation-based SGD with any constant step size \u03b7, any weighted average iterate  of the form as in <ref> satisfies\n    \n    F() - F^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2).\n\n\nThe main technical difficulty in proving <ref> is that we must construct an objective that demonstrates a \u201cslow\u201d convergence rate for every permutation over K epochs.\nTo achieve this, we construct an objective that pushes _n^k toward a constant direction, regardless of the permutation. \nThe constructed objective belongs to the class (L,\u03bc,0,\u03bd) and satisfies component convexity.\nHere we note that our proof technique does not require any assumptions about large epochs.\nThe full proof of <ref> is written in <ref>.\n\nAs mentioned in <ref>, applying \u03b1_k = 0 for 1 \u2264 k \u2264 K and \u03b1_K+1 = 1 yields the lower bound for the last iterate. \nOur result significantly improves the previous lower bound and also matches the known upper bound of permutation-based SGD which will be discussed later in this section.\n\n\n\n  \nComparison with the Previous Work. \nTo the best of our knowledge, the best-known lower bound that holds for any arbitrary permutation-based SGD is proved by <cit.> prior to our work. \nSpecifically, the authors show that there exists a (2n+1)-dimension function F \u22082L, n-1/nL, 1, 1 that for any permutation-based SGD with any constant step size,\n\n    F(_n^K) - F^* = \u03a91/L n^3 K^2.\n\nThus, <ref> improves the lower bound rate by a factor of n and sharpens the dependency on \u03ba.\n\n\nBefore we state the matching upper bound, we define an additional assumption and a function class.\n[Herding bound]\n    \n    There exists an algorithm that has the following property: Given _1, \u2026, _n\u2208^d satisfying _i\u2264 1 for \u2200 i \u2208 [n] and \u2211_i=1^n_i = 0, the algorithm outputs a permutation \u03c3 : [n] \u2192 [n] such that max_k \u2208{1, \u2026, n}\u2211_i=1^k _\u03c3(i)\u2264 H.\n\nWe call an algorithm considered in Assumption\u00a0<ref> as the Herding algorithm, used as a subroutine in Algorithm\u00a0<ref>.\n\n    \n    We define the function class _P\u0141 as follows.\n    \n    _P\u0141 (L, \u03bc, \u03c4, \u03bd)    := { F: f_i  are L-smooth, \n        := { F:  F  satisfies \u03bc-P\u0141 condition, \n        := { F:  F  and f_i  satisfy Assumption <ref>}.\n\n\nNote that _P\u0141 is a relaxation of  in Definition\u00a0<ref>. Compared to , we relax \u03bc-strong convexity to \u03bc-P\u0141, and we also do not assume convexity of component functions f_i.\n\nWe now state the following proposition, provided in Theorem 1 of <cit.>, which gives the convergence rate of <ref> for objectives belonging to _P\u0141 (L, \u03bc, 0, \u03bd).\n[<cit.>, Theorem 1]newpropositiongrabUBa\n    \n    Suppose that F \u2208_P\u0141 (L, \u03bc, 0, \u03bd). Under Assumption <ref>, with constant step size \u03b7 as\n    \n    \u03b7 = 2/\u03bc n K W_0 F(_0^1)-F^*+\u03bd^2/L\u03bc^3n^2K^2/192H^2L^2\u03bd^2,\n\n    where W_0 denotes the Lambert W function,\n    <ref> converges at the rate\n    \n    F(_n^K) - F^* = H^2 L^2 \u03bd^2/\u03bc^3 n^2 K^2\n\n    for K \u2273\u03ba.\n\nProposition <ref> is a slightly different version compared to the original paper <cit.>; the differences are discussed in <ref>.\nWe emphasize that <ref> provides a lower bound \u03a9L \u03bd^2/\u03bc^2 n^2 K^2 for arbitrary permutation-based SGD and Proposition <ref> shows that there exists an algorithm that converges at the rate of H^2 L^2 \u03bd^2/\u03bc^3 n^2 K^2.\nNote that the function class considered in the lower bound is a subset of the function class handled in the upper bound.\nThus, <ref> matches the upper bound up to a factor of \u03ba, if we ignore the term H and some polylogarithmic terms.\nTherefore, we can conclude that <ref> is optimal in terms of the convergence rate with respect to n and K.\nWe defer the discussion of herding constant H to <ref>.\n\n\n\n\n \u00a7.\u00a7 Lower Bound without Component Convexity\n \n<ref> leads us to wonder if it is possible to tighten this \u03ba gap. \nOur next theorem drops the assumption of component convexity in the lower bound and shows that we can close the gap and perfectly match the upper bound, if the problem is sufficiently ill-conditioned and the number of epochs is large enough.\ntheoremgrabLBb\n    \n    For any n \u2265 104, L and \u03bc satisfying \u03ba\u2265 8n, and K \u2265max{\u03ba^2/n, \u03ba^3/2n^1/2}, \n    there exists a 4-dimensional function F \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd and an initialization point _0 such that for any permutation-based SGD with any constant step size \u03b7, any weighted average iterate  of the form as in <ref> satisfies\n    \n    F() - F^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n\nThe proof is in <ref>.\n<ref> provides a sharper lower bound than the previous result with respect to \u03ba.\nIn our construction, some of the components f_i are nonconvex but the constructed objective F is actually strongly convex; however, for simplicity of exposition, we stated F as a member of a larger class _P\u0141.\nHere we discuss the effect of nonconvex components on the convergence rate.\n\n\n\n  \nNonconvex components.\nSome of our component functions constructed in <ref> are concave in particular directions, and this is the key to obtaining an additional \u03ba factor.\n<cit.> also observe that the presence of nonconvex components can slow down convergence.\nThey prove that for a 1-dimensional objective F(x) = 1/n\u2211_i=1^n a_i/2x^2 - b_ix, where all a_i's are nonnegative, there exists a permutation that leads to exponential convergence, but also that this no longer holds if a_i's are allowed to be negative.\nIt is an open problem whether the convergence rate of <ref> could be improved to match the lower bound in <ref> with respect to \u03ba if we additionally assume component convexity.\n\n<ref> provides a sharper lower bound compared to <ref> with respect to \u03ba.\nOne should be aware, however, that the function classes considered in the upper bound (Proposition <ref>) and the construction in <ref> mismatch.\nTherefore, Proposition <ref> does not guarantee the H^2 L^2 \u03bd^2/\u03bc^3 n^2 K^2 convergence rate for the function constructed in <ref>.\nHowever, we argue that this issue can be addressed by extending Proposition <ref> to a wider function class, which is done in prop:grabUBb.\n\n[Extended version of <cit.>, Theorem 1]newpropositiongrabUBb\n    \n    Suppose that F \u2208_P\u0141 (L, \u03bc, \u03c4, \u03bd) and n \u2265 H. Under Assumption <ref>, with constant step size \u03b7 as\n    \n    \u03b7 = 2/\u03bc n K W_0 F(_0^1)-F^*+\u03bd^2/L\u03bc^3n^2K^2/192H^2L^2\u03bd^2,\n\n    where W_0 denotes the Lambert W function, <ref> converges at the rate\n    \n    F(_n^K) - F^* = H^2 L^2 \u03bd^2/\u03bc^3 n^2 K^2\n\n    for K \u2273\u03ba (\u03c4 + 1).\n\nThe proof of Proposition <ref> is in <ref>.\nWe show that the function class considered in Proposition <ref> can be extended to  _P\u0141 (L, \u03bc, \u03c4, \u03bd) by following the proof step in Theorem 1 in <cit.> with slight modifications.\nThe function class of the upper bound (Proposition <ref>) now includes the construction of the lower bound (<ref>).\nTherefore, when the objective is sufficiently ill-conditioned and a sufficiently many epochs are performed, our lower bound perfectly aligns with the upper bound in all factors, assuring that  is indeed the optimal permutation-based SGD algorithm.\n\n\n\n\n\n \u00a7.\u00a7 Discussion of Existing Results\n \nIn this section, we take a deeper look at previous researches that address permutation-based SGD.\nWe mainly discuss the dimension dependency hidden in the upper bounds.\n\n\n\n  \nHerding Bound.\n<cit.> prove that there exists an efficient Herding algorithm that achieves Assumption <ref> with H = \u221a(d log n).\nAlso, it is well known that H = \u03a9 (\u221a(d)) <cit.>. \nThus, both Proposition <ref> and Proposition <ref> contain a dimension term in their convergence rates.\nMeanwhile, our lower bound results are based on fixed dimensional functions, so we can ignore the term H when we compare our lower bound results to the upper bound results.\nWe also note that the assumption n \u2265 H made in Proposition <ref> is quite mild if the dimension of F is independent of n.\n\n\n\n  \nComparison between Proposition <ref> and <cit.>, Theorem 1.\nIn the original statement of Theorem 1 in <cit.>, the authors use slightly different assumptions. \nInstead of smoothness with respect to the L_2 norm, they assume L_2, \u221e-smoothness as follows:\n\n    \u2207 f_i () - \u2207 f_i ()_2 \u2264 L_2, \u221e - _\u221e,  \u2200, \u2208^d.\n\n<cit.> also define the herding bound H with respect to different choices of norms. Specifically, the authors consider max_k \u2208{1, \u2026, n}\u2211_i=1^k _\u03c3(i)_\u221e\u2264 H_\u221e with max_i_i_2 \u2264 1, and explain that combining the results from <cit.> and <cit.> gives H_\u221e = 1. With these assumptions, the authors obtain the convergence rate of <ref> as the following:\n\n    F(_n^K) - F^* = H_\u221e^2 L^2_2, \u221e\u03bd^2/\u03bc^3 n^2 K^2.\n\nHowever, we believe that <ref> is not also free from dimension dependency, since the term L_2, \u221e is likely to contain the dimension dependency in general (e.g., L_2, \u221e = \u221a(d)L holds when F() = L/2^2 for \u2200\u2208^d).\nIt is an open problem whether there exists a permutation-based SGD algorithm that gives a dimension-free upper bound while maintaining the same dependency on other factors.\n\n\n\n\n\n  \nRevisiting <cit.>. We have discussed that the best-known upper bound of permutation-based SGD has dimension dependency.\nEarlier, we mentioned that our lower bound in <ref> improves upon previous results from Theorem\u00a02 of <cit.> by a factor of n.\n\nIn fact, the construction of <cit.> is based on a (2n+1)-dimensional function, and applying the upper bounds for <ref> to this function results in a convergence rate of 1/n K^2, due to the dimension dependency.\nMore precisely, for the function constructed in <cit.>, H is proportional to \u221a(n) and L is constant according to our L_2-norm-based notations, while we also have that H_\u221e is constant and L_2, \u221e is proportional to \u221a(n) following the notations in <cit.>.\nThus, in terms of n dependency, we conclude that the actual gap between existing upper and lower bounds is n^2 rather than n, and that our results succeed in closing the gap completely.\n\n\n\n\u00a7 CONCLUSION\n \n\nWe have shown convergence lower bounds for without-replacement SGD methods, focusing on matching the upper and lower bound in terms of the condition number \u03ba. Our lower bounds for  on weighted average iterates tightly match the corresponding upper bounds under both strong convexity and convexity assumptions. We also constructed lower bounds for permutation-based SGD with and without individual convexity assumptions, which tightly match the upper bounds for  in fixed-dimension settings, therefore implying that  achieves the optimal rate of convergence.\n\nAn immediate direction for future work is to investigate whether one can find lower bounds for arbitrary weighted average iterates of  when \u03b7 = \u03a9( 1/Ln). In the discussion following <ref> (<ref>), we outlined difficulties that arise in proving such a result for larger learning rates \u03b7 = \u03a9( 1/Ln).\n\n\nWe finally note that the power of general permutation-based SGD is not yet well-understood for the regime when the number of epochs is less than the condition number.\n<cit.> show that  does not enjoy faster convergence than with-replacement SGD in this regime, and it is still unclear whether the same restriction holds for permutation-based SGD as well.\n\n\n\n  \u00a7.\u00a7.\u00a7 Acknowledgments\n\nThis work was supported by Institute of Information & communications Technology Planning & evaluation (IITP) grant (No. 2019-0-00075, Artificial Intelligence Graduate School Program (KAIST)) funded by the Korea government (MSIT).\nThe work was also supported by the National Research Foundation of Korea (NRF) grant (No. NRF-2019R1A5A1028324) funded by the Korea government (MSIT). CY acknowledges support from a grant funded by Samsung Electronics Co., Ltd.\n\n\nabbrvnat\n\n\n\n\n\n\n\n\n\u00a7 TEMP\n \n\nHere we prove <ref>, restated below for the sake of readability.\n\n* \n\n\n    We prove the theorem statement for constants c_1 = 2415 and c_2 = 161.\n\n    As the convergence behavior of SGD heavily depends on the step size \u03b7, we consider three step-size regimes and use different objective functions with slow convergence rates in each case. Then we aggregate the three functions to obtain the final lower bound, which will be the minimum among the lower bounds from each regime. Throughout the proof, we will assume n is even. If n is odd, then we can use a similar technique with Theorem\u00a01 of <cit.>, which is to set n-1 nontrivial components satisfying the statement, add a single zero component function, and scale by n-1/n.\n\n    To elaborate, we prove the following lower bounds for each regime. Here F_j^* is the minimizer of F_j for each j = 1, 2, 3. Note that the union of the three ranges completely covers the set of all positive learning rates, \u03b7 > 0.\n    \n        \n  * If \u03b7\u2208( 0, 1/\u03bc n K), there exists a 1-dimensional objective function F_1 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with initialization x_0^1 = D satisfies\n        \n    \ud835\udd3c[ F_1 (x_n^K) - F_1^* ]    = \u03a9( \u03bc D^2 ).\n\n        \n  * If \u03b7\u2208[ 1/\u03bc n K, 1/161 L n], there exists a 1-dimensional objective function F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with initialization x_0^1 = \u03b7\u03bd n^1/2/27000 satisfies\n        \n    \ud835\udd3c[ F_2 (x_n^K) - F_2^* ] = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n        \n  * If \u03b7\u2265max{1/\u03bc n K, 1/161 L n}, there exists a 1-dimensional objective function F_3 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with initialization x_0^1 = 0 satisfies\n        \n    \ud835\udd3c[ F_3 (x_n^K) - F_3^* ]    = \u03a9( \u03bd^2/\u03bc n K).\n\n    \n\n    Now we define the 3-dimensional function F(x, y, z) = F_1(x) + F_2(y) + F_3(z), where F_1, F_2, and F_3 are chosen to satisfy the above lower bounds for \u03bd replaced by \u03bd/\u221a(3). Note that scaling \u03bd does not change the convergence rates above. Similarly, we denote the components by f_i(x, y, z) = f_1, i (x) + f_2, i (y) + f_3, i (z) for i = 1, \u2026, n.\n    \n    If H_1, H_2, and H_3 are L-smooth and/or \u03bc-strongly convex, then H(x, y, z) = H_1(x) + H_2(y) + H_3(z) satisfies\n    \n    \u03bc\u227cmin{\u2207^2 H_1(x), \u2207^2 H_2(y), \u2207^2 H_3(z) }\u227c\u2207^2 H(x, y, z) \u227cmax{\u2207^2 H_1(x), \u2207^2 H_2(y), \u2207^2 H_3(z) }\u227c L ,\n\n    i.e., H() must be L-smooth and/or \u03bc-strongly convex.\n    \n    Also, if H_1, H_2, and H_3 (each with n components h_1, i, h_2, i, and h_3, i) have bounded gradients (Assumption <ref>) for \u03c4 = 0 and \u03bd = \u03bd_0/\u221a(3), then H(x, y, z) = H_1(x) + H_2(y) + H_3(z) satisfies\n    \n    \u2207 h_i (x, y, z) - \u2207 H(x, y, z) ^2 \n    \n            =     \u2207 h_1, i (x) - \u2207 H_1(x) ^2 + \u2207 h_2, i (y) - \u2207 H_2(y) ^2 + \u2207 h_3, i (z) - \u2207 H_3(z) ^2 \n    \n            =     \u2264\u03bd_0^2\n\n    for all i = 1, \u2026, n, i.e., H(x, y, z) satisfies Assumption <ref> for \u03c4 = 0 and \u03bd = \u03bd_0.\n    \n    Since F_1, F_2, F_3 \u2208 (L, \u03bc, 0, \u03bd/\u221a(3)) by construction, we have F \u2208 (L, \u03bc, 0, \u03bd) from the above arguments.\n\n    Now suppose that we set D = \u03bd/\u03bc and initialize at the point ( \u03bd/\u03bc, \u03b7\u03bd n^1/2/27000, 0 ).\n\n    If K \u2265 161 \u03ba, then since 1/\u03bc n K\u22641/161 L n we can use the lower bound for F_2(y). The lower bound for this case becomes\n    \n    [ F (x_n^K, y_n^K, z_n^K) ]    = \u03a9( min{\u03bd^2/\u03bc, L \u03bd^2/\u03bc^2 n K^2, \u03bd^2/\u03bc n K}) = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n    If K < 161 \u03ba, then we cannot use the lower bound for F_2(y). Hence the lower bound for this case becomes\n    \n    [ F (x_n^K, y_n^K, z_n^K) ]    = \u03a9( min{\u03bd^2/\u03bc, \u03bd^2/\u03bc n K}) = \u03a9( \u03bd^2/\u03bc n K),\n\n    which completes the proof.\n\n\nFor the following subsections, we prove the lower bounds for F_1, F_2, and F_3 at the corresponding step size regimes. The proofs are similar to those of <cit.>, corresponding to the case M = B = 1 with slight modifications.\n\n\n\n \u00a7.\u00a7 temp\n \n\nHere we show that there exists F_1 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with x_0 = D satisfies\n\n    \ud835\udd3c[ F_1 (x_n^K) - F_1^* ]    = \u03a9( \u03bc D^2 ).\n\n\n\n    We define F_1 (x) \u2208 (\u03bc, \u03bc, 0, 0) by the following components.\n    \n    f_i (x)    = F_1(x) = \u03bc x^2/2\n\n    Note that (\u03bc, \u03bc, 0, 0) \u2286 (L, \u03bc, 0, \u03bd) and F_1^* = 0 at x^* = 0 by definition. Also note that the components have no stochasticity, and hence we can drop the expectation notation, [\u00b7]. We can easily compute per-epoch updates as:\n    \n    x_0^k+1   = (1 - \u03b7\u03bc)^n x_0^k,   \u2200 k = 1, \u2026, K.\n\n    Since x_0^1= x_0 = D and \u03b7\u22641/\u03bc n K, for any k = 1, \u2026, K we have\n    \n    x_0^k+1 = (1 - \u03b7\u03bc)^nk\u00b7 D\n            \u2265( 1 - 1/nK)^nK\u00b7 D \u2265D/4,\n\n    where the last inequality used ( 1 - 1/m)^m \u22651/4 for all m \u2265 2.\n    Hence, for the final iterate we have x_n^K \u2265D/4 and therefore\n    \n    F_1 (x_n^K)    \u2265\u03bc/2( D/4)^2 = \u03bc D^2/32,\n\n    which concludes that \ud835\udd3c[ F_1 (x_n^K) ] = F_1 (x_n^K) = \u03a9( \u03bc D^2 ).\n\n\n\n\n \u00a7.\u00a7 temp\n \n\nHere we show that there exists F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with x_0^1 = \u03b7\u03bd n^1/2/27000 satisfies\n\n    \ud835\udd3c[ F_2 (x_n^K) - F_2^* ] = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n    \n\n    For notational simplicity, we define _n as the set of all possible permutations of n/2 +1's and n/2 -1's, where n is a positive, even integer. We denote the set of randomly shuffled signs used in the k-th epoch by s^k = {s_i^k}_i=1^n\u2208_n.\n\n    Let us define the function g_+1, g_-1 as follows.\n    \n    g_+1 (x)    = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2 + \u03bd x, \n    \n            g_-1 (x)    = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2 - \u03bd x\n\n    We define F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) by the following components:\n    \n    f_+1 (x)    = g_s_i^k (x) = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2 + \u03bd s_i^k x\n\n    for some \u03bc_0 > 0, such that the finite-sum objective becomes\n    \n    F_2 (x)    = 1/n\u2211_i=1^n f_i(x) = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2.\n\n    Note that F_2^* = 0 at x^* = 0 by definition, and \u03bc_0 is different from \u03bc. (In fact, we set \u03bc_0 = L/2415\u2265\u03bc later in the proof, and ensure that the above definition indeed satisfies F_2 \u2208(L, \u03bc, 0, \u03bd) because of the condition \u03ba\u2265 2415.)\n\n    First we focus on a single epoch, and hence we write x_i instead of x_i^k, omitting the superscripts k for a while.\n    \n    We use the following three lemmas.\n    newlemmalemone\n        \n        For (fixed) x_0 \u2265 0, 0 \u2264 i \u2264\u230an/2\u230b, \u03b7\u22641/161 L n, and L/\u03bc_0\u2265 2415,\n        \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u22642/3 Lx_0 - \u03b7 L \u03bd/480\u221a(i).\n\n    \n    newlemmalemtwo\n        \n        For (fixed) x_0 \u2265 0, 0 \u2264 i \u2264 n-1, and \u03b7\u22641/161 L n,\n        \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u2264( 1 + 161/160 i \u03b7 L ) \u03bc_0 x_0 + 161/160\u03b7\u03bc_0 \u03bd\u221a(i).\n\n    \n    newlemmalemthree\n        \n        If \u03b7\u22641/161 L n, we have the followings.\n        \n            \n  * For (fixed) x_0 < 0, we have\n            \n    \ud835\udd3c[ x_n ]    \u2265( 1 - 160/161\u03b7 L n ) x_0.\n\n            \n  * If we initialize at x_0^1\u2265 0, then we always have \u2119 (x_n^k\u2265 0) \u22651/2 for future start-of-epoch iterates.\n        \n    \n    See Subsections <ref>, <ref>, and <ref> for the proofs of Lemmas <ref>, <ref>, and <ref>, respectively.\n    \n    If an epoch starts at (a fixed value) x_0 \u2265 0, then from Lemmas <ref> and <ref> we have\n    \n    [ x_n - x_0 ]    = - \u03b7\u2211_i=0^n-1\ud835\udd3c[ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ] \n       = - \u03b7\u2211_i = 0^\u230an/2\u230b\ud835\udd3c[ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ] - \u03b7\u2211_i = \u230an/2\u230b + 1^n-1\ud835\udd3c[ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ] \n       \u2265 - \u03b7\u2211_i = 0^\u230an/2\u230b( 2/3 Lx_0 - \u03b7 L \u03bd/480\u221a(i)) - \u03b7\u2211_i = \u230an/2\u230b + 1^n-1( ( 1 + 161/160 i \u03b7 L ) \u03bc_0 x_0 + 161/160\u03b7\u03bc_0 \u03bd\u221a(i)) \n       = - \u03b7( \u2211_i = 0^\u230an/2\u230b2/3 L + \u2211_i = \u230an/2\u230b + 1^n-1( 1 + 161/160 i \u03b7 L ) \u03bc_0 ) x_0 - \u03b7( - \u2211_i = 0^\u230an/2\u230b\u03b7 L \u03bd/480\u221a(i) + \u2211_i = \u230an/2\u230b + 1^n-1161/160\u03b7\u03bc_0 \u03bd\u221a(i)).\n\n    Now we can bound the coefficient of the x_0 term by the following inequality:\n    \n    \u2211_i = 0^\u230an/2\u230b2/3 L + \u2211_i = \u230an/2\u230b + 1^n-1( 1 + 161/160 i \u03b7 L ) \u03bc_0    \u2264( \u230an/2\u230b + 1 ) 2/3 L + ( n - \u230an/2\u230b - 1 ) L/2415( 1 + 1/160) \n       \u22642/3 Ln + Ln/2400\u22643/4 L n,\n\n    where we use i \u03b7 L \u2264\u03b7 L n \u22641/161. Also, the constant term can be bounded as:\n    \n    - \u2211_i = 0^\u230an/2\u230b\u03b7 L \u03bd/480\u221a(i) + \u2211_i = \u230an/2\u230b + 1^n-1161/160\u03b7\u03bc_0 \u03bd\u221a(i)   \u2264 - \u03b7 L \u03bd/480\u222b_0^\u230an/2\u230b\u221a(t) dt + 161/160\u03b7\u03bc_0 \u03bd\u222b_\u230an/2\u230b + 1^n\u221a(t) dt \n       \u2264 - \u03b7 L \u03bd/480\u00b72/3 ( \u230an/2\u230b )^3/2 + 161/160\u03b7\u03bc_0 \u03bd\u00b72/3( n^3/2 -  ( n/2 )^3/2) \n       \u2264 - \u03b7 L \u03bd/480\u00b72/3 ( n/3 )^3/2 + 161/160\u03b7\u03bc_0 \u03bd\u00b72/3\u00b72\u221a(2)-1/2\u221a(2) n^3/2\n       \u2264 - \u03b7 L \u03bd/480\u00b72/9 \u221a(3) n^3/2 + 161/160\u03b7\u03bc_0 \u03bd\u00b71/2 n^3/2\n       \u2264 - \u03b7 L \u03bd n^3/2( 2/480 \u00b7 9 \u221a(3) - 161/160 \u00b7 2 \u00b7 2415) \u2264 - \u03b7 L \u03bd n^3/2/18000,\n\n    where \u230an/2\u230b\u2265n/3 (for n \u2265 2) and 2/480 \u00b7 9 \u221a(3) - 161/160 \u00b7 2 \u00b7 2415 > 1/18000. Hence we can conclude that\n    \n    [ x_n - x_0 ]    \u2265 - \u03b7( 3/4 L n x_0 - \u03b7 L \u03bd n^3/2/18000)\n\n    and therefore\n    \n    [ x_n ]    \u2265( 1 - 3/4\u03b7 L n ) x_0 + \u03b7^2 L \u03bd n^3/2/18000.\n\n    If an epoch starts at (a fixed value) x_0 < 0, then from Lemma <ref> we have\n    \n    [ x_n ]    \u2265( 1 - 160/161\u03b7 L n ) x_0 \u2265( 1 - 3/4\u03b7 L n ) x_0.\n\n    From the second statement of Lemma <ref>, we can observe that for all epochs we have \u2119 (x^k_0) \u22651/2 because we initialize at a positive point x_0^1 \u2265\u03b7\u03bd n^1/2/27000. Therefore, taking expectations over x_0, we can conclude that each epoch must satisfy\n    \n    [ x_n ] \n               = \u2119(x_0 \u2265 0) [x_n | x_0 \u2265 0] + \u2119(x_0 < 0) [x_n | x_0 < 0]\n       \u2265\u2119(x_0 \u2265 0)  (( 1 - 3/4\u03b7 L n ) [x_0 | x_0 \u2265 0] + \u03b7^2 L \u03bd n^3/2/18000 ) + \u2119(x_0 < 0)  ( ( 1 - 3/4\u03b7 L n ) [x_0 | x_0 < 0] )\n       \u2265( 1 - 3/4\u03b7 L n ) [x_0] + \u03b7^2 L \u03bd n^3/2/36000.\n\n    Since the above holds for all \u03bc_0 \u2264L/2415, we may choose \u03bc_0 = L/2415, i.e., our function F_2 can be chosen as\n    \n    F_2 (x)    = ( L 1_x < 0 + L/24151_x \u2265 0) x^2/2.\n\n    Note that since \u03ba\u2265 2415 is equivalent to L/2415\u2265\u03bc, we have F_2(x) \u2208(L, L/2415, 0, \u03bd) \u2286(L, \u03bc, 0, \u03bd).\n\n    From here we focus on unrolling the per-epoch inequalities over all k, and hence we put the superscripts k back in our notation.\n\n    If the starting point of an epoch satisfies \ud835\udd3c [x_0^k] \u2265\u03b7\u03bd n^1/2/27000, then we can easily observe that\n    \n    \ud835\udd3c[ x_0^k+1] = \ud835\udd3c[ x_n^k]    \u2265( 1 - 3/4\u03b7 L n ) \ud835\udd3c [x_0^k] + \u03b7^2 L \u03bd n^3/2/36000\n       \u2265( 1 - 3/4\u03b7 L n ) \u00b7\u03b7\u03bd n^1/2/27000 + \u03b7^2 L \u03bd n^3/2/36000 = \u03b7\u03bd n^1/2/27000.\n\n    Therefore, if we set x_0^1 \u2265\u03b7\u03bd n^1/2/27000 then the final iterate must also maintain \ud835\udd3c [x_n^K] \u2265\u03b7\u03bd n^1/2/27000. Using \u03b7\u22651/\u03bc n K and Jensen's inequality, we can finally conclude that\n    \n    \ud835\udd3c[ F_2 ( x_n^K) ] \u2265L/2 \u00b7 2415\ud835\udd3c[ (x_n^K)^2 ] \u2265L/4830\ud835\udd3c[ x_n^K]^2    \u2265L/4830\u00b7( \u03b7\u03bd n^1/2/27000)^2 \n       \u2265L/4830\u00b7( 1/27000\u00b7\u03bd/\u03bc n^1/2 K)^2 = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n\n\n\n\n \u00a7.\u00a7 temp\n \n\nHere we show that there exists F_3 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with x_0 = 0 satisfies\n\n    \ud835\udd3c[ F_3 (x_n^K) - F_3^* ]    = \u03a9( \u03bd^2/\u03bc n K).\n\n\n\n    Let us define the function h_+1, h_-1 as follows.\n    \n    h_+1 (x)    = Lx^2/2 + \u03bd x, \n    \n            h_-1 (x)    = Lx^2/2 - \u03bd x\n\n    We define F_3 (x) \u2208 (L, L, 0, \u03bd) by the following components:\n    \n    f_i (x)    = h_s_i^k (x) = Lx^2/2 + \u03bd s_i^k x\n\n    such that the finite-sum objective can be written for some s \u2208_n as:\n    \n    F_3 (x)    = 1/n\u2211_i=1^n f_s_i(x) = L x^2/2.\n\n    Note that (L, L, 0, \u03bd) \u2286 (L, \u03bc, 0, \u03bd) and F_3^* = 0 at x^* = 0 by definition.\n    \n    First we focus on a single epoch, and hence we write x_i instead of x_i^k, omitting the superscripts k for a while.\n    \n    Since for i = 1, \u2026, n we have\n    \n    x_i+1   = x_i - \u03b7\u2207 f_i (x_i) = x_i - \u03b7 (L x_i-1 + s_i \u03bd) = (1 - \u03b7 L) x_i - \u03b7\u03bd s_i,\n\n    we can sum up the iterates to obtain\n    \n    x_n    = (1 - \u03b7 L) x_n-1 - \u03b7\u03bd s_n\n       = (1 - \u03b7 L) ( (1 - \u03b7 L) x_n-2 - \u03b7\u03bd s_n-1) - \u03b7\u03bd s_n\n         \u22ee\n       = (1 - \u03b7 L)^n x_0 - \u03b7\u03bd\u2211_i=1^n (1 - \u03b7 L)^n-i s_i.\n\n    Now we can square both terms and take expectations over s \u2208_n to obtain\n    \n    [x_n^2]    = [ ( (1 - \u03b7 L)^n x_0 - \u03b7\u03bd\u2211_i=1^n (1 - \u03b7 L)^n-i s_i)^2 ] \n       = (1 - \u03b7 L)^2n x_0^2 - 2 (1 - \u03b7 L)^n x_0\u03bd[ \u2211_i=1^n (1 - \u03b7 L)^n-i s_i] + \u03b7^2 \u03bd^2 [ ( \u2211_i=1^n (1 - \u03b7 L)^n-i s_i)^2 ] \n       = (1 - \u03b7 L)^2n x_0^2 + \u03b7^2 \u03bd^2 [ ( \u2211_i=1^n (1 - \u03b7 L)^n-i s_i)^2 ],\n\n    where the middle term is eliminated since [s_i] = 0 for all i. By Lemma\u00a01 of <cit.>, we can bound\n    \n    [ ( \u2211_i=1^n (1 - \u03b7 L)^n-i s_i)^2 ] \u2265 c \u00b7min{ 1 + 1/\u03b7 L, \u03b7^2 L^2 n^3 }\n\n    for some universal constant c > 0. Since \u03b7\u22651/161 L n, we can further lower bound the RHS by c'/\u03b7 L for some univseral constant c' > 0. Then we have\n    \n    [x_n^2]    = (1 - \u03b7 L)^2n x_0^2 + \u03b7^2 \u03bd^2 [ ( \u2211_i=1^n (1 - \u03b7 L)^n-i s_i )^2 ] \u2265 (1 - \u03b7 L)^2n x_0^2 + c' \u03b7\u03bd^2/L.\n\n\n    From here we focus on unrolling the per-epoch inequalities over all k, and hence we put the k's back in our notations.\n    \n    Unrolling the inequalities, we obtain\n    \n    [(x_n^K)^2]    \u2265 (1 - \u03b7 L)^2n [(x_n^K-1)^2] + c' \u03b7\u03bd^2/L\n         \u22ee\n       \u2265 (1 - \u03b7 L)^2nK (x_0^1)^2 + c' \u03b7\u03bd^2/L\u2211_k=0^K-1 (1 - \u03b7 L)^2nk\u2265 c' \u03b7\u03bd^2/L,\n\n    where we used x^1_0 = 0. Finally, from \u03b7\u22651/\u03bc n K we can conclude that\n    \n    [F_3 (x_n^K)] = L/2 [(x_n^K)^2] \u2265c'/2\u03b7\u03bd^2 \u2265c'/2\u03bd^2/\u03bc n K.\n\n\n\n\n\n \u00a7.\u00a7 temp\n\n\nIn this subsection, we will prove the lemmas used in <ref>.\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n* \n\n\n    From here, we use the following definition throughout the proof for notational simplicity.\n    \n        Given a permutation of signs s = { s_i }_i=1^n\u2208_n, let us denote the partial sums as _i \u225c\u2211_j=1^i s_j.\n    \n\n    For i=0, the statement is trivial since x_0 \u2265 0 and L/\u03bc_0\u2265 2415 implies\n    \n    [ (L 1_x_0 < 0 + \u03bc_0 1_x_0 \u2265 0) x_0 ]    = \u03bc_0 x_0 \u22641/2415 Lx_0 \u22642/3 Lx_0.\n\n    Hence we may assume that 1 \u2264 i \u2264\u230an/2\u230b. First observe that\n    \n    [ . (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i | _i > 0 ]    \u2264 L [ . x_i | _i > 0 ], \n    [ . (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i | _i \u2264 0 ]    \u2264\u03bc_0 [ . x_i | _i \u2264 0 ],\n\n    since (L 1_x <0 + \u03bc_0 1_x \u2265 0) \u2264 Lx and (L 1_x <0 + \u03bc_0 1_x \u2265 0) \u2264\u03bc_0 x for all x \u2208. By law of total expectations, we have\n    \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u2264 L  (_i > 0) [ . x_i | _i > 0 ] + \u03bc_0  (_i \u2264 0) [ . x_i | _i \u2264 0 ].\n\n    First we bound [ . x_i | _i > 0 ] for the former term. We can show that\n    \n    [ . x_i | _i > 0 ]    = [ . x_0 - \u03b7\u00b7\u2211_j=0^i-1( ( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) x_j + \u03bd s_i+1) | _i > 0 ] \n       = [ . x_0 - \u03b7\u00b7\u2211_j=0^i-1( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) (x_0 + (x_j - x_0)) - \u03b7\u03bd_i | _i > 0 ] \n       = x_0 [ . 1 - \u03b7\u00b7\u2211_j=0^i-1( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) | _i > 0 ] \n       = - \u03b7[ . \u2211_j=0^i-1( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) (x_j - x_0) | _i > 0 ] - \u03b7\u03bd[ . _i | _i > 0 ] \n       \u2264 x_0 [ . 1 - \u03b7\u00b7\u2211_j=0^i-1( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) | _i > 0 ] \n       = + \u03b7 L \u2211_j=0^i-1[ . | x_j - x_0 | | _i > 0 ] - \u03b7\u03bd[ . _i | _i > 0 ].\n\n    \n    Now we use the following lemmas.\n    newlemmalemfour\n        \n        If n \u2265 2 is an even number and 0 \u2264 i \u2264n/2, then \u221a(i)/10\u2264[ | _i | ] \u2264\u221a(i).\n    \n    [<cit.>, Lemma\u00a014]\n        \n        For all 0 \u2264 i \u2264 n, we have (_i > 0) = (_i < 0) \u22651/6.\n    \n    We defer the proof of <ref> to <ref>.\n    \n    Observe that the probability distribution of each _i is symmetric by our definition of _n. Therefore we have\n    \n    [ | _i | ]    = P(_i > 0) [ | _i | | _i > 0 ] + P(_i = 0) [ | _i | | _i = 0 ] + P(_i < 0) [ | _i | | _i < 0 ] \n       = P(_i > 0) [ _i | _i > 0 ] + P(_i < 0) [ - _i | _i < 0 ] \n       = 2 P(_i > 0) [ _i | _i > 0 ].\n\n    Using Lemmas <ref> and <ref>, we can obtain\n    \n    \u221a(i)/20\u2264[ | _i | ]/2\u2264[ _i | _i > 0 ] = [ | _i | ]/2 P(_i > 0)\u2264 3 [ | _i | ] \u2264 3 \u221a(i).\n\n    \n    We also use the following lemma, which is a simple application of Lemmas <ref> and <ref>.\n    newlemmalemfive\n        \n        Suppose that x_0 \u2265 0, 0 \u2264 i \u2264 n, and \u03b7\u22641/161 L n. Then we have\n        \n    [ | x_i - x_0 | ]    \u2264161/160( \u03b7 L i x_0 + \u03b7\u03bd\u221a(i)).\n\n    \n    We defer the proof of <ref> to <ref>.\n    \n    Now we bound the three terms of <ref> one by one. The first term can be bounded simply as\n    \n    x_0 [ . 1 - \u03b7\u00b7\u2211_j=0^i-1( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) | _i > 0 ]    \u2264 (1 - \u03b7\u03bc_0 i) x_0.\n\n    For the second term of <ref>, we use <ref> to obtain\n    \n    [ . | x_i - x_0 | | _i > 0 ] \u2264[ | x_i - x_0 | ]/(_i > 0)\u2264 6 [ | x_i - x_0 | ],\n\n    and then use <ref> to obtain\n    \n    \u03b7 L \u2211_j=0^i-1[ . | x_j - x_0 | | _i > 0 ]    \u2264 6 \u03b7 L \u2211_j=0^i-1[ | x_j - x_0 | ] \n       \u2264 6 \u03b7 L \u00b7161/160\u2211_j=0^i-1( \u03b7 L j x_0 + \u03b7\u03bd\u221a(j)) \n       = 483/80( \u03b7^2 L^2 x_0 \u2211_j=0^i-1 j + \u03b7^2 L \u03bd\u2211_j=0^i-1\u221a(j)) \n       \u2264483/80( \u03b7^2 L^2 x_0 \u00b71/2 i^2 + \u03b7^2 L \u03bd\u00b72/3 i^3/2) \n       \u2264483/160\u03b7^2 L^2 i^2 x_0 + 161/40\u03b7^2 L \u03bd i^3/2.\n\n    The last term of <ref> can be bounded using <ref> as\n    \n    - \u03b7\u03bd[ . _i | _i > 0 ] \u2264 - \u03b7\u03bd\u221a(i)/20.\n\n    From Equations (<ref>)-(<ref>), we have\n    \n    [ . x_i | _i > 0 ]    \u2264 (1 - \u03b7\u03bc_0 i) x_0 + 483/160\u03b7^2 L^2 i^2 x_0 + 161/40\u03b7^2 L \u03bd i^3/2 - \u03b7\u03bd\u221a(i)/20\n       = ( 1 - \u03b7\u03bc_0 i + 483/160\u03b7^2 L^2 i^2 ) x_0 - ( 1/20 - 161/40\u03b7 L i ) \u03b7\u03bd\u221a(i)\n       \u2264( 1 + 3/160 \u00b7 161) x_0 - \u03b7\u03bd\u221a(i)/40 ,\n\n    where the last inequality comes from \u03b7 L i \u2264\u03b7 L n \u22641/161.\n\n    Next we bound [ . x_i | _i \u2264 0 ] for the former term. We can show that\n    \n    [ . x_i | _i \u2264 0 ]    \u2264 x_0 + [ . | x_i - x_0 | | _i \u2264 0 ] \n       \u2264 x_0 + [ | x_i - x_0 | ]/(_i \u2264 0)\n       \u2264 x_0 + 6 [ | x_i - x_0 | ]    (\u2235<ref>) \n       \u2264 x_0 + 6 \u00b7161/160( \u03b7 L i x_0 + \u03b7\u03bd\u221a(i))    (\u2235<ref>) \n       = ( 1 + 483/80\u03b7 L i ) x_0 + 483/80\u03b7\u03bd\u221a(i)\n       = ( 1 + 3/80) x_0 + 483/80\u03b7\u03bd\u221a(i),\n\n    where the last inequality comes from \u03b7 L i \u2264\u03b7 L n \u22641/161.\n    \n    Plugging in Equations (<ref>) and (<ref>) in (<ref>), we have\n    \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u2264 L  (_i > 0) [ . x_i | _i > 0 ] + \u03bc_0  (_i \u2264 0) [ . x_i | _i \u2264 0 ] \n       \u2264 L  (_i > 0) ( ( 1 + 3/160 \u00b7 161) x_0 - \u03b7\u03bd\u221a(i)/40) \n       \u2264 + \u03bc_0  (_i \u2264 0) ( ( 1 + 3/80) x_0 + 483/80\u03b7\u03bd\u221a(i)) \n       = ( L  (_i > 0) ( 1 + 3/160 \u00b7 161) + \u03bc_0  (_i \u2264 0) ( 1 + 3/80) ) x_0 \n       \u2264 - ( L  (_i > 0) \u00b71/40 - \u03bc_0  (_i \u2264 0) \u00b7483/80) \u03b7\u03bd\u221a(i).\n\n    Since (_i > 0) = 1 - (_i = 0)/2\u22641/2 by symmetry and (_i \u2264 0) = 1 - (_i > 0) \u22645/6 by <ref>, we have\n    \n    L  (_i > 0) ( 1 + 3/160 \u00b7 161) + \u03bc_0  (_i \u2264 0) ( 1 + 3/80)    \u2264( 1/2( 1 + 3/160 \u00b7 161) + 5/6\u00b71/2415\u00b783/80) L \u22642/3L,\n\n    where we use \u03b7 L i \u22641/161, L/\u03bc\u2265 2415, and 1/2( 1 + 3/160 \u00b7 161) + 5/6\u00b71/2415\u00b783/80\u22642/3. Also, by <ref> we have\n    \n    L  (_i > 0) \u00b71/40 - \u03bc_0  (_i \u2264 0) \u00b7483/80   \u2265( 1/61/40 - 5/6\u00b71/2415\u00b7483/80) L = 1/480L,\n\n    where we use \u03b7 L i \u22641/161 and L/\u03bc\u2265 2415. Therefore we have\n    \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u22642/3 Lx_0 - \u03b7 L \u03bd/480\u221a(i).\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n* \n\n\n    Since \u03b7\u22641/161 L n, we can easily prove using <ref> as follows.\n    \n    [ (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i ]    \u2264\u03bc[ \u03bc_0 x_i ] \n       \u2264\u03bc_0 x_0 + \u03bc_0 [ | x_i - x_0 | ] \n       \u2264\u03bc_0 x_0 + \u03bc_0 161/160( \u03b7 L i x_0 + \u03b7\u03bd\u221a(i)) \n       \u2264( 1 + 161/160 i \u03b7 L ) \u03bc_0 x_0 + 161/160\u03b7\u03bc_0 \u03bd\u221a(i).\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n* \n\n\n    We divide the proof into three parts. In the first part we compare iterates to the case of using a quadratic function instead, sharing the same permutation. In the second part we assume x_0 < 0 and use Part 1 to prove the first result of the statement. In the third part we assume x_0 \u2265 0 and use Part 1 to prove the second result of the statement\n\n    Part 1. For comparison, we define and use the same function used in <ref>:\n    \n    h_+1 (x)    = Lx^2/2 + \u03bd x,   h_-1 (x) = Lx^2/2 - \u03bd x, \n    \n            h_i (x)    = h_s_i (x) = Lx^2/2 + \u03bd s_i x\n\n    such that the finite-sum objective can be written for some s \u2208_n as:\n    \n    H (x)    = 1/n\u2211_i=1^n h_s_i(x) = L x^2/2.\n\n    Now let us think of  run on the two functions F_2(x) and H(x), where both of the algorithms start from the same point x_0 and both share the same random permutation for all epochs. Let x_i, F and x_i, H be the output of the i-th iterate for  on F_2(x) and H(x), respectively. Now we use mathematical induction on i to prove that x_i, F\u2265 x_i, H. Note that this statement holds for all cases, either x_0 \u2265 0 or x_0 < 0.\n\n    Base case. For i = 0, we have x_0, F = x_0, H = x_0. \n\n    Inductive Case. We assume x_i, F\u2265 x_i, H and divide into the following cases. Note that \u03b7\u22641/161 L n implies 1 - \u03b7\u03bc\u2265 1 - \u03b7 L \u2265 1 - 1/161 n\u2265 0.\n    \n        \n  * If x_i, F\u2265 x_i, H\u2265 0, then we have\n        \n    x_i+1, F - x_i+1, H   = x_i, F - x_i, H - \u03b7( \u2207 F_2 (x_i, F) - \u2207 H (x_i, H) ) \n       = x_i, F - x_i, H - \u03b7( \u03bc x_i, F + \u03bd s_i - L x_i, H - \u03bd s_i ) \n       = (1 - \u03b7\u03bc) x_i, F - (1 - \u03b7 L) x_i, H\u2265 0,\n\n        since x_i, F\u2265 x_i, H\u2265 0 and 1 - \u03b7\u03bc\u2265 1 - \u03b7 L \u2265 0.\n        \n  * If x_i, F\u2265 0 \u2265 x_i, H, then we have\n        \n    x_i+1, F - x_i+1, H   = x_i, F - x_i, H - \u03b7( \u2207 F_2 (x_i, F) - \u2207 H (x_i, H) ) \n       = x_i, F - x_i, H - \u03b7( \u03bc x_i, F + \u03bd s_i - L x_i, H - \u03bd s_i ) \n       = (1 - \u03b7\u03bc) x_i, F - (1 - \u03b7 L) x_i, H\u2265 0,\n\n        since (1 - \u03b7\u03bc) x_i, F\u2265 0 and (1 - \u03b7 L) x_i, H\u2264 0.\n        \n  * If 0 \u2265 x_i, F\u2265 x_i, H, then we have\n        \n    x_i+1, F - x_i+1, H   = x_i, F - x_i, H - \u03b7( \u2207 F_2 (x_i, F) - \u2207 H (x_i, H) ) \n       = x_i, F - x_i, H - \u03b7( L x_i, F + \u03bd s_i - L x_i, H - \u03bd s_i ) \n       = (1 - \u03b7 L) x_i, F - (1 - \u03b7 L) x_i, H\u2265 0.\n\n    \n    \n    Hence by induction we have x_i, F\u2265 x_i, H for all i.\n\n    From the above, we can observe that [x_n, F] \u2265 [x_n, H] = (1 - \u03b7 L)^n x_0.\n    \n    Part 2. For the next step, let us assume x_0 < 0. Suppose that we define\n    \n    \u03c6(z) = 1 - 160/161 nz - (1 - z)^n.\n\n    Then for z \u2208 [0, 1 - (160/161)^1/n-1], we have \u03c6'(z) = n ((1 - z)^n-1 - 160/161) \u2265 0 and hence \u03c6(z) \u2265\u03c6(0) = 0.\n\n    Also, we can observe that for n \u2265 2:\n    \n    ( 1 - 1/161(n-1))^n-1\u2265 1 - 1/161 \u21d2 1 - ( 160/161)^1/n-1\u22651/161 (n-1)\u22651/161 n,\n\n    which implies that \u03b7 L \u22641/161 n\u2264 1 - ( 160/161)^1/n-1. Hence we have \u03c6(\u03b7 L) \u2265 0, or\n    \n    (1 - \u03b7 L)^n \u2264 1 - 160/161\u03b7 L n,\n\n    and for x_0 < 0 we have\n    \n    [x_n, H] = (1 - \u03b7 L)^n x_0 \u2265( 1 - 160/161\u03b7 L n ) x_0.\n\n    Applying Part 1, we can conclude that [x_n, F] \u2265 [x_n, H] \u2265( 1 - 160/161\u03b7 L n ) x_0.\n\n    Part 3. Now suppose that we initialize x_0 \u2265 0. For H(x) and some given permutation s \u2208_n, we have\n    \n    x_n, H   = (1 - \u03b7 L)^n x_0 - \u03b7\u03bd\u2211_i=1^n (1 - \u03b7 L)^n-i s_i.\n\n    Now let us think of pairing two permutations s, s' \u2208_n which satisfy s_i = -s_i' for all i. By definition, the set _n can be exactly partitioned into 1/2nn/2 disjoint pairs. Let us temporarily denote the final iterates obtained by choosing the permutations s and s' by x_n, H^s and x_n, H^s', respectively. Then we can observe that\n    \n    1/2 (x_n, H^s + x_n, H^s')    = (1 - \u03b7 L)^n x_0 - \u03b7\u03bd\u2211_i=1^n (1 - \u03b7 L)^n-i\u00b7( s_i + s_i'/2) = (1 - \u03b7 L)^n x_0,\n\n    which means that each pair of outcomes will be symmetric with respect to (1 - \u03b7 L)^n x_0. Hence the whole probability distribution of (1 - \u03b7 L)^-n x_n, H will stay symmetric with respect to the initial point x_0.\n\n    Considering outputs after multiple epochs, we can sequentially apply the same logic to prove that the distribution of (1 - \u03b7 L)^-nk x_n, H^k will always stay symmetric with respect to x_0^1 for all k. In other words, for each k, the distribution of outputs x_n, H^k conditioned only on the first epoch x_0^1 will be symmetric with respect to (1 - \u03b7 L)^nk x_0 \u2265 0. This automatically implies that we must have (x_n, H^k \u2265 0) \u2265(x_n, H^k \u2265 (1 - \u03b7 L)^nk x_0) \u22651/2 for any starting point x_0^1 \u2265 0. Finally, since Part\u00a01 ensures x_n, F^k \u2265 x_n, H^k, we can conclude that (x_n, F^k \u2265 0) \u2265(x_n, H^k \u2265 0) \u22651/2.\n\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n* \n\n\n    From x_i+1 = x_i - \u03b7( (L 1_x_i < 0 + \u03bc_0 1_x_i \u2265 0) x_i + \u03bd\u03c3_i), we have for all i = 1, \u2026, n:\n    \n    [ | x_i - x_0 | ]    = [ | - \u03b7\u00b7\u2211_j=0^i-1( ( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) x_j + \u03bd s_i+1) | ] \n       \u2264\u03b7\u2211_j=0^i-1[ | ( L 1_x_j < 0 + \u03bc_0 1_x_j \u2265 0) x_j | ] + \u03b7\u03bd[ | \u2211_j=1^i\u03c3_j | ] \n       \u2264\u03b7 L \u2211_j=0^i-1[ | x_j | ] + \u03b7\u03bd[ | _i | ] \n       \u2264\u03b7 L i x_0 + \u03b7 L \u2211_j=0^i-1[ | x_j - x_0| ] + \u03b7\u03bd\u221a(i).    (\u2235<ref>)\n \n    Now let us think of a sequence h(i) defined by h(0) = 0 and recursively as\n    \n    h(i) = \u03b7 L i x_0 + \u03b7 L \u2211_j=0^i-1 h(j) + \u03b7\u03bd\u221a(i),   for i = 1, \u2026, n.\n\n    Then obviously h(i) monotonically increases since h(i) - h(i-1) = \u03b7 L x_0 + \u03b7 L h(i-1) + \u03b7\u03bd (\u221a(i) - \u221a(i-1)) > 0. \n\n    We can plug in h(j) \u2264 h(i) for all j = 0, \u2026, i-1 to obtain h(i) \u2264\u03b7 L i x_0 + \u03b7 L i h(i) + \u03b7\u03bd\u221a(i), and hence\n    \n    h(i)    \u2264\u03b7 L i x_0 + \u03b7\u03bd\u221a(i)/1 - \u03b7 L i.\n\n    Also, by induction we have [ | x_i - x_0 | ] \u2264 h(i), since the sequence [ | x_i - x_0 | ] satisfies a recurrence of the same form but with an inequality. Hence, from \u03b7 L i \u2264\u03b7 L n \u22641/161 we get\n    \n    [ | x_i - x_0 | ]    \u2264\u03b7 L i x_0 + \u03b7\u03bd\u221a(i)/1 - \u03b7 L i\u22641/1 - \u03b7 L n( \u03b7 L i x_0 + \u03b7\u03bd\u221a(i)) \u2264161/160( \u03b7 L i x_0 + \u03b7\u03bd\u221a(i)).\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n\n*\n\n    We assume i \u2265 1, since the statement is vacuously true for i = 0.\n    \n    For the upper bound, we use [ | _i | ] \u2264\u221a(i) as in Lemma 12 of <cit.>.\n\n    For the lower bound, we start from the following equation in Lemma 12 of <cit.>.\n    \n    [ | _i+1| ]    = ( 1 - 1/n - i) [ | _i | ] + (s_i = 0),\n\n    where we can explicitly compute for i = 1, \u2026, n/2:\n    \n    (s_i = 0)    = 1_i  is evenii/2n-in-i/2/nn/2,\n\n    i.e., s_i = 0 is possible if and only if i is even. We also use the following lemma.\n    newlemmalemmortici\n        \n        For even, positive integers n, i with n \u2265 4 and 2 \u2264 i \u2264\u230an/2\u230b, we have\n        \n    ii/2n-in-i/2/nn/2\u22652/5\u221a(i).\n\n    \n    See <ref> for a detailed proof of <ref>.\n    \n    First suppose that i \u2265 2 is an even integer. Then since i \u2264n/2, we have\n    \n    [ | _i| ]    = ( 1 - 1/n - i + 1) [ | _i-1| ] + (s_i-1 = 0) \n       \u2265( 1 - 2/n) [ | _i-1| ] + 1_i-1  is even2/5\u221a(i-1)\n       = ( 1 - 2/n) [ | _i-1| ] \n       \u2265( 1 - 2/n) ( ( 1 - 2/n) [ | _i-2| ] + 1_i-2  is even2/5\u221a(i-2)) \n       = ( 1 - 2/n)^2 [ | _i-2| ] + ( 1 - 2/n) 2/5\u221a(i-2)\n       \u2265( 1 - 2/n)^2 [ | _i-2| ] + ( 1 - 2/n) 2/5\u221a(i).\n\n    We can also explicitly compute\n    \n    [ | _2| ]    = 2 \u00b72 \u00b7n-2n/2/nn/2 = 4 \u00b7 (n-2)! (n/2)! (n/2)!/(n/2)! (n/2 - 2)! n! = 4 (n/2) (n/2 - 1)/n (n-1) = n-1/n-2 = 1 - 1/n-1\u2265 1 - 2/n ,\n\n    from the fact that _2 = \u00b1 2 occurs for n-2n/2 cases among a total of nn/2, and _2 = 0 otherwise.\n    \n    Unrolling the inequalities in (<ref>) (while maintaining the 1/\u221a(i) term), we have\n    \n    [ | _i| ]    \u2265( 1 - 2/n)^2 [ | _i-2| ] + ( 1 - 2/n) 2/5\u221a(i)\n         \u22ee\n       \u2265( 1 - 2/n)^i-2[ | _2| ] + ( 1 - 2/n) ( \u2211_p=0^i/2 - 2 ( 1 - 2/n)^2p) 2/5\u221a(i)\n       \u2265( 1 - 2/n)^i-1 + ( 1 - 2/n) ( \u2211_p=0^i/2 - 2 ( 1 - 2/n)^2p) 2/5\u221a(i)   (\u2235<ref>) \n       \u2265( 1 - 2/n) ( \u2211_p=0^i/2 - 1 ( 1 - 2/n)^2p) 2/5\u221a(i)\n       = ( 1 - 2/n) \u00b71 - ( 1 - 2/n)^i/1 - ( 1 - 2/n)^2\u00b72/5\u221a(i)\n       = ( 1 - 2/n) \u00b71/4/n - 4/n^2\u00b7( 1 - ( 1 - 2/n)^i) \u00b72/5\u221a(i)\n       \u2265 1 \u00b7n/4\u00b7( 1 - 1/1 + 2i/n) \u00b72/5\u221a(i)\n       = n/4\u00b72i/n + 2i\u00b72/5\u221a(i) = n/n + 2i\u00b7\u221a(i)/5\u2265\u221a(i)/10.\n\n    In (<ref>) we use (1 - x)^r \u22641/1 + r x for all 0 \u2264 x \u2264 1 and r \u2265 0. Note that we have to deal with the last iterate separately since <ref> applies only for i \u2265 2. \n\n    Now suppose that i \u2265 1 is an odd integer. Then we have\n    \n    [ | _i+1| ]    = ( 1 - 1/n - i) [ | _i| ] + 1_i  is evenii/2n-in-i/2/nn/2 = ( 1 - 1/n - i) [ | _i| ]    (\u2235 i  is odd)\n\n    and since i+1 is even, we can use the previous result as\n    \n    [ | _i| ]    = n-i/n-i-1[ | _i+1| ] \u2265n-i/n-i-1\u221a(i+1)/10.\n\n    Finally, since we have 2i + 1 \u2264 n and\n    \n    (n-i)^2 (i+1) - (n-i-1)^2 i    = (n-i)^2 + (2n - 2i - 1)i \u2265 0\n\n    implies n-i/n-i-1\u2265\u221a(i)/\u221a(i+1), we can conclude that\n    \n    [ | _i| ]    \u2265n-i/n-i-1\u221a(i+1)/10\u2265\u221a(i)/10.\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 temp\n \n\n*\n    \n\n    From Theorem 1 of <cit.>, for all n \u2265 1 we have the expression\n    \n    n!    = \u221a(\u03c0(2n + \u03b1_n))\u00b7n^n/e^n,   for some value 0.333  \u2264\u03b1_n \u2264 0.354.\n\n    Since i/2\u2265 1, we have\n    \n    ii/2   = i!/((i/2)!)^2 = i^i/e^i\u00b7e^i/(i/2)^i\u221a(\u03c0(2i + \u03b1_i))/\u03c0(i + \u03b1_i/2) = 2^i \u00b7\u221a((2i + \u03b1_i))/\u221a(\u03c0)(i + \u03b1_i/2).\n\n    Then we can compute\n    \n    ii/2n-in-i/2/nn/2   = \u221a((2i + \u03b1_i))/\u221a(\u03c0)(i + \u03b1_i/2)\u221a((2(n-i) + \u03b1_n-i))/\u221a(\u03c0)(n-i + \u03b1_(n-i)/2)\u221a(\u03c0)(n + \u03b1_n/2)/\u221a((2n + \u03b1_n))\n       = 1/\u221a(\u03c0)\u221a((2i + \u03b1_i))/(i + \u03b1_i/2)\u221a((2(n-i) + \u03b1_n-i))/(n-i + \u03b1_(n-i)/2)(n + \u03b1_n/2)/\u221a((2n + \u03b1_n))\n       \u22651/\u221a(\u03c0)\u221a((2i + 0.33))/(i + 0.354)\u221a((2(n-i) + 0.33))/(n-i + 0.354)(n + 0.33)/\u221a((2n + 0.354))\n       \u22651/\u221a(\u03c0)\u221a(2i)/1.354 i\u221a((2(n-i)))/1.354(n-i)n/\u221a(2.354n) = 2/1.354^2 \u221a(2.354 \u03c0)\u221a(n)/\u221a(i(n-i))\n       \u22652/1.354^2 \u221a(2.354 \u03c0)1/\u221a(i)\u22652/5 \u221a(i),\n\n    where 2/1.354^2 \u221a(2.354 \u03c0) = 0.401157 \u2026\u2265 0.4 = 2/5.\n\n\n\n\n\u00a7 TEMP\n \n\nHere we prove <ref>, restated below for the sake of readability.\n\n* \n\n\n    We prove the theorem statement for constants c_1 = 2415 and c_2 = 161.\n    \n    Similarly as in <ref>, we use different objective functions for two step-size regimes and aggregate the functions to obtain the final lower bound. Here we also assume n is even, where we can easily extend to odd n's by the same reasoning as in <ref>.\n\n    Here we prove the following lower bounds for each regime. Here F_j^* is the minimizer of F_j for j = 1, 2. \n    \n        \n  * If \u03b7\u2208( 0, 1/\u03bc n K), there exists a 1-dimensional objective function F_1 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with initialization x_0 = D satisfies\n        \n    \ud835\udd3c[ F_1 (x\u0302) - F_1^* ]    = \u03a9( \u03bc D^2 ).\n\n        \n  * If \u03b7\u2208[ 1/\u03bc n K, 1/161 L n], there exists a 1-dimensional objective function F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with initialization x_0 = \u0398 (\u03b7\u03bd n^1/2) satisfies\n        \n    \ud835\udd3c[ F_2 (x\u0302) - F_2^* ] = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n    \n\n    Now we define the 2-dimensional function F(x, y) = F_1(x) + F_2(y), where F_1 and F_2 are chosen to satisfy the above lower bounds for \u03bd replaced by \u03bd/\u221a(2). Following the analyses in <ref>, from F_1, F_2, \u2208 (L, \u03bc, 0, \u03bd/\u221a(2)) (by construction) we have F \u2208 (L, \u03bc, 0, \u03bd).\n\n    Now suppose that we set D = \u03bd/\u03bc and initialize at the point ( \u03bd/\u03bc, \u03b7\u03bd n^1/2/27000).\n\n    If K \u2265 161 \u03ba, then since 1/\u03bc n K\u22641/161 L n we can use the lower bound for F_2(y). The lower bound for this case becomes\n    \n    [ F (x\u0302, \u0177) ]    = \u03a9( min{\u03bd^2/\u03bc, L \u03bd^2/\u03bc^2 n K^2}) = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n    If K < 161 \u03ba, then we cannot use the lower bound for F_2(y), and the lower bound for this case just becomes\n    \n    [ F (x\u0302, \u0177) ]    = \u03a9( \u03bd^2/\u03bc),\n\n    which completes the proof.\n\n\n\n\n\n\n \u00a7.\u00a7 temp\n\nHere we show that there exists F_1 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with x_0 = D satisfies\n\n    \ud835\udd3c[ F_1 (x_n^K) - F_1^* ]    = \u03a9( \u03bc D^2 ).\n\n\n\n    We define the same F_1 (x) \u2208 (\u03bc, \u03bc, 0, 0) as in <ref> by the following components.\n    \n    f_i (x)    = F_1(x) = \u03bc x^2/2\n\n    Note that (\u03bc, \u03bc, 0, 0) \u2286 (L, \u03bc, 0, \u03bd) and F_1^* = 0 at x^* = 0 by definition.\n    \n    We start from <ref> in <ref>, which gives\n    \n    x_0^k+1 = (1 - \u03b7\u03bc)^nk\u00b7 D\n            \u2265( 1 - 1/nK)^nK\u00b7 D \u2265D/4\n\n    for all k. Then for any weighted average x\u0302 we have\n    \n    x\u0302   = \u2211_k=1^K+1\u03b1_k x_0^k/\u2211_k=1^K+1\u03b1_k\u2265\u2211_k=1^K+1\u03b1_k D/4/\u2211_k=1^K+1\u03b1_k = D/4\n\n    and therefore\n    \n    F_1 (x\u0302)    \u2265\u03bc/2( D/4)^2 = \u03bc D^2/32,\n\n    which concludes that \ud835\udd3c[ F_1 (x\u0302) ] = F_1 (x\u0302) = \u03a9( \u03bc D^2 ).\n\n\n\n\n \u00a7.\u00a7 temp\n\n\nHere we show that there exists F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) such that  with x_0 = \u0398 (\u03b7\u03bd n^1/2) satisfies\n\n    \ud835\udd3c[ F_2 (x_n^K) - F_2^* ] = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n\n\n    We define the F_2 (x) \u2208 (L, \u03bc, 0, \u03bd) as in <ref> by the following components:\n    \n    f_+1 (x)    = g_s_i^k (x) = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2 + \u03bd s_i^k x\n\n    for some \u03bc_0 > 0, such that\n    \n    F_2 (x)    = 1/n\u2211_i=1^n f_i(x) = ( L 1_x < 0 + \u03bc_0 1_x \u2265 0) x^2/2.\n\n    Note that F_2^* = 0 at x^* = 0 by definition.\n\n    We start from equation <ref> in <ref>, which gives\n    \n    \ud835\udd3c[ x_0^k+1] = \ud835\udd3c[ x_n^k]    \u2265( 1 - 3/4\u03b7 L n ) \u00b7\u03b7\u03bd n^1/2/27000 + \u03b7^2 L \u03bd n^3/2/36000 = \u03b7\u03bd n^1/2/27000\n\n    for all k. If we set x_0\u2265\u03b7\u03bd n^1/2/27000 then all end-of-epoch iterates must maintain \ud835\udd3c [x_n^k] \u2265\u03b7\u03bd n^1/2/27000. This implies that for any weighted average x\u0302 we have\n    \n    \ud835\udd3c [x\u0302]    = [ \u2211_k=1^K+1\u03b1_k x_0^k/\u2211_k=1^K+1\u03b1_k] = \u2211_k=1^K+1\u03b1_k [ x_0^k ]/\u2211_k=1^K+1\u03b1_k\u2265\u2211_k=1^K+1\u03b1_k \u03b7\u03bd n^1/2/27000/\u2211_k=1^K+1\u03b1_k = \u03b7\u03bd n^1/2/27000.\n\n    Finally, using \u03b7\u22651/\u03bc n K and Jensen's inequality we have\n    \n    \ud835\udd3c[ F_2 ( x\u0302) ] \u2265L/2 \u00b7 2415\ud835\udd3c[ x\u0302^2 ] \u2265L/4830\ud835\udd3c[ x\u0302]^2    \u2265L/4830\u00b7( \u03b7\u03bd n^1/2/27000)^2 \n       \u2265L/4830\u00b7( 1/27000\u00b7\u03bd/\u03bc n^1/2 K)^2 = \u03a9( L \u03bd^2/\u03bc^2 n K^2).\n\n\n\n\n\n \u00a7.\u00a7 temp\n\n\nHere we prove <ref>, restated below for the sake of readability.\n*\n\n    Suppose that c_1, c_2 are the same constants as in <ref>, and let c_3 = max{ c_1^3/2, c_2^3 }. We start from the proof of <ref> in <ref>, except that we view _0^1 - ^*  = D as a separate constant instead of setting D = \u03bd/\u03bc. Then, if \u03bc > 0 satisfies \u03ba\u2265 c_1 and K \u2265 c_2 \u03ba, there exists some F_\u03bc\u2208(L, \u03bc, 0, \u03bd) satisfying\n    \n    [ F_\u03bc () - F_\u03bc^* ] = \u03a9( min{\u03bc D^2, L \u03bd^2/\u03bc^2 n K^2}).\n\n    Here we can let \u03bc = L^1/3\u03bd^2/3/D^2/3 n^1/3 K^2/3 and F = F_\u03bc to obtain\n    \n    [ F() ] = \u03a9( L^1/3\u03bd^2/3 D^4/3/n^1/3 K^2/3).\n\n    Also, we can check that K \u2265 c_3 \u03bd/L D n^1/2 implies \n    \n    \u03ba = L^2/3 D^2/3 n^1/3 K^2/3/\u03bd^2/3\u2265 c_3^2/3\u2265 c_1\n\n    and K \u2265 c_3 L^2 D^2 n/\u03bd^2 implies \n    \n    K \u2265 c_3^1/3L^2/3 D^2/3 n^1/3 K^2/3/\u03bd^2/3 = c_3^1/3\u03ba\u2265 c_2 \u03ba.\n\n    Finally we have F \u2208(L, \u03bc, 0, \u03bd) \u2286(L, 0, 0, \u03bd) for all \u03bc > 0, which completes the proof.\n\n\n\n\n\u00a7 TEMP\n \n\nHere we prove <ref>, restated below for the sake of readability.\n*\n\n\n    We start from the following lemma from <cit.>.\n    [<cit.>, Lemma\u00a03]\n        Assume that functions f_1, \u2026, f_n are convex and F, f_1, \u2026, f_n are L-smooth. Then  with step size \u03b7\u22641/\u221a(2) L n satisfies\n        \n    [ _0^k+1 - ^* ^2 ]    \u2264[ _0^k - ^* ^2 ] - 2 \u03b7 n [ F (_0^k+1) - F(^*)  ] + 1/2\u03b7^3 L \u03bd^2 n^2.\n\n    \n    Note that the assumptions in <ref> of (L, \u03bc, 0, \u03bd) includes all the required conditions above, plus an additional condition that F is \u03bc-strongly convex. From this additional condition, for all k we have\n    \n    [ F (_0^k+1) - F (^*)  ]    \u2265\u03bc/2[ _0^k+1 - ^* ^2 ].\n\n    Now we apply (<ref>) to only exactly half of the term involving [ F (_0^k+1) - F (^*)  ] to obtain\n    \n    ( 1 + \u03b7\u03bc n/2) [ _0^k+1 - ^* ^2 ]    \u2264[ _0^k - ^* ^2 ] - \u03b7 n [ F (_0^k+1) -F (^*)  ] + 1/2\u03b7^3 L \u03bd^2 n^2.\n\n    Since 0 \u2264\u03b7\u03bc n \u2264\u03b7 L n \u22641/\u221a(2)\u2264 1 implies 1/1 + \u03b7\u03bc n/2\u2264 1 - \u03b7\u03bc n/3 and 2/3\u22641/1 + \u03b7\u03bc n/2\u2264 1, we obtain\n    \n    [ _0^k+1 - ^* ^2 ]    \u22641/1 + \u03b7\u03bc n/2( [ _0^k - ^* ^2 ] - \u03b7 n [ F (_0^k+1) -F (^*)  ] + 1/2\u03b7^3 L \u03bd^2 n^2 ) \n       \u2264( 1 - \u03b7\u03bc n/3) [ _0^k - ^* ^2 ] - 2/3\u03b7 n [ F (_0^k+1) -F (^*)  ] + 1/2\u03b7^3 L \u03bd^2 n^2.\n\n    \n    We derive two different types of weaker inequalities from (<ref>), as:\n    \n    [ _0^k+1 - ^* ^2 ]    \u2264( 1 - \u03b7\u03bc n/3) [ _0^k - ^* ^2 ] + 1/2\u03b7^3 L \u03bd^2 n^2, \n    [ _0^k+1 - ^* ^2 ]    \u2264[ _0^k - ^* ^2 ] - 2/3\u03b7 n [ F (_0^k+1) - F (^*)  ] + 1/2\u03b7^3 L \u03bd^2 n^2.\n\n    From (<ref>), we can unroll the inequality to obtain\n    \n    [ _0^k+1 - ^* ^2 ]    \u2264( 1 - \u03b7\u03bc n/3)^k [ _0^1 - ^* ^2 ] + 1/2\u03b7^3 L \u03bd^2 n^2 \u2211_j=0^K-1( 1 - \u03b7\u03bc n/3)^j \n       \u2264( 1 - \u03b7\u03bc n/3)^k [ _0^1 - ^* ^2 ] + 1/2\u03b7^3 L \u03bd^2  n^2\u2211_j=0^\u221e( 1 - \u03b7\u03bc n/3)^j \n       = ( 1 - \u03b7\u03bc n/3)^k [ _0^1 - ^* ^2 ] + 1/2\u03b7^3 L \u03bd^2 n^2 1/1 - ( 1 - \u03b7\u03bc n/3)\n       = ( 1 - \u03b7\u03bc n/3)^k D^2 + 3/2\u00b7\u03b7^2 L \u03bd^2 n/\u03bc   (D := _0^1 - ^* ) \n       \u2264 e^- 1/3\u03b7\u03bc n k D^2 + 3/2\u00b7\u03b7^2 L \u03bd^2 n/\u03bc\n\n    which holds for all k.\n    \n    From (<ref>), we can rearrange terms as\n    \n    \u03b7 n [ F (_0^k+1) - F (^*)  ]    \u22643/2[ _0^k - ^* ^2 ] - 3/2[ _0^k+1 - ^* ^2 ] + 3/4\u03b7^3 L \u03bd^2 n^2\n\n    and average the inequality from k = \u2308K/2\u2309 to K to obtain\n    \n    \u2264\u03b7 n/K - \u2308K/2\u2309 + 1\u2211_k = \u2308K/2\u2309^K[ F (_0^k+1) - F (^*)  ] \n       \u22641/K - \u2308K/2\u2309 + 1( 3/2[ _0^\u2308K/2\u2309 - ^* ^2 ] - 3/2[ _0^K+1 - ^* ^2 ] ) + 3/4\u03b7^3 L \u03bd^2 n^2 \n       \u22643/2/K - \u2308K/2\u2309 + 1[ _0^\u2308K/2\u2309 - ^* ^2 ] + 3/4\u03b7^3 L \u03bd^2 n^2.\n\n    Therefore we have\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    = \ud835\udd3c[ F ( 1/K - \u2308K/2\u2309 + 1\u2211_k=\u2308K/2\u2309^K_n^k) - F^* ] \n       = \ud835\udd3c[ F ( 1/K - \u2308K/2\u2309 + 1\u2211_k=\u2308K/2\u2309^K_0^k+1) - F^* ] \n       \u22641/K - \u2308K/2\u2309 + 1\u2211_k=\u2308K/2\u2309^K[ F (_0^k+1) - F (^*)  ]    (\u2235Jensen's inequality) \n       \u22643/2/K - \u2308K/2\u2309 + 1\u00b71/\u03b7 n[ _0^\u2308K/2\u2309 - ^* ^2 ] + 3/4\u03b7^2 L n \u03bd^2    (\u2235By (<ref>)) \n       \u22643/\u03b7 n K[ _0^\u2308K/2\u2309 - ^* ^2 ] + 3/4\u03b7^2 L \u03bd^2 n    ( \u2235\u2308K2\u2309\u2264K2 + 1 ) \n       \u22643/\u03b7 n K( e^- 1/3\u03b7\u03bc n ( \u2308K/2\u2309 - 1 ) D^2 + 3/2\u00b7\u03b7^2 L \u03bd^2 n/\u03bc) + 1/2\u03b7^2 L \u03bd^2 n    ( \u2235By (<ref>), for k = \u2308K2\u2309) \n       = 3 D^2/\u03b7 n K e^- 1/3\u03b7\u03bc n ( \u2308K/2\u2309 - 1 ) + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n \n       \u22643D^2/\u03b7 n K e^- 1/9\u03b7\u03bc n K + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n.\n\n    \n    Note that in the last inequality, K \u2265 5 implies \u2308K/2\u2309 - 1 \u2265K/3.\n\n    Now we will divide into four possible cases according to how we choose \u03b7, and then derive that desired upper bound holds in each case from <ref>. Note that we have max{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) } = 1 if and only if K \u2264e^1/2 L^1/2\u03bd/\u03bc^3/2 n^1/2 D, which is again equivalent to \u03bc D^2 \u2264e L \u03bd^2/\u03bc^2 n K^2.\n\n    Case (a) Suppose that \u03b7 = 1/\u221a(2)Ln\u22649/\u03bc n Klog( \u03bc^3 n D^2 K^2/L \u03bd^2), where max{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) } = log( \u03bc^3 n D^2 K^2/L \u03bd^2).\n\n    From <ref> we have\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    \u22643D^2/\u03b7 n K e^- 1/9\u03b7\u03bc n K + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n \n       \u22643 \u221a(2) L D^2/K e^- 1/9 \u221a(2)K/L / \u03bc + 81/2L \u03bd^2/\u03bc^2 n K^2log( \u03bc^3 n D^2 K^2/L \u03bd^2) + 81/2L \u03bd^2/\u03bc^2 n K^2log^2 ( \u03bc^3 n D^2 K^2/L \u03bd^2) \n       = ( L D^2/K e^- 1/9 \u221a(2)K/L / \u03bc + L \u03bd^2/\u03bc^2 n K^2).\n\n\n    Case (b) Suppose that \u03b7 = 1/\u221a(2)Ln\u22649/\u03bc n K, where max{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) } = 1.\n\n    From <ref> we have\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    \u22643D^2/\u03b7 n K e^- 1/9\u03b7\u03bc n K + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n \n       \u22643 \u221a(2) L D^2/K e^- 1/9 \u221a(2)K/L / \u03bc + 81/2L \u03bd^2/\u03bc^2 n K^2 + 81/2L \u03bd^2/\u03bc^2 n K^2\n       = ( L D^2/K e^- 1/9 \u221a(2)K/L / \u03bc + L \u03bd^2/\u03bc^2 n K^2).\n\n\n    Case (c) Suppose that \u03b7 = 9/\u03bc n Klog( \u03bc^3 n D^2 K^2/L \u03bd^2) \u22641/\u221a(2)Ln, where max{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) } = log( \u03bc^3 n D^2 K^2/L \u03bd^2).\n\n    From <ref> we have\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    \u22643D^2/\u03b7 n K e^- 1/9\u03b7\u03bc n K + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n \n       = \u03bc D^2/3 log( \u03bc^3 n D^2 K^2/L \u03bd^2)\u00b7L \u03bd^2/\u03bc^3 n D^2 K^2 + 81/2L \u03bd^2/\u03bc^2 n K^2log( \u03bc^3 n D^2 K^2/L \u03bd^2) + 81/2L \u03bd^2/\u03bc^2 n K^2log^2 ( \u03bc^3 n D^2 K^2/L \u03bd^2) \n       = L \u03bd^2/\u03bc^2 n K^2( 1/3 log( \u03bc^3 n D^2 K^2/L \u03bd^2) + 81/2log( \u03bc^3 n D^2 K^2/L \u03bd^2) + 81/2log^2 ( \u03bc^3 n D^2 K^2/L \u03bd^2) ) \n       = ( L \u03bd^2/\u03bc^2 n K^2).\n\n\n    Case (d) Suppose that \u03b7 = 9/\u03bc n K\u22641/\u221a(2)Ln, where max{ 1, log( \u03bc^3 n D^2 K^2/L \u03bd^2) } = 1.\n\n    From <ref> we have\n    \n    \ud835\udd3c[ F (_tail) - F^* ]    \u22643D^2/\u03b7 n K e^- 1/9\u03b7\u03bc n K + 9/2\u00b7\u03b7 L \u03bd^2/\u03bc K + 1/2\u03b7^2 L \u03bd^2 n \n       = \u03bc D^2/3 + 81/2L \u03bd^2/\u03bc^2 n K^2 + 81/2L \u03bd^2/\u03bc^2 n K^2\n       \u2264L \u03bd^2/\u03bc^2 n K^2\u00b7( e/3 + 81 ) \n       = ( L \u03bd^2/\u03bc^2 n K^2).\n\n    Therefore <ref> holds for all cases, which completes the proof.\n\n\n\n\n\u00a7 TEMP\n \nHere we prove <ref>, restated below for the sake of readability.\n*\n\nSimilarly as in <ref>, we define objective functions for three step-size regimes and aggregate the functions to obtain the final lower bound.\nHere we also assume n is even, where we can easily extend to odd n's by the same reasoning as in <ref>.\n\nWe will prove the following lower bounds for each regime. Here F_j^* is the minimizer of F_j for j = 1, 2, 3. \n\n\n    \n  * If \u03b7\u2208( 0, 1/\u03bc n K), there exists a 1-dimensional objective function F_1(x) \u2208(L,\u03bc,0,\u03bd) such that any permutation-based SGD with initialization x_0^1 = L^1/2\u03bd/\u03bc^3/2 n K satisfies\n    \n    F_1(x\u0302) - F_1^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2).\n\n    \n  * If \u03b7\u2208[ 1/\u03bc n K, 1/L], there exists a 2-dimensional objective function F_2(y, z) \u2208L,\u03bc,0,\u221a(2)\u03bd such that any permutation-based SGD with initialization (y_0^1, z_0^1) = \u03bd/2L, 0 satisfies\n    \n    F_2(\u0177, \u1e91) - F_2^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2),\n\n    where \u0177 and \u1e91 share same weights \u03b1_k_k=1^K+1.\n    \n  * If \u03b7 > 1/L, there exists a 1-dimensional objective function F_3(w) \u2208(2L,\u03bc,0,\u03bd) such that any permutation-based SGD with initialization w_0^1 = \u03bd/\u03bc n K satisfies\n    \n    F_3(\u0175) - F_3^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2).\n\n\n\nNow we define the 4-dimensional function F() = F(x, y, z, w) = F_1(x) + F_2(y,z) + F_3(w), where F_1, F_2, and F_3 are chosen to satisfy the above lower bounds. \n\n\nFollowing the analyses in <ref>, we have F \u2208 (2L, \u03bc, 0, 2\u03bd), which allows us to directly apply the convergence rates in the lower bounds of F_1, F_2 and F_3 to the aggregated function F. \n\nIf K \u2264\u03ba/n, the second step-size regime becomes invalid. In this case, we define F(x, y, z, w) = F_1(x) + F_1(y) + F_1(z) + F_3(w) \u2208 (2L, \u03bc, 0, 2 \u03bd). The final lower bound then becomes the minimum among the lower bounds obtained for the remaining two regimes.\n\nNote that we assumed \u03ba\u2265 4 and our constructed function is 2L-smooth and \u03bc-strongly convex. Thus, \u03ba\u2265 4 is equivalent to \u03bc\u2264L/2 throughout the proof.\n\nFinally, rescaling L and \u03bd will give us the function F \u2208 (L, \u03bc, 0, \u03bd) satisfying F() - F^* = \u03a9L \u03bd^2/\u03bc^2 n^2 K^2.\n\n\nFor the following subsections, we prove the lower bounds for F_1, F_2, and F_3 at the corresponding step size regime.\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_1 (x) \u2208 (L, \u03bc, 0, \u03bd) such that any permutation-based SGD with x_0^1 = L^1/2\u03bd/\u03bc^3/2 n K satisfies\n\n    F_1(x\u0302) - F_1^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2).\n\n\n\nWe define F_1 (x) \u2208 (\u03bc, \u03bc, 0, 0) by the following components:\n\n    f_i(x) = \u03bc/2x^2.\n\nNote that (\u03bc, \u03bc, 0, 0) \u2286 (L, \u03bc, 0, \u03bd) and F_1^* = 0 at x^* = 0 by definition.\n\nIn this regime, we will see that the step size is too small so that x_n^k_k=1^K cannot even reach near the optimal point.\nWe start from x_0^1 = L^1/2\u03bd/\u03bc^3/2 n K. Since the gradient of all component functions at point x are identical to \u03bc x, regardless of the permutation-based SGD algorithm we use, we have\n\n    x_n^k = x_0^1 (1 - \u03b7\u03bc)^nk   \u2265L^1/2\u03bd/\u03bc^3/2 n K(1 - 1/nK)^nk\u2265L^1/2\u03bd/\u03bc^3/2 n K(1 - 1/nK)^nK\n       (a) > L^1/2\u03bd/\u03bc^3/2 n K1/e(1 - 1/nK) (b)\u2265L^1/2\u03bd/\u03bc^3/2 n K1/2e.\n\nwhere (a) comes from lmm:thm1_2 and (b) comes from the assumption that n \u2265 2. Therefore, we have x\u0302 = \u03a9L^1/2\u03bd/\u03bc^3/2 n K for any nonnegative weights \u03b1_k_k=1^K+1. With this x\u0302, we have\n\n    F_1(x\u0302) - F_1^* = \u03bc/2x\u0302^2 = \u03a9L \u03bd^2/\u03bc^2 n^2 K^2.\n\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_2 (y, z) \u2208 (L, \u03bc, 0, \u221a(2)\u03bd) such that any permutation-based SGD with (y_0^1, z_0^1) = \u03bd/2L, 0 satisfies\n\n    F_2(\u0177, \u1e91) - F_2^* = \u03a9( L \u03bd^2/\u03bc^2 n^2K^2).\n\n\n\nLet us define the function g_+1, g_-1 as follows.\n\n    g_+1 (x)    = ( L 1_x < 0 + L/21_x \u2265 0) x^2/2 + \u03bd x, \n    \n        g_-1 (x)    = ( L 1_x < 0 + L/21_x \u2265 0) x^2/2 - \u03bd x.\n\nNote that g_+1 and g_-1 are \u03bc-strongly convex since \u03bc\u2264L/2.\nWe define F_2 (x) \u2208 (L, \u03bc, 0, \u221a(2)\u03bd) by the following components:\n\n    f_i(y, z) =\n        \n            g_+1 (y) + g_-1 (z)     if    i \u2264n/2,\n    \n            g_-1 (y) + g_+1 (z)     otherwise.\n\nWith this construction, the finite-sum objective becomes\n\n    F_2 (y, z)    = 1/n\u2211_i=1^n f_i(y, z) = ( L 1_y < 0 + L/21_y \u2265 0) y^2/2 + ( L 1_z < 0 + L/21_z \u2265 0) z^2/2.\n\nNote that F_2^* = 0 at (y^*, z^*) = (0, 0) by definition.\n\nWe start at (y_0^1, z_0^1) = \u03bd/2L, 0.\nWe now use the following lemma to find the lower bound of y_n^k + z_n^k_k=1^K that holds for every permutation.\n\nnewlemmagrabUBalmma \n    Consider the optimization process whose setting is given as <ref>.\n    For any t \u2264n/2 - 1 and any k \u2208{ 1, \u22ef, K}, if y_2t^k + z_2t^k \u2265 0 holds, then\n    \n    y_2t+2^k + z_2t+2^k \u22651 - \u03b7 L/21 - \u03b7 Ly_2t^k + z_2t^k + \u03b7^2 L \u03bd/2\n\n    holds regardless of which functions are used at the (2t+1)-th and the (2t+2)-th iterations of the k-th epoch.\n    Consequently, if y_0^k + z_0^k \u2265\u03b7\u03bd/3 - \u03b7 L, y_n^k + z_n^k\u2265\u03b7\u03bd/3 - \u03b7 L holds regardless of the permutation \u03c3_k.\n\nThe proof of the lemma is in <ref>. In our setting, y_0^1 + z_0^1 = \u03bd/2L\u2265\u03b7\u03bd/3 - \u03b7 L since \u03b7\u22641/L. Thus, we have y_n^k + z_n^k \u2265\u03b7\u03bd/3 - \u03b7 L for every k \u2208 [K].\n\nFor \u0177 + \u1e91, we get\n\n    \u0177 + \u1e91   = \u2211_k=1^K+1\u03b1_k _0^k + _0^k/\u2211_k=1^K+1\u03b1_k\n       \u2265\u03b7\u03bd/3 - \u03b7 L\u00b7\u2211_k=1^K+1\u03b1_k/\u2211_k=1^K+1\u03b1_k = \u03b7\u03bd/3 - \u03b7 L\n       > \u03b7\u03bd/3 = \u03a9\u03bd/\u03bc n K,\n\nand using the inequality 2(a^2 + b^2) \u2265 (a + b)^2, \n\n    F_2(\u0177, \u1e91) - F_2(y^*, z^*)\n           = ( L 1_y<0 + L/21_y\u22650) \u0177^2/2 + ( L 1_z<0 + L/21_z\u22650) \u1e91^2/2\n       \u2265L/4\u0177^2 + \u1e91^2 \n       \u2265L/8(\u0177 + \u1e91)^2\n       = \u03a9(L \u03bd^2/\u03bc^2 n^2K^2).\n\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_3 (w) \u2208 (2L, \u03bc, 0, \u03bd) such that any permutation-based SGD with w_0^1 = \u03bd/\u03bc n K satisfies\n\n    F_3(\u0175) - F_3^* = \u03a9( L \u03bd^2/\u03bc^2 n^2 K^2).\n\n\n\nWe define F_3 (w) \u2208 (2L, 2L, 0, 0) by the following components:\n\n    f_i(w) = Lw^2.\n\nNote that (2L, 2L, 0, 0) \u2286 (2L, \u03bc, 0, \u03bd) and F_3^* = 0 at w^* = 0 by definition.\n\nIn this regime, we will see that the step size is too large so that w_n^k_k=1^K diverges.\nWe start from w_0^1 = \u03bd/\u03bc n K. Since the gradient of all component functions at point w are identical to 2 L w, we have for every k \u2208 [K],\n\n    w_n^k = 1 - 2 \u03b7 L^nk w_0^1 \u2265 1^nk\u03bd/\u03bc n K   = \u03a9\u03bd/\u03bc n K,\n\nwhere we used the fact that n is even in the second step.\nThus, regardless of the permutation-based SGD we use, we have \u0175 = \u03a9\u03bd/\u03bc n K and F_3(\u0175) - F_3^* = L \u0175^2 = \u03a9L \u03bd^2/\u03bc^2 n^2 K^2.\n\n\n\n\n \u00a7.\u00a7 temp\n \nIn this subsection, we will prove the lemmas used in <ref>.\n*\n\nWithout loss of generality, assume y_2t^k \u2265 z_2t^k. \nSince we assumed y_2t^k + z_2t^k is nonnegative, y_2t^k \u2265 0 holds. \nDepending on which function is used at (2t+1)-th iteration of k-th epoch, we consider following two cases:\n\n\n  * y_2t+1^k = y_2t^k - \u03b7\u2207 h(y_2t^k) - \u03bd and z_2t+1^k = z_2t^k - \u03b7\u2207 h(z_2t^k) + \u03bd, \n\n  * y_2t+1^k = y_2t^k - \u03b7\u2207 h(y_2t^k) + \u03bd and z_2t+1^k = z_2t^k - \u03b7\u2207 h(z_2t^k) - \u03bd.\n\nNote that y_2t+2^k + z_2t+2^k is independent of which function is used at (2t+2)-iteration of k-th epoch.\nThis is because y_2t+2^k = 1 - \u03b7L 1_y_2t+1^k < 0 + L/21_y_2t+1^k \u2265 0y_2t+1^k \u00b1\u03b7\u03bd and z_2t+2^k = 1 - \u03b7L 1_z_2t+1^k < 0 + L/21_z_2t+1^k \u2265 0z_2t+1^k \u2213\u03b7\u03bd so that summation of y and z results in the canceling of \u03b7\u03bd terms.\n\n\n  \nCase (a)\nFor Case (a), y_2t+1^k = (1 - \u03b7 L/2) y_2t^k + \u03b7\u03bd > 0 holds since y_2t^k \u2265 0, but the sign of z_2t^k and z_2t+1^k is undetermined.\nThereby, we split the cases by the signs of z_2t^k and z_2t+1^k.\n\nFirst, assume z_2t^k < 0 and z_2t+1^k < 0. In this setting, y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k < 0, z_2t+1^k < 0. Then,\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k + \u03b7\u03bd) + (1 - \u03b7 L) ( (1 - \u03b7 L) z_2t^k - \u03b7\u03bd)\n       =(1 - \u03b7 L/2)^2 y_2t^k + (1 - \u03b7 L)^2 z_2t^k + \u03b7^2 L \u03bd/2\n       =(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2\n    + \u03b7 L/2( (1 - \u03b7 L/2)y_2t^k - (1 - \u03b7 L)z_2t^k )\n       \u2265(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2,\n\nwhere the last inequality holds because y_2t^k \u2265 0 and z_2t^k < 0.\n\nNext, assume z_2t^k \u2265 0 and z_2t+1^k < 0. In this setting, y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k \u2265 0, z_2t+1^k < 0. Similarly,\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k + \u03b7\u03bd) + (1 - \u03b7 L) ( (1 - \u03b7 L/2)z_2t^k - \u03b7\u03bd)\n       =(1 - \u03b7 L/2)^2 y_2t^k + (1 - \u03b7 L)(1 - \u03b7 L/2) z_2t^k + \u03b7^2 L \u03bd/2\n       =(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2(1 - \u03b7 L/2) y_2t^k\n       \u2265(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\n\nFinally, assume both z_2t^k \u2265 0 and z_2t+1^k \u2265 0. In this setting, y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k \u2265 0, z_2t+1^k \u2265 0. Since 0 \u2264 z_2t+1^k = (1 - \u03b7 L/2)z_2t^k - \u03b7\u03bd, z_2t^k \u2265\u03b7\u03bd/1 - \u03b7 L / 2 holds. Then,\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L/2) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k + \u03b7\u03bd) + (1 - \u03b7 L/2) ( (1 - \u03b7 L/2) z_2t^k - \u03b7\u03bd)\n       =(1 - \u03b7 L/2)^2 y_2t^k + (1 - \u03b7 L/2)^2 z_2t^k\n       =(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 \n    + \u03b7 L/2(1 - \u03b7 L/2) (y_2t^k + z_2t^k) - \u03b7^2 L \u03bd/2\n       \u2265(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\nIn the last inequality, we used the fact that y_2t^k \u2265 0 and z_2t^k \u2265\u03b7 L/1 - \u03b7 L /2.\n\nWe don't have to consider the case when z_2t^k < 0 and z_2t+1^k \u2265 0 hold, because z_2t+1^k = (1 - \u03b7 L)z_2t^k - \u03b7\u03bd < 0 if z_2t^k < 0. \nThus, we have proven the first inequality of the lemma for Case (a).\n\n\n\n  \nCase (b)\nFor Case (b), we consider three cases depending on the signs of y_2t+1^k and z_2t+1^k.\n\nFirst, assume y_2t+1^k \u2265 0 and z_2t+1^k < 0 hold. \nIn this case, if z_2t^k \u2265 0, then z_2t+1^k = (1 - \u03b7 L/2)z_2t^k + \u03b7\u03bd > 0; therefore, z_2t^k < 0 should hold. So in this setting, we have y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k < 0, and z_2t+1^k < 0. Using this fact,\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k - \u03b7\u03bd) + (1 - \u03b7 L) ( (1 - \u03b7 L) z_2t^k + \u03b7\u03bd)\n       =(1 - \u03b7 L/2)^2 y_2t^k + (1 - \u03b7 L)^2 z_2t^k - \u03b7^2 L \u03bd/2\n       =(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2( (1 - \u03b7 L/2)y_2t^k - (1 - \u03b7 L)z_2t^k - 2\u03b7\u03bd)\n       =(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2( y_2t+1^k - z_2t+1^k )\n       \u2265(1 - \u03b7 L/2)(1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\n\nSecond, assume y_2t+1^k < 0 and z_2t+1^k \u2265 0. If z_2t^k < 0, the setting becomes y_2t^k \u2265 0, y_2t+1^k < 0, z_2t^k < 0, z_2t+1^k \u2265 0 so that\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L) y_2t+1^k + (1 - \u03b7 L/2) z_2t+1^k\n       =(1 - \u03b7 L) ( (1 - \u03b7 L/2) y_2t^k - \u03b7\u03bd) + (1 - \u03b7 L/2) ( (1 - \u03b7 L) z_2t^k + \u03b7\u03bd)\n       = (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\nIf z_2t^k \u2265 0, the setting becomes y_2t^k \u2265 0, y_2t+1^k < 0, z_2t^k \u2265 0, z_2t+1^k \u2265 0 so that\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L) y_2t+1^k + (1 - \u03b7 L/2) z_2t+1^k\n       =(1 - \u03b7 L) ( (1 - \u03b7 L/2) y_2t^k - \u03b7\u03bd) + (1 - \u03b7 L/2) ( (1 - \u03b7 L/2) z_2t^k + \u03b7\u03bd)\n       =(1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2(1 - \u03b7 L/2)z_2t^k\n       \u2265 (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\n\nLastly, assume y_2t+1^k \u2265 0 and z_2t+1^k \u2265 0. If z_2t^k < 0, the setting becomes y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k < 0, z_2t+1^k \u2265 0 so that\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L/2) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k - \u03b7\u03bd) + (1 - \u03b7 L/2) ( (1 - \u03b7 L) z_2t^k + \u03b7\u03bd)\n       = (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2((1 - \u03b7 L/2)y_2t^k - \u03b7\u03bd)\n       = (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2 + \u03b7 L/2y_2t+1^k\n       \u2265 (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\nIf z_2t^k \u2265 0, the setting becomes y_2t^k \u2265 0, y_2t+1^k \u2265 0, z_2t^k \u2265 0, z_2t+1^k \u2265 0 so that\n\n    y_2t+2^k + z_2t+2^k\n       =(1 - \u03b7 L/2) y_2t+1^k + (1 - \u03b7 L/2) z_2t+1^k\n       =(1 - \u03b7 L/2) ( (1 - \u03b7 L/2) y_2t^k - \u03b7\u03bd) + (1 - \u03b7 L/2) ( (1 - \u03b7 L/2) z_2t^k + \u03b7\u03bd)\n       = (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2+ \u03b7 L/2((1 - \u03b7 L/2)(y_2t^k + z_2t^k) - \u03b7\u03bd)\n       = (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2+ \u03b7 L/2(y_2t+1^k + (1 - \u03b7 L/2)z_2t^k )\n       \u2265 (1 - \u03b7 L)(1 - \u03b7 L/2)(y_2t^k + z_2t^k) + \u03b7^2 L \u03bd/2.\n\n\nWe do not have to consider the case when y_2t+1^k and z_2t+1^k are both less than 0, because y_2t+1^k + z_2t+1^k \u2265 0 always holds. This can be shown by case analysis on the sign of z_2t^k: if z_2t^k \u2265 0, then\n\n    y_2t+1^k + z_2t+1^k\n       = (1 - \u03b7 L/2)y_2t^k - \u03b7\u03bd + (1 - \u03b7 L/2)z_2t^k + \u03b7\u03bd\n       = (1 - \u03b7 L/2)(y_2t^k + z_2t^k) \u2265 0,\n\nand if z_2t^k < 0, then\n\n    y_2t+1^k + z_2t+1^k\n       = (1 - \u03b7 L/2)y_2t^k - \u03b7\u03bd + (1 - \u03b7 L)z_2t^k + \u03b7\u03bd\n       = (1 - \u03b7 L)(y_2t^k + z_2t^k) + \u03b7 L/2 y_2t^k \u2265 0.\n\nTherefore, we have proven the first inequality of the lemma for Case (b).\n\nPutting the results of Case (a) and (b) together, we have\n\n    y_2t+2^k + z_2t+2^k \u22651 - \u03b7 L/21 - \u03b7 Ly_2t^k + z_2t^k + \u03b7^2 L \u03bd/2\n\nfor any t \u2264n/2 - 1 and any k \u2208{1, \u22ef, K}, proving the first part of the lemma.\n\nIt now remains to prove the second part, namely that \n\n    y_n^k + z_n^k \u2265\u03b7\u03bd/3 - \u03b7 L\n\nholds if y_0^k + z_0^k \u2265\u03b7\u03bd/3 - \u03b7 L. From the first part of the lemma, we can see that the updates over a single epoch can be bounded as\n\n    y_n^k + z_n^k\n           \u22651 - \u03b7 L/21 - \u03b7 Ly_n-2^k + z_n-2^k + \u03b7^2 L \u03bd/2\n       \u2265\u22ef\n       \u22651 - \u03b7 L/2^n/21 - \u03b7 L^n/2y_0^k + z_0^k + \u03b7^2 L \u03bd/2\u00b7\u2211_i=0^n/2-11 - \u03b7 L/2^i1 - \u03b7 L^i\n       = 1 - \u03b7 L/2^n/21 - \u03b7 L^n/2y_0^k + z_0^k + \u03b7^2 L \u03bd/2\u00b71 - (1 - \u03b7 L/2)^n/2(1 - \u03b7 L)^n/2/1 - (1 - \u03b7 L/2)(1 - \u03b7 L)\n       = 1 - \u03b7 L/2^n/21 - \u03b7 L^n/2y_0^k + z_0^k + \u03b7\u03bd/3 - \u03b7 L1 - (1 - \u03b7 L/2)^n/2(1 - \u03b7 L)^n/2\n       = \u03b7\u03bd/3 - \u03b7 L + 1 - \u03b7 L/2^n/21 - \u03b7 L^n/2y_0^k + z_0^k - \u03b7\u03bd/3 - \u03b7 L.\n\nThis ends the proof of the lemma.\n\n\n\n \n    For any t \u2265 2, the following inequality holds:\n    \n    1 - 1/t^t > 1/e1 - 1/t.\n\n\n\n    \n    1 + 1/t-1^t-1 < e    t/t-1^t-1 < e\n       t-1/t^t-1 > 1/e1 - 1/t^t > 1/e1 - 1/t.\n\n\n\n\n\n\u00a7 TEMP\n \nHere we prove <ref>, restated below for the sake of readability.\n*\n\nSimilarly as in <ref>, we define objective functions for four step-size regimes and aggregate the functions to obtain the final lower bound. Here we also assume n is even, where we can easily extend to odd n's by the same reasoning as in <ref>.\n\nWe will prove the following lower bounds for each regime. Here F_j^* is the minimizer of F_j for j = 1, 2, 3, 4. \n\n\n    \n  * If \u03b7\u2208( 0, 1/2 \u03bc n K), there exists a 1-dimensional objective function F_1(x) \u2208_P\u0141(L,\u03bc,0,\u03bd) such that any permutation-based SGD with initialization x_0^1 = L \u03bd/\u03bc^2 n K satisfies\n    \n    F_1(x\u0302) - F_1^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n    \n  * If \u03b7\u2208[1/2 \u03bc n K, 2/nL], there exists a 1-dimensional objective function F_2(y) \u2208_P\u0141L,\u03bc,L/\u03bc,\u03bd such that any permutation-based SGD with initialization y_0^1 = \u03bd/60L satisfies\n    \n    F_2(\u0177) - F_2^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n    \n  * If \u03b7\u2208[2/n L, 1/L], there exists a 1-dimensional objective function F_3(z) \u2208_P\u0141L,\u03bc,L/\u03bc,\u03bd such that any permutation-based SGD with initialization z_0^1 = 3\u03bd/8nL satisfies\n    \n    F_3(\u1e91) - F_3^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n    \n  * If \u03b7 > 1/L, there exists a 1-dimensional objective function F_4(w) \u2208_P\u0141(2L,\u03bc,0,\u03bd) such that any permutation-based SGD with initialization w_0^1 = L^1/2\u03bd/\u03bc^3/2 n K satisfies\n    \n    F_4(\u0175) - F_4^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n\n\nNow we define the 4-dimensional function F() = F(x, y, z, w) = F_1(x) + F_2(y) + F_3(z) + F_4(w), where F_1, F_2, F_3, and F_4 are chosen to satisfy the above lower bounds.\n\n\nFollowing the analyses in <ref>, F is 2L-smooth and \u03bc-strongly convex. Also, if four functions H_1, H_2, H_3, and H_4 (each with n components h_1, i, h_2, i, h_3, i, and h_4, i) satisfies Assumption <ref> for \u03c4 = \u03c4_0 and \u03bd = \u03bd_0, then H() = H_1(x) + H_2(y) + H_3(z) + H_4(w) satisfies\n\n    \u2207 h_i () - \u2207 H()^2\n           = \u2207 h_1, i (x) - \u2207 H_1(x)^2 + \u2207 h_2, i (y) - \u2207 H_2(y)^2\n             + \u2207 h_3, i (z) - \u2207 H_3(z)^2 + \u2207 h_4, i (w) - \u2207 H_4(w)^2\n       \u2264\u03c4_0 H_1(x) + \u03bd_0^2 + \u03c4_0 H_2(y) + \u03bd_0^2 + \u03c4_0 H_3(z) + \u03bd_0^2 + \u03c4_0 H_4(w) + \u03bd_0^2\n       \u2264 (2\u03c4_0^2 H_1(x)^2 + 2\u03bd_0^2) + (2\u03c4_0^2 H_2(y)^2 + 2\u03bd_0^2)\n             + (2\u03c4_0^2 H_3(z)^2 + 2\u03bd_0^2) + (2\u03c4_0^2 H_4(w)^2 + 2\u03bd_0^2)\n       \u2264 2\u03c4_0^2 H_1(x)^2 +H_2(y)^2 + H_3(z)^2 + H_4(w)^2 + 8\u03bd_0^2\n       = 2\u03c4_0^2 H()^2 + 8\u03bd_0^2 < 2\u03c4_0 H() + 3\u03bd_0^2.\n\nfor all i = 1, \u2026, n, i.e., H() satisfies Assumption <ref> for \u03c4 = 2\u03c4_0 and \u03bd = 3\u03bd_0. Combining these results, we obtain F \u2208_P\u01412L,\u03bc,2L/\u03bc,3\u03bd, which allows us to directly apply the convergence rates in the lower bounds of F_1, F_2, F_3, and F_4 to the aggregated function F.\n\nNote that we assumed \u03ba\u2265 8n and our constructed function is 2L-smooth and \u03bc-strongly convex.\nThus, \u03ba\u2265 8n is equivalent to L/\u03bc\u2265 4n throughout the proof.\nAlso, since we assumed K \u2265\u03ba^2/n, K \u2265\u03ba^2/n\u2265\u03ba holds thus 1/2\u03bc n K\u22642/nL holds so all step size regimes are valid.\n\nFinally, rescaling L and \u03bd will give us the function F \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd satisfying F() - F^* = \u03a9L^2 \u03bd^2/\u03bc^3 n^2 K^2.\n\n\nFor the following subsections, we prove the lower bounds for F_1, F_2, F_3, and F_4 at the corresponding step size regime.\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_1 (x) \u2208_P\u0141 (L, \u03bc, 0, \u03bd) such that any permutation-based SGD with x_0^1 = L \u03bd/\u03bc^2 n K satisfies\n\n    F_1(x\u0302) - F_1^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n\n\nWe define F_1 (x) \u2208_P\u0141 (\u03bc, \u03bc, 0, 0) by the following components:\n\n    f_i(x) = \u03bc/2x^2.\n\nNote that _P\u0141 (\u03bc, \u03bc, 0, 0) \u2286_P\u0141 (L, \u03bc, 0, \u03bd) and F_1^* = 0 at x^* = 0 by definition.\n\nIn this regime, we will see that the step size is too small so that x_n^k_k=1^K cannot even reach near the optimal point.\nWe start from x_0^1 = L \u03bd/\u03bc^2 n K. Since the gradient of all component functions at point x are identical to \u03bc x, regardless of the permutation-based SGD algorithm we use, we have\n\n    x_n^k = x_0^1 (1 - \u03b7\u03bc)^nk   \u2265L \u03bd/\u03bc^2 n K(1 - 1/2nK)^nk\u2265L \u03bd/\u03bc^2 n K(1 - 1/2nK)^nK\n       > L \u03bd/\u03bc^2 n K(1 - 1/nK)^nK(a) > L \u03bd/\u03bc^2 n K1/e(1 - 1/nK) (b)\u2265L \u03bd/\u03bc^2 n K1/2e.\n\nwhere (a) comes from lmm:thm1_2 and (b) comes from assumption that n \u2265 2. Therefore, we have x\u0302 = \u03a9L \u03bd/\u03bc^2 n K for any nonnegative weights \u03b1_k_k=1^K+1. With this x\u0302, we have\n\n    F_1(x\u0302) - F_1^* = \u03bc/2x\u0302^2 = \u03a9L^2 \u03bd^2/\u03bc^3 n^2 K^2.\n\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_2 (y) \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd such that any permutation-based SGD with y_0^1 = \u03bd/60L satisfies\n\n    F_2(\u0177) - F_2^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2K^2).\n\n\n\nWe define F_2(y) by the following components:\n\n    f_i(y) =\n        \n            g_1(y)     if    i \u2264n/2,\n    \n            g_2(y)     otherwise,\n\nwhere\n\n    g_1(y) = L/2y^2 - \u03bd y,\n       g_2(y) = -L/21 - 2\u03bc/Ly^2 + \u03bd y.\n\nWith this construction, the finite-sum objective becomes\n\n    F_2(y) = 1/n\u2211_i=1^n f_i(y) = \u03bc/2 y^2.\n\nNote that all the components are L-smooth and F is \u03bc-strongly convex. Moreover,\n\n    \u2207 f_1(y) - \u2207 F_2(y)   = (Ly - \u03bd) - \u03bc y\u2264(L-\u03bc)y + \u03bd\n       \u2264 L y + \u03bd = L/\u03bc\u2207 F_2(y) + \u03bd,\n    \u2207 f_n/2+1(y) - \u2207 F_2(y)   = -L1 - 2\u03bc/Ly + \u03bd - \u03bc y\u2264(L - \u03bc)y + \u03bd\n       \u2264 L y + \u03bd = L/\u03bc\u2207 F_2(y) + \u03bd,\n\nand thereby F_2 \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd. Also, we can easily verify F_2^* = 0 at y^* = 0.\n\nTo simplify notation, we will write \u2207 f_i(y) = a_i y - b_i temporarily. Then, a_i \u2208L, -L1 - 2\u03bc/L, b_i \u2208\u03bd, -\u03bd holds and we can write y_n^k as\n\n    y_1^k = y_0^k - \u03b7\u2207 f_\u03c3_k(1)y_0^k   = 1 - \u03b7 a_\u03c3_k(1)y_0^k + \u03b7 b_\u03c3_k(1), \n    \n        y_2^k = y_1^k - \u03b7\u2207 f_\u03c3_k(2)y_1^k   = 1 - \u03b7 a_\u03c3_k(2)y_1^k + \u03b7 b_\u03c3_k(2)\n       = 1 - \u03b7 a_\u03c3_k(2)1 - \u03b7 a_\u03c3_k(1)y_0^k + \u03b7 b_\u03c3_k(2) + \u03b7 b_\u03c3_k(1)1 - \u03b7 a_\u03c3_k(2), \n    \u22ee\n    \n        y_n^k = y_n-1^k - \u03b7\u2207 f_\u03c3_k(n)y_n-1^k   = \u220f_i=1^n 1 - \u03b7 a_\u03c3_k(i) y_0^k + \u03b7\u2211_i=1^n b_\u03c3_k(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3_k(j).\n\nNote that S := \u220f_i=1^n 1 - \u03b7 a_\u03c3_k(i) = \u220f_i=1^n 1 - \u03b7 a_i is independent of the choice of \u03c3_k, and thus A_\u03c3 := \u03b7\u2211_i=1^n b_\u03c3(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3(j) is the term that we can control using permutation-based SGD.\n\nWe now consider which permutation \u03c3 minimizes A_\u03c3. Choose an arbitrary \u03c3 and assume there exists t \u2208{1, \u22ef, n-1 } such that f_\u03c3(t) = g_2 and f_\u03c3(t+1) = g_1. Then, define another permutation \u03c3^' by \u03c3^' (t) = \u03c3 (t+1), \u03c3^' (t+1) = \u03c3 (t) and \u03c3^' (i)= \u03c3 (i) for i \u2208{1, \u22ef, n }\u2216{t, t+1}.\n\nLet y_\u03c3 and y_\u03c3^' as the value of y_n^k generated by \u03c3 and \u03c3_1^' starting from the same y_0^k, respectively. Since b_\u03c3(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3(j) = b_\u03c3^'(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3^'(j) for i \u2208{1, \u22ef, n }\u2216{t, t+1}, we have\n\n    y_\u03c3 - y_\u03c3'   = \u220f_i=1^n 1 - \u03b7 a_\u03c3(i) y_0^k + \u03b7\u2211_i=1^n b_\u03c3(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3(j)\n              - \u220f_i=1^n 1 - \u03b7 a_\u03c3^'(i) y_0^k + \u03b7\u2211_i=1^n b_\u03c3^'(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3^'(j)\n       = \u03b7( b_\u03c3(t)\u220f_j=t+1^n1 - \u03b7 a_\u03c3(j) + b_\u03c3(t+1)\u220f_j=t+2^n1 - \u03b7 a_\u03c3(j)\n                     - b_\u03c3^'(t)\u220f_j=t+1^n1 - \u03b7 a_\u03c3^'(j) - b_\u03c3^'(t+1)\u220f_j=t+2^n1 - \u03b7 a_\u03c3^'(j)) \n       = \u03b7\u220f_j=t+2^n1 - \u03b7 a_\u03c3(j)\u00b7 -\u03bd1 - \u03b7 L + \u03bd - \u03bd1 + \u03b7 L 1 - 2\u03bc/L - (-\u03bd)\n       = \u03b7\u220f_j=t+2^n1 - \u03b7 a_\u03c3(j)\u00b7 2 \u03b7\u03bc\u03bd > 0.\n\nThereby, we can conclude that the permutation \u03c3 that minimizes A_\u03c3 should satisfy \u03c3(i) \u2264 n/2 for i \u2264 n/2 and \u03c3(i) > n/2 for i > n/2, i.e., f_\u03c3(i) = g_1 for i \u2264 n/2 and f_\u03c3(i) = g_2 for i > n/2. Let \u03c3^* denote such \u03c3.\n\nWith this permutation \u03c3^*, A_\u03c3^* becomes\n\n    A_\u03c3^*   =\u03b7\u03bd\u00b7( 1 + \u03b7 L (1 - 2 \u03bc/L) )^n/2 \u2211_i=0^n/2-1 (1 - \u03b7 L)^i - \u03b7\u03bd\u00b7\u2211_i=0^n/2-1( 1 + \u03b7 L (1 - 2 \u03bc/L) )^i.\n\nHere, we introduce \u03b2 := 1 - 2\u03bc/L and m := n/2 to simplify notation a bit. Note that \u03b2\u2265 1 - 1/m holds since we assumed L/\u03bc > n.\nThen A_\u03c3^* can be rearranged as \n\n    A_\u03c3^*   =\u03b7\u03bd\u00b7( 1 + \u03b7 L \u03b2)^m 1-(1-\u03b7 L)^m/\u03b7 L - \u03b7\u03bd\u00b7(1+\u03b7 L \u03b2)^m - 1/\u03b7 L \u03b2\n       = \u03bd/L \u03b2\u00b7( (1 + \u03b7 L \u03b2)^m (\u03b2 - 1) - \u03b2(1 + \u03b7 L \u03b2)^m (1 - \u03b7 L)^m + 1 ).\n\nUsing lmm:thm2_1 (substituting \u03b7 L to x), we have \u03bd/L \u03b2\u00b7( (1 + \u03b7 L \u03b2)^m (\u03b2 - 1) - \u03b2(1 + \u03b7 L \u03b2)^m (1 - \u03b7 L)^m + 1 ) \u2265\u03b7^2 m L \u03bd/30. \n\nWe now show a lower bound for S. \n\n    S\n           = \u220f_i=1^n 1 - \u03b7 a_i\n       = 1 - \u03b7 L^m 1 + \u03b7 L \u03b2^m \n       = (1 - \u03b7 L (1 - \u03b2) - \u03b7^2 L^2 \u03b2)^m\n       = (1 - \u03b7 L \u00b72\u03bc/L - \u03b7^2 L^2 (1 - 2\u03bc/L) )^m\n       >(1 - 2 \u03b7\u03bc - \u03b7^2 L^2)^m\n       \u2265\n        (1 - 4 \u03b7\u03bc)^m > 1 - 4 \u03b7 m \u03bc,    (if 1/2 \u03bc n K\u2264\u03b7 < 2\u03bc/L^2)\n    \n        (1 - 2 \u03b7^2 L^2)^m > 1 - 2 \u03b7^2 m L^2.    (if 2\u03bc/L^2\u2264\u03b7\u22642/nL)\n\nWe start at y_0^1 = \u03bd/60L.\nBeing aware of \u03ba = 2L/\u03bc in the construction, We first verify that\n\n    \u03bd/60L\n        = \u03bd/60LK/K\u2265\u03bd/60L\u03ba^2/nK\n        = 4L\u03bd/60 \u03bc^21/nK > L \u03bd/240 \u03bc^2 n K.\n\n\nFor the case when 1/2 \u03bc n K\u2264\u03b7 < 2\u03bc/L^2,\n\n    y_n^1\n           = S y_0^1 + A_\u03c3_1\n       \u2265 (1 - 4 \u03b7 m \u03bc) L \u03bd/240 \u03bc^2 n K + \u03b7^2 m L \u03bd/30\n       = L \u03bd/240 \u03bc^2 n K - \u03b7 L \u03bd/120 \u03bc K + \u03b7^2 n L \u03bd/60             (\u2235 n=2m)\n       = L \u03bd/240 \u03bc^2 n K - \u03b7 n L \u03bd/601/2 \u03bc n K - \u03b7\n       \u2265L \u03bd/240 \u03bc^2 n K.\n\nApplying this process in a chain, we then gain y_n^k \u2265L \u03bd/240 \u03bc^2 n K for all k \u2208{1, \u22ef, K}.\nTherefore, regardless of the choice of {\u03b1_k}_k=1^K+1, \u0177 = \u03a9L \u03bd/\u03bc^2 n K holds and F_2(\u0177) - F_2^* = \u03bc/2\u0177^2 = \u03a9L^2 \u03bd^2/\u03bc^3 n^2 K^2.\n\nFor the case when 2\u03bc/L^2\u2264\u03b7\u22642/nL, we have\n\n    y_n^1\n           = S y_0^1 + A_\u03c3_1\n       \u2265 (1 - 2 \u03b7^2 m L^2) \u03bd/60L + \u03b7^2 m L \u03bd/30\n       = \u03bd/60L.\n\nApplying this process in a chain, we then gain y_n^k \u2265\u03bd/60L for all k \u2208{1, \u22ef, K}.\nTherefore, regardless of the choice of {\u03b1_k}_k=1^K+1, \u0177 = \u03a9\u03bd/60L holds and F_2(\u0177) - F_2^* = \u03bc/2\u0177^2 = \u03a9(\u03bc\u03bd^2/L^2) = \u03a9(L^2 \u03bd^2/\u03bc^3 n^2 K^2), \nwhere we used K \u2265\u03ba^2/n in the last step.\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_3 (z) \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd such that any permutation-based SGD with z_0^1 = 3\u03bd/8nL satisfies\n\n    F_3(\u1e91) - F_3^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2K^2).\n\n\n\nWe define F_3 (z) by the following components:\n\n    f_i(z) = L/2z^2 - \u03bd z    if  i = 1,\n    \n        -L/4(n-1)z^2 + \u03bd/n-1z    otherwise.\n\nWith this construction, the finite-sum objective becomes\n\n    F_3(z) = 1/n\u2211_i=1^n f_i(z) = L/4n z^2.\n\nNote that all the components are L-smooth and F is \u03bc-strongly convex since we assumed L/4n\u2265\u03bc. Moreover,\n\n    \u2207 f_1(z) - \u2207 F_3(z)   = Lz - \u03bd - Lz/2n\u22641 - 1/2nLz + \u03bd\n       \u2264Lz + \u03bd = 2n \u2207 F_3(z) + \u03bd\u2264L/\u03bc\u2207 F_3(z) + \u03bd,\n    \u2207 f_2(z) - \u2207 F_3(z)   = -Lz/2(n-1) + \u03bd/n-1 - Lz/2n\n       < Lz + \u03bd = 2n \u2207 F_3(z) + \u03bd\u2264L/\u03bc\u2207 F_3(z) + \u03bd,\n\nand thereby F_3 \u2208_P\u0141L, \u03bc, L/\u03bc, \u03bd.\nAlso, we can easily verify F_3^* = 0 at z^* = 0.\n\nSimilarly as in (<ref>), we temporarily write \u2207 f_i(y) = a_i y - b_i where a_i \u2208L, -L/2(n-1), b_i \u2208\u03bd, -\u03bd/n-1 holds.\nWe then write y_n^k as S y_0^k + A_\u03c3_k, where S := \u220f_i=1^n 1 - \u03b7 a_\u03c3_k(i) = \u220f_i=1^n 1 - \u03b7 a_i is independent of the choice of \u03c3_k, and A_\u03c3 := \u03b7\u2211_i=1^n b_\u03c3(i)\u220f_j=i+1^n1 - \u03b7 a_\u03c3(j) is the term that we can control using permutation-based SGD.\n\n We will first find what permutation \u03c3 leads to the smallest A_\u03c3.\n Choose arbitrary \u03c3 and assume that \u03c3 (1) \u2260 1. Define t := \u03c3^-1 (1). \n We then define another permutation \u03c3^' by \u03c3^' (t-1) = 1, \u03c3^' (t) = \u03c3 (t-1) and \u03c3^' (i) = \u03c3 (i) for i \u2208{1, \u22ef, n}\u2216{t-1, t}.\n\nLet z_\u03c3 and z_\u03c3^' as the value of z_n^k generated by \u03c3 and \u03c3_1^' starting from the same z_0^k, respectively.\nWe will show that z_\u03c3_1 > z_\u03c3_1^'.\nIn a similar manner as (<ref>),\n\n    z_\u03c3 - z_\u03c3^'   = S z_0^k + A_\u03c3 - S z_0^k - A_\u03c3^'\n       = \u03b7\u220f_j=t+2^n 1 + \u03b7 L/2(n-1)\u00b7-\u03bd/n-11 - \u03b7 L + \u03bd - \u03bd1 + \u03b7 L/2(n-1) - \u03bd/n-1\n       = \u03b7\u220f_j=t+1^n 1 + \u03b7 L/2(n-1)\u00b7\u03b7 L \u03bd/2(n-1) > 0\n\nholds.\nThus, we can conclude that the permutation \u03c3 satisfying \u03c3(1) = 1 is the permutation that minimizes A_\u03c3. \nLet \u03c3^* denote such \u03c3_1. \n\nWith this permutation \u03c3^*, A_\u03c3^* becomes\n\n    A_\u03c3^*   = \u03b7\u03bd( 1 + \u03b7 L/2(n-1))^n-1 - \u03b7\u03bd/n-1\u2211_i=0^n-2( 1 + \u03b7 L/2(n-1))^i \n       = \u03b7\u03bd( 1 + \u03b7 L/2(n-1))^n-1 - \u03b7\u03bd/n-1\u00b7(1 + \u03b7 L/(2(n-1)))^n-1 - 1/\u03b7 L /(2(n-1))\n       = 2\u03bd/L - ( 1 + \u03b7 L/2(n-1))^n-1( 2\u03bd/L - \u03b7\u03bd).\n\nNote that \u03b7 L \u2264 1, so 2\u03bd/L - \u03b7\u03bd is nonnegative. Using lmm:thm2_5, we have\n\n    1 + \u03b7 L/2(n-1)^n-1 < e^\u03b7 L/2 < 1 + \u03b7 L/2 + 5 \u03b7^2 L^2/32.\n\nSubstituting (<ref>) to (<ref>) results\n\n    A_\u03c3^*   > 2\u03bd/L - (1 + \u03b7 L/2 + 5\u03b7^2 L^2/32) ( 2\u03bd/L - \u03b7\u03bd)\n       = 3\u03b7^2 L \u03bd/16 + 5 \u03b7^3 L^2 \u03bd/32\n       > 3\u03b7^2 L \u03bd/16.\n\n\n\n\n\n\n\n\n\n\n\nWe start at z_0^1 = 3\u03bd/8nL. Using S=(1 - \u03b7 L)(1 + \u03b7 L/2(n-1))^n-1 > 1 - \u03b7 L, we have\n\n    z_n^1\n           = S z_0^1 + A_\u03c3^*\n       \u2265 (1 - \u03b7 L) z_0^1 + 3\u03b7^2 L \u03bd/16\n       = (1 - \u03b7 L)3\u03bd/8nL + 3\u03b7^2 L \u03bd/16\n       = 3\u03bd/8nL - 3\u03b7\u03bd/8n + 3\u03b7^2 L \u03bd/16\n       = 3\u03bd/8nL - 3 \u03b7 L \u03bd/162/nL - \u03b7\n       \u22653\u03bd/8nL.\n\nApplying this process in a chain, we then gain z_n^k \u22653\u03bd/8nL for all k \u2208{1, \u22ef, K}.\nTherefore, regardless of the choice of {\u03b1_k}_k=1^K+1, \u1e91 = \u03a93\u03bd/8nL holds and F_3(\u1e91) - F_3^* = L/4n\u1e91^2 = \u03a9(\u03bd^2/n^3L) = \u03a9(L^2 \u03bd^2/\u03bc^3 n^2 K^2), \nwhere we used K \u2265\u03ba^3/2n^1/2 in the last step.\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nHere we show that there exists F_4 (w) \u2208_P\u0141 (2L, \u03bc, 0, \u03bd) such that any permutation-based SGD with w_0^1 = L^1/2\u03bd/\u03bc^3/2 n K satisfies\n\n    F_4(\u0175) - F_4^* = \u03a9( L^2 \u03bd^2/\u03bc^3 n^2 K^2).\n\n\n\nWe define F_4 (w) \u2208_P\u0141 (2L, 2L, 0, 0) by the following components:\n\n    f_i(w) = Lw^2.\n\nNote that _P\u0141(2L, 2L, 0, 0) \u2286_P\u0141 (2L, \u03bc, 0, \u03bd) and F_4^* = 0 at w^* = 0 by definition.\n\nIn this regime, we will see that the step size is too large so that w_n^k_k=1^K diverges.\nWe start from w_0^1 = L^1/2\u03bd/\u03bc^3/2 n K. Since the gradient of all component functions at point w are identical to 2 L w, we have for every k \u2208 [K],\n\n    w_n^k = 1 - 2 \u03b7 L^nk w_0^1 \u2265 1^nkL^1/2\u03bd/\u03bc^3/2 n K   = \u03a9L^1/2\u03bd/\u03bc^3/2 n K,\n\nwhere we used the fact that n is even in the second step.\nThus, regardless of the permutation-based SGD algorithm we use, we have \u0175 = \u03a9L^1/2\u03bd/\u03bc^3/2 n K and F_4(\u0175) - F_4^* = L \u0175^2 = \u03a9L^2 \u03bd^2/\u03bc^3 n^2 K^2.\n\n\n\n\n\n \u00a7.\u00a7 temp\n \nIn this subsection, we will prove the lemmas used in <ref>.\n \n    For any even n \u2265 104, any 0 < x \u22642/n and any 1 - 2/n\u2264\u03b2 < 1, let m=n/2. Then, the following inequality holds:\n    \n    (1 + \u03b2 x)^m (\u03b2 - 1) - \u03b2(1 + \u03b2 x)^m (1 - x)^m + 1\u2265m x^2/30.\n\n\n\n\nTo prove the lemma, we focus on the coefficients of x^k for 0 \u2264 k \u2264 2m.\n\nDefine a_k as the absolute value of x^k's coefficient in (1 + \u03b2 x)^m (\u03b2 - 1).\nUsing the fact that 1-1/m\u2264\u03b2 < 1 , a_k = |mk\u03b2^k (\u03b2 - 1) |\u2264m^k/k!\u00b71/m = m^k-1/k!. Note that for k \u2265 m+1, a_k is 0.\n\nLet b_k be x^k's coefficient in \u03b2(1 + \u03b2 x)^m (1 - x)^m.\nWhile the sequence of coefficients {b_k} have alternating signs, we can define a positive sequence c_k which upper bounds the sequence |b_k|.\nSince (1 + \u03b2 x)^m (1 - x)^m = (1 - (1 - \u03b2)x - \u03b2 x^2)^m,\n\n    |b_k|    = \u03b2\u00b7\u2211_t=max0, k-m^\u230ak/2\u230b (-\u03b2)^t (-(1-\u03b2))^k-2tm!/t!(k-2t)!(m-k+t)!\n       \u2264 1 \u00b7\u2211_t=max0, k-m^\u230ak/2\u230b\u03b2^t (1-\u03b2)^k-2tm!/t!(k-2t)!(m-k+t)!\n       \u225c c_k\n\nThen x^k's coefficient in LHS of <ref> is lower bounded by -(a_k + c_k).\nFor even k < m, we have\n\n    c_k+1/c_k   \u2264 (1 - \u03b2) max_t \u2264\u230ak/2\u230bm!/(t!(k+1-2t)!(m-k-1+t)!)/m!/(t!(k-2t)!(m-k+t)!)\n       \u22641/mmax_t \u2264\u230ak/2\u230bm-k+t/k+1-2t\n       \u22641/mmax_t \u2264\u230ak/2\u230b (m-k+t) \n       \u22641/m\u00b7 m \n       = 1.\n\nFor odd k < m, we have\n\n    c_k+1   = \u03b2^k+1/2m!/(k+1/2)!(m-k+1/2)! + \u2211_t=0^k-1/2\u03b2^t (1-\u03b2)^k+1-2tm!/t!(k+1-2t)!(m-k-1+t)!\n       < 1^k+1/2\u00b7m^k+1/2/(k+1/2)! + c_k \u00b7 (1 - \u03b2) max_t \u2264\u230ak/2\u230bm!/(t!(k+1-2t)!(m-k-1+t)!)/m!/(t!(k-2t)!(m-k+t)!)\n       \u2264m^k+1/2/(k+1/2)! + c_k.\n\nFor k \u2265 m, we have\n\n    c_k+1/c_k   \u2264 (1 - \u03b2) max_t \u2264\u230ak/2\u230bm!/(t!(k+1-2t)!(m-k-1+t)!)/m!/(t!(k-2t)!(m-k+t)!)\n       \u22641/mmax_t \u2264\u230ak/2\u230bm-k+t/k+1-2t\n       \u22641/mmax_t \u2264\u230ak/2\u230b (m-k+t) \n       \u22641/m\u00b7(m-k/2) \n       \u22641/m\u00b7m/2\n       = 1/2.\n\nUsing (<ref>), (<ref>) and (<ref>), we will show a_k + c_k \u22642\u00b7 m^k-1/k! for 4 \u2264 k \u2264 2m.\n\nNote that c_1 = (1-\u03b2)\u00b7m!/(m-1)!\u2264 1. Also, we can easily prove \u2211_i=0^pm^i/i!\u2264m^p/(p-1)! for \u2200 m \u2265 3, \u2200 2 \u2264 p \u2264 m-1 using mathematical induction. Therefore, for k \u2264 m,\n\n    c_k \u2264\u2211_i=0^k-1/2m^i/i!\u2264m^k-1/2/(k-1/2 - 1)!   if k is odd,\n    \n        c_k \u2264\u2211_i=0^k/2m^i/i!\u2264m^k/2/(k/2 - 1)!   if k is even,\n\nand applying lmm:thm2_2 and lmm:thm2_3, we finally get c_k \u2264m^k-1/k!.\n\nFor k > m,\n\n    c_k\n           \u2264 c_m \u00b7(1/2)^k-m\n       < m^m-1/m!\u00b7m/m+1\u00b7m/m+2\u00b7\u22ef\u00b7m/k\n       = m^k-1/k!.\n\nThus, we have proven a_k + c_k \u22642 \u00b7 m^k-1/k! for 4 \u2264 k \u2264 2m. This means that the absolute value of the x^k's coefficient of LHS of our statement is upper bounded by 2 \u00b7 m^k-1/k! when 4 \u2264 k \u2264 2m.\n\nWe now consider the coefficient of x^k when k < 4.\nFor k = 0, the coefficient is\n\n    (\u03b2 - 1) - \u03b2\u00b7 1 + 1 = 0.\n\nFor k = 1, the coefficient is\n\n    \u03b2 m (\u03b2 - 1) - \u03b2 (\u03b2 m - m) = 0.\n\nFor k = 2, the coefficient is\n\n    \u03b2^2 \u00b7m2\u00b7 (\u03b2 - 1) - \u03b2\u00b7( (1- \u03b2)^2 \u00b7m2 - \u03b2\u00b7 m ) = \u03b2^2 \u00b7m(m+1)/2 - \u03b2\u00b7m(m-1)/2.\n\nFor fixed m, RHS is a qudratic with respect to \u03b2, and it is minimized when \u03b2 is 1 - 1/m. Hence the above equation can be lower bounded by\n\n    1 - 1/m^2 \u00b7m(m+1)/2 - 1 - 1/m\u00b7m(m-1)/2\n       =m/2 - 1 + 1/2m\n       \u22652m/5.    (m \u2265 10).\n\nFor k=3, the coefficient is\n\n    \u03b2^3 \u00b7m3\u00b7 (\u03b2 - 1) - \u03b2\u00b7( -m3 + m \u00b7\u03b2\u00b7m2 - m2\u00b7\u03b2^2 \u00b7 m + m3\u00b7\u03b2^3 ) \n       =\u03b2/6\u00b7 m(m-1)(m-2) - \u03b2^2/2\u00b7 m^2(m-1) + \u03b2^3/3\u00b7 (m+1)m(m-1) .\n\nFor fixed m, (<ref>) is a cubic function with respect to \u03b2. Differentiating this function, we get\n\n    \u03b2^2 (m+1)m(m-1) - \u03b2 m^2(m-1) + m(m-1)(m-2)/6\n       =m(m-1) \u00b7\u03b2^2 (m+1) - \u03b2 m + m-2/6\n       =m(m-1) \u00b7\u03b2 m (\u03b2 - 1) + \u03b2^2 + m-2/6\n       \u2265 m(m-1) \u00b7 -\u03b2 + \u03b2^2 + m-2/6   (\u2235\u03b2 - 1 \u2265 -1/m)\n       = m(m-1) \u00b7\u03b2 (\u03b2 - 1) + m-2/6\n       \u2265 m(m-1) \u00b7-1/m + m-2/6   (\u2235\u03b2\u2264 1   &  \u03b2 - 1 \u2265 -1/m)\n       > 0.    (\u2235 m \u2265 4)\n\nThereby, (<ref>) is minimized when \u03b2 is 1 - 1/m, and substituting such \u03b2 to (<ref>) results\n\n    1 - 1/m/6\u00b7 m(m-1)(m-2) - 1 - 1/m^2/2\u00b7 m^2(m-1) + 1 - 1/m^3/3\u00b7 (m+1)m(m-1) \n       = -m^2/6 - 1/m + 1/3m^2 + 5/6\n       \u2265 -m^2/6.\n\nRemind that x^k's coefficient in LHS of <ref> is lower bounded by -(a_k + c_k).\nSumming up (<ref>), (<ref>), and the fact that a_k + c_k \u22642 \u00b7 m^k-1/k! for k \u2265 4, we obtain\n\n    (1 + \u03b2 x)^m (\u03b2 - 1) - \u03b2(1 + \u03b2 x)^m (1 - x)^m + 1\n       \u22652m/5 x^2 - m^2/6 x^3 - \u2211_k=4^2m x^k \u00b72 \u00b7 m^k-1/k!\n       > 2/5 mx^2 - mx/6 mx^2 - \u2211_k=4^\u221e x^k \u00b72 \u00b7 m^k-1/k!\n       \u22652/5 mx^2 - 1/6 mx^2 - mx^2 \u00b72/m^2x^2\u00b7\u2211_k=4^\u221e(mx)^k/k!   (\u2235 mx \u2264 1).\n\nFor the last term, 1/m^2x^2\u00b7\u2211_k=4^\u221e(mx)^k/k! is an increasing function of mx so it is maximized when mx is 1. \nThereby we can further extend the above inequality as:\n\n    2/5 mx^2 - 1/6 mx^2 - mx^2 \u00b7 2(e - 1 - 1/1! - 1/2! - 1/3!) \n       \u22652/5 mx^2 - 1/6 mx^2 - 1/5mx^2\n       = 1/30 mx^2.\n\n\n\n\n \n    For m \u2265 52 and even 4 \u2264 k \u2264 m, m^k-1/k! > m^k/2/(k/2 - 1 )! holds.\n\n\n\nWe first consider the case when k \u2265 14. \nSince m \u2265 k, it is sufficient to show m^k/2 - 2 > (k-1)!/(k/2 - 1 )!.\nTaking log on both sides, this inequality becomes\n\n    k/2 - 2log m > \u2211_i=k/2^k-1log i.\n\nUsing \u2211_i=k/2^k-1log i < \u222b_k/2^klog x   dx, we will instead prove following inequality when k \u2265 16:\n\n    log m > \u222b_k/2^klog x   dx/k/2 - 2 = k log k - k/2logk/2 - k/2/k/2 - 2.\n\nDefine f(X) := 2X log(2X) - X log X - X/X-2 = X log X + 2X log 2 - X/X-2. Then,\n\n    /\n        f'(X)\n           = ( X log X + 2X log 2 - X/X-2)'\n       = X - 2 log X - 4 log 2/(X-2)^2.\n\nWe can numerically check that f'(k/2) > 0 holds for k \u2265 14.\nTherefore, for fixed m, _k \u2265 14 f( k/2) = 2\u230am/2\u230b.\n\nWe now have to prove log m > f( \u230am/2\u230b).\nLet s = \u230am/2\u230b. Then f( \u230am/2\u230b) becomes\n\n    f( s ) = s log s + 2s log2 - s/s-2.\n\nCombining log m \u2265log (2s) and\n\n    log (2s) \u2265s log s + 2s log 2 - s/s-2\n       \u27fa (s-2) log (2s) \u2265 s log s + 2s log 2 - s\n       \u27fa s \u2265 (s+2) log 2 + 2 log s\n       \u27f8 s \u2265 26 \u27fa m \u2265 52,\n\nwe have proven the statement.\n\nNow, we are left to prove the lemma for k < 14. Exchanging m^k/2 and k! in the statement of the lemma, we have\n\n    m^k/2-1 > k!/k/2-1!.\n\nWe can numerically check that\n\n    \n  * for k = 4, m \u2265 25 is sufficient,\n    \n  * for k = 6, m \u2265 19 is sufficient,\n    \n  * for k = 8, m \u2265 19 is sufficient,\n    \n  * for k = 10, m \u2265 20 is sufficient,\n    \n  * for k = 12, m \u2265 21 is sufficient,\n    \n    \n\nfor (<ref>) to hold. This ends the proof of the lemma.\n\n\n\n \n    For m \u2265 52 and odd 4 \u2264 k \u2264 m,  m^k-1/k! > m^k-1/2/(k-1/2 - 1)!\n\n \n\n    m^k-1/k! = m/k\u00b7m^k-2/(k-1)! > m/k\u00b7m^k-1/2/( k-1/2 - 1 )!\u2265m^k-1/2/( k-1/2 - 1 )!,\n\nwhere we used lmm:thm2_2 in the first inequality. This ends the proof.\n\n\n\n \n    For x \u2264 1, the following inequality holds:\n    \n    e^x/2 < 1 + x/2 + 5x^2/32.\n\n\n\nUsing Taylor expansion,\n\n    e^x/2   = 1 + x/2 + x^2/8 + \u2211_i=3^\u221e1/i!\u00b7x^i/2^i\n       = 1 + x/2 + x^2/8 + x^2 \u2211_i=3^\u221e1/i!\u00b7x^i-2/2^i\n       \u2264 1 + x/2 + x^2/8 + x^2 \u2211_i=3^\u221e1/i!\u00b71/2^i\n       = 1 + x/2 + x^2/8 + x^2 e^1/2 - 1 - 1/1! \u00b7 2 - 1/2! \u00b7 2^2\n       \u2264 1 + x/2 + x^2/8 + x^2/32\n       = 1 + x/2 + 5x^2/32.\n\n\n\n\n\n\u00a7 TEMP\n \n*\n\nWhile <cit.> gained convergence rate for F \u2208\u2131_P\u0141 (L,\u03bc,0,\u03bd), \nwe found out that their result can easily be extended to F \u2208\u2131_P\u0141 (L,\u03bc,\u03c4,\u03bd) with a slight adjustment.\nWe basically follow up the proof step in Theorem 1 of <cit.>. We first state 2 lemmas that will help us prove the proposition.\n[<cit.>, Lemma 2] newlemmagrabUBlmma\n    \n    Applying offline GraB to a function F \u2208\u2131_P\u0141 (L,\u03bc,\u03c4,\u03bd) with \u03b7 n L < 1 results\n    \n    F(_n^K) - F^* \u2264\u03c1^K (F(_0^1) - F^*) + \u03b7 n L^2/2\u2211_k=1^K \u03c1^K-k\u0394_k^2 - \u03b7 n/4\u2211_k=1^K\u03c1^K-k\u2207 F(_0^k)^2,\n\n    where \u03c1 = 1 - \u03b7 n \u03bc/2 and \u0394_k = max_m=1, \u22ef , n_m^k - _0^k for all k \u2208 [K].\n\n[Extended version of <cit.>, Lemma 3]newlemmagrabUBlmmb\n    \n    Applying offline GraB to a function F \u2208\u2131_P\u0141 (L,\u03bc,\u03c4,\u03bd) with \u03b7 n L \u22641/2 results\n    \n    \u0394_1 \u2264 2 \u03b7 n \u03bd + 2 \u03b7 n (\u03c4+1) \u00b7\u2207 F(_0^1),    and\n       \u0394_k \u2264 2\u03b7 H \u03bd + (2\u03b7 H \u03c4 + 2\u03b7 n) \u00b7\u2016\u2207 F ( _0^k ) \u2016 + ( 4\u03b7 HL(\u03c4+1) + 8\u03b7 nL ) \u00b7\u0394_k-1\n\nfor k \u2208 [K]\u2216{1}.\n\nWe defer the proofs of the lemmas to <ref>.\nWe start by finding the upper bound of \u2211_k=1^K \u03c1^K-k\u0394_k^2. From lmm:grabUBlmm2, we have\n\n    \u0394_k \u2264 2\u03b7 H \u03bd + (2\u03b7 H \u03c4 + 2\u03b7 n) \u00b7\u2207 F ( _0^k ) +  4\u03b7 HL(\u03c4+1) + 8\u03b7 nL \u00b7\u0394_k-1\n\nfor k \u2208 [K] \u2216{1}. Taking square on both sides and applying the inequality 3 a^2 + b^2 + c^2\u2265a + b + c^2, we get\n\n    \u0394_k^2 \u2264 3 \u03b7^2 (4 HL(\u03c4+1) + 8nL )^2 \u0394_k-1^2 + 12 \u03b7^2 H^2 \u03bd^2 + 12 \u03b7^2 (H\u03c4+n)^2 \u2016\u2207 F ( _0^k ) \u2016^2.\n\nSimilarly, for k=1, we have\n\n    \u0394_1^2 \u2264 8 \u03b7^2 n^2 (\u03c4+1)^2 \u2016\u2207 F(_0^1) \u2016^2 + 8 \u03b7^2 n^2 \u03bd^2.\n\nHence,\n\n    \u2211_k=1^K \u03c1^K-k\u0394_k^2\n       = \u2211_k=2^K\u03c1^K-k\u0394_k^2 + \u03c1^K-1\u0394_1^2\n       \u2264\u2211_k=2^K\u03c1^K-k( 3 \u03b7^2 (4 HL(\u03c4+1) + 8nL )^2 \u0394_k-1^2 + 12 \u03b7^2 H^2 \u03bd^2 + 12 \u03b7^2 (H\u03c4+n)^2 \u2207 F(_0^k)^2 )\n              + \u03c1^K-1( 8 \u03b7^2 n^2 (\u03c4+1)^2 \u2207 F(_0^1)^2 + 8 \u03b7^2 n^2 \u03bd^2 )\n       \u2264 3 \u03c1^-1\u03b7^2 (4 HL(\u03c4+1) + 8nL )^2 \u2211_k=2^K\u03c1^K-(k-1)\u0394_k-1^2 + 12\u03b7^2 H^2 \u03bd^2/1 - \u03c1 + 8 \u03c1^K-1\u03b7^2 n^2 \u03bd^2\n              + 12 \u03b7^2 (H\u03c4+n)^2 \u2211_k=2^K \u03c1^K-k\u2207 F(_0^k)^2 + 8 \u03b7^2 n^2 (\u03c4+1)^2 \u03c1^K-1\u2207 F(_0^1)^2\n\nFrom the assumption that H \u2264 n, H\u03c4 + n \u2264 n(\u03c4 + 1) holds. Then, we get\n\n    \u2211_k=1^K \u03c1^K-k\u0394_k^2\n           \u2264 3 \u03c1^-1\u03b7^2 (4 nL(\u03c4+1) + 8nL )^2 \u2211_k=1^K\u03c1^K-k\u0394_k^2 + 12\u03b7^2 H^2 \u03bd^2/1 - \u03c1\n              + 8 \u03c1^K-1\u03b7^2 n^2 \u03bd^2 + 12 \u03b7^2 n^2 (\u03c4 + 1)^2 \u2211_k=1^K \u03c1^K-k\u2207 F(_0^k)^2.\n\nWe now define our step size as:\n\n    \u03b7 = min1/64nL(\u03c4 + 1), 2/\u03bc n K W_0 F(_0^1) - F^* + \u03bd^2/L\u03bc^3 n^2 K^2/192H^2L^2\u03bd^2.\n\nWe focus on \u03b7\u22641/64nL(\u03c4 + 1).\nWith this step size range, \u03c1 = 1 - \u03b7 n \u03bc/2\u2265 1 - \u03b7 n L/2 > 1/2 and \n\n    \u03b7 (4HL(\u03c4 + 1) + 8nL)\n           \u22644HL(\u03c4 + 1)/64nL(\u03c4+1) + 8nL/64nL(\u03c4+1)\n       \u2264H/16n + 1/8(\u03c4 + 1) < 1/4\n\nholds. Thereby,\n\n    3 \u03c1^-1\u03b7^2 (4 HL(\u03c4+1) + 8nL )^2 \u2264 3 \u00b7 2 \u00b71/16 < 1/2.\n\nholds and (<ref>) becomes\n\n    \u2211_k=1^K \u03c1^K-k\u0394_k^2 \u226424\u03b7^2 H^2 \u03bd^2/1 - \u03c1 + 32 \u03c1^K\u03b7^2 n^2 \u03bd^2 + 24 \u03b7^2 n^2 (\u03c4 + 1)^2 \u2211_k=1^K \u03c1^K-k\u2207 F(_0^k)^2.\n\nSubstituting this inequality to lmm:grabUBlmm1, we obtain\n\n    F(_n^K) - F^*\n           \u2264\u03c1^K (F(_0^1) - F^*) + \u03b7 n L^2/2\u2211_k=1^K \u03c1^K-k\u0394_k^2 - \u03b7 n/4\u2211_k=1^K\u03c1^K-k\u2207 F(_0^k)^2 \n       \u2264\u03c1^K (F(_0^1) - F^*) + 12 \u03b7^3 n L^2 H^2 \u03bd^2/1 - \u03c1 + 16 \u03c1^K \u03b7^3 n^3 L^2 \u03bd^2 \n              + 12\u03b7^3 n^3 L^2 (\u03c4 + 1)^2 \u2211_k=1^K \u03c1^K-k\u2207 F(_0^k)^2 - \u03b7 n/4\u2211_k=1^K\u03c1^K-k\u2207 F(_0^k)^2 \n       \u2264\u03c1^K (F(_0^1) - F^*) + 24 \u03b7^2 L^2 H^2 \u03bd^2/\u03bc + 16 \u03c1^K \u03b7^3 n^3 L^2 \u03bd^2,\n\nwhere the last inequality holds because\n\n    12\u03b7^3 n^3 L^2 (\u03c4 + 1)^2\n           = \u03b7 n/4\u00b7 48 \u03b7^2 n^2 L^2 (\u03c4 + 1)^2 \n       \u2264\u03b7 n/4\u00b748/64^2              \u2235\u03b7\u22641/64nL(\u03c4 + 1)\n       < \u03b7 n/4.\n\nThe RHS of (<ref>) can further be extended as\n\n    1 - \u03b7 n \u03bc/2^K (F(_0^1) - F^*) + 16 \u03b7^3 n^3 L^2 \u03bd^2 + 24 \u03b7^2 L^2 H^2 \u03bd^2/\u03bc\n       \u2264 e^-\u03b7 n \u03bc K/2F(_0^1) - F^* + \u03bd^2/L + 24 \u03b7^2 L^2 H^2 \u03bd^2/\u03bc.\n\nTaking derivative of (<ref>) with respect to \u03b7, we can obtain \u03b7 that minimizes (<ref>) is\n\n    \u03b7 = 2/\u03bc n K W_0 F(_0^1) - F^* + \u03bd^2/L\u03bc^3 n^2 K^2/192H^2L^2\u03bd^2,\n\nwhere W_0 denotes the Lambert W function. By substituting this \u03b7 to (<ref>), we finally obtain\n\n    F(_n^K) - F^* = \ud835\udcaa\u0303H^2 L^2 \u03bd^2/\u03bc^3 n^2 K^2.\n\nIn addition, to make use of such \u03b7 to obtain (<ref>), the following condition\n\n    2/\u03bc n K W_0 F(_0^1) - F^* + \u03bd^2/L\u03bc^3 n^2 K^2/192H^2L^2\u03bd^2\u22641/64nL(\u03c4 + 1)\n\nmust hold. Thus, we require\n\n    K \u2273\u03ba (\u03c4 + 1)\n\nto guarantee the convergence rate.\n\n\n\n\n \u00a7.\u00a7 temp\n \n\n\n  \u00a7.\u00a7.\u00a7 Proof for lmm:grabUBlmm1\n\n*\n\nThe update process within a k-th epoch can be written as:\n\n    x_0^k+1 = x_0^k - \u03b7 n \u00b71/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k.\n\nUsing smoothness and ,  = -1/2^2 - 1/2^2 + 1/2 - ^2, we get\n\n    F(_0^k+1)\n           \u2264 F(_0^k) - \u03b7 n \u2207 F(_0^k),1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k + \u03b7^2 n^2 L/21/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2\n       =F(_0^k) - \u03b7 n/2\u2207 F(_0^k)^2 - \u03b7 n/21/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2\n       = + \u03b7 n/2\u2207 F(_0^k)- 1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2 + \u03b7^2 n^2 L/21/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2\n       \u2264 F(_0^k) - \u03b7 n/2\u2207 F(_0^k)^2 + \u03b7 n/2\u2207 F(_0^k) - 1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2,\n\nwhere we used \u03b7 n L < 1 in the last inequality. In addition, we can expand the last term as\n\n    \u2207 F(_0^k) - 1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2\n           = 1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)(_0^k) - 1/n\u2211_t=1^n\u2207 f_\u03c3_k(t)_t-1^k^2       \n       \u22641/n\u2211_t=1^n\u2207 f_\u03c3_k(t)(_0^k) - \u2207 f_\u03c3_k(t)_t-1^k^2       (\u2235Jensen's Inequality)\n       \u2264L^2/n\u2211_t=1^n_0^k - _t-1^k^2       (\u2235smoothness)\n       \u2264 L^2 \u0394_k^2.       (\u2235\u0394_k = max_m=1, \u22ef , n_m^k - _0^k )\n\nCombining these two results, we get\n\n    F(_0^k+1) \u2264 F(_0^k) + \u03b7 n L^2 \u0394_k^2/2 - \u03b7 n/2\u2207 F(_0^k)^2.\n\nUsing the P\u0141 inequality, this inequality becomes\n\n    F(_0^k+1)\n           \u2264 F(_0^k) + \u03b7 n L^2 \u0394_k^2/2 - \u03b7 n/4\u2207 F(_0^k)^2 - \u03b7 n/4\u2207 F(_0^k)^2\n       \u2264 F(_0^k) + \u03b7 n L^2 \u0394_k^2/2 - \u03b7 n \u03bc/2 (F(_0^k) - F^*) - \u03b7 n/4\u2207 F(_0^k)^2.\n\nDefine \u03c1 := 1 - \u03b7 n \u03bc/2. Subtracting F^* on both sides, we get\n\n    F(_0^k+1) - F^* \u2264\u03c1 (F(_0^k) - F^*) + \u03b7 n L^2 \u0394_k^2/2 - \u03b7 n/4\u2207 F(_0^k)^2.\n\nThis inequality holds for all k \u2208{ 1, \u22ef, K}. Unrolling for entire epochs gives\n\n    F(_0^K+1) - F^* \u2264\u03c1^K (F(_0^1) - F^*) + \u03b7 n L^2/2\u2211_k=1^K \u03c1^K-k\u0394_k^2 - \u03b7 n/4\u2211_k=1^K\u03c1^K-k\u2207 F(_0^k)^2.\n\nThis ends the proof of the lemma.\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Proof for lmm:grabUBlmm2\n\n*\n\nWe first consider the situation after the first epoch. For m \u2208 [n] and k \u2208 [K]\u2216{1}, proper additions and subtractions give us\n\n    _m^k\n       = _0^k        - \u03b7\u2211_t=1^m \u2207f_\u03c3_k(t) (_t-1^k )\n\n       = _0^k        - \u03b7\u2211_t=1^m \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 )\n\n               - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_k(t) (_t-1^k ) - \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) )\n\n       = _0^k        - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) )\n\n               - \u03b7m/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) \n\n               - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_k(t) (_t-1^k ) - \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) )\n\n       = _0^k        - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) )\n\n               - \u03b7m \u2207F ( _n^k-1 )\n\n               - \u03b7m/n \u2211_s=1^n ( \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) - \u2207f_\u03c3_k-1(s) ( _n^k-1 ) )\n\n               - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_k(t) (_t-1^k ) - \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) ).\n\nHere, \u03c3_k-1^-1 (t) indicates in which iteration is the t-th sample used at the (k-1)-th epoch and \u2207 f_\u03c3_k(t)_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 indicates the gradient with respect to the same sample used in the t-th iteration of the k-th epoch, but which was computed previously in the (k-1)-th epoch. Using the triangle inequality, we gain\n\n    _m^k - _0^k    \u2264\u03b7\u2211_t=1^m( \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) - 1/n\u2211_s=1^n\u2207 f_\u03c3_k-1(s)( _s-1^k-1) ) \n             + \u03b7 m \u2207 F ( _n^k-1) \n             + \u03b7 m/n\u2211_s=1^n( \u2207 f_\u03c3_k-1(s)( _s-1^k-1) - \u2207 f_\u03c3_k-1(s)( _n^k-1) ) \n             + \u03b7\u2211_t=1^m\u2207 f_\u03c3_k(t)(_t-1^k ) - \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) .\n\nHere, the first term in (<ref>) is the term in which Herding intervenes and it enables us to gain the upper bound. To do so, we first upper bound the norm of each component as\n\n\n                \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) \n\n       \u2264        \u2207f_\u03c3_k(t) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) \n\n               + 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_k-1(s) ( _s-1^k-1 ) \n\n       \u2264        \u03bd+ \u03c4 \u2207F (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 )  + L/n \u2211_s=1^n  _\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 - _s-1^k-1 \n\n       \u2264          \u03bd+ \u03c4( \u2207F ( _0^k )  +  \u2207F ( _0^k-1 ) - \u2207F ( _0^k )  +  \u2207F (_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 ) - \u2207F ( _0^k-1 )  )\n\n               + L/n \u2211_s=1^n (  _\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1 - _0^k-1  +  _0^k-1 - _s-1^k-1  )\n\n       \u2264          \u03bd+ \u03c4( \u2207F ( _0^k )  + 2L\u0394_k-1 ) + 2L\u0394_k-1\n\n       =           \u03bd+ \u03c4\u00b7 \u2207F ( _0^k )  + 2L( \u03c4+ 1 ) \u00b7\u0394_k-1.\n\nNow, define z_t^k as\n\n    z_t^k := \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) - 1/n\u2211_s=1^n\u2207 f_\u03c3_k-1(s)( _s-1^k-1)/\u03bd + \u03c4\u00b7\u2207 F ( _0^k )  + 2L( \u03c4 + 1 ) \u00b7\u0394_k-1\n\nfor t \u2208 [n]. Then, z_t^k\u2264 1 holds.\n\nWe now apply Herding algorithm to upper bound the first term of (<ref>).\nSince z_t^k\u2264 1, we then get following inequality for all m \u2208 [n]:\n\n    \u2211_t=1^m( \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) - 1/n\u2211_s=1^n\u2207 f_\u03c3_k-1(s)( _s-1^k-1) ) \n    \u2264 H ( \u03bd + \u03c4\u00b7\u2207 F ( _0^k )  + 2L( \u03c4 + 1 ) \u00b7\u0394_k-1).\n\nFor the remaining terms in (<ref>), we can upper bound each of them by\n\n    \u2211_s=1^n( \u2207 f_\u03c3_k-1(s)( _s-1^k-1) - \u2207 f_\u03c3_k-1(s)( _n^k-1) )    \u2264\u2211_s=1^n\u2207 f_\u03c3_k-1(s)( _s-1^k-1) - \u2207 f_\u03c3_k-1(s)( _n^k-1) \n       \u2264 L\u2211_s=1^n_s-1^k-1 - _n^k-1\n       \u2264 L\u2211_s=1^n( _s-1^k-1 - _0^k-1 + _0^k-1 - _n^k-1) \n       \u2264 2nL \u0394_k-1\n\nand\n\n    \u2211_t=1^m( \u2207 f_\u03c3_k(t)(_t-1^k ) - \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) ) \n       \u2264\u2211_t=1^m\u2207 f_\u03c3_k(t)(_t-1^k ) - \u2207 f_\u03c3_k(t)(_\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) \n       \u2264 L \u2211_t=1^m_t-1^k - _\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1\n       \u2264 L \u2211_t=1^m( _t-1^k - _0^k  + _0^k - _0^k-1 + _0^k-1 - _\u03c3_k-1^-1 (\u03c3_k (t))-1^k-1) \n       \u2264 mL ( \u0394_k + 2\u0394_k-1).\n\nBy summing up (<ref>)-(<ref>) and taking a max over m \u2208{1, \u22ef, n } on both side of (<ref>),\n\n    \u0394_k\n           \u2264\u03b7 H ( \u03bd + \u03c4\u00b7\u2016\u2207 F ( _0^k ) \u2016 + 2L( \u03c4 + 1 ) \u00b7\u0394_k-1)\n           + \u03b7 n \u2016\u2207 F ( _0^k ) \u2016 + \u03b7 n/n\u00b7 2nL \u0394_k-1 + \u03b7 nL ( \u0394_k + 2\u0394_k-1)\n       \u2264\u03b7 H \u03bd + (\u03b7 H \u03c4 + \u03b7 n) \u00b7\u2016\u2207 F ( _0^k ) \u2016 + ( 2\u03b7 HL(\u03c4+1) + 4\u03b7 nL ) \u00b7\u0394_k-1 + \u03b7 nL \u0394_k.\n\nUsing \u03b7 nL \u22641/2, we finally get\n\n    \u0394_k \u2264 2\u03b7 H \u03bd + (2\u03b7 H \u03c4 + 2\u03b7 n) \u00b7\u2016\u2207 F ( _0^k ) \u2016 + ( 4\u03b7 HL(\u03c4+1) + 8\u03b7 nL ) \u00b7\u0394_k-1.\n\nWe now move on to the first epoch case. By properly decomposing the term, we gain\n\n    _m^1\n       = _0^1        - \u03b7\u2211_t=1^m \u2207f_\u03c3_1(t) ( _t-1^1 )\n\n       = _0^1        - \u03b7\u2211_t=1^m 1/n \u2211_s=1^n \u2207f_\u03c3_1(s) ( _0^1 )\n\n               - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_1(t) ( _0^1 ) - 1/n \u2211_s=1^n \u2207f_\u03c3_1(s) ( _0^1 ) )\n\n               - \u03b7\u2211_t=1^m ( \u2207f_\u03c3_1(t) ( _t-1^1 ) - \u2207f_\u03c3_1 (t) ( _0^1 ) ).\n\nIn a similar way to the technique we used above, we have\n\n    _m^1 - _0^1   \u2264\u03b7\u2211_t=1^m1/n\u2211_s=1^n\u2207 f_\u03c3_1(s)( _0^1)\n             +\u03b7\u2211_t=1^m( \u2207 f_\u03c3_1(t)( _0^1 ) - 1/n\u2211_s=1^n\u2207 f_\u03c3_1(s)( _0^1) )\n             +\u03b7\u2211_t=1^m( \u2207 f_\u03c3_1(t)( _t-1^1) - \u2207 f_\u03c3_1 (t)( _0^1 ) )\n       \u2264\u03b7\u2211_t=1^m\u2207 F _0^1\n             +\u03b7\u2211_t=1^m\u2207 f_\u03c3_1(t)( _0^1 ) - 1/n\u2211_s=1^n\u2207 f_\u03c3_1(s)( _0^1)\n             +\u03b7\u2211_t=1^m L _t-1^1 - _0^1.\n\nTaking a max over m \u2208{1, \u22ef, n} in both sides, we gain\n\n    \u0394_1 \u2264\u03b7 n \u2016\u2207 F ( _0^1 ) \u2016 + \u03b7 n ( \u03bd + \u03c4\u00b7\u2016\u2207 F ( _0^1 ) \u2016) + \u03b7 n L \u0394_1\n\nand using the fact that \u03b7 n L \u22641/2, we finally obtain\n\n    \u0394_1 \u2264 2 \u03b7 n \u03bd + 2 \u03b7 n (\u03c4+1) \u00b7\u2207 F(_0^1).\n\n\n\n"}