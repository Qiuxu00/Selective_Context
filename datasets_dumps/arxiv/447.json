{"entry_id": "http://arxiv.org/abs/2303.07877v1", "published": "20230312155551", "title": "Projectability disentanglement for accurate and automated electronic-structure Hamiltonians", "authors": ["Junfeng Qiao", "Giovanni Pizzi", "Nicola Marzari"], "primary_category": "physics.comp-ph", "categories": ["physics.comp-ph", "cond-mat.mtrl-sci"], "text": "\n\n\n\n\njunfeng.qiao@epfl.ch\nTheory and Simulations of Materials (THEOS), and National Centre\n  for Computational Design and Discovery of Novel Materials (MARVEL), \u00c9cole\n  Polytechnique F\u00e9d\u00e9rale de Lausanne, 1015 Lausanne, Switzerland\n\nTheory and Simulations of Materials\n  (THEOS), and National Centre for Computational Design and Discovery of Novel\n  Materials (MARVEL), \u00c9cole Polytechnique F\u00e9d\u00e9rale de Lausanne, 1015 Lausanne,\n  Switzerland\nLaboratory for Materials Simulations (LMS), Paul\n  Scherrer Institut (PSI), CH-5232 Villigen PSI, Switzerland\n\nTheory and Simulations of Materials (THEOS), and National\n  Centre for Computational Design and Discovery of Novel Materials (MARVEL),\n  \u00c9cole Polytechnique F\u00e9d\u00e9rale de Lausanne, 1015 Lausanne, Switzerland\nLaboratory for Materials Simulations (LMS), Paul Scherrer Institut\n  (PSI), CH-5232 Villigen PSI, Switzerland\n\n\n\n\n  Maximally-localized Wannier functions (MLWFs) are a powerful and broadly used\n    tool to characterize the electronic structure of materials, from chemical\n    bonding to dielectric response to topological properties.\n  Most generally, one can construct MLWFs that describe isolated band manifolds,\n    e.g. for the valence bands of insulators, or entangled band manifolds, e.g. in\n    metals or describing both the valence and the conduction manifolds in\n    insulators.\n  Obtaining MLWFs that describe a target manifold accurately and with the most\n    compact representation often requires chemical intuition and trial and error, a\n    challenging step even for experienced researchers and a roadblock for automated\n    high-throughput calculations.\n  Here, we present a very natural and powerful approach that provides\n    automatically MLWFs spanning the occupied bands and their natural complement\n    for the empty states, resulting in Wannier Hamiltonian models that provide a\n    tight-binding picture of optimized atomic orbitals in crystals.\n  Key to the success of the algorithm is the introduction of a projectability\n    measure for each Bloch state onto atomic orbitals (here, chosen from the\n    pseudopotential projectors) that determines if that state should be kept\n    identically, discarded, or mixed into a disentangling algorithm.\n  We showcase the accuracy of our method by comparing a reference test set of 200\n    materials against the selected-columns-of-the-density-matrix algorithm, and its\n    reliability by constructing Wannier Hamiltonians for 21737 materials from\n    the Materials Cloud.\n\n\nProjectability\n  disentanglement for accurate and automated electronic-structure Hamiltonians\n    Nicola Marzari\n    March 30, 2023\n=============================================================================================\n\n\n\n\n\n\u00a7 INTRODUCTION\n\nIn periodic crystals, the electronic structure is usually described using\n  one-particle Bloch wavefunctions.\nWhile choosing a basis set that is also periodic to describe these\n  wavefunctions can often be beneficial, an alternative approach is to adopt\n  localized orbitals in real space.\nOne such choice of orbitals are Wannier functions (WFs), that can be obtained\n  by Fourier transforming the periodic wavefunctions from reciprocal to real\n  space.\nWFs are not unique, as they depend on the choice of the gauge (i.e., the choice\n  of the phases of the wavefunctions) at each point in the Brillouin zone (BZ).\nMaximally-localized Wannier functions (MLWFs) <cit.> are obtained by a gauge choice that is optimized to\n  provide the most localized set of WFs, i.e., those that minimize the sum of\n  their quadratic spread in real space <cit.>.\nHaving a very localized representation of the electronic structure not only\n  provides an insightful analysis of chemical bonding in solids, but also brings\n  a formal connection between the MLWF centers and the modern theory of electric\n  polarization <cit.>.\nMoreover, the real-space locality of MLWF allows for accurate and fast\n  interpolation of physical operators <cit.>, enabling calculations of\n  material properties that require dense samplings of the BZ, such as Fermi\n  surface, orbital magnetization <cit.>, anomalous Hall conductivity\n  <cit.>, and spin Hall conductivity <cit.>, to name\n  a few.\nPractically, one obtains MLWFs starting from a set of Bloch wavefunctions,\n  calculated e.g., from density-functional theory (DFT).\nOften, these Bloch states are projected onto some localized orbitals (usually\n  chosen by the user) to generate initial guesses for MLWFs.\nIn an insulator, by minimizing the spread functional <cit.> which\n  measures localization, one can obtain a set of MLWFs, i.e., \u201cWannierize\u201d a\n  material.\nThe Wannierization contains an additional disentanglement step <cit.>\n  if the target Bloch states are not isolated from other band manifolds.\nFor such entangled bands\u2014metals or the conduction bands of insulators\u2014one\n  needs to first identify the relevant Bloch states that will be used to\n  construct MLWFs, and then mix or \u201cdisentangle\u201d these from all the Bloch\n  states <cit.>.\nPractically, the choices for the initial projections and states to be\n  disentangled substantially influence the shape and the quality of the final\n  MLWFs.\n\nIn recent years, a lot of effort has been devoted to obtaining high-quality\n  MLWFs and automate the Wannierization procedure.\nFocus of the research can be categorized into the following classes:\n  [label=(*)] \n  * Novel minimization\n  algorithms, such as: the symmetry-adapted WF method that adds constraints to\n  impose the symmetries of the resulting WFs <cit.>; the simultaneous\n  diagonalization algorithm that directly minimizes the spread functional for an\n  isolated (or \u201c\u0393-only\u201d) system <cit.>; the partly-occupied WF\n  method, where the total spread is directly minimized in one step\n  <cit.>, rather than performing a two-step\n  minimization for its gauge-invariant and gauge-dependent parts as in the\n  standard procedure <cit.>; or the variational formulation, that\n  combines single-step optimization with manifold optimization to make the\n  minimization algorithm more robust <cit.>; \n  * new forms for the\n  spread functional, such as the selectively localized WFs (SLWFs) for which only\n  a subset of WFs of interest are localized and a penalty term is added to\n  constrain the position of the WF centers <cit.>, or the\n  spread-balanced WF method, that adds a penalty term to distribute the spread as\n  uniformly as possible among all WFs <cit.>; \n  * targeting a\n  subset of orbitals, e.g. SLWF for a subset of MLWFs <cit.> or the\n  optimized projection functions method where starting projections for the\n  Wannierization are generated from a larger group of initial ones\n  <cit.>; \n  * matrix manifold algorithms instead of projection\n  methods to construct a smooth gauge in a non-iterative way\n  <cit.>; \n  * basis-vector decomposition of the density\n  matrix, e.g. the selected columns of the density matrix (SCDM) algorithm\n  <cit.>, that starts from the density matrix of the system\n  and uses QR decomposition with column pivoting (QRCP) to automatically generate\n  an optimal set of basis vectors from the columns of the density matrix.\n\n\nAt the same time, high-throughput (HT) calculations have become increasingly\n  popular for materials discovery and design.\nCalculations and results managed by workflow engines are collected into\n  databases of original calculations, such as the Materials Project\n  <cit.>, AFLOW <cit.>, OQMD <cit.>, CMR\n  <cit.>, and the Materials Cloud <cit.>, or aggregated, as in\n  NOMAD <cit.>.\nThanks to recent research advances on Wannierization algorithms, it starts now\n  to be possible to run HT Wannierizations for many materials and generate\n  tight-binding (TB) models that reliably describe their physics.\nSo far, several attempts have been made in this direction.\n<cit.> gathered 195\nWannier TB Hamiltonians and applied post-processing symmetrization to study\n  strained III-V semiconductor materials.\n<cit.> implemented the SCDM algorithm and designed a\nprotocol to determine automatically the remaining free parameters of the\nalgorithm; this protocol, implemented into automated workflows, was verified to\nwork well for band interpolations on a set of 200 structures (metals, or\nvalence and conduction bands of insulators) and 81 insulators (valence bands\nonly). <cit.> accumulated a Wannier TB Hamiltonian database of\n1771 materials using the standard hydrogenic orbital projections.\nHowever, there are still several challenges for an accurate and automated HT\n  Wannierization, some of which might be more relevant depending on the research\n  goal and the specific property to compute: MLWFs should be able to faithfully\n  represent the original band structure, often (e.g., for transport properties)\n  at least for those bands close to the Fermi energy; MLWFs should resemble the\n  physically intuitive atomic orbitals for solids that would enter into Bloch\n  sums; the algorithm should be fully and reliably automated and the\n  implementation should be efficient for HT calculations.\n\nTo overcome the challenges mentioned above, in this paper we present a new\n  methodology for automated Wannierization.\nFirst, we choose physically-inspired orbitals as initial projectors for MLWFs,\n  that is, the pseudo-atomic orbitals (PAOs) from pseudopotentials\n  <cit.>.\nThen, for each state |n \ud835\udc24\u27e9 (n is the band index, \ud835\udc24\n  is the Bloch quasi-momentum) we decide if it should be dropped, kept\n  identically, or thrown into the disentanglement algorithm depending on the\n  value of its projectability onto the chosen set of PAOs, replacing the standard\n  disentanglement and frozen manifolds based only on energy windows.\nThis approach naturally and powerfully targets the TB picture of atomic\n  orbitals in crystals, as it will also become apparent from our results.\nMoreover, we fully automate this approach and implement it in the form of\n  open-source <cit.> workflows.\nTo assess its effectiveness and precision, we compare the quality of the band\n  interpolation and the locality of the Wannier Hamiltonians generated with the\n  present approach, which we name as projectability-disentangled Wannier\n  functions (PDWFs), with the results from the SCDM algorithm <cit.>.\nStatistics from 200 materials demonstrate that PDWFs are more localized and\n  more atomic-like, and the band interpolation is accurate at the meV scale.\nFurthermore, to demonstrate the reliability and automation of our method and\n  workflows, we carry out a large-scale high-throughput Wannierization of\n  21737 materials from the Materials Cloud<cit.>.\n\nTo set the context for the following paragraphs, here we briefly summarize the\n  notations for WFs; a detailed description can be found in\n  Refs.\u00a0<cit.>.\nWFs | w_n \ud835\udc11\u27e9 are unitary transformations of Bloch\n  wavefunctions |\u03c8_m\ud835\udc24\u27e9, given by\n  \n    |w_n\n              \ud835\udc11\u27e9 = V/(2 \u03c0)^3\u222b_BZd\ud835\udc24e^-i\ud835\udc24\u00b7\ud835\udc11\u2211_m=1^J\n        or J_\ud835\udc24|\u03c8_m \ud835\udc24\u27e9 U_m n\n            \ud835\udc24,\n\n  where \ud835\udc24 and \ud835\udc11 are the Bloch\n  quasi-momentum in the BZ and a real-space lattice vector, respectively; m is\n  the band index, and n is the Wannier-function index (running from 1 to the\n  number of WFs J).\nFor an isolated group of bands, J is equal to the number of bands, and the\n  U_m n \ud835\udc24 are unitary matrices; for entangled bands, the number of\n  bands considered at each k-point is J_\ud835\udc24\u2265 J, and the U_m n\n        \ud835\udc24 are semi-unitary rectangular matrices.\nMLWFs are the minimizers of the quadratic spread functional <cit.>\n  \n    \u03a9=\u2211_n=1^J[\u27e8 w_n\n            0|\ud835\udc2b^2| w_n 0|-\u27e9|\u27e8 w_n\n            0|\ud835\udc2b| w_n 0|\u27e9|^2].\n\nSince <ref> is a minimization problem with multiple local\n  minima, initial guesses for U_m n \ud835\udc24 substantially influence the\n  optimization path and the final minimum obtained.\nIn order to target the most localized and chemically appealing solution,\n  <cit.> used hydrogenic wavefunctions |g_n\u27e9 (i.e., analytic\n  solutions of the isolated hydrogenic Schr\u00f6dinger equation) to provide a set\n  of sensible initial guesses |\u03d5_n \ud835\udc24\u27e9, after projection on\n  the space defined by the relevant Bloch states: \n    |\u03d5_n \ud835\udc24\u27e9 = \u2211_m=1^J\n      or J_\ud835\udc24|\u03c8_m \ud835\udc24\u27e9\u27e8\u03c8_m\n          \ud835\udc24 | g_n|.\u27e9\n\nThe projection matrices A_mn\ud835\udc24 = \u27e8\u03c8_m \ud835\udc24 |\n      g_n|$\u27e9, after L\u00f6wdin orthonormalization <cit.>, form the\n  initial guesses forU_m n \ud835\udc24.\nWe underline that while the gauge of Bloch wavefunctions|\u03c8_m\n        \ud835\udc24\u27e9is arbitrary (i.e.,|\u03c8_m \ud835\udc24 \u27e9 U_m n\n        \ud835\udc24are also solutions of the electronic structure problem),\n  <ref> is invariant to such gauge freedom since|\u03c8_m\n        \ud835\udc24\u27e9 \u27e8\u03c8_m \ud835\udc24 | g_n |=\u27e9 \u2211_i |\u03c8_m\n        \ud835\udc24\u27e9 U_mi\ud835\udc24 U_im\ud835\udc24^\u2020\u27e8\u03c8_m\n        \ud835\udc24 | g_n |$\u27e9 where U_\ud835\udc24 are arbitrary unitary matrices.\nFor entangled bands, the \u201cstandard\u201d disentanglement approach <cit.>\n  uses energy windows to choose the disentanglement and frozen manifolds: an\n  (outer) disentanglement window that specifies a larger space of Bloch states\n  that one could mix to obtain a smaller disentangled manifold to localize,\n  together with a manifold defined by an (inner) frozen window that is taken as\n  is.\n\n\n\n\u00a7 RESULTS AND DISCUSSIONS\n\n\n\n \u00a7.\u00a7 Pseudo-atomic-orbital projections\n\nIn addition to the hydrogenic orbitals discussed above, alternative starting\n  guesses for the Wannierization can be used.\nFor instance, in pseudopotential plane-wave methods, PAOs are localized\n  orbitals originating from the pseudopotential generation procedure\n  <cit.>.\nIn this procedure, for each element, atomic wavefunctions of an isolated atom\n  are pseudized to remove the radial nodes and are localized functions around the\n  atom; spherical harmonics with well-defined angular-momentum character (s,\n  p, d, or f) are chosen for their angular dependency.\nPAOs are commonly used for analyzing the orbital contributions to band\n  structures, as the basis set for non-iterative construction of TB Hamiltonians\n  <cit.>, or as projectors in DFT+Hubbard calculations\n  <cit.>.\n\nIn order to understand the contribution of each orbital | g_n\u27e9 to a\n  Bloch state |\u03c8_m \ud835\udc24\u27e9, we define a measure of\n  projectability as the square of the inner product between |\u03c8_m\n        \ud835\udc24\u27e9 and | g_n\u27e9:\n  \n    p_nm\ud835\udc24 = | \u27e8 g_n | \u03c8_m \ud835\udc24|\u27e9|^2;\n\n  the projectability of |\u03c8_m \ud835\udc24\u27e9 onto all\n  PAOs is then defined as \n    p_m\ud835\udc24 = \u2211_n p_nm\ud835\udc24.\n\nIf the projectors | g_n\u27e9 are complete for |\u03c8_m \ud835\udc24\u27e9, then p_m\ud835\udc24 = 1.\nThe band projectability is a very useful criterion to identify the orbital\n  character of the bands; this is exemplified in <ref>,\n  where we show the projectability of the bands of graphene onto 2s and 2p\n  PAOs for carbon.\nIt is immediately apparent how one can easily identify states in the conduction\n  manifold that have a strong 2p and 2s component.\n\n\n\nCompared with the hydrogenic projections, which is the method used by default\n  in <cit.> and its interface code to <cit.>\n  (called ), PAOs are better adapted to each element since they come exactly\n  from the pseudopotential used in the actual solid-state calculation.\nMoreover, in pseudopotentials with semicore states, the PAOs for semicores are\n  nodeless and those for valence wavefunctions have at least one radial node (so\n  as to be orthogonal to the semicore states with same angular momentum); thus\n  band projectability can clearly differentiate semicore from valence, making\n  PAOs more convenient than the hydrogenic orbitals, for which the user would\n  need to manually set the correct radial functions for both semicore and valence\n  projectors.\nFor these reasons, we use in this work the PAOs as initial and more accurate\n  projections.\nIf needed, higher energy orbitals not included in the pseudopotential file can\n  be constructed, for example, using solutions of Schr\u00f6dinger equation under\n  confinement potential <cit.> (see also discussion in\n  <ref>).\n\n\n\n \u00a7.\u00a7 Projectability disentanglement\n\nAs mentioned, the standard disentanglement approach selects the disentanglement\n  and frozen manifolds via two energy windows <cit.>.\nWe refer to this as energy disentanglement (ED).\nHowever, since bands have dispersions across the BZ, a fixed window for all\n  k-points might not be an optimal choice.\nTaking the graphene band structure (<ref>) as an\n  example, the bands which have large projectability are mixed with many\n  free-electron bands (grey in the figure), which have zero projectability.\nIn this case, one is faced with several options for the outer and inner energy\n  windows, each with different shortcomings:\n  [label=(*)] \n  * If the inner window\n  includes free-electron bands, the final MLWFs are mixtures of 2s, 2p atomic\n  orbitals and free-electron bands, delocalizing the resulting MLWFs; \n  * if\n  the outer window excludes both the free-electron bands and the atomic-orbital\n  states inside free-electron bands, the WFs lack the anti-bonding part of the\n  bonding/anti-bonding closure <cit.>, again degrading the\n  localization of WF; \n  * if the upper bound of the inner window is set to its\n  maximal allowed value, i.e. the blue dashed line positioned at the minimum of\n  free-electron bands in <ref>, and all the DFT eigenstates\n  are included in the outer window, the disentanglement algorithm\n  <cit.> will extract an optimally smooth manifold, at the expense of\n  decreasing the chemical representability of the atomic-orbital bands in the\n  free-electron region; in other words, the MLWFs obtained lose the information\n  of the TB atomic orbitals in this chemical environment (see\n  <ref>).\n\n\nThe graphene case highlights the limitations of the standard ED.\nInstead, we propose here to select the disentanglement and frozen manifolds\n  based on the projectability p_m\ud835\udc24 of each state on the chosen PAOs\n  (i.e., states are selected irrespective of their energy, but rather based on\n  their chemical representativeness).\nSpecifically, we select states based on two thresholds and :\n  [label=(*)] \n  * If p_m\ud835\udc24 <\n  , the state \u03c8_m\ud835\udc24 is discarded.\n\n  * If p_m\ud835\udc24\u2265 , the state \u03c8_m\ud835\udc24 is kept\n  identically.\n\nCrucially, all states for which \u2264 p_m\ud835\udc24 < are thrown\n  in the disentanglement algorithm.\nOptimal numerical values for and are discussed later.\nIn the case of graphene, identifies the fully atomic-orbital states\n  inside the free-electron bands, while removes the fully free-electron\n  bands from the disentanglement process, preventing the mixing of atomic and\n  free-electron states.\nThe two thresholds and constitute the parameters of the\n  disentanglement process, replacing the four defining energy windows (the lower\n  and upper bounds of the outer and inner energy windows).\n\nIdeally, if PAOs were always a complete set to describe valence and\n  near-Fermi-energy conduction bands, the PD would select the most relevant Bloch\n  states and accurately interpolate these DFT bands.\nHowever, since the PAOs are fixed orbitals from isolated single-atom\n  calculations for each element, if the chemical environment in the crystal\n  structure is significantly different from that of pseudopotential generation,\n  then the total projectability p_m\ud835\udc24 might be smaller than 1 for\n  bands around the conduction band minimum (CBM) or even for valence bands.\nIn such cases, one solution is to increase the number of PAOs, i.e., adding\n  more projectors with higher angular momentum, as we will discuss in\n  <ref>.\nHowever, since one almost always wants to correctly reproduce valence bands\n  (plus possibly the bottom of the conduction) but at the same time keep the\n  Wannier Hamiltonian small for computational reasons, we suggest to additionally\n  freeze all the states that sit below the Fermi energy in metals (or below the\n  CBM for insulators) and also those a few eV above (typically, 2eV\n  or so).\nSuch a combination of PD+ED gives accurate interpolation of bands below and\n  around the Fermi energy (or band edges for insulators), as well as maximally\n  restoring the atomic-orbital picture.\n\nWe stress here that, even if we call the resulting Wannier functions PDWFs for\n  clarity, our optimal suggestion is to always also freeze the states in the\n  energy window mentioned above, as we discuss in the next sections.\n\n\n\n \u00a7.\u00a7 Comparison\n\nWe choose four prototypical materials to discuss the present method: graphene,\n  silicon, copper, and strontium vanadate ().\nGraphene is a difficult case where atomic-orbital states highly mix with\n  free-electron bands; silicon tests the Wannierization of both valence and\n  conduction bands of an insulator; copper is a test on a metal; and represents the class of (metallic) perovskites.\nWe compare the shapes, centers, and spreads of the resulting MLWFs using the\n  five methods mentioned earlier: hydrogenic projection with ED (i.e., the\n  standard approach), SCDM, PAO projection with ED, PAO projection with PD, and\n  PAO projection with PD+ED.\n\n\n\n  \u00a7.\u00a7.\u00a7 Graphene\n\nThe original and interpolated band structures for the five methods discussed\n  are shown in\n  <ref>.\nThe blue dashed lines in\n  <ref> indicate\n  the top of the inner energy window, which is set optimally (and manually) to\n  just below the free-electron bands, to freeze as much as possible the\n  atomic-orbital states but exclude any free-electron state.\nFor PD and PD+ED, we choose = 0.85 and = 0.02 (we will discuss\n  later on the choice of these thresholds).\nComparing <ref> and <ref>, one sees\n  that ED produces similar bands irrespective of using hydrogenic or PAO\n  projection.\nHowever, as shown in <ref> (first and third row), the\n  MLWFs for the two cases fall into slightly different minima: MLWFs from\n  hydrogenic projection with ED are p_z and hybridized s \u00b1 p orbitals\n  pointing towards the center of the hexagon, while MLWFs from PAO with ED are\n  p_z, p_x, and s \u00b1 p_y.\nBoth the PAO with PD and PAO with PD+ED cases reach the same set of MLWFs,\n  p_z, p_x, and s \u00b1 p_y, but with larger spreads than the PAO with ED,\n  since the PD and PD+ED freeze more states, giving thus less freedom for maximal\n  localization.\nNevertheless, the interpolated bands of the PAO with PD and PAO with PD+ED\n  cases can much better reproduce the atomic-orbital states inside the\n  free-electron bands.\nFinally, compared to other cases, SCDM includes some free-electron bands, some\n  of which can be even reproduced by the Wannier interpolation.\nHowever, in order to follow those free-electron bands, abrupt changes of\n  character and band derivative are needed in the conduction band.\nAs required by Nyquist\u2013Shannon sampling theorem<cit.>, this\n  results in a denser \ud835\udc24-space sampling needed to obtain a good\n  interpolation quality.\nMoreover, the MLWFs are much more delocalized and do not resemble atomic\n  orbitals: as shown in <ref>, the last two MLWFs for SCDM\n  are floating away from the graphene 2D lattice, blurring the TB picture of\n  atomic orbitals in solids.\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Silicon\n\nThe SCDM method obtains four front-bonding and four back-bonding MLWFs, while\n  all other cases lead to atom-centered s and p MLWFs, as shown in\n  <ref>.\nWhile overall the SCDM bands (<ref>) seem to reproduce\n  relatively better the higher conduction bands, they fail to correctly reproduce\n  the bottom of the conduction band near the X point, induce more wiggles around\n  X and W, and have much larger spreads.\nDue to the low projectability of Bloch states around X (p_m\ud835\udc24\n  around 0.83), the CBM is not correctly reproduced in the PAO with PD, as these\n  are not frozen in PD with the current choice of = 0.95 and = 0.01.\nTo explicitly freeze the CBM, would need to be lowered below 0.83.\nHowever, such kind of decrease will also result in freezing some high-energy\n  conduction bands, degrading the localization.\nPD+ED overcomes this by explicitly freezing the near-Fermi-energy and\n  low-projectability states at the CBM, but still only freezing those\n  atomic-orbital states in the high-energy conduction bands that possess high\n  projectability (see <ref>), thus improving band\n  interpolation.\nWe note that adding d PAOs increases the CBM projectability (from 0.83 to\n  0.99) and restores a high-quality band-structure interpolation within the PD\n  method: as shown in <ref>, the low-energy conduction\n  bands are correctly reproduced once we regenerate a silicon pseudopotential\n  including 3d PAOs.\nTherefore, PD is sufficient to obtain an accurate band interpolation if enough\n  PAOs are included (we will also discuss this later in <ref>).\nFor completeness, we show the SCDM interpolation using the regenerated\n  pseudopotential in <ref>: the added d PAOs help select a\n  larger manifold thanks to the increased projectability, enabling SCDM to\n  reproduce higher conduction bands, as well as fixing the wrong interpolation at\n  the W point.\nIn general, adding more PAOs improves interpolation quality in cases where the\n  target bands have low projectability, at the price of increased computational\n  cost.\nPD+ED is a better option for reaching a good interpolation accuracy while\n  keeping the size of the corresponding TB model small.\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Copper and \n\nResults for copper and are only shown in the SI\n  (<ref>),\n  since the conclusions are the same: PD+ED consistently provides the best\n  interpolation quality among all methods we consider, while not requiring to\n  increase the size of the Hamiltonian model, and results in WFs that resemble\n  atomic orbitals or their hybridization.\n\n\n\n \u00a7.\u00a7 High-throughput verification\n\nIn this section we discuss the applicability of the present PDWF method to\n  obtain, in a fully automated way and without user input, WFs for any material.\nIn order to assess quantitatively its performance, we compare it to SCDM, that\n  can also be fully automated (see Ref.\u00a0<cit.>).\n\nIn all results that follow, we exclude semicore orbitals in both methods, since\n  these low-energy states correspond to almost flat bands and do not play any\n  role in the chemistry of the materials.\nWe compare quantitatively the band interpolation quality between the two\n  methods and the corresponding WF centers and spreads on the 200-structure set\n  used in Ref.\u00a0<cit.> for both occupied and unoccupied bands,\n  totalling 6818 MLWFs for each method.\nIn accordance with Refs.\u00a0<cit.>, the band interpolation\n  quality is measured by the average band distance,\n  \n    \u03b7_\u03bd = \u221a(\u2211_n\ud835\udc24f\u0303_n\ud835\udc24 (\u03f5_n\ud835\udc24^DFT -\n        \u03f5_n\ud835\udc24^Wan)^2 /\u2211_n\ud835\udc24f\u0303_n\ud835\udc24),\n\n  and the max band distance,\n  \n    \u03b7_\u03bd^max =\n        max_n\ud835\udc24( f\u0303_n\ud835\udc24|\n        \u03f5_n\ud835\udc24^DFT - \u03f5_n\ud835\udc24^Wan| ),\n\n  where f\u0303_n\ud835\udc24 =\n    \u221a(f^DFT_n\ud835\udc24(E_F+\u03bd, \u03c3)\n      f^Wan_n\ud835\udc24(E_F+\u03bd, \u03c3)) and f(E_F+\u03bd, \u03c3) is\n  the Fermi-Dirac distribution.\nHere E_F+\u03bd and \u03c3 are fictitious Fermi levels and smearing widths\n  which we choose for comparing a specific range of bands.\nSince the Wannier TB model describes the low-energy valence electrons, it is\n  expected that the band interpolation deviates from the original in the higher\n  conduction band region.\nTherefore, the higher \u03bd is, the larger \u03b7_\u03bd is expected to be.\nIn the following paragraphs, we will use \u03b7_0 and \u03b7_2 to compare\n  bands below and + 2eV, respectively; \u03c3 is always fixed at\n  0.1eV.\n\nIn the supplementary information <ref>, we provide\n  comparisons between the Wannier-interpolated bands and the DFT bands for both\n  PDWF and SCDM, their respective band distances, and the Hamiltonian decay plots\n  for each of the 200 materials.\nWe discuss these properties in the following.\n\n\n\n  \u00a7.\u00a7.\u00a7 Projectability thresholds and automation\n\nFor PDWF, we set the maximum of the inner window to the Fermi energy +\n  2eV for metals, or to the CBM + 2eV for insulators, to fully\n  reproduce states around Fermi energy or the band edges.\nWe also specify the two additional parameters and .\nFrom our tests, in most cases = 0.95 and = 0.01 already produce\n  very good results.\nHowever, since chemical environments vary across different crystal structures,\n  the two parameters are not universal and influence the quality of band\n  interpolation.\n<Ref> shows the variation of band\ndistances w.r.t. and for several materials.\nFor (<ref>), \u03b7_0\n  and \u03b7_2 reach a minimum at two different sets of parameters, i.e. =\n  0.99, = 0.01 and = 0.97, = 0.01, respectively.\nIn some cases, the variation of \u03b7 w.r.t.\nand can be non-monotonic and display\nmultiple local minima: For instance, in (<ref>) at = 0.01, \u03b7_2 decreases\nfrom = 0.90 to 0.95 but increases from = 0.95 to 0.98 and finally\nreaches a local minimum at = 0.99.\nIn other cases, \u03b7 can be quite stable and largely independent of the\n  parameters: E.g., for (<ref>),\n  \u03b7_2 reaches the same minimum for = 0.99 to 0.88.\n\n\nTherefore, we implement an iterative optimization workflow to automatically\n  find the optimal values for and , in order to fully automate the\n  Wannierization procedure.\nThe workflow is released as part of the \n  package <cit.>.\nFirst, we run a QE band structure workflow to get the reference DFT bands for\n  calculating \u03b7_2; in addition, the DFT bands are also used to calculate the\n  band gap of the material.\nSecond, we run an optimization workflow with the following settings: The\n  maximum of the inner window is set to Fermi energy + 2eV for metals and\n  CBM + 2eV for insulators, respectively; and are set to the\n  defaults of 0.95 and 0.01, respectively.\nThird, if the average band distance \u03b7_2 is less than a threshold (set to\n  10meV here), the workflow stops; otherwise, the workflow iterates on a\n  mesh of and , i.e. decreasing from 0.99 to 0.80 with step size\n  -0.01, and = 0.01 or 0.02, until \u03b7_2 \u2264 threshold.\nIf \u03b7_2 is still larger than the threshold after exhausting all the\n  parameter combinations, the workflow will output the minimum-\u03b7_2\n  calculation.\n\n\n\n  \u00a7.\u00a7.\u00a7 Band distance\n\nTo compare quantitatively the band interpolation quality of SCDM and PDWF, we\n  Wannierize the 200 structures mentioned earlier and calculate their band\n  distances with respect to the corresponding DFT bands.\nWe choose \u03b7_2 and \u03b7_2^max to compare near-Fermi-energy bands.\nThe histograms of the band distances for the 200 structures are shown in\n  <ref>.\nTo directly compare SCDM and PDWF, the mean and median value of \u03b7 of the\n  200 calculations are shown as vertical lines in each panel.\nFor PDWF, the mean \u03b7_2 is 4.231meV, to be compared with\n  11.201meV for SCDM.\nFor \u03b7_2^max (that is a more stringent test of the quality of\n  interpolation) the PDWF method also performs better, with a \u03b7_2^max =\n  36.743meV vs.\n84.011meV for SCDM.\nWe can also observe this trend in <ref>: For \u03b7_2\n  and \u03b7_2^max, the PDWF histogram bins are much more clustered towards\n  \u03b7 = 0.\nNote that in the cumulative histograms of \u03b7_2, at \u03b7 = 20meV,\n  the PDWF cumulative count is closer to the total number of calculations (200).\nThis indicates that the PDWF has a higher success rate in reducing the\n  interpolation error below 20meV.\nSimilarly, for \u03b7_2^max, PDWF has a higher success rate in reducing the\n  interpolation error under 100meV (to get a better overview of \u03b7 and\n  \u03b7^max, we further show the same histograms of \u03b7 in a wider range\n  0100meV, and \u03b7^max in range 0500meV, in\n  <ref>).\nTo reduce the effect of major outliers, we can also compare the interpolation\n  accuracy of successful calculations, i.e., excluding the outlier calculations\n  which have significantly large band distances.\nAs shown in <ref>, the \u03b7_2^\u2264 20, i.e.,\n  the average of all the calculations for which \u03b7_2 \u2264 20meV,\n  indicates that PDWF (2.922meV) is twice as good as SCDM\n  (5.280meV), and also has a higher success rate: for \u03b7_2^\u2264 20,\n  193 / 200 = 96.5% of the structures have \u03b7_2 \u2264 20meV, while\n  for SCDM it is 183 / 200 = 91.5%.\nMore details are listed in <ref>.\n\n\nIn summary, PDWF provides more accurate and robust interpolations, especially\n  for bands around the Fermi energy or the band gap edges, which are the most\n  relevant bands for many applications.\nLast but not least, a higher energy range can be accurately interpolated by\n  increasing the number of PAOs (see <ref>).\n\n\n\n  \u00a7.\u00a7.\u00a7 MLWF centers\n\nSince we are aiming at restoring a tight-binding atomic-orbital picture with\n  PDWF, we compare the distance of the WF centers from the nearest-neighboring\n  (NN) and next-nearest-neighboring (NNN) atoms, again both for SCDM and PDWF.\nFor each method, we compute d_NN and d_NNN, i.e., the\n  average distance of all the 6818 MLWFs from the respective NN and NNN\n  atoms.\nIf d_NN is 0, then the atomic-orbital picture is strictly preserved.\nHowever, this is unlikely to happen since there is no constraint on the WF\n  centers during both the disentanglement and the localization, and the final\n  PDWFs, resembling atomic orbitals, are optimized according to the chemical\n  environment.\nStill, if a WF center is much closer to the NN atom than to the NNN atom, then\n  one can still assign it to the NN atom, preserving the atomic-orbital picture.\n<Ref> shows the histograms for d_NN and\nd_NNN for the two methods.\nThe PDWF average d_NN = 0.43 is smaller than the\n  SCDM d_NN = 0.53, and correspondingly the PDWF\n  d_NNN = 2.19 is instead larger than the SCDM\n  d_NNN = 2.11.\nThis can also be observed in <ref>: The overlap of\n  the d_NN and d_NNN histograms is smaller for PDWF than\n  for SCDM.\nTo further understand the overlaps, we plot the histogram of the ratio\n  d_NN / d_NNN of each MLWF in the insets of\n  <ref>.\nFor a MLWF, if d_NN / d_NNN = 1, then the MLWF is a bonding\n  orbital centered between two atoms; while if d_NN / d_NNN\u226a 1, then it can be regarded as an (almost) atomic orbital.\nThe histogram of the ratio of SCDM has a long tail extending towards 1.0, i.e.,\n  there are a large number of SCDM MLWFs sitting close to bond centers; on the\n  contrary, the vast majority of the PDWF MLWFs are closer to the NN atom.\n\n\nWe can further compare the effect of maximal localization on the WF centers.\nThe WFs from the projection matrices A_mn\ud835\udc24 are strictly\n  atom-centered, i.e. d_NN = 0.\nThe inset of <ref> shows the histogram of the\n  initial WFs, i.e., after disentanglement and before maximal localization, and\n  the final MLWFs, i.e., after maximal localization, for PDWF.\nIf one chooses d_NN\u2264 0.1 as the criterion for\n  atom-centered MLWFs, then 5594/6818 = 82.0% of the initial WFs and\n  2045/6818 = 30.0% of the final MLWFs are atom-centered.\nThe disentanglement and maximal localization improve the band interpolation,\n  but since there is no constraint on the WF center in the spread functional\n  <ref>, many of the final MLWF centers are not atom-centered.\nAs a comparison, for SCDM, 955/6818 = 14.0% of the initial WFs and\n  1823/6818 = 26.7% of the final MLWFs are atom-centered.\nFor completeness, the statistics and histograms of initial and final\n  d_NN, d_NNN, and d_NN / d_NNN are\n  shown in <ref> and <ref>.\n\nIn summary, for PDWF, most of the initial WFs (after disentanglement and before\n  maximal localization) are atom-centered; many drift a bit away from atom\n  centers during the localization, but the MLWFs are still much closer to the NN\n  than to NNN atoms.\nFor SCDM, most of the initial WFs are away from atom centers, and maximal\n  localization pushes some of the WFs back to atoms, but there is still a large\n  number of MLWFs for which an atom representing the WF center cannot be clearly\n  identified.\nTo exactly fix the MLWFs to atomic positions, one needs to add constraints to\n  the spread functional <cit.>, at the cost of potentially having worse\n  interpolators.\nHowever, this is beyond the scope of the current work, and here we rely on the\n  atom-centered PAO projectors to guide the MLWFs towards the atomic positions,\n  so that the final MLWFs are optimally localized and atom-centered.\n\n\n\n  \u00a7.\u00a7.\u00a7 MLWF spreads\n\nNext, we investigate the spread distributions of SCDM and PDWF.\nUsually, we want localized MLWFs to restore the TB atomic orbitals.\n<Ref>\nshows the histograms of the spread distributions for the two methods.\nThe SCDM spreads have a long tail extending over 10 ^2 in\n  <ref>, due to its inclusion of free-electron states in\n  the density matrix, thus resulting in more delocalized MLWFs as discussed\n  earlier (see e.g. <ref>).\nOn the contrary, the PDWF selects and freezes atomic-orbital states from the\n  remaining bands, leading to much more localized MLWFs, thus much more clustered\n  in a narrow range of 04^2, and already at\n  5^2 the cumulative histogram almost reaches the total number of\n  MLWFs (see <ref>).\nThis can be interpreted as follows: The PAO initial projections guide the\n  spread minimization toward the (local) minimum resembling spherical harmonics,\n  whereas the SCDM-decomposed basis vectors are designed to be mathematical\n  objects spanning as much as possible the density matrix, but result in WFs for\n  which it is harder to assign definite orbital characters.\n\n\n\nWe can further compare the average initial (after disentanglement but before\n  maximal localization) and final (after disentanglement and maximal\n  localization) spreads between the two methods, as shown in\n  <ref> and corresponding histograms in\n  <ref>.\nMaximal localization is needed to bring SCDM spreads, from the initial\n  \u03a9^i = 30.82^2 to the final \u03a9^f =\n  3.54^2; For PDWF, the initial \u03a9^i =\n  2.72^2 is already excellent, and much better than the final\n  \u03a9^f for SCDM; localization then brings it to an optimal \u03a9^f =\n  1.41^2.\n\n\n\n  \u00a7.\u00a7.\u00a7 Hamiltonian decay\n\n\nFinally, we compare the decay length of the Wannier gauge Hamiltonian between\n  the two methods in <ref>.\nThanks to the localization of MLWFs, the expectation values of quantum\n  mechanical operators in the MLWF basis, such as the Hamiltonian\n  H(\ud835\udc11), decay rapidly with respect to the lattice vector \ud835\udc11\n  (exponentially in insulators<cit.> and properly\n  disentangled metals).\nTo compare this decay for the Hamiltonian matrix elements, we approximate the\n  norm of the Hamiltonian as\n  \n    \u2016\n        H(\ud835\udc11) \u2016 = \u2016 H(0) \u2016exp(-\n        \u2016\ud835\udc11\u2016/\u03c4),\n\n  where\n  \u03c4 measures the decay length.\nThen \u03c4 is fitted by least squares to the calculated \u2016\n    H(\ud835\udc11) \u2016; as shown in <ref>, the\n  Hamiltonian of PDWF decays faster than SCDM for , which is selected\n  here to represent the general trend between PDWF and SCDM Hamiltonians.\n<ref> shows the histogram of \u03c4 for the 200 materials; the mean \u03c4 are\n2.266 for PDWF and 2.659 for SCDM,\nrespectively, indicating that the PDWF Hamiltonian decays faster than SCDM, consistent with the better band interpolation\nof PDWF discussed in <ref>.\n\n\n\n\n\n \u00a7.\u00a7 High-throughput Wannierization\n\nBased on the above verification, we run a HT Wannierization using PDWF for\n  21737 materials, selected from the non-magnetic materials of the MC3D\n  database <cit.>.\n<Ref> shows the band distance\nhistograms for \u03b7_2 and \u03b7_2^max.\nOverall, the statistics follow the same trend as the 200 materials set in\n  <ref>: the average \u03b7_2 and average \u03b7_2^max\n  are  3.685 meV and  42.768 meV, respectively.\nNote in <ref> the \u03b7_2 is not truncated at\n  10meV, but rather due to the automated optimization workflow: results\n  that have \u03b7_2 larger than a threshold (10meV) are further optimized\n  with respect to and , thus improving the average band distance\n  \u03b7_2.\nIn <ref> we show several other statistics for the band\n  distances.\nThe excellent interpolation quality of PDWF can be assessed, for instance, from\n  the number of systems with \u03b7_2 \u2264 20meV, that are \u2248 97.8%\n  of all the calculations (21259 / 21737); the corresponding bands distance\n  calculated on these 21259 calculations is \u03b7_2^\u2264 20 =\n  2.118meV.\nThis remarkable result show how automated and reliable Wannierizations can now\n  be deployed automatically both for individual calculation and for HT\n  application.\n\n\n\n\n \u00a7.\u00a7 Additional PAOs for high-energy high-accuracy interpolation\n\nBased on the HT Wannierization results, one can identify cases where the\n  interpolation quality can be further improved by increasing the number of PAOs.\nTypically, the number of PAOs is determined during pseudopotential generation,\n  and they are usually the orbitals describing low-energy valence electrons.\nIn some cases, the bonding/anti-bonding combinations of these PAOs are not\n  sufficient to span the space of target conduction bands, leading to a loss of\n  interpolation quality.\nWe use silicon as an example to illustrate the difficulties of accurately\n  describing its CBM <cit.>, which is not located at any high-symmetry\n  k-point, but along the \u0393-X line.\nThe common choice of one s and three p hydrogenic or PAOs projectors per\n  atom results in oscillations in the Wannier-interpolated bands at the meV\n  level.\nTo remedy this, one can use a larger set of PAOs, e.g., by regenerating a\n  silicon pseudopotential including d PAOs as discussed in <ref>.\nHowever, generating a new pseudopotential requires extensive testing and\n  validation, therefore another solution could be using a set of PAOs different\n  from the pseudopotential ones.\nTo compare this second approach, we test here also PAOs obtained from the code <cit.>, and Wannierize silicon using one s, three p, and\n  five d PAOs per atom using ED.\nThis provides a much better description of the CBM, as shown in\n  <ref> Moreover, the additional d orbitals allow to\n  raise the inner energy window and better reproduce a larger number of\n  conduction bands, as shown in <ref>, which might be\n  beneficial for some applications. \nFor completeness, we also show the WF spreads and shapes of d orbitals in\n  <ref>.\nHowever, there are some caveats to this approach.\nWhen using external PAOs, ideally one should generate them using the same\n  pseudization scheme as the pseudopotentials used in the DFT calculations.\nThe PAOs from are instead generated using a different scheme, resulting in\n  lower projectabilities (smaller than one even for the valence bands, as shown\n  in <ref>).\nIn such case, PD cannot reproduce the original bands (see\n  <ref>), thus ED (with a higher\n  inner energy window) is needed to obtain accurate interpolation (see\n  <ref>).\nIn comparison, the pseudopotential PAOs which we regenerated with 3d orbitals\n  (as discussed in <ref>) are better projectors for the\n  wavefunctions.\nIndeed, the first 12 bands have projectabilities almost equal to 1, and as a\n  consequence PD itself already provides accurate band interpolation (all the\n  low-energy conduction states are frozen since their projectabilities are high,\n  see <ref>).\nMoreover, we mention that when adding additional projectors one needs to make\n  sure that they have the correct number of radial nodes: e.g., the gold\n  pseudopotential from SSSP <cit.> contains 5s+5p semicore states,\n  and 6s+5d orbitals for valence electrons.\nIf one wants to add an additional 6p orbital, it is important to ensure that\n  the 6p orbital has one radial node, such that it is orthogonal to the\n  nodeless 5p semicore state; Otherwise, the Bloch wavefunctions would project\n  onto the 5p semicore state, and PD would only disentangle the 5p semicore\n  states instead of the 6p orbitals contributing to bands above the Fermi\n  energy.\nIn summary, including more projectors can further improve the interpolation\n  quality, but at the expense of increasing the number of orbitals in the model.\nThe combination of PD and ED enables to improve the interpolation quality of\n  low-projectability states while keeping the TB model size small.\nAutomatic checks could be implemented in the future in the workflows to\n  detect whether the projectability drops below a certain threshold, and in that\n  case either raise a warning or automatically add more projectors.\n\n\n\n\u00a7 CONCLUSIONS\n\nWe present an automated method for the automated, robust, and reliable\n  construction of tight-binding models based on MLWFs.\nThe approach applies equally well to metals, insulators and semiconductors,\n  providing in all cases atomic-like orbitals that span both the occupied states,\n  and the empty ones whose character remains orbital-like and and not\n  free-electron-like.\nThe method is based on the band projectability onto pseudo-atomic orbitals to\n  select which states are kept identically, dropped, or passed on to the\n  established disentanglement procedure.\nWe augment such projectability-based selection with an additional energy window\n  to guarantee that all states around the Fermi level or the conduction band edge\n  are well reproduced, showing that such a combination enables accurate\n  interpolation even when minimal sets of initial atomic orbitals are chosen.\nThis results in compact Wannier tight-binding models that provide accurate band\n  interpolations while preserving the picture of atomic orbitals in crystals.\nWe refer to the method collectively as projectability-disentangled Wannier\n  functions (PDWF).\n\nThe Wannierization process is implemented as fully automated workflows.\nWe compare PDWFs with the other method that is also fully automated, namely\n  SCDM.\nWe show with a detailed study of 200 structures that PDWFs lead to more\n  accurate band interpolations (with errors with respect to the original bands at\n  the meV scale), and are more atom-centered and more localized than those\n  originating from SCDM.\nThe high accuracy in band interpolations, the target atomic orbitals obtained,\n  and the low computational cost make PDWFs an ideal choice for automated or\n  high-throughput Wannierization, which we demonstrate by performing the\n  Wannierization of 21737 non-magnetic structures from the Materials Cloud\n  MC3D database.\n\n\n\n\u00a7 METHODS\n\n\nWe implement the PAO projection in the  executable\n  inside (QE) <cit.>; the PD and PD+ED methods\n  are implemented on top of the code <cit.>.\nIn terms of the practical implementation, computing PAO projections is more\n  efficient in both computational time and memory than the SCDM QR decomposition\n  with column pivoting (QRCP) algorithm, since the A_mn\ud835\udc24 matrices\n  (i.e., the inner products of Bloch wavefunctions with PAOs) can be evaluated in\n  the plane-wave G vector space, rather than requiring a Fourier transform and\n  decomposition of very large real-space wavefunction matrices.\nFurthermore, since the HT Wannierization can be computationally intensive, we\n  implement a \u201ck-pool parallelization strategy\u201d inside , similarly to\n  the main  code of QE, to efficiently utilize many-core\n  architectures by parallelizing over \u201cpools\u201d of processors for the almost\n  trivially-parallel computations at each k-point.\nTest results show that k-pool parallelization significantly improves the\n  efficiency of (benchmarks are shown in <ref>).\n\nThe DFT calculations are carried out using QE, with the SSSP efficiency\n  (version 1.1, PBE functional) library <cit.> for pseudopotentials\n  and its recommended energy cutoffs.\nThe HT calculations are managed with the infrastructure\n  <cit.> which submits QE and calculations to\n  remote clusters, parses, and stores the results into a database, while also\n  orchestrating all sequences of simulations and workflows.\nThe automated workflows are open-source and hosted on \n  <cit.>.\nThe workflows accept a crystal structure as input and provide the\n  Wannier-interpolated band structure, the real-space MLWFs, and a number of\n  additional quantities as output.\nSemicore states from pseudopotentials are automatically detected and excluded\n  from the Wannierizations, except for a few cases where some semicore states\n  overlap with valence states; in such cases, all the semicore states are\n  Wannierized, otherwise the band interpolation quality would be degraded,\n  especially for SCDM.\nA regular k-point mesh is used for the Wannier calculations, with a k-point\n  spacing of 0.2, as selected by the protocol in\n  <cit.>.\nMLWFs are rendered with VESTA <cit.>.\nFigures are generated by  <cit.>.\n\n\n\n\u00a7 DATA AVAILABILITY\n\nAll data generated for this work can be obtained from the Materials Cloud\n  Archive (<https://doi.org/10.24435/materialscloud:v4-e9>).\n\n\n\n\u00a7 CODE AVAILABILITY\n\n\nAll codes used for this work are open-source; the latest stable versions can be\n  downloaded at <http://www.wannier.org/>,\n  <https://www.quantum-espresso.org/>, <https://www.aiida.net/>, and\n  <https://github.com/aiidateam/aiida-wannier90-workflows>.\n\nThe modifications to the codes mentioned above implemented for this work will\n  become available in the next releases of () and .\n\n\n\n\u00a7 ACKNOWLEDGEMENTS\n\nWe acknowledge financial support from the NCCR MARVEL (a National Centre of\n  Competence in Research, funded by the Swiss National Science Foundation, grant\n  No.\n205602), the Swiss National Science Foundation (SNSF) Project Funding\n(grant 200021E206190 \u201cFISH4DIET\u201d).\nThe work is also supported by a pilot access grant from the Swiss National\n  Supercomputing Centre (CSCS) on the Swiss share of the LUMI system under\n  project ID \u201cPILOT MC EPFL-NM 01\u201d, a CHRONOS grant from the CSCS on the Swiss\n  share of the LUMI system under project ID \u201cREGULAR MC EPFL-NM 02\u201d, and a\n  grant from the CSCS under project ID s0178.\n\n\n\n\u00a7 AUTHOR CONTRIBUTIONS\n\nJ.\nQ.\nimplemented and tested the PDWF method on selected materials.\nG.\nP.\nand\nN.\nM.\nsupervised the project.\nAll authors analyzed the results and contributed to writing the manuscript.\n\n\n\n\n\n\n\n\n\n\n\n50\nfxundefined [1]\n ifx#1\n\nfnum [1]\n #1firstoftwo\n secondoftwo\n \nfx [1]\n #1firstoftwo\n secondoftwo\n \n\n\n\n\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12`&12`#12`1\u03022`_12`%12\nstartlink[1]\nendlink[0]\n\nrl [1]href #1\n\n\n\n\n\n\n\n\n\n\n\n\n@bib@innerbibempty\n\n[Marzari and Vanderbilt(1997)]Marzari1997\n  author author N.\u00a0Marzari and author D.\u00a0Vanderbilt, title title Maximally localized\n  generalized Wannier functions for composite energy bands, https://doi.org/10.1103/physrevb.56.12847 journal journal Phys. Rev. B volume 56, pages 12847 (year 1997)NoStop\n[Souza et\u00a0al.(2001)Souza,\n  Marzari, and Vanderbilt]Souza2001\n  author author I.\u00a0Souza, author N.\u00a0Marzari,  and author D.\u00a0Vanderbilt,  title title Maximally localized Wannier functions\n  for entangled energy bands, https://doi.org/10.1103/physrevb.65.035109 journal journal Phys. Rev. B volume 65, pages 035109 (year 2001)NoStop\n[Marzari et\u00a0al.(2012)Marzari, Mostofi, Yates, Souza, and Vanderbilt]Marzari2012\n  author author N.\u00a0Marzari, author A.\u00a0A. Mostofi, author J.\u00a0R. Yates,\n  author I.\u00a0Souza, and author D.\u00a0Vanderbilt, title\n  title Maximally localized Wannier functions: Theory and\n  applications, https://doi.org/10.1103/revmodphys.84.1419\n  journal journal Rev. Mod. Phys. volume 84, pages 1419 (year\n  2012)NoStop\n[Pizzi et\u00a0al.(2020)Pizzi,\n  Vitale, Arita, Bl\u00fcgel,\n  Freimuth, G\u00e9ranton, Gibertini, Gresch, Johnson, Koretsune, Iba\u00f1ez-Azpiroz, Lee,\n  Lihm, Marchand, Marrazzo,\n  Mokrousov, Mustafa, Nohara,\n  Nomura, Paulatto, Ponc\u00e9, Ponweiser, Qiao, Th\u00f6le, Tsirkin, Wierzbowska, Marzari, Vanderbilt, Souza, Mostofi, and Yates]Pizzi2020\n  author author G.\u00a0Pizzi, author V.\u00a0Vitale,\n  author R.\u00a0Arita, author S.\u00a0Bl\u00fcgel, author\n  F.\u00a0Freimuth, author\n  G.\u00a0G\u00e9ranton, author\n  M.\u00a0Gibertini, author\n  D.\u00a0Gresch, author C.\u00a0Johnson, author T.\u00a0Koretsune, author J.\u00a0Iba\u00f1ez-Azpiroz, author H.\u00a0Lee, author J.-M.  Lihm, author D.\u00a0Marchand, author A.\u00a0Marrazzo,\n  author Y.\u00a0Mokrousov, author J.\u00a0I. Mustafa, author\n  Y.\u00a0Nohara, author Y.\u00a0Nomura, author L.\u00a0Paulatto, author S.\u00a0Ponc\u00e9, author T.\u00a0Ponweiser, author J.\u00a0Qiao, author F.\u00a0Th\u00f6le, author S.\u00a0S. Tsirkin,\n  author M.\u00a0Wierzbowska, author N.\u00a0Marzari, author\n  D.\u00a0Vanderbilt, author\n  I.\u00a0Souza, author A.\u00a0A. Mostofi, and author J.\u00a0R. Yates, title title\n  Wannier90 as a community code: new features and applications, https://doi.org/10.1088/1361-648x/ab51ff journal journal J. Phys.: Condens. Matter volume 32,  pages 165902 (year 2020)NoStop\n[Resta and Vanderbilt(2007)]Resta2007\n  author author R.\u00a0Resta and author D.\u00a0Vanderbilt, title title Theory of\n  Polarization: A Modern Approach (publisher\n  Springer, year 2007) pp. pages\n  31\u201368NoStop\n[Lee et\u00a0al.(2005)Lee,\n  Nardelli, and Marzari]Lee2005\n  author author Y.-S. Lee, author M.\u00a0B. Nardelli,  and author N.\u00a0Marzari,  title title Band structure and quantum conductance\n  of nanostructures from maximally localized wannier functions: The case of\n  functionalized carbon nanotubes, https://doi.org/10.1103/PhysRevLett.95.076804 journal\n  journal Phys. Rev. Lett. volume 95,  pages 076804 (year 2005)NoStop\n[Lopez et\u00a0al.(2012)Lopez,\n  Vanderbilt, Thonhauser, and Souza]Lopez2012\n  author author M.\u00a0G. Lopez, author D.\u00a0Vanderbilt,\n  author T.\u00a0Thonhauser, and  author I.\u00a0Souza, title title Wannier-based calculation of the orbital\n  magnetization in crystals, https://doi.org/10.1103/physrevb.85.014435 journal journal Phys. Rev. B volume 85, pages 014435 (year 2012)NoStop\n[Wang et\u00a0al.(2006)Wang,\n  Yates, Souza, and Vanderbilt]Wang2006\n  author author X.\u00a0Wang, author J.\u00a0R. Yates,\n  author I.\u00a0Souza, and author D.\u00a0Vanderbilt, title\n  title Ab initio calculation of the anomalous Hall conductivity\n  by Wannier interpolation, https://doi.org/10.1103/physrevb.74.195118 journal journal Phys. Rev. B volume 74, pages 195118 (year 2006)NoStop\n[Yates et\u00a0al.(2007)Yates,\n  Wang, Vanderbilt, and Souza]Yates2007\n  author author J.\u00a0R. Yates, author X.\u00a0Wang,\n  author D.\u00a0Vanderbilt, and  author I.\u00a0Souza, title title Spectral and Fermi surface properties from\n  Wannier interpolation, https://doi.org/10.1103/physrevb.75.195121\n  journal journal Phys. Rev. B volume 75, pages 195121 (year\n  2007)NoStop\n[Qiao et\u00a0al.(2018)Qiao,\n  Zhou, Yuan, and Zhao]Qiao2018\n  author author J.\u00a0Qiao, author J.\u00a0Zhou, author Z.\u00a0Yuan, and author\n  W.\u00a0Zhao, title title Calculation of intrinsic spin Hall conductivity by Wannier\n  interpolation, https://doi.org/10.1103/physrevb.98.214402\n  journal journal Phys. Rev. B volume 98, pages 214402 (year\n  2018)NoStop\n[Sakuma(2013)]Sakuma2013\n  author author R.\u00a0Sakuma, title title Symmetry-adapted\n  Wannier functions in the maximal localization procedure, https://doi.org/10.1103/PhysRevB.87.235109 journal journal Phys. Rev. B volume 87, pages 235109 (year 2013)NoStop\n[Gygi et\u00a0al.(2003)Gygi,\n  Fattebert, and Schwegler]Gygi2003\n  author author F.\u00a0Gygi, author J.-L. Fattebert, and author E.\u00a0Schwegler, title title Computation of\n  Maximally Localized Wannier Functions using a simultaneous diagonalization\n  algorithm, https://doi.org/10.1016/s0010-4655(03)00315-1\n  journal journal Comput. Phys. Commun. volume 155, pages 1 (year\n  2003)NoStop\n[Thygesen et\u00a0al.(2005a)Thygesen, Hansen, and Jacobsen]Thygesen2005\n  author author K.\u00a0S. Thygesen, author L.\u00a0B. Hansen, and author K.\u00a0W. Jacobsen, title title Partly Occupied Wannier\n  Functions, https://doi.org/10.1103/physrevlett.94.026405\n  journal journal Phys. Rev. Lett. volume 94, pages 026405 (year\n  2005a)NoStop\n[Thygesen et\u00a0al.(2005b)Thygesen, Hansen, and Jacobsen]Thygesen2005a\n  author author K.\u00a0S. Thygesen, author L.\u00a0B. Hansen, and author K.\u00a0W. Jacobsen, title title Partly occupied Wannier\n  functions: Construction and applications, https://doi.org/10.1103/physrevb.72.125119 journal journal Phys. Rev. B volume 72, pages 125119 (year 2005b)NoStop\n[Damle et\u00a0al.(2019)Damle,\n  Levitt, and Lin]Damle2019\n  author author A.\u00a0Damle, author A.\u00a0Levitt, and  author L.\u00a0Lin, title title Variational Formulation for Wannier Functions\n  with Entangled Band Structure, https://doi.org/10.1137/18m1167164\n  journal journal Multiscale Model. Simul.  volume 17, pages 167 (year\n  2019)NoStop\n[Wang et\u00a0al.(2014)Wang,\n  Lazar, Park, Millis, and  Marianetti]Wang2014\n  author author R.\u00a0Wang, author E.\u00a0A. Lazar,\n  author H.\u00a0Park, author\n  A.\u00a0J. Millis, and author\n  C.\u00a0A. Marianetti, title\n  title Selectively localized Wannier functions, https://doi.org/10.1103/physrevb.90.165125 journal journal Phys. Rev. B volume 90, pages 165125 (year 2014)NoStop\n[Fontana et\u00a0al.(2021)Fontana, Larsen, Olsen, and Thygesen]Fontana2021\n  author author P.\u00a0F. Fontana, author A.\u00a0H. Larsen,\n  author T.\u00a0Olsen, and author K.\u00a0S. Thygesen, title title Spread-balanced Wannier functions: Robust and\n  automatable orbital localization, https://doi.org/10.1103/physrevb.104.125140 journal journal Phys. Rev. B volume 104, pages 125140 (year 2021)NoStop\n[Mustafa et\u00a0al.(2015)Mustafa, Coh, Cohen, and Louie]Mustafa2015\n  author author J.\u00a0I. Mustafa, author S.\u00a0Coh,\n  author M.\u00a0L. Cohen, and  author S.\u00a0G. Louie, title title Automated construction of maximally localized\n  Wannier functions: Optimized projection functions method, https://doi.org/10.1103/physrevb.92.165134 journal journal Phys. Rev. B volume 92, pages 165134 (year 2015)NoStop\n[Canc\u00e8s et\u00a0al.(2017)Canc\u00e8s, Levitt, Panati, and  Stoltz]Cances2017\n  author author \u00c9.\u00a0Canc\u00e8s, author A.\u00a0Levitt, author G.\u00a0Panati,  and author G.\u00a0Stoltz,  title title Robust determination of maximally\n  localized Wannier functions, https://doi.org/10.1103/physrevb.95.075114 journal journal Phys. Rev. B volume 95, pages 075114 (year 2017)NoStop\n[Gontier et\u00a0al.(2019)Gontier, Levitt, and Siraj-dine]Gontier2019\n  author author D.\u00a0Gontier, author A.\u00a0Levitt,  and author S.\u00a0Siraj-dine,  title title Numerical construction of Wannier\n  functions through homotopy, https://doi.org/10.1063/1.5085753\n  journal journal J. Math. Phys. volume 60, pages 031901 (year\n  2019)NoStop\n[Damle et\u00a0al.(2015)Damle,\n  Lin, and Ying]Damle2015\n  author author A.\u00a0Damle, author L.\u00a0Lin, and  author L.\u00a0Ying, title title Compressed Representation of\n  Kohn\u2013Sham Orbitals via Selected Columns of the Density Matrix,  https://doi.org/10.1021/ct500985f journal journal J. Chem. Theory Comput. volume 11,  pages 1463 (year 2015)NoStop\n[Damle and Lin(2018)]Damle2018\n  author author A.\u00a0Damle and author L.\u00a0Lin,  title title Disentanglement via Entanglement: A\n  Unified Method for Wannier Localization, https://doi.org/10.1137/17m1129696 journal journal Multiscale Model. Simul. volume 16,  pages 1392 (year 2018)NoStop\n[Jain et\u00a0al.(2013)Jain,\n  Ong, Hautier, Chen,\n  Richards, Dacek, Cholia,\n  Gunter, Skinner, Ceder, and  Persson]Jain2013\n  author author A.\u00a0Jain, author S.\u00a0P. Ong,\n  author G.\u00a0Hautier, author W.\u00a0Chen, author\n  W.\u00a0D. Richards, author\n  S.\u00a0Dacek, author S.\u00a0Cholia, author D.\u00a0Gunter, author D.\u00a0Skinner, author G.\u00a0Ceder, and author K.\u00a0A.  Persson, title title Commentary:\n  The Materials Project: A materials genome approach to accelerating\n  materials innovation, https://doi.org/10.1063/1.4812323\n  journal journal APL Mater. volume 1, pages 011002 (year\n  2013)NoStop\n[Curtarolo et\u00a0al.(2012)Curtarolo, Setyawan, Hart, Jahnatek, Chepulskii, Taylor, Wang, Xue, Yang, Levy,\n  Mehl, Stokes, Demchenko,  and Morgan]Curtarolo2012\n  author author S.\u00a0Curtarolo, author W.\u00a0Setyawan,\n  author G.\u00a0L.\u00a0W. Hart, author M.\u00a0Jahnatek, author\n  R.\u00a0V. Chepulskii, author\n  R.\u00a0H. Taylor, author\n  S.\u00a0Wang, author J.\u00a0Xue, author K.\u00a0Yang, author O.\u00a0Levy, author M.\u00a0J. Mehl, author\n  H.\u00a0T. Stokes, author\n  D.\u00a0O. Demchenko, and author\n  D.\u00a0Morgan, title title AFLOW: An automatic framework for high-throughput materials\n  discovery, https://doi.org/10.1016/j.commatsci.2012.02.005\n  journal journal Comput. Mater. Sci. volume 58, pages 218 (year\n  2012)NoStop\n[Saal et\u00a0al.(2013)Saal,\n  Kirklin, Aykol, Meredig,  and Wolverton]Saal2013\n  author author J.\u00a0E. Saal, author S.\u00a0Kirklin,\n  author M.\u00a0Aykol, author B.\u00a0Meredig, and author\n  C.\u00a0Wolverton, title title Materials Design and Discovery with High-Throughput\n  Density Functional Theory: The Open Quantum Materials\n  Database (OQMD), https://doi.org/10.1007/s11837-013-0755-4\n  journal journal JOM volume\n  65, pages 1501 (year 2013)NoStop\n[CMR()]CMR\n  @noop  title Computational Materials Repository,  howpublished <https://cmr.fysik.dtu.dk/>, note\n  [Online; accessed 2023-02-28]NoStop\n[Talirz et\u00a0al.(2020)Talirz,\n  Kumbhar, Passaro, Yakutovich,\n  Granata, Gargiulo, Borelli,\n  Uhrin, Huber, Zoupanos,\n  Adorf, Andersen, Sch\u00fctt,\n  Pignedoli, Passerone, VandeVondele, Schulthess, Smit,\n  Pizzi, and Marzari]Talirz2020\n  author author L.\u00a0Talirz, author S.\u00a0Kumbhar,\n  author E.\u00a0Passaro, author A.\u00a0V. Yakutovich, author V.\u00a0Granata, author\n  F.\u00a0Gargiulo, author\n  M.\u00a0Borelli, author M.\u00a0Uhrin, author S.\u00a0P.  Huber, author S.\u00a0Zoupanos, author C.\u00a0S. Adorf,\n  author C.\u00a0W. Andersen, author O.\u00a0Sch\u00fctt, author\n  C.\u00a0A. Pignedoli, author\n  D.\u00a0Passerone, author\n  J.\u00a0VandeVondele, author\n  T.\u00a0C. Schulthess, author\n  B.\u00a0Smit, author G.\u00a0Pizzi, and author N.\u00a0Marzari, title title\n  Materials Cloud, a platform for open computational science, https://doi.org/10.1038/s41597-020-00637-5 journal journal Sci. Data volume 7, pages\n  299 (year 2020)NoStop\n[Draxl and Scheffler(2018)]Draxl2018\n  author author C.\u00a0Draxl and author M.\u00a0Scheffler, title title NOMAD: The FAIR\n  concept for big data-driven materials science, https://doi.org/10.1557/mrs.2018.208 journal journal MRS Bulletin volume 43, pages 676 (year 2018)NoStop\n[Gresch et\u00a0al.(2018)Gresch,\n  Wu, Winkler, H\u00e4uselmann,\n  Troyer, and Soluyanov]Gresch2018\n  author author D.\u00a0Gresch, author Q.\u00a0Wu, author G.\u00a0W. Winkler, author\n  R.\u00a0H\u00e4uselmann, author\n  M.\u00a0Troyer, and author\n  A.\u00a0A. Soluyanov, title\n  title Automated construction of symmetrized Wannier-like\n  tight-binding models from ab initio calculations, https://doi.org/10.1103/physrevmaterials.2.103805 journal\n  journal Phys. Rev. Mater. volume 2,  pages 103805 (year 2018)NoStop\n[Vitale et\u00a0al.(2020)Vitale,\n  Pizzi, Marrazzo, Yates,\n  Marzari, and Mostofi]Vitale2020\n  author author V.\u00a0Vitale, author G.\u00a0Pizzi,\n  author A.\u00a0Marrazzo, author J.\u00a0R. Yates, author\n  N.\u00a0Marzari, and author\n  A.\u00a0A. Mostofi, title\n  title Automated high-throughput Wannierisation, https://doi.org/10.1038/s41524-020-0312-y journal journal npj Comput. Mater. volume 6, pages 66 (year 2020)NoStop\n[Garrity and Choudhary(2021)]Garrity2021\n  author author K.\u00a0F. Garrity and author K.\u00a0Choudhary, title title Database of Wannier\n  tight-binding Hamiltonians using high-throughput density functional\n  theory, https://doi.org/10.1038/s41597-021-00885-z journal journal Sci. Data volume\n  8, pages 106 (year 2021)NoStop\n[Agapito et\u00a0al.(2016)Agapito, Ismail-Beigi, Curtarolo,\n  Fornari, and Nardelli]Agapito2016\n  author author L.\u00a0A. Agapito, author S.\u00a0Ismail-Beigi, author S.\u00a0Curtarolo, author M.\u00a0Fornari,  and author M.\u00a0B. Nardelli,  title title Accurate tight-binding Hamiltonian\n  matrices from ab initio calculations: Minimal basis sets, https://doi.org/10.1103/physrevb.93.035104 journal journal Phys. Rev. B volume 93, pages 035104 (year 2016)NoStop\n[Pizzi et\u00a0al.(2016)Pizzi,\n  Cepellotti, Sabatini, Marzari, and Kozinsky]Pizzi2016\n  author author G.\u00a0Pizzi, author A.\u00a0Cepellotti,\n  author R.\u00a0Sabatini, author N.\u00a0Marzari, and author\n  B.\u00a0Kozinsky, title title AiiDA: automated interactive infrastructure and database for\n  computational science, https://doi.org/10.1016/j.commatsci.2015.09.013 journal\n  journal Comput. Mater. Sci. volume\n  111, pages 218 (year 2016)NoStop\n[Huber et\u00a0al.(2020)Huber,\n  Zoupanos, Uhrin, Talirz,\n  Kahle, H\u00e4uselmann, Gresch,\n  M\u00fcller, Yakutovich, Andersen, Ramirez, Adorf, Gargiulo, Kumbhar, Passaro, Johnston, Merkys, Cepellotti, Mounet, Marzari, Kozinsky, and  Pizzi]Huber2020\n  author author S.\u00a0P. Huber, author S.\u00a0Zoupanos,\n  author M.\u00a0Uhrin, author L.\u00a0Talirz, author\n  L.\u00a0Kahle, author R.\u00a0H\u00e4uselmann, author D.\u00a0Gresch, author T.\u00a0M\u00fcller, author A.\u00a0V.  Yakutovich, author C.\u00a0W.  Andersen, author F.\u00a0F.  Ramirez, author C.\u00a0S.  Adorf, author F.\u00a0Gargiulo, author S.\u00a0Kumbhar,\n  author E.\u00a0Passaro, author C.\u00a0Johnston, author\n  A.\u00a0Merkys, author A.\u00a0Cepellotti, author N.\u00a0Mounet, author N.\u00a0Marzari, author B.\u00a0Kozinsky, and author G.\u00a0Pizzi, title title AiiDA\n  1.0, a scalable computational infrastructure for automated reproducible\n  workflows and data provenance, https://doi.org/10.1038/s41597-020-00638-4 journal journal Sci. Data volume 7, pages\n  300 (year 2020)NoStop\n[Uhrin et\u00a0al.(2021)Uhrin,\n  Huber, Yu, Marzari, and  Pizzi]Uhrin2021\n  author author M.\u00a0Uhrin, author S.\u00a0P. Huber,\n  author J.\u00a0Yu, author\n  N.\u00a0Marzari, and author\n  G.\u00a0Pizzi, title title Workflows in AiiDA: Engineering a high-throughput, event-based\n  engine for robust and modular computational workflows, https://doi.org/10.1016/j.commatsci.2020.110086 journal\n  journal Comput. Mater. Sci. volume\n  187, pages 110086 (year 2021)NoStop\n[MC3()]MC3D\n  @noop  title Materials Cloud three-dimensional crystals\n  database (MC3D), howpublished\n  <https://www.materialscloud.org/discover/mc3d/dashboard/ptable>,  note [Online; accessed 2023-02-28]NoStop\n[L\u00f6wdin()]Loewdin1950\n  author author P.-O. L\u00f6wdin, title title On the non-orthogonality\n  problem connected with the use of atomic wave functions in the theory of\n  molecules and crystals, https://doi.org/10.1063/1.1747632\n  journal journal J. Chem. Phys. volume 18, pages 365NoStop\n[Mahajan et\u00a0al.(2021)Mahajan, Timrov, Marzari, and  Kashyap]PhysRevMaterials.5.104402\n  author author R.\u00a0Mahajan, author I.\u00a0Timrov,\n  author N.\u00a0Marzari, and author A.\u00a0Kashyap, title\n  title Importance of intersite hubbard interactions in\n  MnO_2: A first-principles\n  DFT+U+V study, https://doi.org/10.1103/PhysRevMaterials.5.104402\n  journal journal Phys. Rev. Materials volume 5, pages 104402 (year\n  2021)NoStop\n[Giannozzi et\u00a0al.(2020)Giannozzi, Baseggio, Bonf\u00e0,\n  Brunato, Car, Carnimeo,\n  Cavazzoni, de\u00a0Gironcoli, Delugas, Ruffino, Ferretti, Marzari, Timrov, Urru, and Baroni]Giannozzi2020a\n  author author P.\u00a0Giannozzi, author O.\u00a0Baseggio,\n  author P.\u00a0Bonf\u00e0, author D.\u00a0Brunato, author\n  R.\u00a0Car, author I.\u00a0Carnimeo, author C.\u00a0Cavazzoni, author S.\u00a0de\u00a0Gironcoli, author P.\u00a0Delugas, author F.\u00a0F.  Ruffino, author A.\u00a0Ferretti, author N.\u00a0Marzari,\n  author I.\u00a0Timrov, author A.\u00a0Urru, and author\n  S.\u00a0Baroni, title title Quantum ESPRESSO toward the exascale, https://doi.org/10.1063/5.0005082 journal journal J. Chem. Phys. volume 152, pages 154105 (year 2020)NoStop\n[Ozaki(2003)]Ozaki2003\n  author author T.\u00a0Ozaki, title title Variationally optimized\n  atomic orbitals for large-scale electronic structures, https://doi.org/10.1103/PhysRevB.67.155108 journal journal Phys. Rev. B volume 67, pages 155108 (year 2003)NoStop\n[Ozaki and Kino(2004)]Ozaki2004\n  author author T.\u00a0Ozaki and author H.\u00a0Kino,  title title Numerical atomic basis orbitals from\n  H to Kr, https://doi.org/10.1103/physrevb.69.195113 journal journal Phys. Rev. B volume\n  69, pages 195113 (year 2004)NoStop\n[Alan\u00a0Oppenheim(1997)]Oppenheim1997\n  author author S.\u00a0N. Alan\u00a0Oppenheim, Alan\u00a0Willsky, @noop  title Signals and Systems (publisher Prentice\n  Hall, year 1997) p. pages 957NoStop\n[Prandini et\u00a0al.(2018)Prandini, Marrazzo, Castelli, Mounet, and Marzari]Prandini2018\n  author author G.\u00a0Prandini, author A.\u00a0Marrazzo,\n  author I.\u00a0E. Castelli, author N.\u00a0Mounet, and author\n  N.\u00a0Marzari, title title Precision and efficiency in solid-state pseudopotential\n  calculations, https://doi.org/10.1038/s41524-018-0127-2\n  journal journal npj Comput. Mater. volume 4, pages 72 (year\n  2018)NoStop\n[aii()]aiidaW90\n  @noop  title aiida-wannier90-workflows: A collection of\n  advanced automated workflows to compute Wannier functions using AiiDA and the\n  Wannier90 code, howpublished\n  <https://github.com/aiidateam/aiida-wannier90-workflows>, note [Online; accessed 2023-02-28]NoStop\n[Brouder et\u00a0al.(2007)Brouder, Panati, Calandra, Mourougane, and Marzari]Brouder2007\n  author author C.\u00a0Brouder, author G.\u00a0Panati,\n  author M.\u00a0Calandra, author C.\u00a0Mourougane, and author N.\u00a0Marzari, title\n  title Exponential localization of wannier functions in\n  insulators, https://doi.org/10.1103/physrevlett.98.046402\n  journal journal Phys. Rev. Lett. volume 98, pages 046402 (year\n  2007)NoStop\n[Panati and Pisante(2013)]Panati2013\n  author author G.\u00a0Panati and author A.\u00a0Pisante, title title Bloch bundles,\n  marzari-vanderbilt functional and maximally localized wannier functions,  https://doi.org/10.1007/s00220-013-1741-y journal\n  journal Commun. Math. Phys. volume\n  322, pages 835 (year 2013)NoStop\n[Ponc\u00e9 et\u00a0al.(2021)Ponc\u00e9, Macheda, Margine,\n  Marzari, Bonini, and Giustino]Ponce2021\n  author author S.\u00a0Ponc\u00e9, author F.\u00a0Macheda, author E.\u00a0R. Margine, author N.\u00a0Marzari,\n  author N.\u00a0Bonini, and author F.\u00a0Giustino, title\n  title First-principles predictions of Hall and drift mobilities\n  in semiconductors, https://doi.org/10.1103/physrevresearch.3.043022 journal\n  journal Phys. Rev. Res. volume 3,  pages 043022 (year 2021)NoStop\n[Giannozzi et\u00a0al.(2009)Giannozzi, Baroni, Bonini, Calandra, Car, Cavazzoni, Ceresoli, Chiarotti, Cococcioni,\n  Dabo, Corso, de\u00a0Gironcoli,\n  Fabris, Fratesi, Gebauer,\n  Gerstmann, Gougoussis, Kokalj, Lazzeri, Martin-Samos,\n  Marzari, Mauri, Mazzarello,\n  Paolini, Pasquarello, Paulatto, Sbraccia, Scandolo, Sclauzero, Seitsonen, Smogunov,\n  Umari, and Wentzcovitch]Giannozzi2009\n  author author P.\u00a0Giannozzi, author S.\u00a0Baroni,\n  author N.\u00a0Bonini, author M.\u00a0Calandra, author\n  R.\u00a0Car, author C.\u00a0Cavazzoni, author D.\u00a0Ceresoli, author G.\u00a0L.  Chiarotti, author M.\u00a0Cococcioni, author I.\u00a0Dabo,\n  author A.\u00a0D. Corso, author S.\u00a0de\u00a0Gironcoli, author\n  S.\u00a0Fabris, author G.\u00a0Fratesi, author R.\u00a0Gebauer, author U.\u00a0Gerstmann, author C.\u00a0Gougoussis, author A.\u00a0Kokalj, author M.\u00a0Lazzeri, author L.\u00a0Martin-Samos, author N.\u00a0Marzari, author F.\u00a0Mauri, author R.\u00a0Mazzarello, author S.\u00a0Paolini, author A.\u00a0Pasquarello, author L.\u00a0Paulatto, author C.\u00a0Sbraccia, author S.\u00a0Scandolo, author G.\u00a0Sclauzero, author A.\u00a0P.  Seitsonen, author A.\u00a0Smogunov, author P.\u00a0Umari,  and author R.\u00a0M. Wentzcovitch,  title title QUANTUM ESPRESSO: a modular and\n  open-source software project for quantum simulations of materials, https://doi.org/10.1088/0953-8984/21/39/395502 journal\n  journal J. Phys.: Condens. Matter volume\n  21, pages 395502 (year 2009)NoStop\n[Momma and Izumi(2011)]Momma2011\n  author author K.\u00a0Momma and author F.\u00a0Izumi,  title title VESTA 3 for three-dimensional\n  visualization of crystal, volumetric and morphology data, https://doi.org/10.1107/S0021889811038970 journal journal J. Appl. Crystallogr. volume 44,  pages 1272 (year 2011)NoStop\n[Hunter(2007)]Hunter2007\n  author author J.\u00a0D. Hunter, title title Matplotlib: A 2D\n  Graphics Environment, https://doi.org/10.1109/MCSE.2007.55\n  journal journal Comput. Sci. Eng. volume 9, pages 90 (year\n  2007)NoStop\n\n\n\n\n"}