{"entry_id": "http://arxiv.org/abs/2303.06839v1", "published": "20230313040032", "title": "A closed-form expression for the variance of truncated distribution and its uses", "authors": ["Roberto Vila", "Narayanaswamy Balakrishnan", "Raul Matsushita"], "primary_category": "stat.ME", "categories": ["stat.ME", "math.PR"], "text": "\nDDFM: Denoising Diffusion Model for Multi-Modality Image Fusion\n    Zixiang Zhao^1,2  Haowen Bai^1  Yuanzhi Zhu^2  Jiangshe Zhang^1  Shuang Xu^3\n\n            Yulun Zhang^2  Kai Zhang^2  Deyu Meng^1  Radu Timofte^2,4  Luc Van Gool^2\n\n\t\t^1Xi\u2019an Jiaotong University   ^2Computer Vision Lab, ETH Z\u00fcrich\n\n            ^3Northwestern Polytechnical University   ^4University of Wurzburg\n\n\n    Received: date / Accepted: date\n============================================================================================================================================================================================================================================================================================================================\n\n\n\n\nThis work sheds some light on the relationship between a distribution's standard deviation and its range, a topic that has been discussed extensively in the literature. While many previous studies have proposed inequalities or relationships that depend on the shape of the population distribution, the approach here is built on a family of bounded probability distributions based on skewing functions. We offer closed-form expressions for its moments and the asymptotic behavior as the support's semi-range tends to zero and \u221e. We also establish an inequality in which the well-known Popoviciu's one is a special case. Finally, we provide an example using US dollar prices in four different currencies traded on foreign exchange markets to illustrate the results developed here.\n\nKeywords. Truncated distribution \u00b7 Skewing function \u00b7 Popoviciu's inequality \u00b7 Skew-symmetric distribution  \u00b7 Econophysics.\n\n\nMathematics Subject Classification (2010). MSC 60E05 \u00b7 MSC 62Exx \u00b7 MSC 62Fxx.\n\n\n\n\n\n\n\n\u00a7 INTRODUCTION\n\n\nRelating the standard deviation (\u03c3) to the range is a well-studied topic <cit.>. However, most of the results found in the literature in this regard propose inequalities or relationships that depend on the shape of the population distribution. <cit.> recently suggested a power law between \u03c3 and the semi-range \u2113 without knowing the population distribution, but assuming  symmetric truncated forms restricted to \u2113\u226a 1. They argued that truncation is a phenomenon naturally generated by the sampling process. In their approach, conditional distribution properties can link the usual unbounded distribution for describing unobserved data.\n\nHere, we establish a closed-form expression for the variance of truncated distributions valid for all \u2113 > 0. We start with the general case (Section <ref>), by considering a truncated variable X over the interval [a,b] based on a cumulative distribution function G with unbounded support as a skewing function. For c \u2208 (a,b) and p>0, we present a general form for \ud835\udd3c[(X-c)^p] as well as its asymptotic behavior as the support's semi-range tends to zero and \u221e. We also present some inequalities that included Popoviciu's inequality as a special case. \n\nSection <ref> presents some properties and examples regarding the symmetrically truncated distribution as a particular case. Importantly, we deduce the form of the ratio \u03c3/\u2113 as a function of G and \u2113. For illustrative purposes, we have presented an example using actual financial data (Section <ref>). They consist of 16 million tick-by-tick returns of four currencies against the US dollar transacted on foreign exchange markets. Finally, Section <ref> makes some brief concluding remarks.\n \n\n\n\u00a7 MAIN RESULTS\n\n\n\n\n \u00a7.\u00a7 General case\n\n\nSuppose we have a random variable with cumulative distribution function (CDF) G(x) and with infinite support. Based on G, given two real numbers a and b, such that a<b, we have\n\n\n    F_X(x)\n    =\n    G(x)-G(a) G(b)-G(a),    a<x<b,\n\nto be the truncated CDF of a random variable X with support (a,b). Then, we have the following result concerning its moments.\n\n\n\n\n\n\n\n\nLet c and p be real numbers such that a<c<b and p>0.\nThen, the p-th moment about c is given by\n\n    \ud835\udd3c[(X-c)^p]\n    =\n    1G(b)-G(a) [\n    \t(b-c)^p G(b)\n    \t-\n    \t(a-c)^p G(a)\n    -\n    p I_G(c;a-c,b-c,p)\n    ],\n\nwhere I_G(c;s,t,p) is defined as\n\n    I_G(c; s,t,p)=\u222b_s^t y^p-1 G(y+c)  dy,    s<t.\n\n\n\n\n\nFrom (<ref>), we have\n\n    \ud835\udd3c[(X-c)^p]\n    \n    \n       =\n    1 G(b)-G(a)\u222b_a^b (x-c)^p  dG(x)\n    \n       \n    =\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    p G(b)-G(a){\u222b_a^c[ \u222b_0^x-c y^p-1  dy]  dG(x)\n    +\n    \u222b_c^b[ \u222b_0^x-c y^p-1  dy]  dG(x)\n    }.\n\nChange the order of integration,\nthe above expression can be written as\n\n    =\n    p G(b)-G(a){\u222b_0^a-cy^p-1[ \u222b_a^y+c dG(x) ]   dy\n    +\n    \u222b_0^b-cy^p-1[ \u222b_y+c^b dG(x) ]   dy\n    }\n       =\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    1 G(b)-G(a)[\n    (b-c)^p G(b)\n    -\n    (a-c)^p G(a)] \n       \n    -\n    p G(b)-G(a)\u222b_a-c^0 y^p-1 G(y+c)  dy\n    -\n    p G(b)-G(a)\u222b_0^b-c y^p-1 G(y+c)  dy,\n\nwhich completes the proof of the theorem.\n\n\n\n\n\tUnder the conditions of Theorem <ref>, \n\twe have\n\t\n    \ud835\udd3c[(X-c)^p]\n    \t\u2a7d\n    \t\t(b-c)^p [1-F_X(c)]\n    \t\t+\n    \t\t(a-c)^p F_X(c),    if p  is even,\n    \t\t\n    \n    \t\t(b-c)^p [1-F_X(c)],    if p  is odd,\n\n\twhere F_X is as given in (<ref>).\n\n\nIt is evident that\n\n    I_G(c;a-c,b-c,p)=I_G(c;a-c,0,p)+I_G(c;0,b-c,p).\n\n\nAssuming p to be even, for a-c<y<0, we have y^p-1 G(c)< y^p-1 G(y+c)< y^p-1G(a), and for 0<y<b-c, we have y^p-1G(c)<y^p-1 G(y+c)<y^p-1G(b). Consequently, we get\n\n    I_G(c;a-c,0,p)\u2a7e -G(c) (c-a)^p p  and  \n    I_G(c;0,b-c,p)\u2a7eG(c) (b-c)^p p.\n\nNow, upon using these inequalities in (<ref>), we obtain\n\n    I_G(c;a-c,b-c,p)\u2a7eG(c) p [(b-c)^p-(c-a)^p].\n\nUsing the above inequality in the expression in Theorem <ref>, we get\n\n    \ud835\udd3c[(X-c)^p]\n    \u2a7d1G(b)-G(a) {\n    (b-c)^p G(b)\n    -\n    (a-c)^p G(a)\n    -\n    G(c) [(b-c)^p-(c-a)^p]\n    }.\n\nFrom (<ref>), the right-hand side of the above inequality can be rewritten as \n\n    =\n    (b-c)^p [1-F_X(c)]\n    +\n    (a-c)^p F_X(c).\n\nThis proves the inequality for the case when p is even.\n\nThe inequality for the case when p is odd can be established in an analogous manner.\n\n\n\n\nWhen p is even, a lower bound for \ud835\udd3c[(X-c)^p] can be established as below.\n\nUnder the conditions of Theorem <ref>, \nfor p even, we have\n\n    \ud835\udd3c[(X-c)^p]\n    \t\u2a7e \n    \t(t-c)^p [F_X(b)-F_X(t)],   if c<t<b.\n\n\n\nSuppose p is even. Then, as\n(X-c)^p\u2a7e 0 and (X-c)^p\u2a7e (t-c)^p for X>t>c, it is clear that\n\n    \ud835\udd3c[(X-c)^p]\n    \u2a7e\ud835\udd3c[(X-c)^p1_{X>t}]\n    \u2a7e\n    (t-c)^p \ud835\udd3c[1_{X>t}],\n\nwhich yields the required result.\n\n\n\n\n\n\tUnder the conditions of Theorem <ref>, \n\twe have\n\n    min_a<c<b\ud835\udd3c[(X-c)^p]\n    \t\u2a7d(b-a2)^p,    if p  is even,\n    \t\n    \n    \t0,    if p\u2a7e 1  is odd.\n\n\n\nSuppose p is even. In this case, from Corollary <ref>, we have\n\n\n    \ud835\udd3c[(X-c)^p]\n    \u2a7d\n    (b-c)^p [1-F_X(c)]\n    +\n    (a-c)^p F_X(c)\n    \u2a7d\n    S(F(c))\n    T(c),\n\nwhere S(F(c))=max{1-F_X(c), F_X(c)} and T(c)=(b-c)^p\n+\n(a-c)^p. As F_X(c)=1/2 is a minimum point of M(F(c)), we have\n\n    min_0<F(c)<1 S(F(c))=1 2.\n\nTaking the minimum over 0<F(c)<1 in (<ref>), we get\n\n    \ud835\udd3c[(X-c)^p]\n    \u2a7d1 2 \n    T(c).\n\nNow, taking the minimum over a<c<b in the above inequality and using the fact that the function T(c) reaches a minimum value at the point c=(a+b)/2, we get\n\n    min_a<c<b\ud835\udd3c[(X-c)^p]\u2a7d1 2  T(a+b 2)=(b-a2)^p.\n\nThis proves the inequality for the case when p is even. Further, \nthe inequality for the case when p is odd trivially follows from Corollary <ref>.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe variance \u03c3^2 can be expressed as\n\t\n    \u03c3^2 =  Var(X)\n    \t\t=\n    \t\t1G(b)-G(a) [\n    \t\t(b-\u03bc)^2 G(b)\n    \t\t-\n    \t\t(a-\u03bc)^2 G(a)\n    \t\t-\n    \t\t2 I_G(\u03bc;a-\u03bc,b-\u03bc)\n    \t\t],\n\n\twhere \u03bc=\ud835\udd3c(X) and  \n\t\n    I_G(\u03bc;s,t)=\u222b_s^t y G(y+\u03bc)  dy,    s<t.\n\n\n\nBy taking c=\u03bc and p=2 in Theorem <ref>, \nwe obtain the required result.\n\n\n\n\nThe Popoviciu inequality <cit.> on variances given by\n\n    \u03c3^2\u2a7d(b-a2)^2,\n\nfollows from Proposition <ref>.\n\n\n\tThe proof follows immediately by setting p=2 in  Proposition <ref>.\n\n\n\nA reverse form of Popoviciu's inequality can be obtained upon taking p=2, c=\u03bc=\ud835\udd3c(X) and t=(\u03bc+b)/2 in Proposition <ref>.\n\nWe have\n\n    \u03c3^2 \u2a7e(b-\u03bc2)^2 [F_X(b)-F_X(\u03bc+b 2)].\n\n\n\n\n\n\n\n\n\n\n\n\n  \u00a7.\u00a7.\u00a7 Asymptotic behavior\n\nIn the following theorem, we establish the asymptotic behaviour of the p-th moment.\n\n\n\tIf X is distributed as in (<ref>), then\n\twe have\n\n    lim_b-a 2\u27f6 0^+\ud835\udd3c[(X-ab-a)^p ]\n    =\n    1 p+1,    p>-1,\n\nand\n\n    lim_b-a 2\u27f6\u221e\ud835\udd3c[(X-ab-a)^p ]\n    =\n    1 2^p.\n\n\n\nFrom (<ref>), we find\n\t\n    F_X-a/b-a(z)\n    \t=\n    \tG(z(b-a)+a)-G(a) G(b)-G(a)\n    \t=\n    \tG(b-a 2 (2z-1)+a+b 2)-G(a+b 2-b-a 2) \n    \tG(b-a 2+a+b 2)-G(a+b 2-b-a 2),  0<z<1.\n\t\nNow, it is a simple task to verify that\n\n    lim_b-a 2\u27f6 0 F_X-a/b-a(z)\n    =\n    \n    \n    \n    F_U(z), \n      \u2200 z\u2208\u211d,\n\nand\n\n    lim_b-a 2\u27f6\u221e F_X-a/b-a(z)\n    =\n    F_Y(z), \n      \u2200 z\u22601 2,\n\nwhere U\u223c U(0,1) and Y is a discrete random variable such that \u2119(Y=1/2)=1. \n\nMoreover, we note that [(X-a)/(b-a)]^p is uniformly integrable because 0<(X-a)/(b-a)<1. As convergence in distribution along with uniform integrability imply convergence in mean <cit.>, we have\n\n    lim_b-a 2\u27f6 0^+\ud835\udd3c[(X-ab-a)^p ]\n    =\n    \ud835\udd3c(U^p),    p>-1,\n\nand\n\n    lim_b-a 2\u27f6\u221e\ud835\udd3c[(X-ab-a)^p ]\n    =\n    \ud835\udd3c(Y^p),\n\nwhich completes the proof of the theorem.\n\n\n\n\nWe further have\n\t\n    lim_b-a 2\u27f6 0^+\u03c3^2 +(\u03bc-a)^2 (b-a)^2=1 3  and  lim_b-a 2\u27f6\u221e\u03c3^2 (b-a)^2= 0.\n\nwhere \u03bc=\ud835\udd3c(X) and \u03c3^2 =  Var(X).\n\n\n\tBy taking p=2 in Theorem <ref>, the above results follow readily.\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Symmetric case\n\n\n\n\tIn this section, we assume that G is a skewing function, i.e., it is such that G(x)\u2a7e 0 and G(-x)=1-G(x), and X distributed as in (<ref>) with a=-\u2113 and b=\u2113>0. That is, X has its CDF as\n\n    F_X(x)\n    =\n    G(x)+G(\u2113)-1 2G(\u2113)-1,    -\u2113<x<\u2113.\n\n\n\nThe variance \u03c3^2 can be expressed as\n\t\n    \u03c3^2\n    \t=\n    \t\u2113^2 H(\u2113),\n\nwhere \n       \n    H(\u2113) = 1-2C(\u2113)-12G(\u2113)-1,\n\n with C(\u2113)=C(\u2113,G) defined as\n\t\n    C(\u2113)=2\u2113^2\u222b_0^\u2113 yG(y)  dy.\n\n\tMoreover, 1/2\u2a7d C(\u2113)\u2a7d G(\u2113).\n\n\nAs G is a skewing function, we have \u03bc=\ud835\udd3c(X)=0. Moreover, I_G(\u03bc;a-\u03bc,b-\u03bc) in Proposition <ref> satisfies the identity \n\t\n    I_G(\u03bc;a-\u03bc,b-\u03bc)=\u2113^2[C(\u2113)-1 2].\n\nUpon substituting this in Proposition <ref> and carrying out some simple algebraic steps, the required result follows.\n\n\n\n\n\n\tIt is useful to observe that, knowing C(\u2113) (see Table <ref> for some explicit examples of these constants), Proposition <ref> gives a more informative result than Popoviciu's inequality and present\n\tin particular a method for the exact calculation of the variance of truncated distributions of the form in (<ref>).\n\n\n\nIn Table <ref>, \u03a6 is the CDF of a standard normal distribution,\n\n\n\nLi_2[z]=-\u222b_0^z log(1-x)/x  dx is the polylogarithm function  of order 2 and erf(z)=(2/\u221a(\u03c0)) \u222b_0^z exp(-x^2) dx is the error function.\n\n\n\nWe further have\n\n    lim_\u2113\u27f6 0^+H(\u2113) = lim_\u2113\u27f6 0^+\u03c3^2\u2113^2=1 3  and  lim_\u2113\u27f6\u221eH(\u2113) = lim_\u2113\u27f6\u221e\u03c3^2\u2113^2= 0.\n\n\n\nUpon taking a=-\u2113, b=\u2113 and \u03bc=0 in Corollary <ref>, the required result follows.\n\n\nNext, we present two further examples in addition to Table <ref>.\n\n\n\n\nLet X be a truncated symmetric standard Cauchy distribution with density function f(x) = (2 arctan\u2113)^-1\u00b7(1+x^2)^-1 if |x| < \u2113, with \u2113\u2a7d 1, and f(x)=0, if |y| > \u2113. As its variance is \u03c3^2 = \u2113/arctan\u2113 - 1 <cit.>, we obtain\n       \n    H(\u2113) = 1/\u2113arctan\u2113 - 1/\u2113^2.\n\n\n\n\n\nLet X be a symmetrically truncated standard Gaussian distribution with density function f(x) = {\u221a(2\u03c0) [1-2\u03a6(-\u2113)]}^-1exp(-x^2/2), if |x| < \u2113, where \u2113\u2a7d 1 and \u03a6 is the standard Gaussian cumulative distribution function, and f(x)=0, if |x| > \u2113 <cit.>. As its variance can be expressed as \u03c3^2 = 1 - 2 \u2113 f(\u2113), we find\n       \n    H(\u2113) = 1/\u2113^2 - 2/\u2113^3 f(\u2113).\n\n\n\nIn both these examples, we observe H(\u2113) \u2192 1/3 as \u2113\u2193 0 and H(\u2113) \u2191 0 as \u2113\u2191\u221e, as stated in Proposition <ref>. However, \n       \n    \u2113 H(\u2113) = \u03c3^2/\u2113\n\nbehaves differently as \u2191\u221e. In the first example,  \u2113 H(\u2113)  \u2192  2/\u03c0, but in the second example, we find  \u2113 H(\u2113)  \u2192  0. \n \n\n\n\n\n\n\n\n\n\u00a7 ILLUSTRATION WITH FINANCIAL DATA\n \n\nWe illustrate the results developed here with intraday spot exchange rate data of four currencies against the US dollar transacted on the foreign exchange (Forex) market. There are 16 million tick-by-tick returns of bid prices provided by Tick Data, LLC (Table <ref>). Following the discussion regarding the truncated nature of the past <cit.>, we consider the symmetric case here. \n\nFor each currency, let {X_ij} be the jth return observed on day i = 1,\u2026, d (Table <ref>). Taking the daily sample standard deviation s_i and the maximum daily absolute return \u2113_i = max_1\u2264 j \u2264 n_i{X_ij}, where n_i denotes the sample size on day i with n = \u2211_i=1^d n_i, Figure <ref> depicts the daily sample ratios {s_i/\u2113_i} in the form of dots.\n\nNow, consider the general sequence ignoring days as {X_t}, where t = 1,\u2026, n. Letting \n\u2113^* = max_1\u2264 t \u2264 n{X_t}, we generated a grid of 1,000 truncation points, \n{\u2113: \u2113 = m \u2113^*/1000, where  m = 1,\u2026, 1000}. For each \u2113 over this grid, we obtained the sample standard deviation of the conditional (truncated) data {X_t| |X_t| \u2264\u2113}.\nIn this way, we empirically find the form of the ratio \u03c3/ \u2113 for the returns of each currency (Figure <ref>). Then, Proposition <ref> provides a feasible and practical way of describing the relationship between the variance and the cutoff \u2113. For small \u2113, <cit.> proposed the power law \u03c3^\u03b2/ \u2113\u2248\u03b6 from a second-order approximation, where \u03b2 > 0 and \u03b6 are real constants. So, we may approximate \u03c3/\u2113 as\n\n    \u03c3/\u2113\u2248\u03b6^1/\u03b2\u2113^- 1 + 1/\u03b2.\n\nFigure <ref> depicts the log-log plots of this approximated result, and shows the validity of such a power law approximation for \u03c3/\u2113.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a7 CONCLUDING REMARKS\n \n\n\nIn this work, we have presented a general approach for understanding the relationship between the variance and the range of a general family of truncated distributions based on skewing functions. We have established a closed-form expression for its moments and their asymptotic behavior as the support's semi-range tends to zero and \u221e.\n\nAs discussed previously by <cit.>, if the truncated nature arises naturally from the past, the function relating truncation length and standard deviation may assist in connecting the bounded past and unbounded future data. For this reason, we expect our results to be useful in many practical situations.\n\n\n\n\n\n\n\n\n\n\n\n  \nAcknowledgements\nRoberto Vila gratefully acknowledges financial support from CNPq, CAPES, and FAP-DF, Brazil.\nRaul Matsushita acknowledges financial support from CNPq, CAPES, FAP-DF, and DPI/DPG/UnB, Brazil. \n\n\n  \nDisclosure statement\nThere are no conflicts of interest to disclose.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Billingsley, 1968]Billingsley1968\nBillingsley, P. (1968). Convergence of Probability Measures. John Wiley & Sons, New York.\n\n[David et\u00a0al., 1954]David\nDavid, \u00a0H.\u00a0A., Hartley, \u00a0H.\u00a0O. and Pearson, \u00a0E. \u00a0S.  (1954). \nThe distribution of the ratio, in a single normal sample, of range to standard deviation.\nBiometrika, 41:482\u2013493.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Johnson, Kotz and Balakrishnan, 1994]Johnson.Kotz.1970\nJohnson, N. L., Kotz, S. and Balakrishnan, N. (1994),\nContinuous Univariate Distributions.\nVol. 1, Second edition. John Wiley & Sons, New York.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Matsushita et\u00a0al., 2020]Matsushita2020\nMatsushita, R., Da Silva, S., Da Fonseca, R. and Nagata, M. (2020).\nBypassing the truncation problem of truncated L\u00e9vy flights.\nPhysica A, 559:125035.\n\n[Matsushita et\u00a0al., 2023]Matsushita2023\nMatsushita, R., Da Silva, S., Da Fonseca, R. and Nagata, M. (2023).\nRetrodicting with the truncated L\u00e9vy flight.\nCommunications in Nonlinear Science and Numerical Simulation, 126:106900.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Popoviciu, 1935]Popoviciu1935\nPopoviciu, T. (1935). \nSur les \u00e9quations alg\u00e9briques ayant toutes leurs racines r\u00e9elles.\nMathematica (Cluj), 9:129\u2013145.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[Shone, 1949]Shone\nShone, K.\u00a0J. (1949).\nRelations between the standard deviation and the distribution of range in non-Normal populations.\nJournal of the Royal Statistical Society. Series B , 11:85\u201388.\n\n\n\n\n\n\n\n\n\n\n\n[Tippett, 1925]Tippett\nTippett, L.\u00a0H.\u00a0C. (1925).\nOn the extreme individuals and the range of samples taken from a normal population.\nBiometrika, 17:364\u2013387.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}