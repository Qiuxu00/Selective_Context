{"entry_id": "http://arxiv.org/abs/2303.07042v1", "published": "20230313120540", "title": "Harmonic Field-based Provable Exploration of 3D Indoor Environments", "authors": ["Raksi Kopo", "Charalampos P. Bechlioulis", "Kostas J. Kyriakopoulos"], "primary_category": "cs.RO", "categories": ["cs.RO"], "text": "\nBayesian Approach to Micromechanical Parameter Identification Using Integrated Digital Image Correlation\n    [\n    Received; accepted\n========================================================================================================\n\n\n\nempty\nempty\n\n\n\n\n\n\nThis work presents a safe and efficient methodology for autonomous indoor exploration with aerial robots using Harmonic Potential Fields (HPF). The challenge of applying HPF in complex 3D environments rests on high computational load involved in solving the Laplace equation. To address this issue, the proposed solution utilizes the Fast Multiple accelerated Boundary Element Method with boundary values controlled to ensure both safety and convergence. The methodology is validated through simulations that demonstrate its efficiency, safety and convergence.\n\n\n\n\n \n\n\n\n\n\n\u00a7 INTRODUCTION\n\nAutonomous robotic exploration has a range of useful applications, including search and rescue missions, infrastructure inspection, and mapping. Robots operating autonomously can reduce the risks and costs associated with human exploration in hazardous and remote environments. Several methods have been developed aiming to address the autonomous exploration problem. A popular approach is maximizing the expected information gain <cit.>. In general, this involves finding the control action that minimizes a utility function, which encompasses the map's uncertainty, the uncertainty in the robot's position, and possibly a type of cost for executing the control action, usually the path length. In <cit.> Rapidly Random exploring Trees (RRT) path planning is introduced in information gain exploration. The authors in <cit.> use Frontier-based Exploration planning <cit.> for global exploration and the exploration method in <cit.> to improve the performance of the latter in larger environments.\n\nAn alternative approach utilizes Artificial Potential Fields (APF) in exploration. Compared to RRTs, which ensure probabilistic exploration, meaning full exploration given infinite time, APFs can ensure complete exploration if they are free of local minima. Furthermore, APFs can produce smooth trajectories and are inherently reactive. The two main approaches in constructing free of local minima APF are Navigation Functions <cit.> and Harmonic Potential Fields <cit.>. The former requires parameter tuning, while the latter is inherently free of local minima inside their domain of definition. The main drawbacks of such approaches are that they might require extraction of a closed form workspace representation from the probabilistic map or, in the case of HAPF, they can be computationally chalenging to calculate using conventional methods like Finite Elements or Finite Differences. These problems become more difficult in three dimensions due to more complex geometries and larger workspace volume. The method in <cit.> uses Fast Multiple Boundary Element Method (FastBEM) which significantly accelerates the calculation of the harmonic potential. In another work <cit.>, the author uses GPU-parallelised Finite Differences and devises an algorithm to eliminate the explored flat potential areas from future calculations.\n\nIn this work, we extend the results presented in <cit.> to three-dimensional complex indoor environments. The proposed exploration scheme guarantees complete exploration of such environments in finite time, while producing smooth and safe trajectories. We use Fast Multiple Boundary Element Method (FastBEM) to efficiently calculate the Harmonic Potential Field navigating the robot. Contrary to [11], we have developed algorithms for the removal of explored dead ends and robust boundary extraction, which further improve the exploration process. Finally, we demonstrate the effectiveness of our approach by testing it in a realistic indoor environment.\n\n\n\n\n\u00a7 PROBLEM FORMULATION\n\nThe initially unknown workspace W is a compact and connected subspace of ^3. The interior of W is the free space and its boundary can be considered as a union of disconnected closed surfaces with multiple handles. In most cases, there is only one surface if there are no floating or flying obstacles present. We assume that the robot has spherical sensing capabilities, meaning that its sensing space S(p) is composed of all line segments starting at the robot's position p=[x,y,z] with a length no greater than a specified range r and lying inside W. At a given time instance t, the explored space \u03b5(t) is defined as the union of sensing spaces S(p) for all positions p along the path P(t) that the robot has traversed up to that time. More specifically, the explored space at a time instance t is defined as \u03b5(t)=\u22c3_p\u2208 P(t) S(p), where P(t) is the path that the robot has traversed in time t.  The boundary of the explored space consists of two different sets: the occupied boundary \u2202\u03b5_o, which is comprised of parts of \u2202 W and the free boundary parts \u2202\u03b5_f, which belong to the unoccupied space. The former remains the same while the latter is integrated into the interior of \u03b5 as the robot explores the workspace.\n\n\nProblem definition: Assuming a robot that obeys a single integrator kinematic model \u1e57=u with initial position p(0)=p_0 \u2208 intW, find a control law u=f(p,t,\u03b5) that generates a path P(T), so that in finite time T>0 , \u03b5(T)=W.\n\n\n\n\u00a7 METHODOLOGY\n\nThe central idea behind boundary value problem (BVP) exploration is to find a harmonic potential field \u03c6(p) by solving the Laplace equation (<ref>), subject to boundary conditions that assign attractive potential unexplored frontiers and repulsive potential to boundaries corresponding to obstacles:\n\n\n    \u2207^2\u03c6(p)=0,\n\n  \n    \u2202\u03c6/\u2202 n=\u2207\u03c6\u00b7 n(q) =k(q),\u00a0\u2200 q\u2208\u2202\u03b5\n\n\n\nwhere n(q) denotes the unit normal vector of \u2202\u03b5 at q and k(q) is a given function that evaluates the directional derivative of \u03c6(p) over the boundary \u2202\u03b5. \n \n\n For the boundary value problem (<ref>) with Neumann conditions (<ref>) to have a solution, the potential function must satisfy the compatibility constraint. This constraint states that the flux (flow) of the gradient field of \u03c6 across the boundary of the region must be equal to zero. \n\n    \u222c_\u2202\u03b5\u2207\u03c6\u00b7 n dS=0\n\n\n\nAn important property of harmonic functions, namely the maximum principle, states that a non-constant harmonic function cannot attain a maximum or minimum at an interior point of its domain. This implies that the values of a harmonic function in a bounded domain are bounded by its maximum and minimum values on the boundary. This makes harmonic potential fields suitable for autonomous navigation since the robot cannot be trapped in a local minimum.\n\n\n\n \u00a7.\u00a7 Fast Multi-pole Boundary Element Method\n\nThe method chosen to solve the Laplace equation is the Fast Multi-pole accelerated Boundary Element Method (FastBEM) developed in <cit.> which accelerates the conventional BEM and it is more efficient than Finite Element Method and Finite Difference Method in terms of computational time and memory requirements and for complex boundary geometries such as those of indoor environments. In conventional BEM <cit.> the boundary of the domain \u2202\u03b5 is discretized and the boundary value problem (<ref>) is reformulated to boundary integral equations (<ref>) using Green's second identity and the fundamental solution. More specifically, the solution at a point p\u2208\u03b5, inside the domain is expressed as a linear combination of the boundary values of the potential and its normal derivative:\n\n\n    \u03c6 (p)= H_p\u00b7\u03c6\u0302-G_p\u00b7k\u0302\n    \nFor Neumann BVPs, the unknown boundary values of the potential, \u03c6\u0302=[\u03c6\u0302_1, \u03c6\u0302_2, ..., \u03c6\u0302_N]^T, depend linearly on the boundary values of its normal derivative, k\u0302=[k\u0302_1, k\u0302_2, ...,k\u0302_N]^T\n\n    \u03c6\u0302= H^-1\u00b7 G \u00b7k\u0302\n\nwhere N is the number of boundary elements. The definitions of the 1\u00d7 N vectors H_p, G_p and the N\u00d7 N matrices H, G which contain the surface integrals of the fundamental solution and its normal derivative on each element can be found in <cit.>. The computational load of the Boundary Element Method primarily lies in assembling the BEM matrix H and solving the associated linear system. It is worth noting that the entries of H depend only on the geometry of the boundary, so if certain parts of the boundary do not change, the corresponding entries of the matrix are computed only once and reused, which reduces the computational effort significantly.\n\n In conventional BEM the computation of the matrix H requires O(N^2) operations and the solution of the system H\u00b7\u03c6\u0302=G\u00b7k\u0302 using direct solvers requires O(N^3) operations. The main idea of FastBEM is to use iterative solvers with the Fast Multi-pole Method to accelerate the matrix-vector multiplication H\u00b7\u03c6\u0302 in each iteration without ever forming the entire matrix H explicitly. The boundary elements are subdivided via an octree decomposition and the interactions among elements in conventional BEM are replaced by cell to cell interactions of the octree. Direct integration is performed only for the elements that are close to the source point whereas multi-pole  expansions are used for far away elements. This reduces the number of operations to O(N) decreasing dramatically the solution time. Moreover, the use of iterative solvers reduces significantly the memory requirements since the elements of H do not need to be explicitly stored.\n\n\n\n\n \u00a7.\u00a7 Occupancy Grid Mapping\n\nThe representation of the explored space \u03b5 is done through occupancy grid maps <cit.>. An occupancy probability value Pr(m) is assigned to each grid cell and updated using algorithms similar to those described in Chapter 9 of <cit.>, extended to three dimensions. Each point q\u2208\u2202\u03b5 inherits the probability of the cell that contains it, Pr(q)=Pr(m(q)), \u2225 c-q\u2225_\u221e\u2264 m_r/2, where c denotes the center of cell m and m_r the cell size of the map in meters per cell. Defining an occupancy probability threshold a\u2208[0.5,1] we can classify each boundary point q\u2208\u2202\u03b5 as occupied or free and define the sets \u2202\u03b5_o and \u2202\u03b5_f as \u2202\u03b5_o={q\u2208\u2202\u03b5: Pr(q)\u2265a} and \u2202\u03b5_f=\u2202\u03b5\u2216\u2202\u03b5_o.\n\n\n \u00a7.\u00a7 Velocity Control Law\n\nThe robot's velocity control law has the form:\n\n    u=-K_u\u00b7 s\u00b7\u2207_p\u03c6(p,k\u0302)\n\nwhere K_u is a scaling constant and s=S_R_1(d(p,\u2202\u03b5)) denotes a function that asymptotically approaches zero as the robot approaches the boundary, for instance: \n\n    S_a(x)={[                 1,                x>a; 3(x/a)^2-2(x/a)^3,            0\u2264 x\u2264 a;                 0,               x<0.;                    ].\n\nBy the definition of S_R_1 we see that whenever the minimum euclidean distance d(p,\u2202\u03b5) between the robot and the the boundary becomes less that a constant R_1, the robot will start slowing down.\n\n\n \u00a7.\u00a7 Construction of the Boundary Value Problem\n\nIn order to guarantee safety and complete exploration via (<ref>), as it will be shown later in the next section, the boundary values k\u0302 will track their desired target values k\u0302_t that will be designed in the sequel.\n\n\n  \u00a7.\u00a7.\u00a7 Target Boundary Values\n\nFirst, we will define k\u0302_t as:\n\n    k\u0302_t=k/k'_m I(q)k'(q).\n\n\nThe function k'(q) is defined using (<ref>) as:\n\n    k'={[ S_1-\u03b1(Pr(q)-\u03b1),         Pr(q)\u2265\u03b1;  -S_\u03b1(\u03b1-Pr(q)),         Pr(q)<\u03b1;                 ].\n\nand it assigns the appropriate sign to each target boundary value based on the probability occupancy Pr(q) of the corresponding boundary element at position q and the occupancy threshold \u03b1\u2208 [0.5, 1]. The function I(q) defined as\n\n    I(q)={[  \u222c_\u2202\u03b5_pk'dS,       q\u2208\u2202\u03b5_p;             ; -\u222c_\u2202\u03b5_nk'dS,       q\u2208\u2202\u03b5_n;              ].\n\nis used to render the target boundary values compatible as shown in (<ref>) for the feasibility of the BVP solution. The sets \u2202\u03b5_p={q\u2208\u2202\u03b5 : k'(q)\u22650} and \u2202\u03b5_n={q\u2208\u2202\u03b5 : k'(q)<0} correspond to the parts of the boundary where k' is positive and negative respectively.\nRegarding k and k'_m, it should be noted that k is a constant that specifies the maximum and minimum values of k\u0302_t and k'_m=max_q\u2208\u2202\u03b5(\u2225k'(q)/I(q)\u2225).\n    \n\n\n\n  \u00a7.\u00a7.\u00a7 Boundary Value Control Law\n\nThe boundary values k\u0302 converge to the desired target values k\u0302_\u0302t\u0302 through the following control law:\n\n    k\u0307\u0302\u0307=(c\u03bc+b_e)(k\u0302_t-k\u0302)  , k\u0302(0)=k\u0302_0\n\nThe parameters c and \u03bc are defined as c=S_\u03f5_w(\u2225\u2207_p\u03c6-\u03f5_1\u2225) and \u03bc=S_\u03bc_1(K_u s\u2225\u2207_p\u03c6\u2225^2/\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225+\u03f5_2) with \u03f5_w, \u03f5_1 and \u03f5_2 small positive constants. The term c ensures that k\u0307\u0302\u0307\u2192 0 as the robot converges to a critical point of \u03c6, whereas \u03bc is used to adjust the rate with which the boundary values approach the target values. By specifying \u03bc_1 > 9/8 we ensure that S_\u03bc_1(x)<x, \u2200 x > 0. The usefulness of this will become apparent in the next section. Regarding the term \u2202\u03c6/\u2202k\u0302=[\u2202\u03c6/\u2202k\u0302_1, \u2202\u03c6/\u2202k\u0302_2..., \u2202\u03c6/\u2202k\u0302_N] in \u03bc, we see that combining (<ref>) and (<ref>) we have \u03c6 = (H_p\u00b7 H^-1\u00b7 G-G_p)\u00b7k\u0302, therefore \u2202\u03c6/\u2202k\u0302=H_p\u00b7 H^-1\u00b7 G-G_p. Finally, b_e is defined as\n\n    b_e={[                     0, if  k\u0302(q) \u22650  \u2200 q\u2208\u2202\u03b5_o;                       ;                     1,              otherwise;                        ].\n\nand ensures that the potential becomes safe by increasing the convergence rate of k\u0302 to the desired target value k\u0302_t in case there exists an attractive occupied boundary, such as when a previously free part of the boundary is replaced by an obstacle during exploration.\n\n\n \u00a7.\u00a7 Proof of Safety and Complete Exploration\n\nIn this subsection, we state some useful theoretical results regarding the aforementioned control design.\n\n k\u0302_t is bounded and compatible.\n\n\n From the definition of k'_m it holds that\n    \n    k'_m\u2265\u2225k'(q)/I(q)\u2225\u21d2\u2225kk'(q)/k'_m I(q)\u2225\u2264k\u21d2 -k\u2264k\u0302_t\u2264k\n\n    therefore k\u0302_t is bounded. Also\n\n    \u222c_\u2202\u03b5k\u0302_tdS=\u222c_\u2202\u03b5kk'(q)/k'_m I(q)dS=\u222c_\u2202\u03b5_pkk'(q)/k'_m I(q)dS+\u222c_\u2202\u03b5_nkk'(q)/k'_m I(q)dS\n\n    \n\n   \n    =k/k'_m \u222c_\u2202\u03b5_pk'dS\u222c_\u2202\u03b5_pk'(q)dS-k/k'_m \u222c_\u2202\u03b5_nk'dS\u222c_\u2202\u03b5_nk'(q)dS=k/k'_m-k/k'_m=0\n\n which completes the proof.\n\n\n Assuming that k\u0302 is compatible for t = 0, the adaptive law (<ref>) guarantees that k\u0302 will remain compatible and bounded for all time.   \n\n\n\n    Assume that k\u0302_i(t)=k\u0305 for some time  t \u2265 0. Then, k\u0307\u0302\u0307_i must be non-positive because it is proportional to k\u0302_t,i-k\u0302_i and k\u0302_t,i\u2264k thus, k\u0302_i cannot exceed k. Similarly, it holds that -k\u2264k\u0302_i. Therefore k\u0302 is bounded. Next, we denote as I_c the closed surface integral of k\u0302. For constant boundary elements\n   \n    I_c=\u222c_\u2202\u03b5k\u0302dS=\u2211_i=1^N A_i k\u0302_i=A\u00b7k\u0302\n where A=[A_1, A_2, ..., A_N] denotes the areas of each element. In case A_i=A_j, i\u2260 j then we remove the j-th elements from A and k\u0302 and replace k\u0302_i with k\u0302_i+k\u0302_j so that the new A is full column rank. Taking the derivative of I_c w.r.t. time we have\n\n    \u0130_\u0307\u010b=\u0226\u00b7k\u0302+A\u00b7k\u0307\u0302\u0307=\u0226\u00b7k\u0302+A\u00b7 (c\u03bc+b_e)(k\u0302_t-k\u0302)\n \n    and from the compatibility of k\u0302_t, i.e., A\u00b7k\u0302_t=0, we obtain:\n    \n    \u0130_\u0307\u010b=\u0226\u00b7k\u0302-A\u00b7k\u0302(c\u03bc+b_e)=[\u0226\u00b7(A^T\u00b7 A)^-1\u00b7 A^T-(c\u03bc+b_e)] A\u00b7k\u0302\n \n    \n    \u0130_\u0307\u010b=[\u0226\u00b7(A^T\u00b7 A)^-1\u00b7 A^T-(c\u03bc+b_e)]I_c.\n\n    Therefore if k satisfies the compatibility condition, I_c=0, at t=0 then it satisfies it for all t\u22650. Considering this, we choose k\u0302_0=k\u0302_t,0 as initial conditions for (<ref>). \n    \n\n\n    If the potential \u03c6(p,k\u0302) is unsafe, the control law (<ref>) guarantees it will become safe in finite time.\n\n\nWhen the robot is using the potential field computed in the previous time step of the newly explored occupied boundary, \u2202\u03b5_o may have attractive potential rendering \u03c6 unsafe. In that case, b_e in (<ref>) is activated so that in finite time k\u0302 approaches the desired positive value k\u0302_t asymptotically and the potential field computed in the next step becomes safe eventually.\n\n\n\n    The function \u03c6(p,k\u0302) is lower bounded.\n\n\n    Due to well-posedness of the boundary value problem \u03c6(p,k\u0302) depends continuously on the boundary conditions k\u0302\u2208[-k,k],  \u2200 p\u2208\u03b5. The set [-k,k] is closed therefore by the extreme value theorem \u03c6 accepts a maximum and a minimum value in {(p,k\u0302)| k\u0302\u2208[-k,k]  and  p\u2208\u03b5}. Therefore it is lower bounded.\n    \n\n\n    The robot's trajectory under control law (<ref>) is safe.\n\n\n    If \u03c6 is safe then all points in the occupied boundary are repulsive and collision avoidance is ensured. In case \u03c6 is not safe, it will become safe in finite time as p\u2192\u2202\u03b5_o, which means that the robot approaches the boundary asymptotically, therefore in the worst case the robot stops at the boundary. Assuming accurate sensing and that the updated potential field is computed as the robot moves, the occupied boundary becomes strictly repulsive and collision avoidance is ensured.  \n     \n\n\n\n Assuming b_e=0, the proposed robot control guarantees the full exploration of W in finite time from almost any initial configuration.\n\n\nBarbalat's lemma will be used to prove that d\u03c6/dt\u21920 as t\u2192\u221e. The following conditions must be satisfied: 1) \u03c6 has a finite limit as t\u2192\u221e, and 2) d\u03c6/dt is uniformly continuous w.r.t. time. For the first condition we showed that \u03c6(p,k\u0302) is lower bounded and we need to show that d\u03c6/dt\u22640, where:\n\n    d\u03c6/dt=\u2207_p\u03c6\u00b7dp/dt+\u2202\u03c6/\u2202k\u0302\u00b7dk\u0302/dt\n\n\n    d\u03c6/dt\u2264-K_us\u2225\u2207_p\u03c6\u2225^2+\u2225\u2202\u03c6/\u2202k\u0302\u00b7(k\u0302_t-k\u0302)\u2225 c\u03bc.\n\nFor \u03bc_1>9/8 it holds that:\n\n    K_us\u2225\u2207_p\u03c6\u2225^2/\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225+\u03b5_2\u2265 S_\u03bc_1(K_us\u2225\u2207_p\u03c6\u2225^2/\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225+\u03b5_2)\n\n\n    K_us\u2225\u2207_p\u03c6\u2225^2\u2265 (\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225+\u03b5_2)\u03bc\n\n\n    K_us\u2225\u2207_p\u03c6\u2225^2\u2265\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225 c \u03bc\n\n\n    0\u2265-K_us\u2225\u2207_p\u03c6\u2225^2+\u2225\u2202\u03c6/\u2202k\u0302(k\u0302_t-k\u0302)\u2225 c \u03bc.\n\nNext, we show that d\u03c6/dt is uniformly continuous w.r.t. time. It suffices to show that d\u03c6/dt is locally Lipschitz continuous since \u03c6 has been proven bounded.\nIn the first term of d\u03c6/dt in (<ref>) , s is locally Lipschitz continuous and bounded between 0 and 1, \u2207_p\u03c6 is real analytic and thus locally Lipschitz and bounded in \u03b5. Therefore, the first term of d\u03c6/dt is locally Lipschitz continuous as a product of locally Lipschitz continuous and bounded functions. Regarding the second term, it can be shown that it is continuous and has a piece-wise continuous first derivative, as a composition of such functions. Using the extreme value theorem, it can be shown that the derivative of the second term is bounded. Thus, using the mean value theorem it can be shown that the second term of d\u03c6/dt is locally Lipschitz continuous. Consequently, d\u03c6/dt is locally Lipschitz continuous.\n\nTherefore the conditions of Barbalat's lemma are fulfilled and the derivative of \u03c6 w.r.t. time converges to 0 as t\u2192\u221e. By (<ref>) we see that d\u03c6/dt\u2192 0 occurs in two cases: i) when the robot approaches the free boundary (s\u21920 and \u03bc\u21920) and ii) when \u2225\u2207_p\u03c6\u2225\u21920 (c\u21920).\nThe second case, means that the robot converges to a critical point of \u03c6 which for a harmonic function is an unstable saddle. Therefore, the robot will move towards the free boundary of W and thus fully explore it in finite time.\n\n\n\n\u00a7 IMPLEMENTATION\n\n\n\n \u00a7.\u00a7 Boundary Extraction\n\nAfter obtaining the occupancy map of the explored workspace, we need to extract its boundary in form of a closed triangulated surface which is required by the BEM solver. In this implementation, we used 3D Delaunay triangulation <cit.> due to its computational efficiency and ability to produce the required closed surface. The implementation steps are given as follows:\n\n\n\n\n\n \u00a7.\u00a7 Dead End Closing\n\nGiven a generated map and trajectory, the goal of this algorithm is to remove the explored regions that the robot will not have to traverse again (i.e., areas with no unexplored free boundaries). To do this we need to identify boundary patches between the region to be removed and the remaining space. Once the region has been removed, the boundaries between the remaining space and the removed region are set to have an occupancy probability of 0.99, indicating that they are now considered occupied. For simplicity, the algorithm considers only one boundary patch at a time that separates the explored space into two distinct regions. In this implementation, we examine planar patches that intersect the trajectory and are perpendicular to it. Next, we provide the implementation steps of the algorithm and demonstrate the results from its application on the \u201dMaze\" environment in Figure <ref>. The figure shows the boundary of the explored space on the left and the boundary that is used in the Fast BEM solver after applying the dead end closing algorithm on the right.\n\n\n\n\n\n\u00a7 RESULTS\n\nIn this section, we present the simulation results from our implementation. The sensing and occupancy grid mapping were simulated using Matlab's Navigation Toolbox. The environments were designed in CAD software and imported as mesh files. All aforementioned algorithms where implemented in Matlab 2020b, except the Laplace solver which is provided in <cit.>. The controller parameter values that are used in the following simulations are shown in TABLE <ref>. We test our algorithm in two different environments shown in Figure <ref>. The first is a small corridor maze in order to demonstrate the performance of the dead end closing algorithm and the second is a more complex and larger environment representing a two story building with multiple rooms. \n\n\n\n\n\n\n \u00a7.\u00a7 Generated Maps and Trajectories\n\nThe generated maps and trajectories are shown in Figures <ref> and <ref> and the corresponding path lengths and exploration times in Table <ref>. We see that the robot has fully explored the testing environments in reasonable time and maintains a safe distance from the explored space's boundaries. Regarding the Corridor Maze environment, we see that the dead end closing algorithm helped reduce the total exploration time by a factor of 1.6. As for the two story building environment the robot was able to revisit the upper and lower floor to explore remaining space. This validates the completeness of the proposed exploration scheme for large and complex environments. Regarding the performance of FastBEM, the computation of the unknown boundary values in (<ref>) was conducted every 10 iterations or when the robot approached close to the free boundary and rose linearly from 2 sec for 2500 elements to 27 sec for 27000 elements for the two story building. For the corridor maze those numbers where lower than 6 sec and lower than 2 sec when we applied the dead end closing algorithm. The maximum computation time of the gradient \u2207_p\u03c6 from (<ref>) per step was 0.2 and 0.12 sec for the Two-story and the Corridor Maze, respectively. For the latter, the dead end closing algorithm reduced the gradient computation time below 0.04 seconds.\n\n\n\n\n\n\n\n\n\n\n \u00a7.\u00a7 Comparison\n\nIn this subsection, we compare the performance of our algorithm with two other state-of-the-art algorithms: the receding horizon next best view planner (RH-NBVP) <cit.> and the frontier-based planner <cit.>, on the same indoor environment. In order to compensate for the narrower field of view used in <cit.>, which was [60^\u2218,90^\u2218] with a depth of 5 meters, we used a smaller sensing radius of 3 meters instead of 5 meters. Additionally, we lowered our map's resolution to 3 cells/m to ensure compatibility with the RH-NBVP's map resolution of 2.5 cells/m. The generated maps and trajectories for our algorithm are shown in Figure <ref> for two different starting positions, while those for the RH-NBVP and the frontier-based planner are shown in Figure <ref>. Regarding the exploration time, the overall time of the RH-NBVP was 501 seconds, the frontier-based planner was 470 seconds (on average), and our algorithm was faster than the other two algorithms, with 451 seconds and 371 seconds respectively for the two initial points. All approaches fully explored the environment, but the trajectories generated by our algorithm are smoother (smaller radius of curvature more than 0.45m), maintain a safe distance from the walls more than 0.35m and transverse every corridor of the environment. In contrast, the trajectories generated by the other approaches contain sharp turns, approach close to the walls (the minimum distance reached 0.05m) and do not extend evenly to all the corridors of the environment.\n\n\n\n\n\n\n\n\u00a7 CONCLUSIONS\n\nIn summary, this work presents a safe, smooth, efficient and provably complete method for 3D exploration of complex indoor environments. Furthermore, we proposed two algorithms for robust boundary extraction and for reduction of the boundary's size by removing explored dead ends automatically. The aforementioned properties were validated by simulation results in various types of environments. In comparison to two existing approaches, we showed that the proposed scheme outperforms them in terms of safety, trajectory smoothness and exploration time in a typical indoor environment. For future research, we aim at applying a faster GPU-based version of FMBEM in real experiments and extending the methodology to outdoor environments for tasks like inspection of structures.\n\n\n\nieeetran\n\n\n"}